/*! For license information please see officewebsurfaces.core.min.js.LICENSE.txt */
var OfficeWebSurfaces=function(e){function t(t){for(var n,i,o=t[0],a=t[1],s=0,c=[];s<o.length;s++)i=o[s],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&c.push(r[i][0]),r[i]=0;for(n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n]);for(u&&u(t);c.length;)c.shift()()}var n={},r={0:0};function i(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.e=function(e){var t=[],n=r[e];if(0!==n)if(n)t.push(n[2]);else{var o=new Promise((function(t,i){n=r[e]=[t,i]}));t.push(n[2]=o);var a,s=document.createElement("script");s.charset="utf-8",s.timeout=120,i.nc&&s.setAttribute("nonce",i.nc),s.src=function(e){return i.p+""+({1:"officewebsurfaces.fabric"}[e]||e)+".59f38e6397fb39c60fd6.min.js"}(e);var u=new Error;a=function(t){s.onerror=s.onload=null,clearTimeout(c);var n=r[e];if(0!==n){if(n){var i=t&&("load"===t.type?"missing":t.type),o=t&&t.target&&t.target.src;u.message="Loading chunk "+e+" failed.\n("+i+": "+o+")",u.name="ChunkLoadError",u.type=i,u.request=o,n[1](u)}r[e]=void 0}};var c=setTimeout((function(){a({type:"timeout",target:s})}),12e4);s.onerror=s.onload=a,document.head.appendChild(s)}return Promise.all(t)},i.m=e,i.c=n,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i.oe=function(e){throw console.error(e),e};var o=window.webpackJsonpOfficeWebSurfaces=window.webpackJsonpOfficeWebSurfaces||[],a=o.push.bind(o);o.push=t,o=o.slice();for(var s=0;s<o.length;s++)t(o[s]);var u=a;return i(i.s=7)}([function(e,t,n){"use strict";n.d(t,"h",(function(){return r})),n.d(t,"j",(function(){return i})),n.d(t,"l",(function(){return o})),n.d(t,"k",(function(){return a})),n.d(t,"i",(function(){return s})),n.d(t,"g",(function(){return u})),n.d(t,"b",(function(){return c})),n.d(t,"f",(function(){return l})),n.d(t,"a",(function(){return f})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return v})),n.d(t,"e",(function(){return p}));var r="function",i="object",o="undefined",a="prototype",s="hasOwnProperty",u="default",c=Object,l=c[a],f=c.assign,d=c.create,v=c.defineProperty,p=l[s]},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return s}));var r=n(0),i=null;function o(e){return void 0===e&&(e=!0),i&&e||(typeof globalThis!==r.l&&globalThis&&(i=globalThis),typeof self!==r.l&&self&&(i=self),typeof window!==r.l&&window&&(i=window),typeof window!==r.l&&window&&(i=window)),i}function a(e){throw new TypeError(e)}function s(e){var t=r.c;if(t)return t(e);if(null==e)return{};var n=typeof e;function i(){}return n!==r.j&&n!==r.h&&a("Object prototype may only be an Object:"+e),i[r.k]=e,new i}},,function(e,t,n){"use strict";function r(e,t){return void 0===t&&(t=!0),e&&(t&&function(e){var t,n;return e&&((n=e)&&n._virtual)&&(t=e._virtual.parent),t}(e)||e.parentNode&&e.parentNode)}n.d(t,"a",(function(){return r}))},,function(e,t,n){e.exports=n(10)},function(e,t){!function(){"use strict";if("object"==typeof window)if("IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype)"isIntersecting"in window.IntersectionObserverEntry.prototype||Object.defineProperty(window.IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return this.intersectionRatio>0}});else{var e=window.document,t=[],n=null,r=null;o.prototype.THROTTLE_TIMEOUT=100,o.prototype.POLL_INTERVAL=null,o.prototype.USE_MUTATION_OBSERVER=!0,o._setupCrossOriginUpdater=function(){return n||(n=function(e,n){r=e&&n?l(e,n):{top:0,bottom:0,left:0,right:0,width:0,height:0},t.forEach((function(e){e._checkForIntersections()}))}),n},o._resetCrossOriginUpdater=function(){n=null,r=null},o.prototype.observe=function(e){if(!this._observationTargets.some((function(t){return t.element==e}))){if(!e||1!=e.nodeType)throw new Error("target must be an Element");this._registerInstance(),this._observationTargets.push({element:e,entry:null}),this._monitorIntersections(e.ownerDocument),this._checkForIntersections()}},o.prototype.unobserve=function(e){this._observationTargets=this._observationTargets.filter((function(t){return t.element!=e})),this._unmonitorIntersections(e.ownerDocument),0==this._observationTargets.length&&this._unregisterInstance()},o.prototype.disconnect=function(){this._observationTargets=[],this._unmonitorAllIntersections(),this._unregisterInstance()},o.prototype.takeRecords=function(){var e=this._queuedEntries.slice();return this._queuedEntries=[],e},o.prototype._initThresholds=function(e){var t=e||[0];return Array.isArray(t)||(t=[t]),t.sort().filter((function(e,t,n){if("number"!=typeof e||isNaN(e)||e<0||e>1)throw new Error("threshold must be a number between 0 and 1 inclusively");return e!==n[t-1]}))},o.prototype._parseRootMargin=function(e){var t=(e||"0px").split(/\s+/).map((function(e){var t=/^(-?\d*\.?\d+)(px|%)$/.exec(e);if(!t)throw new Error("rootMargin must be specified in pixels or percent");return{value:parseFloat(t[1]),unit:t[2]}}));return t[1]=t[1]||t[0],t[2]=t[2]||t[0],t[3]=t[3]||t[1],t},o.prototype._monitorIntersections=function(t){var n=t.defaultView;if(n&&-1==this._monitoringDocuments.indexOf(t)){var r=this._checkForIntersections,i=null,o=null;if(this.POLL_INTERVAL?i=n.setInterval(r,this.POLL_INTERVAL):(a(n,"resize",r,!0),a(t,"scroll",r,!0),this.USE_MUTATION_OBSERVER&&"MutationObserver"in n&&(o=new n.MutationObserver(r)).observe(t,{attributes:!0,childList:!0,characterData:!0,subtree:!0})),this._monitoringDocuments.push(t),this._monitoringUnsubscribes.push((function(){var e=t.defaultView;e&&(i&&e.clearInterval(i),s(e,"resize",r,!0)),s(t,"scroll",r,!0),o&&o.disconnect()})),t!=(this.root&&this.root.ownerDocument||e)){var u=v(t);u&&this._monitorIntersections(u.ownerDocument)}}},o.prototype._unmonitorIntersections=function(t){var n=this._monitoringDocuments.indexOf(t);if(-1!=n){var r=this.root&&this.root.ownerDocument||e;if(!this._observationTargets.some((function(e){var n=e.element.ownerDocument;if(n==t)return!0;for(;n&&n!=r;){var i=v(n);if((n=i&&i.ownerDocument)==t)return!0}return!1}))){var i=this._monitoringUnsubscribes[n];if(this._monitoringDocuments.splice(n,1),this._monitoringUnsubscribes.splice(n,1),i(),t!=r){var o=v(t);o&&this._unmonitorIntersections(o.ownerDocument)}}}},o.prototype._unmonitorAllIntersections=function(){var e=this._monitoringUnsubscribes.slice(0);this._monitoringDocuments.length=0,this._monitoringUnsubscribes.length=0;for(var t=0;t<e.length;t++)e[t]()},o.prototype._checkForIntersections=function(){if(this.root||!n||r){var e=this._rootIsInDom(),t=e?this._getRootRect():{top:0,bottom:0,left:0,right:0,width:0,height:0};this._observationTargets.forEach((function(r){var o=r.element,a=u(o),s=this._rootContainsTarget(o),c=r.entry,l=e&&s&&this._computeTargetAndRootIntersection(o,a,t),f=r.entry=new i({time:window.performance&&performance.now&&performance.now(),target:o,boundingClientRect:a,rootBounds:n&&!this.root?null:t,intersectionRect:l});c?e&&s?this._hasCrossedThreshold(c,f)&&this._queuedEntries.push(f):c&&c.isIntersecting&&this._queuedEntries.push(f):this._queuedEntries.push(f)}),this),this._queuedEntries.length&&this._callback(this.takeRecords(),this)}},o.prototype._computeTargetAndRootIntersection=function(t,i,o){if("none"!=window.getComputedStyle(t).display){for(var a,s,c,f,v,p,h,g,m=i,y=d(t),b=!1;!b&&y;){var w=null,C=1==y.nodeType?window.getComputedStyle(y):{};if("none"==C.display)return null;if(y==this.root||9==y.nodeType)if(b=!0,y==this.root||y==e)n&&!this.root?!r||0==r.width&&0==r.height?(y=null,w=null,m=null):w=r:w=o;else{var T=d(y),E=T&&u(T),S=T&&this._computeTargetAndRootIntersection(T,E,o);E&&S?(y=T,w=l(E,S)):(y=null,m=null)}else{var x=y.ownerDocument;y!=x.body&&y!=x.documentElement&&"visible"!=C.overflow&&(w=u(y))}if(w&&(a=w,s=m,c=void 0,f=void 0,v=void 0,p=void 0,h=void 0,g=void 0,c=Math.max(a.top,s.top),f=Math.min(a.bottom,s.bottom),v=Math.max(a.left,s.left),p=Math.min(a.right,s.right),g=f-c,m=(h=p-v)>=0&&g>=0&&{top:c,bottom:f,left:v,right:p,width:h,height:g}||null),!m)break;y=y&&d(y)}return m}},o.prototype._getRootRect=function(){var t;if(this.root)t=u(this.root);else{var n=e.documentElement,r=e.body;t={top:0,left:0,right:n.clientWidth||r.clientWidth,width:n.clientWidth||r.clientWidth,bottom:n.clientHeight||r.clientHeight,height:n.clientHeight||r.clientHeight}}return this._expandRectByRootMargin(t)},o.prototype._expandRectByRootMargin=function(e){var t=this._rootMarginValues.map((function(t,n){return"px"==t.unit?t.value:t.value*(n%2?e.width:e.height)/100})),n={top:e.top-t[0],right:e.right+t[1],bottom:e.bottom+t[2],left:e.left-t[3]};return n.width=n.right-n.left,n.height=n.bottom-n.top,n},o.prototype._hasCrossedThreshold=function(e,t){var n=e&&e.isIntersecting?e.intersectionRatio||0:-1,r=t.isIntersecting?t.intersectionRatio||0:-1;if(n!==r)for(var i=0;i<this.thresholds.length;i++){var o=this.thresholds[i];if(o==n||o==r||o<n!=o<r)return!0}},o.prototype._rootIsInDom=function(){return!this.root||f(e,this.root)},o.prototype._rootContainsTarget=function(t){return f(this.root||e,t)&&(!this.root||this.root.ownerDocument==t.ownerDocument)},o.prototype._registerInstance=function(){t.indexOf(this)<0&&t.push(this)},o.prototype._unregisterInstance=function(){var e=t.indexOf(this);-1!=e&&t.splice(e,1)},window.IntersectionObserver=o,window.IntersectionObserverEntry=i}function i(e){this.time=e.time,this.target=e.target,this.rootBounds=c(e.rootBounds),this.boundingClientRect=c(e.boundingClientRect),this.intersectionRect=c(e.intersectionRect||{top:0,bottom:0,left:0,right:0,width:0,height:0}),this.isIntersecting=!!e.intersectionRect;var t=this.boundingClientRect,n=t.width*t.height,r=this.intersectionRect,i=r.width*r.height;this.intersectionRatio=n?Number((i/n).toFixed(4)):this.isIntersecting?1:0}function o(e,t){var n,r,i,o=t||{};if("function"!=typeof e)throw new Error("callback must be a function");if(o.root&&1!=o.root.nodeType)throw new Error("root must be an Element");this._checkForIntersections=(n=this._checkForIntersections.bind(this),r=this.THROTTLE_TIMEOUT,i=null,function(){i||(i=setTimeout((function(){n(),i=null}),r))}),this._callback=e,this._observationTargets=[],this._queuedEntries=[],this._rootMarginValues=this._parseRootMargin(o.rootMargin),this.thresholds=this._initThresholds(o.threshold),this.root=o.root||null,this.rootMargin=this._rootMarginValues.map((function(e){return e.value+e.unit})).join(" "),this._monitoringDocuments=[],this._monitoringUnsubscribes=[]}function a(e,t,n,r){"function"==typeof e.addEventListener?e.addEventListener(t,n,r||!1):"function"==typeof e.attachEvent&&e.attachEvent("on"+t,n)}function s(e,t,n,r){"function"==typeof e.removeEventListener?e.removeEventListener(t,n,r||!1):"function"==typeof e.detatchEvent&&e.detatchEvent("on"+t,n)}function u(e){var t;try{t=e.getBoundingClientRect()}catch(e){}return t?(t.width&&t.height||(t={top:t.top,right:t.right,bottom:t.bottom,left:t.left,width:t.right-t.left,height:t.bottom-t.top}),t):{top:0,bottom:0,left:0,right:0,width:0,height:0}}function c(e){return!e||"x"in e?e:{top:e.top,y:e.top,bottom:e.bottom,left:e.left,x:e.left,right:e.right,width:e.width,height:e.height}}function l(e,t){var n=t.top-e.top,r=t.left-e.left;return{top:n,left:r,height:t.height,width:t.width,bottom:n+t.height,right:r+t.width}}function f(e,t){for(var n=t;n;){if(n==e)return!0;n=d(n)}return!1}function d(t){var n=t.parentNode;return 9==t.nodeType&&t!=e?v(t):n&&11==n.nodeType&&n.host?n.host:n&&n.assignedSlot?n.assignedSlot.parentNode:n}function v(e){try{return e.defaultView&&e.defaultView.frameElement||null}catch(e){return null}}}()},function(e,t,n){"use strict";String.prototype.startsWith||Object.defineProperty(String.prototype,"startsWith",{value:function(e,t){var n=!t||t<0?0:+t;return this.substring(n,n+e.length)===e}}),String.prototype.endsWith||(String.prototype.endsWith=function(e,t){var n=t;return(void 0===n||n>this.length)&&(n=this.length),this.substring(n-e.length,n)===e})},function(e,t,n){"use strict";n.r(t),n.d(t,"GetSurfaceContainerId",(function(){return To})),n.d(t,"Initialize",(function(){return Io})),n.d(t,"RemoveSurface",(function(){return Vo})),n.d(t,"RenderSurface",(function(){return ja}));n(8);!function(){if("function"!=typeof window.CustomEvent){var e=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e[0],r=e[1],i=void 0===r?{}:r,o=i.bubbles,a=void 0!==o&&o,s=i.cancelable,u=void 0!==s&&s,c=i.detail,l=void 0===c?null:c,f=document.createEvent("CustomEvent");return f.initCustomEvent(n,a,u,l),f};e.prototype=Event.prototype,window.CustomEvent=e}}();n(9);var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var o=function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function a(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function s(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))}function u(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}Object.create;function c(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}var l;Object.create;function f(){try{return window&&window.navigator&&window.navigator.userAgent?window.navigator.userAgent:""}catch(e){return""}}!function(e){e[e.Unknown=0]="Unknown",e[e.Windows=1]="Windows",e[e.Mac=2]="Mac",e[e.Unix=3]="Unix",e[e.Linux=4]="Linux"}(l||(l={}));var d,v=(-1===(d=function(){var e=f(),t=-1,n=e.indexOf("MSIE ");if(n>0&&(t=parseInt(e.substring(n+5,e.indexOf(".",n)),10)),e.indexOf("Trident/")>0){var r=e.indexOf("rv:");t=parseInt(e.substring(r+3,e.indexOf(".",r)),10)}return t}())&&(d=function(){var e=f(),t=-1;if(e.indexOf("Trident/")>0){var n=e.indexOf("rv:");t=parseInt(e.substring(n+3,e.indexOf(".",n)),10)}return t}()),d>0),p=!1;function h(){return p&&null!==console&&null!==console.log}var g,m=function(e){if(!e||!Object.assign)return e;var t={};return Object.keys(e).forEach((function(n){"object"==typeof e[n]?Object.assign(t,m(e[n])):t[n]=e[n]})),t};function y(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];h()&&(v?console.log(t,m(n)):console.log("%c%s",e,t,m(n)))}function b(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];y.apply(void 0,c(["color:red",e],t))}function w(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];y.apply(void 0,c(["color:blue",e],t))}function C(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];h()&&(window&&!("Firebug"in window)?console.assert.apply(console,c([e,t],n)):e||b.apply(void 0,c(["Assertion failure: "+t],n)))}function T(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];h()&&C(e,t,n)}!function(e){e[e.None=0]="None",e[e.Trace=1]="Trace",e[e.Info=2]="Info",e[e.Warning=3]="Warning",e[e.Error=4]="Error"}(g||(g={}));var E,S,x=function(){var e=this;this.name=function(){return"ConsoleLogSink"},this.beginEvent=function(){return null},this.isLocal=function(){return!0},this.endEvent=function(t,n){T(!n,"Expected context to be null for sink",e.name()),e.writeEntry(t)},this.writeEntry=function(e){if(e.messageData){var t=function(e){switch(e){case g.Info:return"color:green";case g.Warning:return"color:Orange";case g.Error:return"color:red";default:b("Unknown LogLevel: ",e)}return"color:black"}(e.messageData.logLevel),n=e.messageData;y(t,"Log."+g[e.messageData.logLevel],"0x"+n.eventTagId.toString(16),n.message,n.messageDetails)}e.eventActionData&&w("Log.Event:"+e.eventActionData.eventActionType,{tagId:"0x"+e.eventActionData.eventTagId.toString(16)},e.eventActionData,e.customData)}};!function(e){e.DataClassification={EssentialServiceMetadata:1,AccountData:2,SystemMetadata:4,OrganizationIdentifiableInformation:8,EndUserIdentifiableInformation:16,CustomerContent:32,AccessControl:64},e.DataFieldType={String:0,Boolean:1,Int64:2,Double:3,Guid:4},e.SamplingPolicy={NotSet:0,Measure:1,Diagnostics:2,CriticalBusinessImpact:191,CriticalCensus:192,CriticalExperimentation:193,CriticalUsage:194},e.PersistencePriority={NotSet:0,Normal:1,High:2},e.CostPriority={NotSet:0,Normal:1,High:2},e.DataCategories={NotSet:0,SoftwareSetup:1,ProductServiceUsage:2,ProductServicePerformance:4,DeviceConfiguration:8,InkingTypingSpeech:16},e.DiagnosticLevel={ReservedDoNotUse:0,Required:10,BasicEvent:10,Optional:100,FullEvent:100,RequiredServiceData:110,NecessaryServiceDataEvent:110,RequiredServiceDataForEssentialServices:120,AlwaysOnNecessaryServiceDataEvent:120},e.CustomerContentType={None:0,MocaAddIn:1},e.LogLevel={Error:0,Warning:1,Info:2,Verbose:3},e.Category={Core:0,Sink:1,Transport:2}}(E||(E={})),function(e){e[e.None=0]="None",e[e.Test=1]="Test",e[e.Dev=2]="Dev",e[e.Edog=3]="Edog",e[e.Int=4]="Int",e[e.Prod=5]="Prod"}(S||(S={}));var k,D=function(e){switch(e||"production"){case"development":return S.Dev;case"test":return S.Test;default:return S.Prod}},I=function(e,t){var n=t||"production";T(n,"Invalid environment!");var r=e||"";T(r,"Invalid deployment url!");var i=r.toLowerCase(),o=0===i.indexOf("http");S.None;return o?i.indexOf("//localhost:")>=0||i.indexOf("//127.0.0.1:")>=0?S.Dev:i.indexOf("/int/")>=0?S.Int:i.indexOf("/edog/")>=0?S.Edog:S.Prod:"development"===n?S.Dev:"test"===n?S.Test:S.Prod},_=new function(){var e=this;this.config=null,this.setConfiguration=function(t){e.config=t},this.getConfiguration=function(){return e.config},this.isProduction=function(){return D()===S.Prod},this.isTest=function(){return D()===S.Test},this.isDevelopment=function(){return D()===S.Dev}},O=new Uint8Array(16);function A(){if(!k&&!(k="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return k(O)}var P=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var L=function(e){return"string"==typeof e&&P.test(e)},N=[],M=0;M<256;++M)N.push((M+256).toString(16).substr(1));var F=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(N[e[t+0]]+N[e[t+1]]+N[e[t+2]]+N[e[t+3]]+"-"+N[e[t+4]]+N[e[t+5]]+"-"+N[e[t+6]]+N[e[t+7]]+"-"+N[e[t+8]]+N[e[t+9]]+"-"+N[e[t+10]]+N[e[t+11]]+N[e[t+12]]+N[e[t+13]]+N[e[t+14]]+N[e[t+15]]).toLowerCase();if(!L(n))throw TypeError("Stringified UUID is invalid");return n};var B=function(e,t,n){var r=(e=e||{}).random||(e.rng||A)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var i=0;i<16;++i)t[n+i]=r[i];return t}return F(r)},R=function(){return B().toString()},U=function(e){return s(void 0,void 0,void 0,(function(){return u(this,(function(t){return[2,new Promise((function(t){setTimeout(t,e)}))]}))}))},j=(Object.keys,new Date),H=R(),z=function(e){return e===Object(e)},q=j.toISOString();function K(e){return{correlationId:R(),currentTime:(new Date).toISOString(),environment:e?S[e.Environment]:S[S.None],sessionId:e&&e.CustomSessionId?e.CustomSessionId:H,sessionStartTime:q}}function W(){var e=-1,t=window&&window.performance;if(t){var n=t.timeOrigin||t.timing&&t.timing.navigationStart;e=n&&Date.now()-n}return e}function V(){return{windowHeight:window?window.innerHeight:void 0,windowWidth:window?window.innerWidth:void 0}}function J(){return{browserLang:navigator?navigator.language:"Error",browserOnline:!!navigator&&navigator.onLine,browserUserAgent:navigator?navigator.userAgent:"Error",colorDepth:screen?screen.colorDepth:-1,pixelDepth:screen?screen.pixelDepth:-1,screenHeight:screen?screen.height:-1,screenWidth:screen?screen.width:-1}}function Q(e,t,n,r){T(e!==g.None,"Invalid logLevel"),C(t>0,"Invalid tagId"),T(n,"Invalid message"),T(r,"Invalid messageDetails");var i=r&&r.length>0?r.map((function(e){return"string"==typeof e?e:Z(e)})):void 0,o="string"==typeof n?{eventFlags:void 0,message:n}:n;return{eventFlags:o.eventFlags,eventTagId:t,logLevel:e,message:o.message,messageDetails:i}}var X=function(e,t){e&&Object.keys(e).forEach((function(n){var r=e[n];null!=r&&(z(r)?t(n,JSON.stringify(r)):("string"==typeof r||function(e){return"boolean"==typeof e}(r)||function(e){return"number"==typeof e}(r))&&t(n,r))}))};function G(e,t){T(t,"Invalid callback"),T(e,"Invalid logEntry"),X(e.metadata,t),X(e.messageData,t),X(e.eventActionData,t),X(e.customData,t),X(e.browserData,t)}var $=["name","number","message","description"];function Z(e){return JSON.stringify(e,(function(e,t){if(t instanceof Error){var n={name:"",message:""};return Object.getOwnPropertyNames(t).forEach((function(e){var r=e;-1!==$.indexOf(e.toLowerCase())&&(n[r]=t[r])})),n}return t}))}var Y=function(e,t){return void 0===t&&(t={dataCategories:E.DataCategories.ProductServicePerformance,diagnosticLevel:E.DiagnosticLevel.RequiredServiceData}),o(o({},t),e)},ee=new function(e,t,n){var r=this;void 0===n&&(n=g.Info),this.logSinks=e,this.configuration=t,this.logLevel=n,this.assert=C,this.debug=T,this.clearSinks=function(){r.logSinks=[]},this.setLogLevel=function(e){return r.logLevel=e},this.getLogLevel=function(){return r.logLevel},this.getConfiguration=function(){return r.configuration},this.setConfiguration=function(e){return r.configuration=e},this.updateCustomData=function(e){r.configuration&&(r.configuration.CustomMetadata=o(o({},r.configuration.CustomMetadata),e))},this.addSink=function(e){if(e){var t=r.logSinks.filter((function(t){return t.name()===e.name()}));T(!t||0===t.length,"Sink already exists",e,r.logSinks),t&&t.length>0||r.logSinks.push(e)}else C(e,"Invalid logSink!")},this.removeSinks=function(e){r.logSinks.filter((function(t){return t.name()===e})).forEach((function(e){var t=r.logSinks.indexOf(e);r.logSinks.splice(t,1)}))},this.reserve=function(e){return e},this.trace=function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var o=r.createMessageLogEntry(Q(g.Trace,e,t,n));r.writeEntry(o)},this.info=function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var o=r.createMessageLogEntry(Q(g.Info,e,t,n));r.writeEntry(o)},this.warn=function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var o=r.createMessageLogEntry(Q(g.Warning,e,t,n));r.writeEntry(o)},this.error=function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var o=r.createMessageLogEntry(Q(g.Error,e,t,n));r.writeEntry(o)},this.local=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var i=r.createMessageLogEntry(Q(g.Info,68769,e,t));r.writeEntry(i,!0)},this.localWarn=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var i=r.createMessageLogEntry(Q(g.Warning,68769,e,t));r.writeEntry(i,!0)},this.instrument=function(e,t,n,i){return void 0===i&&(i={}),s(r,void 0,void 0,(function(){var r,o,s,c,l,f,d=this,v=i.logError,p=void 0===v||v,h=i.onEndEvent,g=i.rethrow,m=void 0===g||g,y=a(i,["logError","onEndEvent","rethrow"]);return u(this,(function(i){switch(i.label){case 0:r=this.beginEvent(e,t,y),y.payloadData||(y.payloadData={}),o=y.payloadData,s=function(){d.endEvent(r,o),h&&h(o.resultType)},c=null,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,n(o)];case 2:return c=i.sent(),o.resultType=o.resultType||"None",s(),[3,4];case 3:if(l=i.sent(),f=l,p&&this.error(592801920,"Instrumentation error handler",e,t,f),o.resultType="Failure",!o.resultInfo&&p&&(o.resultInfo=Z(f)),!o.responseCode&&f.code&&(o.responseCode=f.code),s(),m)throw f;return[3,4];case 4:return[2,c]}}))}))},this.event=function(e,t,n){void 0===n&&(n={});var i=r.beginEvent(e,t,n);r.endEvent(i,void 0,!1)},this.userActionEvent=function(e,t,n){var i=void 0===n?{}:n,a=i.customData,s=i.eventFlags,u=i.payloadData;return r.event(e,t,{customData:a,eventFlags:o({dataCategories:E.DataCategories.ProductServiceUsage},s),payloadData:u})},this.beginEvent=function(e,t,n){void 0===n&&(n={}),r.assert(0!==e,"Invalid eventTagId"),r.debug(t,"Invalid eventActionType");var i={};return r.safeEnumerateSinks((function(e){var r=e.beginEvent(t,Y(n.eventFlags));r&&(i[e.name()]=r)})),{eventActionType:t,eventData:n,eventEnded:!1,eventStartTime:Date.now(),eventTagId:e,sinkContexts:i}},this.beginUserActionEvent=function(e,t,n){var i=void 0===n?{}:n,a=i.customData,s=i.eventFlags,u=i.payloadData;return r.beginEvent(e,t,{customData:a,eventFlags:o({dataCategories:E.DataCategories.ProductServiceUsage},s),payloadData:u})},this.endEvent=function(e,t,n){if(void 0===n&&(n=!0),r.debug(e,"Invalid beginEventData"),r.assert(!e.eventEnded,"Event already ended - "+e.eventActionType),r.debug(e.eventData,"Invalid eventData",e),r.debug(e.eventStartTime,"Invalid eventStartTime",e),r.debug(e.eventActionType,"Invalid eventActionType",e),e&&!e.eventEnded){if(n){var i=e.eventData,a=e.eventStartTime,s=Date.now();i.payloadData=o({responseTime:s-a},i.payloadData)}r.configuration&&r.configuration.CustomMetadata&&(e.eventData.customData=o(o({},r.configuration.CustomMetadata),e.eventData.customData)),e.eventData.payloadData=o(o({},e.eventData.payloadData),t),r.sendEvent(e)}},this.createEventLogEntry=function(e){var t=e.eventTagId,n=e.eventActionType,i=e.eventData,a=i.customData,s=i.eventFlags,u=i.payloadData;return{customData:a,eventActionData:o({eventActionType:n,eventTagId:t},u),eventFlags:Y(s),metadata:K(r.configuration)}},this.createMessageLogEntry=function(e){var t=e.eventFlags,n=a(e,["eventFlags"]);return{eventFlags:Y(t),messageData:n,metadata:K(r.configuration)}},this.writeEntry=function(e,t){void 0===t&&(t=!1),e.messageData&&e.messageData.logLevel<r.logLevel||r.safeEnumerateSinks((function(t){t.writeEntry(e)}),t)},this.sendEvent=function(e){var t=r.createEventLogEntry(e),n=e.sinkContexts;r.safeEnumerateSinks((function(e){e.endEvent(t,n[e.name()])})),e.eventEnded=!0},this.safeEnumerateSinks=function(e,t){if(void 0===t&&(t=!1),T(r.logSinks,"Invalid input",e,r.logSinks),r.logSinks)for(var n=0,i=r.logSinks;n<i.length;n++){var o=i[n];try{(!t||o.isLocal&&o.isLocal())&&e(o)}catch(t){T(!1,"Error with callback",t,o,e)}}}}([]);function te(e){var t="";if(void 0!==e){var n=document.querySelector('script[src^="'+e+'"]');n&&(t=n.getAttribute("src"))}return t||void 0}var ne,re=(ne=[],{fireEvent:function(e){ne.forEach((function(t){return t(e)}))},addListener:function(e){e&&ne.push(e)}});function ie(e,t,n){re.fireEvent({level:e,category:t,message:n})}function oe(e,t,n){ie(0,e,(function(){var e=n instanceof Error?n.message:"";return"".concat(t,": ").concat(e)}))}var ae={};var se=/^Office(\.[A-Z][a-zA-Z0-9]*){2,}$/,ue=/^[a-zA-Z0-9_\.]{1,95}$/;function ce(e){if(!function(e){if(!e||e.length>98)return!1;return se.test(e)}(e.eventName))throw new Error("Invalid eventName");var t=e.eventContract;if(t){if(t.name&&!le(t.name))throw new Error("Invalid eventContract");fe(t.dataFields)}fe(e.dataFields)}function le(e){return ue.test(e)}function fe(e){e&&e.forEach((function(e){if("string"!=typeof e.name||!le(e.name))throw new Error("Invalid dataField name");2===e.dataType&&function(e){if("number"!=typeof e||!isFinite(e)||Math.floor(e)!==e||e<-9007199254740991||e>9007199254740991)throw new Error("Invalid integer ".concat(JSON.stringify(e)))}(e.value)}))}function de(e,t){return{name:e,dataType:1,value:t,classification:4}}function ve(e,t){return{name:e,dataType:2,value:t,classification:4}}function pe(e,t){return{name:e,dataType:0,value:t,classification:4}}function he(e){var t={eventName:e.eventName,eventFlags:e.eventFlags||{},telemetryProperties:e.telemetryProperties?o({},e.telemetryProperties):{},dataFields:e.dataFields?e.dataFields.slice():[],timestamp:e.timestamp||(new Date).getTime()};return e.eventContract&&(t.eventContract={name:e.eventContract.name,dataFields:e.eventContract.dataFields.slice()}),t}var ge=function(){function e(e,t,n){var r,i,a;this.telemetrySinks=[],this.persistentDataFields=[],this.partAFields=[],this.eventQueue=[],this.config=n||{},e&&(this.telemetrySinks=e.telemetrySinks,(r=this.persistentDataFields).push.apply(r,e.persistentDataFields),this.config=o(o({},e.getConfig()),this.config),(i=this.partAFields).push.apply(i,e.partAFields)),t&&(a=this.persistentDataFields).push.apply(a,t)}return e.prototype.sendTelemetryEvent=function(e){var t=he(e),n=t.telemetryProperties;if(n.customerContentVersion||n.customerContentType)ie(0,0,(function(){return"Customer content"}));else{if(!n.ariaTenantToken||!n.nexusTenantToken){var r=function(e){for(var t=e.length;t>0;){var n=e.substr(0,t);if(ae[n])return ae[n];t=e.lastIndexOf(".",t-1)}}(t.eventName);if(!r)return void ie(0,0,(function(){return"No tenant token: "+e.eventName}));n.ariaTenantToken=r.ariaTenantToken,n.nexusTenantToken=r.nexusTenantToken}this.sendTelemetryEventInternal(t)}},e.prototype.sendCustomerContent=function(e){var t=he(e),n=t.telemetryProperties;return(!n.customerContentVersion||n.customerContentVersion>1)&&(n.customerContentVersion=1),n.ariaTenantToken=void 0,n.nexusTenantToken=void 0,t.dataFields.push(ve("EventContent.Type",2)),this.sendTelemetryEventInternal(t)},e.prototype.sendTelemetryEventInternal=function(e){try{if(0===this.telemetrySinks.length)return void(this.config.enableQueue&&this.eventQueue.length<1e3?this.eventQueue.push(e):ie(1,0,(function(){return"No telemetry sinks are attached."})));this.processTelemetryEvent(e)}catch(e){return void oe(0,"SendTelemetryEvent",e)}try{this.telemetrySinks.forEach((function(t){var n=e.telemetryProperties;n.customerContentVersion&&n.customerContentType?t.sendCustomerContent&&t.sendCustomerContent(e):t.sendTelemetryEvent(e)}))}catch(e){}},e.prototype.processTelemetryEvent=function(e){var t,n,r;if(e.dataFields&&(null===(r=e.dataFields)||void 0===r||r.unshift(pe("OTelJS.Version","4.8.16")),this.persistentDataFields&&(t=e.dataFields).unshift.apply(t,this.persistentDataFields)),this.partAFields.length>0){var i=e.eventContract||{name:"",dataFields:[]};(n=i.dataFields).push.apply(n,this.partAFields),e.eventContract=i}this.config.disableValidation||ce(e)},e.prototype.addSink=function(e){this.telemetrySinks.push(e),this.flushQueue()},e.prototype.flushQueue=function(){var e=this,t=this.eventQueue;this.eventQueue=[],this.telemetrySinks.length>0&&t.forEach((function(t){e.sendTelemetryEventInternal(t)}))},e.prototype.setTenantToken=function(e,t,n){!function(e,t){"Office."===e.substring(0,7)&&"."!==e[e.length-1]?ae[e]=t:ie(0,0,(function(){return"Namespace: ".concat(e)}))}(e,{ariaTenantToken:t,nexusTenantToken:n})},e.prototype.cloneEvent=function(e){return he(e)},e.prototype.getConfig=function(){return this.config},e}();function me(e,t){return e?e+"."+t:t}function ye(e,t,n,r){n&&r.push(pe("".concat(me(e,t)),n))}function be(e,t,n,r){"boolean"==typeof n&&r.push(de("".concat(me(e,t)),n))}function we(e,t,n,r){"number"==typeof n&&r.push(ve("".concat(me(e,t)),n))}var Ce=function(e){var t=[];return we("Activity.Result","Code",e.code,t),ye("Activity.Result","Type",e.type,t),we("Activity.Result","Tag",e.tag,t),be("Activity.Result","IsExpected",e.isExpected,t),t.push(pe("zC.Activity.Result","Office.System.Result")),t},Te={contractName:"Office.System.Activity",getFields:function(e){var t=[];return ye("Activity","CV",e.cV,t),we("Activity","Duration",e.duration,t),we("Activity","Count",e.count,t),we("Activity","AggMode",e.aggMode,t),be("Activity","Success",e.success,t),e.result&&t.push.apply(t,Ce(e.result)),t.push(pe("zC.Activity",this.contractName)),t}},Ee=function(){return 1e3*Date.now()};"object"==typeof window&&"object"==typeof window.performance&&"now"in window.performance&&(Ee=function(){return 1e3*Math.floor(window.performance.now())});var Se,xe=function(e){var t,n=Ee(),r=he(e.telemetryEvent);return{cv:e.parentCv.getNext(),eventName:e.telemetryEvent.eventName,dataFields:r.dataFields,eventFlags:r.eventFlags,telemetryProperties:r.telemetryProperties,createChildActivity:function(t){return xe({telemetryEvent:t,sendTelemetryEvent:e.sendTelemetryEvent,parentCv:this.cv})},setResult:function(e,t,n){this.result={code:e,type:t,tag:n}},endNow:function(){if(!t){void 0===this.success&&void 0===this.result&&ie(1,0,(function(){return"Activity does not have success or result set"}));var r=Ee();t=!0;var i={duration:r-n,count:1,aggMode:0,cV:this.cv.value,success:this.success,result:this.result},o=this.eventContract&&this.eventContract.dataFields?this.eventContract.dataFields:[];return o.push.apply(o,Te.getFields(i)),this.eventContract={name:Te.contractName,dataFields:o},e.sendTelemetryEvent(this)}ie(0,0,(function(){return"Already ended"}))}}},ke=function(e){var t=[];return t.push(pe("".concat("Error",".ErrorGroup"),e.errorGroup)),t.push(ve("".concat("Error",".Tag"),e.tag)),void 0!==e.code&&t.push(ve("".concat("Error",".Code"),e.code)),void 0!==e.id&&t.push(ve("".concat("Error",".Id"),e.id)),void 0!==e.count&&t.push(ve("".concat("Error",".Count"),e.count)),t},De=function(){function e(e){this.value=e,this.nextChild=0}return e.prototype.getNext=function(){return new e("".concat(this.value,".").concat(++this.nextChild))},e}();var Ie=function(e){function t(t,n,r){var i=e.call(this,t,n,r)||this;return i.baseCv=function(){if(!Se){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=[],n=0;n<22;n++)t.push(e.charAt(Math.floor(Math.random()*e.length)));Se=new De(t.join(""))}return Se}(),i}return i(t,e),t.prototype.createActivity=function(e){return xe({sendTelemetryEvent:this.sendTelemetryEvent.bind(this),telemetryEvent:e,parentCv:this.baseCv})},t.prototype.sendActivity=function(e,t,n,r){return this.sendTelemetryEvent({eventName:e,eventContract:{name:Te.contractName,dataFields:Te.getFields(t)},dataFields:n,eventFlags:r})},t.prototype.sendError=function(e){var t=ke(e.error);return null!=e.dataFields&&t.push.apply(t,e.dataFields),this.sendTelemetryEvent({eventName:e.eventName,dataFields:t,eventFlags:e.eventFlags})},t.prototype.createCustomerContentActivity=function(e){return xe({sendTelemetryEvent:this.sendCustomerContent.bind(this),telemetryEvent:e,parentCv:this.baseCv})},t}(ge),_e=n(15),Oe=n(0),Ae=n(3),Pe=Oe.d,Le=Oe.b.freeze,Ne=(Oe.b.seal,Oe.b.keys),Me=String[Oe.k],Fe=Me.trim,Be=Me.endsWith,Re=Me.startsWith,Ue=Date[Oe.k].toISOString,je=Array.isArray,He=Oe.f.toString,ze=Oe.e.toString,qe=ze.call(Oe.b),Ke=/-([a-z])/g,We=/([^\w\d_$])/g,Ve=/^(\d+[\w\d_$])/,Je=Object.getPrototypeOf;function Qe(e,t){return typeof e===t}function Xe(e){return void 0===e||typeof e===Oe.l}function Ge(e){return null===e||Xe(e)}function $e(e){return!Ge(e)}function Ze(e,t){return!(!e||!Oe.e.call(e,t))}function Ye(e){return!(!e||typeof e!==Oe.j)}function et(e){return!(!e||typeof e!==Oe.h)}function tt(e){var t=e;return t&&ct(t)&&(t=(t=(t=t.replace(Ke,(function(e,t){return t.toUpperCase()}))).replace(We,"_")).replace(Ve,(function(e,t){return"_"+t}))),t}function nt(e,t){if(e)for(var n in e)Oe.e.call(e,n)&&t.call(e,n,e[n])}function rt(e,t){var n=!1;return e&&t&&!(n=e===t)&&(n=Be?e.endsWith(t):function(e,t){var n=!1,r=t?t.length:0,i=e?e.length:0;if(r&&i&&i>=r&&!(n=e===t)){for(var o=i-1,a=r-1;a>=0;a--){if(e[o]!=t[a])return!1;o--}n=!0}return n}(e,t)),n}function it(e,t){var n=!1;return e&&t&&!(n=e===t)&&(n=Re?e.startsWith(t):function(e,t){var n=!1,r=t?t.length:0;if(e&&r&&e.length>=r&&!(n=e===t)){for(var i=0;i<r;i++)if(e[i]!==t[i])return!1;n=!0}return n}(e,t)),n}function ot(e,t){return!(!e||!t)&&-1!==e.indexOf(t)}function at(e){return!(!e||"[object Date]"!==He.call(e))}var st=je||function(e){return!(!e||"[object Array]"!==He.call(e))};function ut(e){return!(!e||"[object Error]"!==He.call(e))}function ct(e){return"string"==typeof e}function lt(e){return"number"==typeof e}function ft(e){return"boolean"==typeof e}function dt(e){var t=!1;if(e&&"object"==typeof e){var n=Je?Je(e):function(e){if(e){if(Je)return Je(e);var t=e.__proto__||e[Oe.k]||e.constructor;if(t)return t}return null}(e);n?(n.constructor&&Oe.e.call(n,"constructor")&&(n=n.constructor),t=typeof n===Oe.h&&ze.call(n)===qe):t=!0}return t}function vt(e){if(e)return Ue?e.toISOString():function(e){if(e&&e.getUTCFullYear){var t=function(e){var t=String(e);return 1===t.length&&(t="0"+t),t};return e.getUTCFullYear()+"-"+t(e.getUTCMonth()+1)+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+":"+t(e.getUTCMinutes())+":"+t(e.getUTCSeconds())+"."+String((e.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}(e)}function pt(e,t,n){var r=e.length;try{for(var i=0;i<r&&(!(i in e)||-1!==t.call(n||e,e[i],i,e));i++);}catch(e){}}function ht(e,t,n){if(e){if(e.indexOf)return e.indexOf(t,n);var r=e.length,i=n||0;try{for(var o=Math.max(i>=0?i:r-Math.abs(i),0);o<r;o++)if(o in e&&e[o]===t)return o}catch(e){}}return-1}function gt(e,t,n){var r;if(e){if(e.map)return e.map(t,n);var i=e.length,o=n||e;r=new Array(i);try{for(var a=0;a<i;a++)a in e&&(r[a]=t.call(o,e[a],e))}catch(e){}}return r}function mt(e,t,n){var r;if(e){if(e.reduce)return e.reduce(t,n);var i=e.length,o=0;if(arguments.length>=3)r=arguments[2];else{for(;o<i&&!(o in e);)o++;r=e[o++]}for(;o<i;)o in e&&(r=t(r,e[o],o,e)),o++}return r}function yt(e){return e&&(e=Fe&&e.trim?e.trim():e.replace?e.replace(/^\s+|\s+$/g,""):e),e}var bt=!{toString:null}.propertyIsEnumerable("toString"),wt=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];function Ct(e){var t=typeof e;if(t===Oe.h||t===Oe.j&&null!==e||Object(Ae.c)("objKeys called on non-object"),!bt&&Ne)return Ne(e);var n=[];for(var r in e)e&&Oe.e.call(e,r)&&n.push(r);if(bt)for(var i=wt.length,o=0;o<i;o++)e&&Oe.e.call(e,wt[o])&&n.push(wt[o]);return n}function Tt(e,t,n,r){if(Pe)try{var i={enumerable:!0,configurable:!0};return n&&(i.get=n),r&&(i.set=r),Pe(e,t,i),!0}catch(e){}return!1}function Et(e){return e}function St(e){return Le&&nt(e,(function(e,t){(st(t)||Ye(t))&&Le(t)})),xt(e)}var xt=Le||Et;function kt(){var e=Date;return e.now?e.now():(new e).getTime()}function Dt(e){return ut(e)?e.name:""}function It(e,t,n,r,i){var o=n;return e&&((o=e[t])===n||i&&!i(o)||r&&!r(n)||(o=n,e[t]=o)),o}function _t(e){return!e}function Ot(e){return!!e}function At(e){throw new Error(e)}function Pt(e,t){var n=null,r=null;return et(e)?n=e:r=e,function(){var e=arguments;if(n&&(r=n()),r)return r[t].apply(r,e)}}function Lt(e,t,n,r,i){e&&t&&n&&(!1!==i||Xe(e[t]))&&(e[t]=Pt(n,r))}function Nt(e,t,n,r){return e&&t&&Ye(e)&&st(n)&&pt(n,(function(n){ct(n)&&Lt(e,n,t,n,r)})),e}function Mt(e){return e&&Oe.a&&(e=Object(Oe.b)(Object(Oe.a)({},e))),e}function Ft(e,t,n,r,i,o){var a=arguments,s=a[0]||{},u=a.length,c=!1,l=1;for(u>0&&ft(s)&&(c=s,s=a[l]||{},l++),Ye(s)||(s={});l<u;l++){var f=a[l],d=st(f),v=Ye(f);for(var p in f){var h=d&&p in f||v&&Oe.e.call(f,p);if(h){var g=f[p],m=void 0;if(c&&g&&((m=st(g))||dt(g))){var y=s[p];m?st(y)||(y=[]):dt(y)||(y={}),g=Ft(c,y,g)}void 0!==g&&(s[p]=g)}}}return s}var Bt=null,Rt=null,Ut=!1,jt=null,Ht=null;function zt(e,t){var n=!1;if(e){try{if(!(n=t in e)){var r=e[Oe.k];r&&(n=t in r)}}catch(e){}if(!n)try{n=!Xe((new e)[t])}catch(e){}}return n}function qt(e){var t=Object(Ae.a)();return t&&t[e]?t[e]:"window"===e&&Kt()?window:null}function Kt(){return Boolean(typeof window===Oe.j&&window)}function Wt(){return Kt()?window:qt("window")}function Vt(){return Boolean(typeof document===Oe.j&&document)?document:qt("document")}function Jt(){return Boolean(typeof navigator===Oe.j&&navigator)}function Qt(){return Jt()?navigator:qt("navigator")}function Xt(e){if(e&&Ut){var t=qt("__mockLocation");if(t)return t}return typeof location===Oe.j&&location?location:qt("location")}function Gt(){return qt("performance")}function $t(){return Boolean(typeof JSON===Oe.j&&JSON||null!==qt("JSON"))}function Zt(){return $t()?JSON||qt("JSON"):null}function Yt(){var e=Qt();return!(!e||!e.product)&&"ReactNative"===e.product}function en(){var e=Qt();if(e&&(e.userAgent!==Rt||null===Bt)){var t=((Rt=e.userAgent)||"").toLowerCase();Bt=ot(t,"msie")||ot(t,"trident/")}return Bt}function tn(e){var t=Object[Oe.k].toString.call(e),n="";return"[object Error]"===t?n="{ stack: '"+e.stack+"', message: '"+e.message+"', name: '"+e.name+"'":$t()&&(n=Zt().stringify(e)),t+n}function nn(){return null===Ht&&(Ht=Jt()&&Boolean(Qt().sendBeacon)),Ht}function rn(e){var t=!1;try{t=!!qt("fetch");var n=qt("Request");t&&e&&n&&(t=zt(n,"keepalive"))}catch(e){}return t}function on(){return null===jt&&(jt=typeof XDomainRequest!==Oe.l)&&an()&&(jt=jt&&!zt(qt("XMLHttpRequest"),"withCredentials")),jt}function an(){var e=!1;try{e=!!qt("XMLHttpRequest")}catch(e){}return e}var sn=Object,un=sn.getPrototypeOf,cn=sn.getOwnPropertyNames,ln=0;function fn(e,t){return e&&sn.prototype.hasOwnProperty.call(e,t)}function dn(e){return e&&(e===sn.prototype||e===Array.prototype)}function vn(e){return dn(e)||e===Function.prototype}function pn(e){var t;if(e){if(un)return un(e);var n=e.__proto__||e.prototype||(e.constructor?e.constructor.prototype:null);t=e._dyn__proto__||n,fn(e,"_dyn__proto__")||(delete e._dynInstProto,t=e._dyn__proto__=e._dynInstProto||e._dyn__proto__,e._dynInstProto=n)}return t}function hn(e,t){var n=[];if(cn)n=cn(e);else for(var r in e)"string"==typeof r&&fn(e,r)&&n.push(r);if(n&&n.length>0)for(var i=0;i<n.length;i++)t(n[i])}function gn(e,t,n){return"constructor"!==t&&"function"==typeof e[t]&&(n||fn(e,t))}function mn(e){throw new TypeError("DynamicProto: "+e)}function yn(e,t){for(var n=e.length-1;n>=0;n--)if(e[n]===t)return!0;return!1}function bn(e,t,n,r){var i=null;if(e&&fn(n,"_dynClass")){var o=e._dynInstFuncs||{};if((i=(o[n._dynClass]||{})[t])||mn("Missing ["+t+"] function"),!i._dynInstChk&&!1!==o._dynInstChk){for(var a=!fn(e,t),s=pn(e),u=[];a&&s&&!vn(s)&&!yn(u,s);){var c=s[t];if(c){a=c===r;break}u.push(s),s=pn(s)}try{a&&(e[t]=i),i._dynInstChk=1}catch(e){o._dynInstChk=!1}}}return i}function wn(e,t,n){var r=t[e];return r===n&&(r=pn(t)[e]),"function"!=typeof r&&mn("["+e+"] is not a function"),r}function Cn(e,t,n,r,i){if(!dn(e)){var o=n._dynInstFuncs=n._dynInstFuncs||{},a=o[t]=o[t]||{};!1!==o._dynInstChk&&(o._dynInstChk=!!i),hn(n,(function(t){gn(n,t,!1)&&n[t]!==r[t]&&(a[t]=n[t],delete n[t],(!fn(e,t)||e[t]&&!e[t]._isDynProxy)&&(e[t]=function(e,t){var n=function(){var r=bn(this,t,e,n)||wn(t,e,n);return r.apply(this,arguments)};return n._isDynProxy=1,n}(e,t)))}))}}function Tn(e,t){return fn(e,"prototype")?e.name||t||"_unknown_":((e||{}).constructor||{}).name||t||"_unknown_"}function En(e,t,n,r){fn(e,"prototype")||mn("theClass is an invalid class definition.");var i=e.prototype;(function(e,t){if(un){for(var n=[],r=pn(t);r&&!vn(r)&&!yn(n,r);){if(r===e)return!0;n.push(r),r=pn(r)}return!1}return!0})(i,t)||mn("["+Tn(e)+"] is not in class hierarchy of ["+Tn(t)+"]");var o=null;fn(i,"_dynClass")?o=i._dynClass:(o="_dynCls$"+Tn(e,"_")+"$"+ln,ln++,i._dynClass=o);var a=En._dfOpts,s=!!a.useBaseInst;s&&r&&void 0!==r.useBaseInst&&(s=!!r.useBaseInst);var u=function(e){var t={};return hn(e,(function(n){!t[n]&&gn(e,n,!1)&&(t[n]=e[n])})),t}(t);n(t,function(e,t,n,r){function i(e,t,n){var i=t[n];if(i._isDynProxy&&r){var o=e._dynInstFuncs||{};!1!==o._dynInstChk&&(i=(o[t._dynClass]||{})[n]||i)}return function(){return i.apply(e,arguments)}}var o={};hn(n,(function(e){o[e]=i(t,n,e)}));for(var a=pn(e),s=[];a&&!vn(a)&&!yn(s,a);)hn(a,(function(e){!o[e]&&gn(a,e,!un)&&(o[e]=i(t,a,e))})),s.push(a),a=pn(a);return o}(i,t,u,s));var c=!!un&&!!a.setInstFuncs;c&&r&&(c=!!r.setInstFuncs),Cn(i,o,t,u,!1!==c)}En._dfOpts={setInstFuncs:!0,useBaseInst:!0};var Sn,xn=["eventsSent","eventsDiscarded","eventsSendRequest","perfEvent"],kn=null;function Dn(e,t){return function(){var n=arguments,r=In(t);if(r){var i=r.listener;i&&i[e]&&i[e].apply(i,n)}}}function In(e){var t,n=kn;return n||!0===e.disableDbgExt||(n=kn||((t=qt("Microsoft"))&&(kn=t.ApplicationInsights),kn)),n?n.ChromeDbgExt:null}function _n(e){return e?'"'+e.replace(/\"/g,"")+'"':""}function On(e,t){var n=typeof console!==Oe.l?console:qt("console");if(n){var r="log";n[e]&&(r=e),et(n[r])&&n[r](t)}}var An=function(){function e(e,t,n,r){void 0===n&&(n=!1);this.messageId=e,this.message=(n?"AI: ":"AI (Internal): ")+e;var i="";$t()&&(i=Zt().stringify(r));var o=(t?" message:"+_n(t):"")+(r?" props:"+_n(i):"");this.message+=o}return e.dataType="MessageData",e}();var Pn=function e(t){this.identifier="DiagnosticLogger",this.queue=[];var n=0,r={};En(e,this,(function(e){function i(e,n){var r=t[e];return Ge(r)?n:r}function o(e,n){var r=In(t);r&&r.diagLog&&r.diagLog(e,n)}Ge(t)&&(t={}),e.consoleLoggingLevel=function(){return i("loggingLevelConsole",0)},e.telemetryLoggingLevel=function(){return i("loggingLevelTelemetry",1)},e.maxInternalMessageLimit=function(){return i("maxMessageLimit",25)},e.enableDebugExceptions=function(){return i("enableDebugExceptions",!1)},e.throwInternal=function(t,n,i,a,s){void 0===s&&(s=!1);var u=new An(n,i,s,a);if(e.enableDebugExceptions())throw tn(u);var c=1===t?"errorToConsole":"warnToConsole";if(Xe(u.message))o("throw"+(1===t?"Critical":"Warning"),u);else{var l=e.consoleLoggingLevel();if(s){var f=+u.messageId;!r[f]&&l>=t&&(e[c](u.message),r[f]=!0)}else l>=t&&e[c](u.message);e.logInternalMessage(t,u)}},e.warnToConsole=function(e){On("warn",e),o("warning",e)},e.errorToConsole=function(e){On("error",e),o("error",e)},e.resetInternalMessageCount=function(){n=0,r={}},e.logInternalMessage=function(t,i){if(!(n>=e.maxInternalMessageLimit())){var a=!0,s="AITR_"+i.messageId;if(r[s]?a=!1:r[s]=!0,a&&(t<=e.telemetryLoggingLevel()&&(e.queue.push(i),n++,o(1===t?"error":"warn",i)),n===e.maxInternalMessageLimit())){var u="Internal events throttle limit per PageView reached for this app.",c=new An(23,u,!1);e.queue.push(c),1===t?e.errorToConsole(u):e.warnToConsole(u)}}}}))};function Ln(e){return e||new Pn}function Nn(e,t,n,r,i,o){void 0===o&&(o=!1),(e||new Pn).throwInternal(t,n,r,i,o)}var Mn=null,Fn=function(){function e(t,n,r){var i,o=this,a=!1;(o.start=kt(),o.name=t,o.isAsync=r,o.isChildEvt=function(){return!1},et(n))&&(a=Tt(o,"payload",(function(){return!i&&et(n)&&(i=n(),n=null),i})));o.getCtx=function(t){return t?t===e.ParentContextKey||t===e.ChildrenContextKey?o[t]:(o.ctx||{})[t]:null},o.setCtx=function(t,n){if(t)if(t===e.ParentContextKey)o[t]||(o.isChildEvt=function(){return!0}),o[t]=n;else if(t===e.ChildrenContextKey)o[t]=n;else{(o.ctx=o.ctx||{})[t]=n}},o.complete=function(){var t=0,r=o.getCtx(e.ChildrenContextKey);if(st(r))for(var i=0;i<r.length;i++){var s=r[i];s&&(t+=s.time)}o.time=kt()-o.start,o.exTime=o.time-t,o.complete=function(){},!a&&et(n)&&(o.payload=n())}}return e.ParentContextKey="parent",e.ChildrenContextKey="childEvts",e}(),Bn=function e(t){this.ctx={},En(e,this,(function(e){e.create=function(e,t,n){return new Fn(e,t,n)},e.fire=function(e){e&&(e.complete(),t&&et(t.perfEvent)&&t.perfEvent(e))},e.setCtx=function(t,n){t&&((e.ctx=e.ctx||{})[t]=n)},e.getCtx=function(t){return(e.ctx||{})[t]}}))};function Rn(e,t,n,r,i){if(e){var o=e;if(et(o.getPerfMgr)&&(o=o.getPerfMgr()),o){var a=void 0,s=o.getCtx("CoreUtils.doPerf");try{if(a=o.create(t(),r,i)){if(s&&a.setCtx&&(a.setCtx(Fn.ParentContextKey,s),s.getCtx&&s.setCtx)){var u=s.getCtx(Fn.ChildrenContextKey);u||(u=[],s.setCtx(Fn.ChildrenContextKey,u)),u.push(a)}return o.setCtx("CoreUtils.doPerf",a),n(a)}}catch(e){a&&a.setCtx&&a.setCtx("exception",e)}finally{a&&o.fire(a),o.setCtx("CoreUtils.doPerf",s)}}}return n()}var Un=!1,jn=123456789,Hn=987654321;function zn(e){e<0&&(e>>>=0),jn=123456789+e&4294967295,Hn=987654321-e&4294967295,Un=!0}function qn(){try{var e=2147483647&kt();zn((4294967296*Math.random()^e)+e)}catch(e){}}function Kn(e){return e>0?Math.floor(Wn()/4294967295*(e+1))>>>0:0}function Wn(e){var t=0,n=qt("crypto")||qt("msCrypto");return n&&n.getRandomValues&&(t=4294967295&n.getRandomValues(new Uint32Array(1))[0]),0===t&&en()&&(Un||qn(),t=4294967295&Jn()),0===t&&(t=Math.floor(4294967296*Math.random()|0)),e||(t>>>=0),t}function Vn(e){e?zn(e):qn()}function Jn(e){var t=((Hn=36969*(65535&Hn)+(Hn>>16)&4294967295)<<16)+(65535&(jn=18e3*(65535&jn)+(jn>>16)&4294967295))>>>0&4294967295|0;return e||(t>>>=0),t}function Qn(e){void 0===e&&(e=22);for(var t=Wn()>>>0,n=0,r="";r.length<e;)n++,r+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&t),t>>>=6,5===n&&(t=(Wn()<<2&4294967295|3&t)>>>0,n=0);return r}var Xn=Oe.d,Gn="."+Qn(6),$n=0;function Zn(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType}function Yn(e,t){var n=t[e.id];if(!n){n={};try{Zn(t)&&(function(e,t,n){if(Xn)try{return Xn(e,t,{value:n,enumerable:!1,configurable:!0}),!0}catch(e){}return!1}(t,e.id,n)||(t[e.id]=n))}catch(e){}}return n}function er(e,t){return void 0===t&&(t=!1),tt(e+$n+++(t?".2.8.4":"")+Gn)}function tr(e){var t={id:er("_aiData-"+(e||"")+".2.8.4"),accept:function(e){return Zn(e)},get:function(e,n,r,i){var o=e[t.id];return o?o[tt(n)]:(i&&((o=Yn(t,e))[tt(n)]=r),r)},kill:function(e,t){if(e&&e[t])try{delete e[t]}catch(e){}}};return t}var nr=null,rr=null,ir=null,or=Vt(),ar={},sr={};function ur(e,t){var n=lr._ckMgr||sr._ckMgr;return n||(n=lr._ckMgr=lr(e,t),sr._ckMgr=n),n}function cr(e){return!e||e.isEnabled()}function lr(e,t){var n=function(e){var t=e.cookieCfg=e.cookieCfg||{};if(It(t,"domain",e.cookieDomain,$e,Ge),It(t,"path",e.cookiePath||"/",null,Ge),Ge(t.enabled)){var n=void 0;Xe(e.isCookieUseDisabled)||(n=!e.isCookieUseDisabled),Xe(e.disableCookiesUsage)||(n=!e.disableCookiesUsage),t.enabled=n}return t}(e||sr),r=n.path||"/",i=n.domain,o=!1!==n.enabled,a={isEnabled:function(){var e=o&&fr(t),n=sr._ckMgr;return e&&n&&a!==n&&(e=cr(n)),e},setEnabled:function(e){o=!1!==e},set:function(e,t,o,s,u){var c=!1;if(cr(a)){var l={},f=yt(t||""),d=f.indexOf(";");if(-1!==d&&(f=yt(t.substring(0,d)),l=dr(t.substring(d+1))),It(l,"domain",s||i,Ot,Xe),!Ge(o)){var v=en();if(Xe(l.expires)){var p=kt()+1e3*o;if(p>0){var h=new Date;h.setTime(p),It(l,"expires",vr(h,v?"toGMTString":"toUTCString")||vr(h,v?"toGMTString":"toUTCString")||"",Ot)}}v||It(l,"max-age",""+o,null,Xe)}var g=Xt();g&&"https:"===g.protocol&&(It(l,"secure",null,null,Xe),null===rr&&(rr=!mr((Qt()||{}).userAgent)),rr&&It(l,"SameSite","None",null,Xe)),It(l,"path",u||r,null,Xe),(n.setCookie||gr)(e,pr(f,l)),c=!0}return c},get:function(e){var t="";return cr(a)&&(t=(n.getCookie||hr)(e)),t},del:function(e,t){var n=!1;return cr(a)&&(n=a.purge(e,t)),n},purge:function(e,r){var i,o=!1;if(fr(t)){var a=((i={}).path=r||"/",i.expires="Thu, 01 Jan 1970 00:00:01 GMT",i);en()||(a["max-age"]="0"),(n.delCookie||gr)(e,pr("",a)),o=!0}return o}};return a._ckMgr=a,a}function fr(e){if(null===nr){nr=!1;try{nr=void 0!==(or||{}).cookie}catch(t){Nn(e,2,68,"Cannot access document.cookie - "+Dt(t),{exception:tn(t)})}}return nr}function dr(e){var t={};e&&e.length&&pt(yt(e).split(";"),(function(e){if(e=yt(e||"")){var n=e.indexOf("=");-1===n?t[e]=null:t[yt(e.substring(0,n))]=yt(e.substring(n+1))}}));return t}function vr(e,t){return et(e[t])?e[t]():null}function pr(e,t){var n=e||"";return nt(t,(function(e,t){n+="; "+e+(Ge(t)?"":"="+t)})),n}function hr(e){var t="";if(or){var n=or.cookie||"";ir!==n&&(ar=dr(n),ir=n),t=yt(ar[e]||"")}return t}function gr(e,t){or&&(or.cookie=e+"="+t)}function mr(e){return!!ct(e)&&(!(!ot(e,"CPU iPhone OS 12")&&!ot(e,"iPad; CPU OS 12"))||(!!(ot(e,"Macintosh; Intel Mac OS X 10_14")&&ot(e,"Version/")&&ot(e,"Safari"))||(!(!ot(e,"Macintosh; Intel Mac OS X 10_14")||!rt(e,"AppleWebKit/605.1.15 (KHTML, like Gecko)"))||(!(!ot(e,"Chrome/5")&&!ot(e,"Chrome/6"))||(!(!ot(e,"UnrealEngine")||ot(e,"Chrome"))||!(!ot(e,"UCBrowser/12")&&!ot(e,"UCBrowser/11")))))))}var yr=er("aiEvtPageHide"),br=er("aiEvtPageShow"),wr=/\.[\.]+/g,Cr=/[\.]+$/,Tr=1,Er=tr("events"),Sr=/^([^.]*)(?:\.(.+)|)/;function xr(e){return e&&e.replace?e.replace(/^\s*\.*|\.*\s*$/g,""):e}function kr(e,t){if(t){var n="";st(t)?(n="",pt(t,(function(e){(e=xr(e))&&("."!==e[0]&&(e="."+e),n+=e)}))):n=xr(t),n&&("."!==n[0]&&(n="."+n),e=(e||"")+n)}var r=Sr.exec(e||"")||[];return{type:r[1],ns:(r[2]||"").replace(wr,".").replace(Cr,"").split(".").sort().join(".")}}function Dr(e,t,n){void 0===n&&(n=!0);var r=Er.get(e,"events",{},n),i=r[t];return i||(i=r[t]=[]),i}function Ir(e,t,n,r){e&&t&&t.type&&(e.removeEventListener?e.removeEventListener(t.type,n,r):e.detachEvent&&e.detachEvent("on"+t.type,n))}function _r(e,t,n,r){for(var i=t.length;i--;){var o=t[i];o&&(n.ns&&n.ns!==o.evtName.ns||r&&!r(o)||(Ir(e,o.evtName,o.handler,o.capture),t.splice(i,1)))}}function Or(e,t){return t?kr("xx",st(t)?[e].concat(t):[e,t]).ns.split("."):e}function Ar(e,t,n,r,i){void 0===i&&(i=!1);var o=!1;if(e)try{var a=kr(t,r);if((o=function(e,t,n,r){var i=!1;return e&&t&&t.type&&n&&(e.addEventListener?(e.addEventListener(t.type,n,r),i=!0):e.attachEvent&&(e.attachEvent("on"+t.type,n),i=!0)),i}(e,a,n,i))&&Er.accept(e)){var s={guid:Tr++,evtName:a,handler:n,capture:i};Dr(e,a.type).push(s)}}catch(e){}return o}function Pr(e,t,n,r,i){if(void 0===i&&(i=!1),e)try{var o=kr(t,r),a=!1;!function(e,t,n){if(t.type)_r(e,Dr(e,t.type),t,n);else{var r=Er.get(e,"events",{});nt(r,(function(r,i){_r(e,i,t,n)})),0===Ct(r).length&&Er.kill(e,"events")}}(e,o,(function(e){return!((!o.ns||n)&&e.handler!==n)&&(a=!0,!0)})),a||Ir(e,o,n,i)}catch(e){}}function Lr(e,t,n){var r=!1,i=Wt();i&&(r=Ar(i,e,t,n),r=Ar(i.body,e,t,n)||r);var o=Vt();return o&&(r=Ar(o,e,t,n)||r),r}function Nr(e,t,n,r){var i=!1;return t&&e&&e.length>0&&pt(e,(function(e){e&&(n&&-1!==ht(n,e)||(i=Lr(e,t,r)||i))})),i}function Mr(e,t,n){e&&st(e)&&pt(e,(function(e){e&&function(e,t,n){var r=Wt();r&&(Pr(r,e,t,n),Pr(r.body,e,t,n));var i=Vt();i&&Pr(i,e,t,n)}(e,t,n)}))}function Fr(e,t,n){return function(e,t,n,r){var i=!1;return t&&e&&st(e)&&!(i=Nr(e,t,n,r))&&n&&n.length>0&&(i=Nr(e,t,null,r)),i}(["beforeunload","unload","pagehide"],e,t,n)}var Br,Rr=null;Oe.l;function Ur(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(qr,(function(e){var t=0|Kn(15);return("x"===e?t:3&t|8).toString(16)}))}function jr(){var e=Gt();return e&&e.now?e.now():kt()}function Hr(){for(var e,t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],n="",r=0;r<4;r++)n+=t[15&(e=Wn())]+t[e>>4&15]+t[e>>8&15]+t[e>>12&15]+t[e>>16&15]+t[e>>20&15]+t[e>>24&15]+t[e>>28&15];var i=t[8+(3&Wn())|0];return n.substr(0,8)+n.substr(9,4)+"4"+n.substr(13,3)+i+n.substr(16,3)+n.substr(19,12)}var zr={_canUseCookies:void 0,isTypeof:Qe,isUndefined:Xe,isNullOrUndefined:Ge,hasOwnProperty:Ze,isFunction:et,isObject:Ye,isDate:at,isArray:st,isError:ut,isString:ct,isNumber:lt,isBoolean:ft,toISOString:vt,arrForEach:pt,arrIndexOf:ht,arrMap:gt,arrReduce:mt,strTrim:yt,objCreate:Ae.b,objKeys:Ct,objDefineAccessors:Tt,addEventHandler:Lr,dateNow:kt,isIE:en,disableCookies:function(){Kr().setEnabled(!1)},newGuid:Ur,perfNow:jr,newId:Qn,randomValue:Kn,random32:Wn,mwcRandomSeed:Vn,mwcRandom32:Jn,generateW3CId:Hr},qr=/[xy]/g;function Kr(e,t){var n=ur(e,t),r=zr._canUseCookies;return null===Rr&&(Rr=[],Br=r,Tt(zr,"_canUseCookies",(function(){return Br}),(function(e){Br=e,pt(Rr,(function(t){t.setEnabled(e)}))}))),-1===ht(Rr,n)&&Rr.push(n),ft(r)&&n.setEnabled(r),ft(Br)&&n.setEnabled(Br),n}var Wr="00000000000000000000000000000000";function Vr(e,t,n){return!(!e||e.length!==t||e===n)&&!!e.match(/^[\da-f]*$/)}function Jr(e){return Vr(e,32,Wr)}function Qr(e){return Vr(e,16,"0000000000000000")}var Xr=tr("plugin");function Gr(e){return Xr.get(e,"state",{},!0)}function $r(e,t){for(var n,r=[],i=null,o=e.getNext();o;){var a=o.getPlugin();if(a){i&&et(i.setNextPlugin)&&et(a.processTelemetry)&&i.setNextPlugin(a);(et(a.isInitialized)?a.isInitialized():(n=Gr(a)).isInitialized)||r.push(a),i=a,o=o.getNext()}}pt(r,(function(r){var i=e.core();r.initialize(e.getCfg(),i,t,e.getNext()),n=Gr(r),r.core||n.core||(n.core=i),n.isInitialized=!0,delete n.teardown}))}function Zr(e){return e.sort((function(e,t){var n=0;if(t){var r=et(t.processTelemetry);et(e.processTelemetry)?n=r?e.priority-t.priority:1:r&&(n=-1)}else n=e?1:-1;return n}))}var Yr=0;function ei(e,t,n,r){var i=null,o=[];null!==r&&(i=r?function(e,t,n){for(;e;){if(e.getPlugin()===n)return e;e=e.getNext()}return ii([n],t.config||{},t)}(e,n,r):e);var a={_next:function(){var e=i;if(i=e?e.getNext():null,!e){var t=o;t&&t.length>0&&(pt(t,(function(e){try{e.func.call(e.self,e.args)}catch(e){Nn(n.logger,2,73,"Unexpected Exception during onComplete - "+tn(e))}})),o=[])}return e},ctx:{core:function(){return n},diagLog:function(){return function(e,t){return(e||{}).logger||new Pn(t)}(n,t)},getCfg:function(){return t},getExtCfg:s,getConfig:function(e,n,r){void 0===r&&(r=!1);var i,o=s(e,null);o&&!Ge(o[n])?i=o[n]:t&&!Ge(t[n])&&(i=t[n]);return Ge(i)?r:i},hasNext:function(){return!!i},getNext:function(){return i},setNext:function(e){i=e},iterate:function(e){var t;for(;t=a._next();){var n=t.getPlugin();n&&e(n)}},onComplete:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];e&&o.push({func:e,self:Xe(t)?a.ctx:t,args:n})}}};function s(e,n,r){var i;if(void 0===n&&(n={}),void 0===r&&(r=0),t){var o=t.extensionConfig;o&&e&&(i=o[e])}if(i){if(Ye(n)&&0!==r){var a=Ft(!0,n,i);t&&2===r&&nt(n,(function(e){if(Ge(a[e])){var n=t[e];Ge(n)||(a[e]=n)}})),i=a}}else i=n;return i}return a}function ti(e,t,n,r){var i=ei(e,t,n,r),o=i.ctx;return o.processNext=function(e){var t=i._next();return t&&t.processTelemetry(e,o),!t},o.createNew=function(e,r){return void 0===e&&(e=null),st(e)&&(e=ii(e,t,n,r)),ti(e||o.getNext(),t,n,r)},o}function ni(e,t,n){var r=t.config||{},i=ei(e,r,t,n),o=i.ctx;return o.processNext=function(e){var t=i._next();return t&&t.unload(o,e),!t},o.createNew=function(e,n){return void 0===e&&(e=null),st(e)&&(e=ii(e,r,t,n)),ni(e||o.getNext(),t,n)},o}function ri(e,t,n){var r=t.config||{},i=ei(e,r,t,n).ctx;return i.processNext=function(e){return i.iterate((function(t){et(t.update)&&t.update(i,e)}))},i.createNew=function(e,n){return void 0===e&&(e=null),st(e)&&(e=ii(e,r,t,n)),ri(e||i.getNext(),t,n)},i}function ii(e,t,n,r){var i=null,o=!r;if(st(e)&&e.length>0){var a=null;pt(e,(function(e){if(o||r!==e||(o=!0),o&&e&&et(e.processTelemetry)){var s=function(e,t,n){var r,i=null,o=et(e.processTelemetry),a=et(e.setNextPlugin);r=e?e.identifier+"-"+e.priority+"-"+Yr++:"Unknown-0-"+Yr++;var s={getPlugin:function(){return e},getNext:function(){return i},processTelemetry:function(t,n){c(n=n||u(),(function(n){if(!e||!o)return!1;var r=Gr(e);if(r.teardown||r.disabled)return!1;a&&e.setNextPlugin(i);return e.processTelemetry(t,n),!0}),"processTelemetry",(function(){return{item:t}}),!t.sync)||n.processNext(t)},unload:function(t,n){c(t,(function(){var r=!1;if(e){var i=Gr(e),o=e.core||i.core;!e||o&&o!==t.core()||i.teardown||(i.core=null,i.teardown=!0,i.isInitialized=!1,e.teardown&&!0===e.teardown(t,n)&&(r=!0))}return r}),"unload",(function(){}),n.isAsync)||t.processNext(n)},update:function(t,n){c(t,(function(){var r=!1;if(e){var i=Gr(e),o=e.core||i.core;!e||o&&o!==t.core()||i.teardown||e.update&&!0===e.update(t,n)&&(r=!0)}return r}),"update",(function(){}),!1)||t.processNext(n)},_id:r,_setNext:function(e){i=e}};function u(){var r;return e&&et(e._getTelCtx)&&(r=e._getTelCtx()),r||(r=ti(s,t,n)),r}function c(t,n,o,a,s){var u=!1,c=e?e.identifier:"TelemetryPluginChain",l=t._hasRun;return l||(l=t._hasRun={}),t.setNext(i),e&&Rn(t.core(),(function(){return c+":"+o}),(function(){l[r]=!0;try{var e=i?i._id:"";e&&(l[e]=!1),u=n(t)}catch(e){var a=!i||l[i._id];a&&(u=!0),i&&a||Nn(t.diagLog(),1,73,"Plugin ["+c+"] failed during "+o+" - "+tn(e)+", run flags: "+tn(l))}}),a,s),u}return xt(s)}(e,t,n);i||(i=s),a&&a._setNext(s),a=s}}))}return r&&!i?ii([r],t,n):i}function oi(e,t,n,r){t&&st(t)&&t.length>0&&(pt(t=t.sort((function(e,t){return e.priority-t.priority})),(function(e){e.priority<500&&At("Channel has invalid priority - "+e.identifier)})),e.push({queue:xt(t),chain:ii(t,n,r)}))}function ai(){var e=[];return{add:function(t){t&&e.push(t)},run:function(t,n){pt(e,(function(e){try{e(t,n)}catch(e){Nn(t.diagLog(),2,73,"Unexpected error calling unload handler - "+tn(e))}})),e=[]}}}var si=function e(){var t,n,r,i,o,a=this;function s(e){void 0===e&&(e=null);var t=e;if(!t){var i=n||ti(null,{},a.core);t=r&&r.getPlugin?i.createNew(null,r.getPlugin):i.createNew(null,r)}return t}function u(e,t,i){e&&It(e,"extensionConfig",[],null,Ge),!i&&t&&(i=t.getProcessTelContext().getNext());var o=r;r&&r.getPlugin&&(o=r.getPlugin()),a.core=t,n=ti(i,e,t,o)}function c(){t=!1,a.core=null,n=null,r=null,o=[],i=ai()}c(),En(e,a,(function(e){e.initialize=function(e,n,r,i){u(e,n,i),t=!0},e.teardown=function(t,n){var a=e.core;if(a&&(!t||a===t.core())){var s,u=!1,l=t||ni(null,a,r&&r.getPlugin?r.getPlugin():r),f=n||{reason:0,isAsync:!1};return e._doTeardown&&!0===e._doTeardown(l,f,d)?s=!0:d(),s}function d(){u||(u=!0,i.run(l,n),pt(o,(function(e){e.rm()})),o=[],!0===s&&l.processNext(f),c())}},e.update=function(t,n){var i=e.core;if(i&&(!t||i===t.core())){var o,a=!1,s=t||ri(null,i,r&&r.getPlugin?r.getPlugin():r),c=n||{reason:0};return e._doUpdate&&!0===e._doUpdate(s,c,l)?o=!0:l(),o}function l(){a||(a=!0,u(s.getCfg(),s.core(),s.getNext()))}},e._addHook=function(e){e&&(st(e)?o=o.concat(e):o.push(e))},Lt(e,"_addUnloadCb",(function(){return i}),"add")})),a.diagLog=function(e){return s(e).diagLog()},a.isInitialized=function(){return t},a.setInitialized=function(e){t=e},a.setNextPlugin=function(e){r=e},a.processNext=function(e,t){t?t.processNext(e):r&&et(r.processTelemetry)&&r.processTelemetry(e,null)},a._getTelCtx=s},ui=function(e){function t(){var n,r,i=e.call(this)||this;function o(){n=0,r=[]}return i.identifier="TelemetryInitializerPlugin",i.priority=199,o(),En(t,i,(function(e,t){e.addTelemetryInitializer=function(e){var t={id:n++,fn:e};return r.push(t),{remove:function(){pt(r,(function(e,n){if(e.id===t.id)return r.splice(n,1),-1}))}}},e.processTelemetry=function(t,n){for(var i=!1,o=r.length,a=0;a<o;++a){var s=r[a];if(s)try{if(!1===s.fn.apply(null,[t])){i=!0;break}}catch(e){Nn(n.diagLog(),1,64,"One of telemetry initializers failed, telemetry item will not be sent: "+Dt(e),{exception:tn(e)},!0)}}i||e.processNext(t,n)},e._doTeardown=function(){o()}})),i}return Object(_e.a)(t,e),t}(si),ci={loggingLevelConsole:1};function li(e,t){return new Bn(t)}function fi(e,t,n){var r=[],i={};return pt(n,(function(n){(Ge(n)||Ge(n.initialize))&&At("Plugins must provide initialize method");var o=n.priority,a=n.identifier;n&&o&&(Ge(i[o])?i[o]=a:function(e,t){Ln(e).warnToConsole(t)}(e,"Two extensions have same priority #"+o+" - "+i[o]+", "+a)),(!o||o<t)&&r.push(n)})),{all:n,core:r}}function di(e,t){var n=!1;return pt(t,(function(t){if(t===e)return n=!0,-1})),n}function vi(e,t,n,r){pt(e,(function(e){if(e&&e[t])if(n)setTimeout((function(){return r(e)}),0);else try{r(e)}catch(e){}}))}var pi,hi=function e(t){this.listeners=[];var n=!!(t||{}).perfEvtsSendAll;En(e,this,(function(e){e.addNotificationListener=function(t){e.listeners.push(t)},e.removeNotificationListener=function(t){for(var n=ht(e.listeners,t);n>-1;)e.listeners.splice(n,1),n=ht(e.listeners,t)},e.eventsSent=function(t){vi(e.listeners,"eventsSent",!0,(function(e){e.eventsSent(t)}))},e.eventsDiscarded=function(t,n){vi(e.listeners,"eventsDiscarded",!0,(function(e){e.eventsDiscarded(t,n)}))},e.eventsSendRequest=function(t,n){vi(e.listeners,"eventsSendRequest",n,(function(e){e.eventsSendRequest(t,n)}))},e.perfEvent=function(t){t&&(!n&&t.isChildEvt()||vi(e.listeners,"perfEvent",!1,(function(e){t.isAsync?setTimeout((function(){return e.perfEvent(t)}),0):e.perfEvent(t)})))}}))},gi=function(e){function t(){var n=e.call(this)||this;return En(t,n,(function(e,t){function n(t){var n=e.getNotifyMgr();n&&n.eventsDiscarded([t],2)}e.initialize=function(e,n,r,i){t.initialize(e,n,r||new Pn(e),i||new hi(e))},e.track=function(r){Rn(e.getPerfMgr(),(function(){return"AppInsightsCore:track"}),(function(){null===r&&(n(r),At("Invalid telemetry item")),function(e){Ge(e.name)&&(n(e),At("telemetry name required"))}(r),t.track(r)}),(function(){return{item:r}}),!r.sync)}})),n}return Object(_e.a)(t,e),t}((function e(){var t,n,r,i,o,a,s,u,c,l,f,d,v,p,h,g,m,y,b,w=0;En(e,this,(function(e){function C(){t=!1,e.config=Ft(!0,{},ci),e.logger=new Pn(e.config),e._extensions=[],p=new ui,n=[],r=null,i=null,o=null,a=null,s=null,c=null,u=[],l=null,f=null,d=null,v=!1,h=null,g=er("AIBaseCore",!0),m=ai(),b=null}function T(){return ti(x(),e.config,e)}function E(t,n){var r=fi(e.logger,500,u);c=r.core,s=null;var i=r.all;if(d=xt(function(e,t,n,r){var i=[];if(e&&pt(e,(function(e){return oi(i,e,n,r)})),t){var o=[];pt(t,(function(e){e.priority>500&&o.push(e)})),oi(i,o,n,r)}return i}(f,i,t,e)),l){var o=ht(i,l);-1!==o&&i.splice(o,1),-1!==(o=ht(c,l))&&c.splice(o,1),l._setQueue(d)}else l=function(e,t){var n;function r(){return ti(null,t.config,t,null)}function i(e,t,n,r){var i=e?e.length+1:1;function o(){0==--i&&(r&&r(),r=null)}i>0&&pt(e,(function(e){if(e&&e.queue.length>0){var r=e.chain,a=t.createNew(r);a.onComplete(o),n(a)}else i--})),o()}var o=!1;return(n={identifier:"ChannelControllerPlugin",priority:500,initialize:function(t,n,r,i){o=!0,pt(e,(function(e){e&&e.queue.length>0&&$r(ti(e.chain,t,n),r)}))},isInitialized:function(){return o},processTelemetry:function(t,n){i(e,n||r(),(function(e){e.processNext(t)}),(function(){n.processNext(t)}))},update:function(t,n){var r=n||{reason:0};return i(e,t,(function(e){e.processNext(r)}),(function(){t.processNext(r)})),!0}}).pause=function(){i(e,r(),(function(e){e.iterate((function(e){e.pause&&e.pause()}))}),null)},n.resume=function(){i(e,r(),(function(e){e.iterate((function(e){e.resume&&e.resume()}))}),null)},n.teardown=function(t,n){var r=n||{reason:0,isAsync:!1};return i(e,t,(function(e){e.processNext(r)}),(function(){t.processNext(r),o=!1})),!0},n.getChannel=function(t){var n=null;return e&&e.length>0&&pt(e,(function(e){if(e&&e.queue.length>0&&(pt(e.queue,(function(e){if(e.identifier===t)return n=e,-1})),n))return-1})),n},n.flush=function(t,n,o,a){var s=1,u=!1,c=null;function l(){s--,u&&0===s&&(c&&(clearTimeout(c),c=null),n&&n(u),n=null)}return a=a||5e3,i(e,r(),(function(e){e.iterate((function(e){if(e.flush){s++;var n=!1;e.flush(t,(function(){n=!0,l()}),o)||n||(t&&null==c?c=setTimeout((function(){c=null,l()}),a):l())}}))}),(function(){u=!0,l()})),!0},n._setQueue=function(t){e=t},n}(d,e);i.push(l),c.push(l),e._extensions=Zr(i),l.initialize(t,e,i),$r(T(),i),e._extensions=xt(Zr(c||[])).slice(),n&&function(t){var n=ri(x(),e);e._updateHook&&!0===e._updateHook(n,t)||n.processNext(t)}(n)}function S(t){var n=null,r=null;return pt(e._extensions,(function(e){if(e.identifier===t&&e!==l&&e!==p)return r=e,-1})),!r&&l&&(r=l.getChannel(t)),r&&(n={plugin:r,setEnabled:function(e){Gr(r).disabled=!e},isEnabled:function(){var e=Gr(r);return!e.teardown&&!e.disabled},remove:function(t,n){void 0===t&&(t=!0);var i=[r];k(i,{reason:1,isAsync:t},(function(t){t&&E(e.config,{reason:32,removed:i}),n&&n(t)}))}}),n}function x(){if(!s){var t=(c||[]).slice();-1===ht(t,p)&&t.push(p),s=ii(Zr(t),e.config,e)}return s}function k(t,n,r){if(t&&t.length>0){var i=ni(ii(t,e.config,e),e);i.onComplete((function(){var e=!1,n=[];pt(u,(function(r,i){di(r,t)?e=!0:n.push(r)})),u=n;var i=[];f&&(pt(f,(function(n,r){var o=[];pt(n,(function(n){di(n,t)?e=!0:o.push(n)})),i.push(o)})),f=i),r&&r(e)})),i.processNext(n)}else r(!1)}function D(){var t=e.logger?e.logger.queue:[];t&&(pt(t,(function(t){var n={name:h||"InternalMessageId: "+t.messageId,iKey:e.config.instrumentationKey,time:vt(new Date),baseType:An.dataType,baseData:{message:t.message}};e.track(n)})),t.length=0)}function I(e,t,n,r){return l?l.flush(e,t,n||6,r):(t&&t(!1),!0)}function _(t){var n=e.logger;n?Nn(n,2,73,t):At(t)}C(),e.isInitialized=function(){return t},e.initialize=function(n,i,a,s){v&&At("SDK is still unloading..."),e.isInitialized()&&At("Core should not be initialized more than once"),n&&!Ge(n.instrumentationKey)||At("Please provide instrumentation key"),r=s,e._notificationManager=s,e.config=n||{},function(e){!0===e.disableDbgExt&&y&&(r.removeNotificationListener(y),y=null),r&&!y&&!0!==e.disableDbgExt&&(y=function(e){if(!Sn){Sn={};for(var t=0;t<xn.length;t++)Sn[xn[t]]=Dn(xn[t],e)}return Sn}(e),r.addNotificationListener(y))}(n),function(t){!t.enablePerfMgr&&o&&(o=null),t.enablePerfMgr&&It(e.config,"createPerfMgr",li)}(n),n.extensions=Ge(n.extensions)?[]:n.extensions,function(e){var t,n,i,o;(t=e,n="extensionConfig",t?!(o=t[n])&&Ge(o)&&(o=Xe(i)?{}:i,t[n]=o):o=Xe(i)?{}:i,o).NotificationManager=r}(n),a&&(e.logger=a),(u=[]).push.apply(u,Object(_e.b)(Object(_e.b)([],i,!1),n.extensions,!1)),f=(n||{}).channels,E(n,null),d&&0!==d.length||At("No channels available"),t=!0,e.releaseQueue()},e.getTransmissionControls=function(){var e=[];return d&&pt(d,(function(t){e.push(t.queue)})),xt(e)},e.track=function(t){It(t,"iKey",e.config.instrumentationKey,null,_t),It(t,"time",vt(new Date),null,_t),It(t,"ver","4.0",null,Ge),!v&&e.isInitialized()?T().processNext(t):n.push(t)},e.getProcessTelContext=T,e.getNotifyMgr=function(){var t;return r||(r=Object(Ae.b)(((t={}).addNotificationListener=function(e){},t.removeNotificationListener=function(e){},t.eventsSent=function(e){},t.eventsDiscarded=function(e,t){},t.eventsSendRequest=function(e,t){},t)),e._notificationManager=r),r},e.addNotificationListener=function(e){r&&r.addNotificationListener(e)},e.removeNotificationListener=function(e){r&&r.removeNotificationListener(e)},e.getCookieMgr=function(){return a||(a=lr(e.config,e.logger)),a},e.setCookieMgr=function(e){a=e},e.getPerfMgr=function(){return i||o||e.config&&e.config.enablePerfMgr&&et(e.config.createPerfMgr)&&(o=e.config.createPerfMgr(e,e.getNotifyMgr())),i||o||Mn},e.setPerfMgr=function(e){i=e},e.eventCnt=function(){return n.length},e.releaseQueue=function(){if(t&&n.length>0){var e=n;n=[],pt(e,(function(e){T().processNext(e)}))}},e.pollInternalLogs=function(t){h=t||null;var n=e.config.diagnosticLogInterval;return n&&n>0||(n=1e4),w&&clearInterval(w),w=setInterval((function(){D()}),n)},e.stopPollingInternalLogs=function(){w&&(clearInterval(w),w=0,D())},Nt(e,(function(){return p}),["addTelemetryInitializer"]),e.unload=function(n,r,i){void 0===n&&(n=!0),t||At("SDK is not initialized"),v&&At("SDK is still unloading...");var o={reason:50,isAsync:n,flushComplete:!1},a=ni(x(),e);function s(t){o.flushComplete=t,v=!0,m.run(a,o),e.stopPollingInternalLogs(),a.processNext(o)}a.onComplete((function(){C(),r&&r(o)}),e),I(n,s,6,i)||s(!1)},e.getPlugin=S,e.addPlugin=function(t,n,r,i){if(!t)return i&&i(!1),void _("Plugins must provide initialize method");var o=S(t.identifier);if(o&&!n)return i&&i(!1),void _("Plugin ["+t.identifier+"] is already loaded!");var a={reason:16};function s(n){u.push(t),a.added=[t],E(e.config,a),i&&i(!0)}if(o){var c=[o.plugin];k(c,{reason:2,isAsync:!!r},(function(e){e?(a.removed=c,a.reason|=32,s()):i&&i(!1)}))}else s()},e.evtNamespace=function(){return g},e.flush=I,e.getTraceCtx=function(e){var t,n;return b||(n={},b={getName:function(){return n.name},setName:function(e){t&&t.setName(e),n.name=e},getTraceId:function(){return n.traceId},setTraceId:function(e){t&&t.setTraceId(e),Jr(e)&&(n.traceId=e)},getSpanId:function(){return n.spanId},setSpanId:function(e){t&&t.setSpanId(e),Qr(e)&&(n.spanId=e)},getTraceFlags:function(){return n.traceFlags},setTraceFlags:function(e){t&&t.setTraceFlags(e),n.traceFlags=e}}),b},e.setTraceCtx=function(e){b=e||null},Lt(e,"addUnloadCb",(function(){return m}),"add")}))})),mi=((pi={})[0]=0,pi[2]=6,pi[1]=1,pi[3]=7,pi[4098]=6,pi[4097]=1,pi[4099]=7,pi);Boolean(Vt()),Boolean(Wt());function yi(e){return!(""===e||Ge(e))}function bi(e){if(e){var t=e.indexOf("-");if(t>-1)return e.substring(0,t)}return""}function wi(e){return!!(e&&lt(e)&&e>=1&&e<=4)}function Ci(e,t,n){if(!t&&!yi(t)||"string"!=typeof e)return null;var r=typeof t;if("string"===r||"number"===r||"boolean"===r||st(t))t={value:t};else if("object"!==r||t.hasOwnProperty("value")){if(Ge(t.value)||""===t.value||!ct(t.value)&&!lt(t.value)&&!ft(t.value)&&!st(t.value))return null}else t={value:n?JSON.stringify(t):t};if(st(t.value)&&!Di(t.value))return null;if(!Ge(t.kind)){if(st(t.value)||!ki(t.kind))return null;t.value=t.value.toString()}return t}function Ti(e,t,n){var r=-1;if(!Xe(e))if(t>0&&(32===t?r=8192:t<=13&&(r=t<<5)),function(e){if(e>=0&&e<=9)return!0;return!1}(n))-1===r&&(r=0),r|=n;else{var i=mi[_i(e)]||-1;-1!==r&&-1!==i?r|=i:6===i&&(r=i)}return r}function Ei(e){void 0===e&&(e="D");var t=Ur();return"B"===e?t="{"+t+"}":"P"===e?t="("+t+")":"N"===e&&(t=t.replace(/-/g,"")),t}function Si(e,t,n,r,i){var o={},a=!1,s=0,u=arguments.length,c=Object[Oe.k],l=arguments;for("[object Boolean]"===c.toString.call(l[0])&&(a=l[0],s++);s<u;s++){nt(e=l[s],(function(e,t){a&&t&&Ye(t)?st(t)?(o[e]=o[e]||[],pt(t,(function(t,n){t&&Ye(t)?o[e][n]=Si(!0,o[e][n],t):o[e][n]=t}))):o[e]=Si(!0,o[e],t):o[e]=t}))}return o}var xi=jr;function ki(e){return 0===e||e>0&&e<=13||32===e}function Di(e){return e.length>0}function Ii(e,t){var n=e;n.timings=n.timings||{},n.timings.processTelemetryStart=n.timings.processTelemetryStart||{},n.timings.processTelemetryStart[t]=xi()}function _i(e){var t=0;if(null!=e){var n=typeof e;"string"===n?t=1:"number"===n?t=2:"boolean"===n?t=3:n===Oe.j&&(t=4,st(e)?(t=4096,e.length>0&&(t|=_i(e[0]))):Ze(e,"value")&&(t=8192|_i(e.value)))}return t}Oe.l,Oe.j,Oe.l,Ae.b;var Oi=function(e){function t(){var n=e.call(this)||this;return n.pluginVersionStringArr=[],n.pluginVersionString="",En(t,n,(function(e,t){e.logger&&e.logger.queue||(e.logger=new Pn({loggingLevelConsole:1})),e.initialize=function(n,r,i,o){Rn(e,(function(){return"AppInsightsCore.initialize"}),(function(){if(n){n.endpointUrl||(n.endpointUrl="https://browser.events.data.microsoft.com/OneCollector/1.0/");var a=n.propertyStorageOverride;if(a&&(!a.getProperty||!a.setProperty))throw new Error("Invalid property storage override passed.");n.channels&&pt(n.channels,(function(t){t&&pt(t,(function(t){if(t.identifier&&t.version){var n=t.identifier+"="+t.version;e.pluginVersionStringArr.push(n)}}))}))}e.getWParam=function(){return"undefined"!=typeof document?0:-1},r&&pt(r,(function(t){if(t&&t.identifier&&t.version){var n=t.identifier+"="+t.version;e.pluginVersionStringArr.push(n)}})),e.pluginVersionString=e.pluginVersionStringArr.join(";");try{t.initialize(n,r,i,o),e.pollInternalLogs("InternalLog")}catch(t){var s=e.logger,u=tn(t);-1!==u.indexOf("channels")&&(u+="\n - Channels must be provided through config.channels only!"),s.throwInternal(1,514,"SDK Initialization Failed - no telemetry will be sent: "+u)}}),(function(){return{config:n,extensions:r,logger:i,notificationManager:o}}))},e.track=function(n){Rn(e,(function(){return"AppInsightsCore.track"}),(function(){var r=n;if(r){r.timings=r.timings||{},r.timings.trackStart=xi(),wi(r.latency)||(r.latency=1);var i=r.ext=r.ext||{};i.sdk=i.sdk||{},i.sdk.ver="1DS-Web-JS-3.2.3";var o=r.baseData=r.baseData||{};o.properties||(o.properties={});var a=o.properties;a.version||(a.version=""),""!==e.pluginVersionString&&(a.version=e.pluginVersionString)}t.track(r)}),(function(){return{item:n}}),!n.sync)}})),n}return Object(_e.a)(t,e),t}(gi);var Ai,Pi=(Ai={},nt({Unknown:0,NonRetryableStatus:1,InvalidEvent:2,SizeLimitExceeded:3,KillSwitch:4,QueueFull:5},(function(e,t){Ai[e]=t,Ai[t]=e})),St(Ai));function Li(e){var t=(e.ext||{}).intweb;return t&&yi(t.msfpc)?t.msfpc:null}function Ni(e){for(var t=null,n=0;null===t&&n<e.length;n++)t=Li(e[n]);return t}var Mi=function(){function e(t,n){var r=n?[].concat(n):[],i=Ni(r);this.iKey=function(){return t},this.Msfpc=function(){return i||""},this.count=function(){return r.length},this.events=function(){return r},this.addEvent=function(e){return!!e&&(r.push(e),i||(i=Li(e)),!0)},this.split=function(n,o){var a;if(n<r.length){var s=r.length-n;Ge(o)||(s=o<s?o:s),a=r.splice(n,s),i=Ni(r)}return new e(t,a)}}return e.create=function(t,n){return new e(t,n)},e}(),Fi=Math.min(2e6,65e3),Bi=/\./,Ri=function e(t,n,r,i){var o=!!i,a=n,s={};En(e,this,(function(e){function n(e,t,i,u,c,l,f){nt(e,(function(e,d){var v=null;if(d||yi(d)){var p=i,h=e,g=c,m=t;if(o&&!u&&Bi.test(e)){var y=e.split("."),b=y.length;if(b>1){g&&(g=g.slice());for(var w=0;w<b-1;w++){var C=y[w];m=m[C]=m[C]||{},p+="."+C,g&&g.push(C)}h=y[b-1]}}if(v=u&&function(e,t){var n=s[e];return void 0===n&&(e.length>=7&&(n=it(e,"ext.metadata")||it(e,"ext.web")),s[e]=n),n}(p)||!a||!a.handleField(p,h)?Ci(h,d,r):a.value(p,h,d,r)){var T=v.value;if(m[h]=T,l&&l(g,h,v),f&&"object"==typeof T&&!st(T)){var E=g;E&&(E=E.slice()).push(h),n(d,T,p+"."+h,u,E,l,f)}}}}))}e.createPayload=function(e,t,n,r,i,o){return{apiKeys:[],payloadBlob:"",overflow:null,sizeExceed:[],failedEvts:[],batches:[],numEvents:0,retryCnt:e,isTeardown:t,isSync:n,isBeacon:r,sendType:o,sendReason:i}},e.appendPayload=function(n,r,i){var o=n&&r&&!n.overflow;return o&&Rn(t,(function(){return"Serializer:appendPayload"}),(function(){for(var t=r.events(),o=n.payloadBlob,a=n.numEvents,s=!1,u=[],c=[],l=n.isBeacon,f=l?65e3:3984588,d=l?Fi:2e6,v=0,p=0;v<t.length;){var h=t[v];if(h){if(a>=i){n.overflow=r.split(v);break}var g=e.getEventBlob(h);if(g&&g.length<=d){var m=g.length;if(o.length+m>f){n.overflow=r.split(v);break}o&&(o+="\n"),o+=g,++p>20&&(o.substr(0,1),p=0),s=!0,a++}else g?u.push(h):c.push(h),t.splice(v,1),v--}v++}if(u&&u.length>0&&n.sizeExceed.push(Mi.create(r.iKey(),u)),c&&c.length>0&&n.failedEvts.push(Mi.create(r.iKey(),c)),s){n.batches.push(r),n.payloadBlob=o,n.numEvents=a;var y=r.iKey();-1===ht(n.apiKeys,y)&&n.apiKeys.push(y)}}),(function(){return{payload:n,theBatch:{iKey:r.iKey(),evts:r.events()},max:i}})),o},e.getEventBlob=function(e){try{return Rn(t,(function(){return"Serializer.getEventBlob"}),(function(){var t={};t.name=e.name,t.time=e.time,t.ver=e.ver,t.iKey="o:"+bi(e.iKey);var r={},i=e.ext;i&&(t.ext=r,nt(i,(function(e,t){n(t,r[e]={},"ext."+e,!0,null,null,!0)})));var o=t.data={};o.baseType=e.baseType;var a=o.baseData={};return n(e.baseData,a,"baseData",!1,["baseData"],(function(e,t,n){Ui(r,e,t,n)}),!0),n(e.data,o,"data",!1,[],(function(e,t,n){Ui(r,e,t,n)}),!0),JSON.stringify(t)}),(function(){return{item:e}}))}catch(e){return null}}}))};function Ui(e,t,n,r){if(r&&e){var i=Ti(r.value,r.kind,r.propertyType);if(i>-1){var o=e.metadata;o||(o=e.metadata={f:{}});var a=o.f;if(a||(a=o.f={}),t)for(var s=0;s<t.length;s++){var u=t[s];a[u]||(a[u]={f:{}});var c=a[u].f;c||(c=a[u].f={}),a=c}a=a[n]={},st(r.value)?a.a={t:i}:a.t=i}}}function ji(e){var t,n=Math.floor(1200*Math.random())+2400;return t=Math.pow(2,e)*n,Math.min(t,6e5)}var Hi,zi=function e(){var t={};En(e,this,(function(e){e.setKillSwitchTenants=function(e,n){if(e&&n)try{var r=function(e){var t=[];return e&&pt(e,(function(e){t.push(yt(e))})),t}(e.split(","));if("this-request-only"===n)return r;for(var i=1e3*parseInt(n,10),o=0;o<r.length;++o)t[r[o]]=kt()+i}catch(e){return[]}return[]},e.isTenantKilled=function(e){var n=t,r=yt(e);return void 0!==n[r]&&n[r]>kt()||(delete n[r],!1)}}))},qi=function e(){var t=!0,n=!0,r=!0,i="use-collector-delta",o=!1;En(e,this,(function(e){e.allowRequestSending=function(){return t},e.firstRequestSent=function(){r&&(r=!1,o||(t=!1))},e.shouldAddClockSkewHeaders=function(){return n},e.getClockSkewHeaderValue=function(){return i},e.setClockSkew=function(e){o||(e?(i=e,n=!0,o=!0):n=!1,t=!0)}}))},Ki=((Hi={})[1]="requeue",Hi[100]="requeue",Hi[200]="sent",Hi[8004]="drop",Hi[8003]="drop",Hi),Wi={},Vi={};function Ji(e,t,n){Wi[e]=t,!1!==n&&(Vi[t]=e)}function Qi(e){try{return e.responseText}catch(e){}return""}function Xi(e,t){var n=!1;if(e&&t){var r=Ct(e);if(r&&r.length>0)for(var i=t.toLowerCase(),o=0;o<r.length;o++){var a=r[o];if(a&&Ze(t,a)&&a.toLowerCase()===i){n=!0;break}}}return n}function Gi(e,t,n,r){t&&n&&n.length>0&&(r&&Wi[t]?(e.hdrs[Wi[t]]=n,e.useHdrs=!0):e.url+="&"+t+"="+n)}Ji("AuthMsaDeviceTicket","AuthMsaDeviceTicket",!1),Ji("client-version","client-version"),Ji("client-id","Client-Id"),Ji("apikey","apikey"),Ji("time-delta-to-apply-millis","time-delta-to-apply-millis"),Ji("upload-time","upload-time"),Ji("AuthXToken","AuthXToken");var $i=function e(t,n,r,i,o){this._responseHandlers=[];var a,s,u,c,l,f,d="?cors=true&"+"content-type".toLowerCase()+"=application/x-json-stream",v=new zi,p=!1,h=new qi,g=!1,m=0,y=!0,b=[],w={},C=[],T=null,E=!1,S=!1,x=!1;En(e,this,(function(e){var k=!0;function D(e,t){for(var n=0,r=null,i=0;null==r&&i<e.length;)1===(n=e[i])?on()?r=I:an()&&(r=O):2===n&&rn(t)?r=_:g&&3===n&&nn()&&(r=P),i++;return r?{_transport:n,_isSync:t,sendPOST:r}:null}function I(e,t,n){var r=new XDomainRequest;r.open("POST",e.urlString),e.timeout&&(r.timeout=e.timeout),r.onload=function(){var e=Qi(r);A(t,200,{},e),K(e)},r.onerror=function(){A(t,400,{})},r.ontimeout=function(){A(t,500,{})},r.onprogress=function(){},n?r.send(e.data):o.set((function(){r.send(e.data)}),0)}function _(e,t,n){var r,i=e.urlString,a=!1,s=!1,u=((r={body:e.data,method:"POST"}).Microsoft_ApplicationInsights_BypassAjaxInstrumentation=!0,r);n&&(u.keepalive=!0,2===e._sendReason&&(a=!0,i+="&NoResponseBody=true")),k&&(u.credentials="include"),e.headers&&Ct(e.headers).length>0&&(u.headers=e.headers),fetch(i,u).then((function(e){var n={},r="";e.headers&&e.headers.forEach((function(e,t){n[t]=e})),e.body&&e.text().then((function(e){r=e})),s||(s=!0,A(t,e.status,n,r),K(r))})).catch((function(e){s||(s=!0,A(t,0,{}))})),a&&!s&&(s=!0,A(t,200,{})),!s&&e.timeout>0&&o.set((function(){s||(s=!0,A(t,500,{}))}),e.timeout)}function O(e,t,n){var r=e.urlString;function i(e,t,n){if(!e[n]&&t&&t.getResponseHeader){var r=t.getResponseHeader(n);r&&(e[n]=yt(r))}return e}function o(e){var t,n,r={};return e.getAllResponseHeaders?(t=e.getAllResponseHeaders(),n={},ct(t)&&pt(yt(t).split(/[\r\n]+/),(function(e){if(e){var t=e.indexOf(": ");if(-1!==t){var r=yt(e.substring(0,t)).toLowerCase(),i=yt(e.substring(t+1));n[r]=i}else n[yt(e)]=1}})),r=n):(r=i(r,e,"time-delta-millis"),r=i(r,e,"kill-duration"),r=i(r,e,"kill-duration-seconds")),r}function a(e,n){A(t,e.status,o(e),n)}n&&e.disableXhrSync&&(n=!1);var s=function(e,t,n,r,i,o){function a(e,t,n){try{e[t]=n}catch(e){}}void 0===r&&(r=!1),void 0===i&&(i=!1);var s=new XMLHttpRequest;return r&&a(s,"Microsoft_ApplicationInsights_BypassAjaxInstrumentation",r),n&&a(s,"withCredentials",n),s.open(e,t,!i),n&&a(s,"withCredentials",n),!i&&o&&a(s,"timeout",o),s}("POST",r,k,!0,n,e.timeout);nt(e.headers,(function(e,t){s.setRequestHeader(e,t)})),s.onload=function(){var e=Qi(s);a(s,e),K(e)},s.onerror=function(){a(s)},s.ontimeout=function(){a(s)},s.send(e.data)}function A(e,t,n,r){try{e(t,n,r)}catch(e){Nn(a.diagLog(),2,518,tn(e))}}function P(e,t,n){var r=200,i=e._thePayload,o=e.urlString+"&NoResponseBody=true";try{var s=Qt();if(!s.sendBeacon(o,e.data))if(i){var u=[];pt(i.batches,(function(e){if(u&&e&&e.count()>0){for(var t=e.events(),n=0;n<t.length;n++)if(!s.sendBeacon(o,T.getEventBlob(t[n]))){u.push(e.split(n));break}}else u.push(e.split(0))})),W(u,8003,i.sendType,!0)}else r=0}catch(e){a.diagLog().warnToConsole("Failed to send telemetry using sendBeacon API. Ex:"+tn(e)),r=0}finally{A(t,r,{},"")}}function L(e){return 2===e||3===e}function N(e){return S&&L(e)&&(e=2),e}function M(){return!p&&m<n}function F(){var e=C;return C=[],e}function B(e,t,n){var r=!1;return e&&e.length>0&&!p&&s[t]&&T&&(r=0!==t||M()&&(n>0||h.allowRequestSending())),r}function R(e){var t={};return e&&pt(e,(function(e,n){t[n]={iKey:e.iKey(),evts:e.events()}})),t}function U(e,n,r,i,o){if(e&&0!==e.length)if(p)W(e,1,i);else{i=N(i);try{var c=e,l=0!==i;Rn(u,(function(){return"HttpManager:_sendBatches"}),(function(a){a&&(e=e.slice(0));for(var u=[],c=null,f=xi(),d=s[i]||(l?s[1]:s[0]),p=(S||L(i)||d&&3===d._transport)&&!y&&g&&nn();B(e,i,n);){var h=e.shift();h&&h.count()>0&&(v.isTenantKilled(h.iKey())?u.push(h):(c=c||T.createPayload(n,r,l,p,o,i),T.appendPayload(c,h,t)?null!==c.overflow&&(e=[c.overflow].concat(e),c.overflow=null,z(c,f,xi(),o),f=xi(),c=null):(z(c,f,xi(),o),f=xi(),e=[h].concat(e),c=null)))}c&&z(c,f,xi(),o),e.length>0&&(C=e.concat(C)),W(u,8004,i)}),(function(){return{batches:R(c),retryCount:n,isTeardown:r,isSynchronous:l,sendReason:o,useSendBeacon:L(i),sendType:i}}),!l)}catch(e){Nn(a.diagLog(),2,48,"Unexpected Exception sending batch: "+tn(e))}}}function j(e,t){var n={url:d,hdrs:{},useHdrs:!1};t?(n.hdrs=Si(n.hdrs,w),n.useHdrs=Ct(n.hdrs).length>0):nt(w,(function(e,t){Vi[e]?Gi(n,Vi[e],t,!1):(n.hdrs[e]=t,n.useHdrs=!0)})),Gi(n,"client-id","NO_AUTH",t),Gi(n,"client-version","1DS-Web-JS-3.2.3",t);var r="";pt(e.apiKeys,(function(e){r.length>0&&(r+=","),r+=e})),Gi(n,"apikey",r,t),Gi(n,"upload-time",kt().toString(),t);var i=function(e){for(var t=0;t<e.batches.length;t++){var n=e.batches[t].Msfpc();if(n)return encodeURIComponent(n)}return""}(e);if(yi(i)&&(n.url+="&ext.intweb.msfpc="+i),h.shouldAddClockSkewHeaders()&&Gi(n,"time-delta-to-apply-millis",h.getClockSkewHeaderValue(),t),u.getWParam){var o=u.getWParam();o>=0&&(n.url+="&w="+o)}for(var a=0;a<b.length;a++)n.url+="&"+b[a].name+"="+b[a].value;return n}function H(e,t,n){e[t]=e[t]||{},e[t][a.identifier]=n}function z(t,n,i,o){if(t&&t.payloadBlob&&t.payloadBlob.length>0){var c=!!e.sendHook,d=s[t.sendType];!L(t.sendType)&&t.isBeacon&&2===t.sendReason&&(d=s[2]||s[3]||d);var p=x;(t.isBeacon||3===d._transport)&&(p=!1);var g=j(t,p);p=p||g.useHdrs;var b=xi();Rn(u,(function(){return"HttpManager:_doPayloadSend"}),(function(){for(var s=0;s<t.batches.length;s++)for(var w=t.batches[s].events(),C=0;C<w.length;C++){var T=w[C];if(E){var x=T.timings=T.timings||{};H(x,"sendEventStart",b),H(x,"serializationStart",n),H(x,"serializationCompleted",i)}T.sendAttempt>0?T.sendAttempt++:T.sendAttempt=1}W(t.batches,1e3+(o||0),t.sendType,!0);var k={data:t.payloadBlob,urlString:g.url,headers:g.hdrs,_thePayload:t,_sendReason:o,timeout:l};Xe(f)||(k.disableXhrSync=!!f),p&&(Xi(k.headers,"cache-control")||(k.headers["cache-control"]="no-cache, no-store"),Xi(k.headers,"content-type")||(k.headers["content-type"]="application/x-json-stream"));var D=null;d&&(D=function(n){h.firstRequestSent();var i=function(n,i){!function(t,n,i,o){var s,u=9e3,c=null,l=!1,f=!1;try{var d=!0;if(typeof t!==Oe.l){if(n){h.setClockSkew(n["time-delta-millis"]);var p=n["kill-duration"]||n["kill-duration-seconds"];pt(v.setKillSwitchTenants(n["kill-tokens"],p),(function(e){pt(i.batches,(function(t){if(t.iKey()===e){c=c||[];var n=t.split(0);i.numEvents-=n.count(),c.push(n)}}))}))}if(200==t||204==t)return void(u=200);((s=t)>=300&&s<500&&408!=s&&429!=s||501==s||505==s||i.numEvents<=0)&&(d=!1),u=9e3+t%1e3}if(d){u=100;var g=i.retryCnt;0===i.sendType&&(g<r?(l=!0,q((function(){0===i.sendType&&m--,U(i.batches,g+1,i.isTeardown,S?2:i.sendType,5)}),S,ji(g))):(f=!0,S&&(u=8001)))}}finally{l||(h.setClockSkew(),function(t,n,r,i){try{i&&a._backOffTransmission(),200===n&&(i||t.isSync||a._clearBackOff(),function(e){if(E){var t=xi();pt(e,(function(e){var n,r;e&&e.count()>0&&(n=e.events(),r=t,E&&pt(n,(function(e){H(e.timings=e.timings||{},"sendEventCompleted",r)})))}))}}(t.batches)),W(t.batches,n,t.sendType,!0)}finally{0===t.sendType&&(m--,5!==r&&e.sendQueuedRequests(t.sendType,r))}}(i,u,o,f)),W(c,8004,i.sendType)}}(n,i,t,o)},s=t.isTeardown||t.isSync;try{d.sendPOST(n,i,s),e.sendListener&&e.sendListener(k,n,s,t.isBeacon)}catch(e){a.diagLog().warnToConsole("Unexpected exception sending payload. Ex:"+tn(e)),A(i,0,{})}}),Rn(u,(function(){return"HttpManager:_doPayloadSend.sender"}),(function(){if(D)if(0===t.sendType&&m++,c&&!t.isBeacon&&3!==d._transport){var n={data:k.data,urlString:k.urlString,headers:Si({},k.headers),timeout:k.timeout,disableXhrSync:k.disableXhrSync},r=!1;Rn(u,(function(){return"HttpManager:_doPayloadSend.sendHook"}),(function(){try{e.sendHook(n,(function(e){r=!0,y||e._thePayload||(e._thePayload=e._thePayload||k._thePayload,e._sendReason=e._sendReason||k._sendReason),D(e)}),t.isSync||t.isTeardown)}catch(e){r||D(k)}}))}else D(k)}))}),(function(){return{thePayload:t,serializationStart:n,serializationCompleted:i,sendReason:o}}),t.isSync)}t.sizeExceed&&t.sizeExceed.length>0&&W(t.sizeExceed,8003,t.sendType),t.failedEvts&&t.failedEvts.length>0&&W(t.failedEvts,8002,t.sendType)}function q(e,t,n){t?e():o.set(e,n)}function K(t){var n=e._responseHandlers;try{for(var r=0;r<n.length;r++)try{n[r](t)}catch(e){Nn(a.diagLog(),1,519,"Response handler failed: "+e)}if(t){var i=JSON.parse(t);yi(i.webResult)&&yi(i.webResult.msfpc)&&c.set("MSFPC",i.webResult.msfpc,31536e3)}}catch(e){}}function W(e,t,n,r){if(e&&e.length>0&&i){var o=i[(c=t,l=Ki[c],yi(l)||(l="oth",c>=9e3&&c<=9999?l="rspFail":c>=8e3&&c<=8999?l="drop":c>=1e3&&c<=1999&&(l="send")),l)];if(o){var s=0!==n;Rn(u,(function(){return"HttpManager:_sendBatchesNotification"}),(function(){q((function(){try{o.call(i,e,t,s,n)}catch(e){Nn(a.diagLog(),1,74,"send request notification failed: "+e)}}),r||s,0)}),(function(){return{batches:R(e),reason:t,isSync:s,sendSync:r,sendType:n}}),!s)}}var c,l}e.initialize=function(e,t,n,r,i){var o;i||(i={}),d=e+d,x=!!Xe(i.avoidOptions)||!i.avoidOptions,u=t,c=t.getCookieMgr(),E=!u.config.disableEventTimings;var v=!!u.config.enableCompoundKey;a=n;var p=i.valueSanitizer,h=i.stringifyObjects;Xe(i.enableCompoundKey)||(v=!!i.enableCompoundKey),l=i.xhrTimeout,f=i.disableXhrSync,g=!Yt(),T=new Ri(u,p,h,v);var m=r,b=i.alwaysUseXhrOverride?r:null,w=i.alwaysUseXhrOverride?r:null;if(!r){y=!1;var C=Xt();C&&C.protocol&&"file:"===C.protocol.toLowerCase()&&(k=!1);var S=[];S=Yt()?[2,1]:[1,2,3];var I=i.transports;I&&(lt(I)?S=[I].concat(S):st(I)&&(S=I.concat(S))),r=D(S,!1),m=D(S,!0),r||a.diagLog().warnToConsole("No available transport to send events")}(o={})[0]=r,o[1]=m||D([1,2,3],!0),o[2]=b||D([3,2],!0)||m||D([1],!0),o[3]=w||D([2,3],!0)||m||D([1],!0),s=o},e._getDbgPlgTargets=function(){return[s[0],v,T,s]},e.addQueryStringParameter=function(e,t){for(var n=0;n<b.length;n++)if(b[n].name===e)return void(b[n].value=t);b.push({name:e,value:t})},e.addHeader=function(e,t){w[e]=t},e.canSendRequest=function(){return M()&&h.allowRequestSending()},e.sendQueuedRequests=function(e,t){Xe(e)&&(e=0),S&&(e=N(e),t=2),B(C,e,0)&&U(F(),0,!1,e,t||0)},e.isCompletelyIdle=function(){return!p&&0===m&&0===C.length},e.setUnloading=function(e){S=e},e.addBatch=function(e){if(e&&e.count()>0){if(v.isTenantKilled(e.iKey()))return!1;C.push(e)}return!0},e.teardown=function(){C.length>0&&U(F(),0,!0,2,2)},e.pause=function(){p=!0},e.resume=function(){p=!1,e.sendQueuedRequests(0,4)},e.sendSynchronousBatch=function(e,t,n){e&&e.count()>0&&(Ge(t)&&(t=1),S&&(t=N(t),n=2),U([e],0,!1,t,n||0))}}))};function Zi(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return setTimeout(e,t,n)}function Yi(e){clearTimeout(e)}function eo(e,t){return{set:e||Zi,clear:t||Yi}}var to=function(e){function t(){var n,r=e.call(this)||this;r.identifier="PostChannel",r.priority=1011,r.version="3.2.3";var i,o,a,s,u,c,l,f=!1,d=[],v=null,p=!1,h=0,g=500,m=0,y=1e4,b={},w="REAL_TIME",C=null,T=null,E=0,S=0,x={},k=-1,D=!0,I=!1,_=6,O=2;return En(t,r,(function(e,t){function r(e){"beforeunload"!==(e||Wt().event).type&&(I=!0,o.setUnloading(I)),U(2,2)}function A(e){I=!1,o.setUnloading(I)}function P(e,t){if(e.sendAttempt||(e.sendAttempt=0),e.latency||(e.latency=1),e.ext&&e.ext.trace&&delete e.ext.trace,e.ext&&e.ext.user&&e.ext.user.id&&delete e.ext.user.id,D&&(e.ext=Mt(e.ext),e.baseData&&(e.baseData=Mt(e.baseData)),e.data&&(e.data=Mt(e.data))),e.sync)if(E||p)e.latency=3,e.sync=!1;else if(o)return D&&(e=Mt(e)),void o.sendSynchronousBatch(Mi.create(e.iKey,[e]),!0===e.sync?1:e.sync,3);var n=e.latency,r=m,i=y;4===n&&(r=h,i=g);var a=!1;if(r<i)a=!z(e,t);else{var s=1,u=20;4===n&&(s=4,u=1),a=!0,function(e,t,n,r){for(;n<=t;){var i=j(e,t,!0);if(i&&i.count()>0){var o=i.split(0,r),a=o.count();if(a>0)return 4===n?h-=a:m-=a,X("eventsDiscarded",[o],Pi.QueueFull),!0}n++}return q(),!1}(e.iKey,e.latency,s,u)&&(a=!z(e,t))}a&&Q("eventsDiscarded",[e],Pi.QueueFull)}function L(e,t,n){var r=K(e,t,n);return o.sendQueuedRequests(t,n),r}function N(){return m>0}function M(){if(k>=0&&K(k,0,u)&&o.sendQueuedRequests(0,u),h>0&&!T&&!p){var e=b[w][2];e>=0&&(T=B((function(){T=null,L(4,0,1),M()}),e))}var t=b[w][1];!C&&!v&&t>=0&&!p&&(N()?C=B((function(){C=null,L(0===S?3:1,0,1),S++,S%=2,M()}),t):S=0)}function F(){n=null,f=!1,d=[],v=null,p=!1,h=0,g=500,m=0,y=1e4,b={},w="REAL_TIME",C=null,T=null,E=0,S=0,i=null,x={},a=void 0,s=0,k=-1,u=null,D=!0,I=!1,_=6,O=2,c=null,l=eo(),o=new $i(500,2,1,{requeue:V,send:G,sent:$,drop:Z,rspFail:Y,oth:ee},l),W(),x[4]={batches:[],iKeyMap:{}},x[3]={batches:[],iKeyMap:{}},x[2]={batches:[],iKeyMap:{}},x[1]={batches:[],iKeyMap:{}},te()}function B(e,t){0===t&&E&&(t=1);var n=1e3;return E&&(n=ji(E-1)),l.set(e,t*n)}function R(){return null!==C&&(l.clear(C),C=null,S=0,!0)}function U(e,t){R(),v&&(l.clear(v),v=null),p||L(1,e,t)}function j(e,t,n){var r=x[t];r||(r=x[t=1]);var i=r.iKeyMap[e];return!i&&n&&(i=Mi.create(e),r.batches.push(i),r.iKeyMap[e]=i),i}function H(t,n){o.canSendRequest()&&!E&&(a>0&&m>a&&(n=!0),n&&null==v&&e.flush(t,null,20))}function z(e,t){D&&(e=Mt(e));var n=e.latency,r=j(e.iKey,n,!0);return!!r.addEvent(e)&&(4!==n?(m++,t&&0===e.sendAttempt&&H(!e.sync,s>0&&r.count()>=s)):h++,!0)}function q(){for(var e=0,t=0,n=function(n){var r=x[n];r&&r.batches&&pt(r.batches,(function(r){4===n?e+=r.count():t+=r.count()}))},r=1;r<=4;r++)n(r);m=t,h=e}function K(t,n,r){var i=!1,a=0===n;return!a||o.canSendRequest()?Rn(e.core,(function(){return"PostChannel._queueBatches"}),(function(){for(var e=[],n=4;n>=t;){var r=x[n];r&&r.batches&&r.batches.length>0&&(pt(r.batches,(function(t){o.addBatch(t)?i=i||t&&t.count()>0:e=e.concat(t.events()),4===n?h-=t.count():m-=t.count()})),r.batches=[],r.iKeyMap={}),n--}e.length>0&&Q("eventsDiscarded",e,Pi.KillSwitch),i&&k>=t&&(k=-1,u=0)}),(function(){return{latency:t,sendType:n,sendReason:r}}),!a):(k=k>=0?Math.min(k,t):t,u=Math.max(u,r)),i}function W(){(b={}).REAL_TIME=[2,1,0],b.NEAR_REAL_TIME=[6,3,0],b.BEST_EFFORT=[18,9,0]}function V(t,n){var r=[],i=_;I&&(i=O),pt(t,(function(t){t&&t.count()>0&&pt(t.events(),(function(t){t&&(t.sync&&(t.latency=4,t.sync=!1),t.sendAttempt<i?(Ii(t,e.identifier),P(t,!1)):r.push(t))}))})),r.length>0&&Q("eventsDiscarded",r,Pi.NonRetryableStatus),I&&U(2,2)}function J(t,n){var r=e._notificationManager||{},i=r[t];if(i)try{i.apply(r,n)}catch(n){Nn(e.diagLog(),1,74,t+" notification failed: "+n)}}function Q(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];t&&t.length>0&&J(e,[t].concat(n))}function X(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];t&&t.length>0&&pt(t,(function(t){t&&t.count()>0&&J(e,[t.events()].concat(n))}))}function G(e,t,n){e&&e.length>0&&J("eventsSendRequest",[t>=1e3&&t<=1999?t-1e3:0,!0!==n])}function $(e,t){X("eventsSent",e,t),M()}function Z(e,t){X("eventsDiscarded",e,t>=8e3&&t<=8999?t-8e3:Pi.Unknown)}function Y(e){X("eventsDiscarded",e,Pi.NonRetryableStatus),M()}function ee(e,t){X("eventsDiscarded",e,Pi.Unknown),M()}function te(){s=n&&n.disableAutoBatchFlushLimit?0:Math.max(1500,y/6)}F(),e._getDbgPlgTargets=function(){return[o]},e.initialize=function(s,u,f){Rn(u,(function(){return"PostChannel:initialize"}),(function(){var d=u;t.initialize(s,u,f);try{u.addUnloadCb;c=Or(er(e.identifier),u.evtNamespace&&u.evtNamespace());var v=e._getTelCtx();s.extensionConfig[e.identifier]=s.extensionConfig[e.identifier]||{},n=v.getExtCfg(e.identifier),l=eo(n.setTimeoutOverride,n.clearTimeoutOverride),D=!n.disableOptimizeObj&&!!qt("chrome"),function(e){var t=e.getWParam;e.getWParam=function(){var e=0;return n.ignoreMc1Ms0CookieProcessing&&(e|=2),e|t()}}(d),n.eventsLimitInMem>0&&(y=n.eventsLimitInMem),n.immediateEventLimit>0&&(g=n.immediateEventLimit),n.autoFlushEventsLimit>0&&(a=n.autoFlushEventsLimit),lt(n.maxEventRetryAttempts)&&(_=n.maxEventRetryAttempts),lt(n.maxUnloadEventRetryAttempts)&&(O=n.maxUnloadEventRetryAttempts),te(),n.httpXHROverride&&n.httpXHROverride.sendPOST&&(i=n.httpXHROverride),yi(s.anonCookieName)&&o.addQueryStringParameter("anoncknm",s.anonCookieName),o.sendHook=n.payloadPreprocessor,o.sendListener=n.payloadListener;var p=n.overrideEndpointUrl?n.overrideEndpointUrl:s.endpointUrl;e._notificationManager=s.extensionConfig.NotificationManager,o.initialize(p,e.core,e,i,n);var h=s.disablePageUnloadEvents||[];Fr(r,h,c),function e(t,n,r){var i=Or(yr,r),o=Nr(["pagehide"],t,n,i);return n&&-1!==ht(n,"visibilitychange")||(o=Nr(["visibilitychange"],(function(e){var n=Vt();t&&n&&"hidden"===n.visibilityState&&t(e)}),n,i)||o),!o&&n&&(o=e(t,null,r)),o}(r,h,c),function e(t,n,r){var i=Or(br,r),o=Nr(["pageshow"],t,n,i);return!(o=Nr(["visibilitychange"],(function(e){var n=Vt();t&&n&&"visible"===n.visibilityState&&t(e)}),n,i)||o)&&n&&(o=e(t,null,r)),o}(A,s.disablePageShowEvents,c)}catch(t){throw e.setInitialized(!1),t}}),(function(){return{coreConfig:s,core:u,extensions:f}}))},e.processTelemetry=function(t,r){Ii(t,e.identifier);var i=(r=e._getTelCtx(r)).getExtCfg(e.identifier),o=!!n.disableTelemetry;i&&(o=o||!!i.disableTelemetry);var a=t;o||f||(n.overrideInstrumentationKey&&(a.iKey=n.overrideInstrumentationKey),i&&i.overrideInstrumentationKey&&(a.iKey=i.overrideInstrumentationKey),P(a,!0),I?U(2,2):M()),e.processNext(a,r)},e._doTeardown=function(e,t){U(2,2),f=!0,o.teardown(),Mr(["beforeunload","unload","pagehide"],null,c),function(e,t){var n=Or(yr,t);Mr(["pagehide"],e,n),Mr(["visibilitychange"],null,n)}(null,c),function(e,t){var n=Or(br,t);Mr(["pageshow"],e,n),Mr(["visibilitychange"],null,n)}(null,c),F()},e.setEventQueueLimits=function(e,t){y=e>0?e:1e4,a=t>0?t:0,te();var n=m>e;if(!n&&s>0)for(var r=1;!n&&r<=3;r++){var i=x[r];i&&i.batches&&pt(i.batches,(function(e){e&&e.count()>=s&&(n=!0)}))}H(!0,n)},e.pause=function(){R(),p=!0,o.pause()},e.resume=function(){p=!1,o.resume(),M()},e.addResponseHandler=function(e){o._responseHandlers.push(e)},e._loadTransmitProfiles=function(e){R(),W(),w="REAL_TIME",M(),nt(e,(function(e,t){var n=t.length;if(n>=2){var r=n>2?t[2]:0;if(t.splice(0,n-2),t[1]<0&&(t[0]=-1),t[1]>0&&t[0]>0){var i=t[0]/t[1];t[0]=Math.ceil(i)*t[1]}r>=0&&t[1]>=0&&r>t[1]&&(r=t[1]),t.push(r),b[e]=t}}))},e.flush=function(e,t,n){if(void 0===e&&(e=!0),!p)if(n=n||1,e)null==v?(R(),K(1,0,n),v=B((function(){v=null,function e(t,n){L(1,0,n),q(),function e(t){o.isCompletelyIdle()?t():v=B((function(){v=null,e(t)}),.25)}((function(){t&&t(),d.length>0?v=B((function(){v=null,e(d.shift(),n)}),0):(v=null,M())}))}(t,n)}),0)):d.push(t);else{var r=R();L(1,1,n),null!=t&&t(),r&&M()}},e.setMsaAuthTicket=function(e){o.addHeader("AuthMsaDeviceTicket",e)},e.hasEvents=N,e._setTransmitProfile=function(e){w!==e&&void 0!==b[e]&&(R(),w=e,M())},e._backOffTransmission=function(){E<4&&(E++,R(),M())},e._clearBackOff=function(){E&&(E=0,R(),M())},Tt(e,"_setTimeoutOverride",(function(){return l.set}),(function(e){l=eo(e,l.clear)})),Tt(e,"_clearTimeoutOverride",(function(){return l.clear}),(function(e){l=eo(l.set,e)}))})),r}return Object(_e.a)(t,e),t}(si),no=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.initialize=function(t,n){this._postChannel=new to;var r=[];n&&(r=r.concat(n)),t.channels=[[this._postChannel]],t.extensionConfig=t.extensionConfig||[],t.extensionConfig[this._postChannel.identifier]=o(o({},t.channelConfiguration),t.extensionConfig[this._postChannel.identifier]);try{e.prototype.initialize.call(this,t,r)}catch(e){this.logger.warnToConsole("Failed to initialize SDK."+e)}},t.prototype.setUploadFrequency=function(e){if(this._postChannel&&e){var t=e/1e3,n=t/2,r={};r.OTelCustomTransmissionProfile=[t,n],this._postChannel._loadTransmitProfiles(r),this._postChannel._setTransmitProfile("OTelCustomTransmissionProfile")}},t.prototype.flush=function(e){this._postChannel&&this._postChannel.flush(e)},t.prototype.shutdown=function(){this._postChannel&&this._postChannel.teardown()},t}(Oi);function ro(e,t,n){t&&t.forEach((function(t){if(!t.classification||4===t.classification||1===t.classification||n.customerContentEnabled&&32===t.classification){var r,i;switch(r=n.prependDataToken?"zC."===t.name.substr(0,3)?"zC.Data."+t.name.substr(3):"Data."+t.name:t.name,t.dataType){case 3:i=6;break;case 2:i=4;break;case 4:i=8;break;case 0:return void(e[r]="string"==typeof t.value?t.value.substr(0,25e3):t.value);case 1:default:return void(e[r]=t.value)}var o={value:t.value,propertyType:i};e[r]=o}}))}function io(e,t){try{return e()}catch(e){return oe(1,"1DS Sink",e),t}}var oo,ao=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.identifier="PartAPlugin",t.priority=450,t._properties={},t}return i(t,e),t.prototype.initialize=function(t,n,r){e.prototype.initialize.call(this,t,n,r)},t.prototype.processTelemetry=function(e,t){Object.assign?Object.assign(e.data,this._properties):e.data=Si(e.data,this._properties);var n=this._getTelCtx(t);this.processNext(e,n)},t.prototype.addDataFields=function(e){ro(this._properties,e,{prependDataToken:!1,customerContentEnabled:!1})},t}(si),so=function(){function e(e,t,n){this.start=Date.now(),this.name=e,this.isAsync=!0===n,this.payload=t}return e.prototype.isChildEvt=function(){return!1},e.prototype.complete=function(){this.time=Date.now()-this.start,this.exTime=this.time},e}(),uo=function(){function e(e){this._callbacks=e}return e.prototype.create=function(e,t,n){return"HttpManager:_sendBatches"===e||"HttpManager:_sendBatchesNotification"===e?new so(e,t,n):null},e.prototype.fire=function(e){if(e&&e.complete(),this._callbacks)switch(e.name){case"HttpManager:_sendBatches":this.handleSendBatches(e);break;case"HttpManager:_sendBatchesNotification":this.handleSendBatchesNotification(e)}},e.prototype.setCtx=function(e,t){},e.prototype.getCtx=function(e){},e.prototype.handleSendBatches=function(e){this._callbacks.requestProcessingStats&&this._callbacks.requestProcessingStats(e.time||0,0)},e.prototype.handleSendBatchesNotification=function(e){if(this._callbacks.requestProcessingStats&&e.payload){var t=e.payload();if(t.batches&&t.reason&&t.reason>=1e3&&t.reason<=1999){var n=0;for(var r in t.batches)n+=t.batches[r].evts.length;this._callbacks.requestProcessingStats(0,n)}}},e}();!function(e){e.USGOV_DOD="https://pf.events.data.microsoft.com/OneCollector/1.0/",e.USGOV_DOJ="https://tb.events.data.microsoft.com/OneCollector/1.0/",e.PUBLIC="https://browser.events.data.microsoft.com/OneCollector/1.0/",e.CUSTOMER_CONTENT="https://office-c.events.data.microsoft.com/OneCollector/1.0/",e.EUDB="https://eu-office.events.data.microsoft.com/OneCollector/1.0/"}(oo||(oo={}));var co=function(e){function t(t,n){var r,i,a=e.call(this,t,n)||this;a.usePartAPlugin=!0;var s=new ao,u=function(e){e&&e.addNotificationListener({eventsSent:function(e){ie(2,2,(function(){return"Successfully sent ".concat(e.length," event(s)")})),ie(3,2,(function(){return"Sent event(s) details : ".concat(JSON.stringify(e,null,2))})),a.eventsSent+=e.length},eventsDiscarded:function(e,t){ie(0,2,(function(){return"Discarded ".concat(e.length," event(s) because ").concat(t)})),ie(3,2,(function(){return"Discarded event(s) details : ".concat(JSON.stringify(e,null,2))})),a.eventsDiscarded+=e.length}})};function c(e,t,n,r){var i={instrumentationKey:t,endpointUrl:n,channelConfiguration:{eventsLimitInMem:e.eventsLimitInMem,httpXHROverride:e.httpXHROverride,setTimeoutOverride:e.setTimeoutOverride,clearTimeoutOverride:e.clearTimeoutOverride,ignoreMc1Ms0CookieProcessing:!0,disableOptimizeObj:!0},disableCookiesUsage:!0,extensionConfig:o({},e.extensionConfig)};e.stats&&e.stats.networkStats&&i.channelConfiguration&&(i.channelConfiguration.payloadListener=function(t,n){var r,i=n||t;i.data&&(null===(r=e.stats)||void 0===r||r.networkStats(i.data.length))});var a=new no;return a.initialize(i,r),a.setUploadFrequency(e.uploadFrequency),e.notificationListener&&a.addNotificationListener(e.notificationListener),e.stats&&a.setPerfMgr(new uo(e.stats)),a}a.sendTelemetryEvent=function(e){return io((function(){var t=a.getOneDSTelemetryEvent(e);t&&r&&r.track(t)}),void 0)},a.sendCustomerContent=function(e){return io((function(){var t=a.getOneDSCustomerContent(e);t&&i&&i.track(t)}),void 0)},a.addPersistentDataFields=function(e){s.addDataFields(e)},a.flush=function(e){r&&r.flush(e)},a.shutdown=function(){try{r&&r.shutdown()}catch(e){ie(0,2,(function(){return"An error occurred on shutdown"}))}};var l=[s];if(n.plugins&&l.push.apply(l,n.plugins),!n.endpointUrl)throw new Error("Missing Endpoint Url");return r=c(n,"f998cc5ba4d448d6a1e8e913ff18be94-dd122e0a-fcf8-4dc5-9dbb-6afac5325183-7405",n.endpointUrl,l),n.enableCustomerContent&&n.endpointUrl===oo.PUBLIC&&(i=c(n,"b22a201c3f1d41d28ccc399ba6cc9ca2-1972c77f-1f79-4283-a0f9-b4ddc4646f55-7121",oo.CUSTOMER_CONTENT,l)),n.disableStatsTracking||(u(r),u(i)),a.addPersistentDataFields(t),a}return i(t,e),t}((function(e,t){var n=this;this.eventsProcessed=0,this.eventsSent=0,this.eventsDiscarded=0,this.usePartAPlugin=!1;var r=[],i=!1,a={name:"DiagnosticLevel",processEvent:function(e){var t=e.eventFlags.diagnosticLevel;return i||10===t||110===t||120===t}},s={},u=Ei(),c=(new Date).getTime().toString(),l=function(e,t){if(1===t.eventType)return"b22a201c3f1d41d28ccc399ba6cc9ca2-1972c77f-1f79-4283-a0f9-b4ddc4646f55-7121";if(!e.telemetryProperties||!e.telemetryProperties.ariaTenantToken)throw new Error("Missing Tenant Token");return e.telemetryProperties.ariaTenantToken},f=function(e,t){var i,a=he(e);if(function(e){for(var t=function(t){var n=r[t];if(!n.processEvent(e))return ie(2,1,(function(){return"".concat(e.eventName," suppressed by ").concat(n.name)})),{value:!1}},n=0;n<r.length;n++){var i=t(n);if("object"==typeof i)return i.value}return!0}(a)){n.eventsProcessed++;var f=((i=a.timestamp)?new Date(i):new Date).toISOString(),d={"Event.Sequence":{value:n.eventsProcessed,propertyType:4},"Event.Name":a.eventName,"Event.Source":"OTelJS","Event.Time":{value:f,propertyType:9}};ro(d,a.dataFields,{prependDataToken:!0,customerContentEnabled:1===t.eventType}),d["Event.Id"]=u+"."+n.eventsProcessed;var v="custom";a.eventContract&&(a.eventContract.name&&(d["Event.Contract"]=a.eventContract.name,v+="."+a.eventContract.name.toLowerCase().replace(/\./g,"_")),ro(d,a.eventContract.dataFields,{prependDataToken:!1,customerContentEnabled:1===t.eventType}));var p={iKey:l(a,t),name:a.eventName,data:d,time:f,baseType:v,ext:{sdk:{seq:n.eventsProcessed,epoch:c}}};return n.usePartAPlugin||(p.data=o(o({},p.data),s)),p}};this.getOneDSTelemetryEvent=function(e){return f(e,{eventType:0})},this.getOneDSCustomerContent=function(e){if(t.enableCustomerContent&&e.telemetryProperties.customerContentVersion&&Math.floor(e.telemetryProperties.customerContentVersion)<=1&&1===e.telemetryProperties.customerContentType)return f(e,{eventType:1})},this.addPreprocessor=function(e){r.push(e)},this.addPersistentDataFields=function(e){ro(s,e,{prependDataToken:!1,customerContentEnabled:!1})},this.setOptionalEventsEnabled=function(e){i=e},this.setFullEventsEnabled=this.setOptionalEventsEnabled,t.enableOptionalEvents&&(i=!0),this.addPersistentDataFields(e),this.addPreprocessor(a)})),lo=function(){function e(e,t,n,r){var i,o,s,u=this;void 0===n&&(n=!1),void 0===r&&(r=new Ie),this.aggregateStream=n,this.telemetryLogger=r,this.name=function(){return"OTelSink"},this.writeEntry=function(e){(e?e.messageData:null)&&u.sendTraceMessage(e),(e?e.eventActionData:null)&&u.sendEventEntry(e)},this.flush=function(){return function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];y.apply(void 0,c(["color:black",e],t))}("OTelSink flush")},this.beginEvent=function(e,t){var n=u.getOTelActivityName(e||"EventError"),r={activityScope:u.createOTelEvent(n,t),aggregatedScope:u.aggregateStream?u.createOTelEvent("Aggregated",t):void 0};return T(0===n.indexOf(u.eventNamePrefix),"eventName prefix not expected",n),{context:r}},this.endEvent=function(e,t){var n=t&&t.context;if(t){u.endEventScope(e,n.activityScope),n.aggregatedScope&&u.endEventScope(e,n.aggregatedScope);var r=e&&e.eventActionData;r&&w("OTelSink: 0x"+r.eventTagId.toString(16)+" "+r.eventActionType)}else T(n,"activityInfo not defined",t)},this.sendOTelEvent=function(e){T(e,"telemetryEvent not defined",e),e&&u.telemetryLogger.sendTelemetryEvent(e)},this.sendOTelActivity=function(e){T(e,"activityScope not defined",e),e&&e.endNow()},this.endEventScope=function(e,t){var n=e&&e.eventActionData;if(n){e.eventFlags;G(a(e,["eventFlags"]),(function(e,n){t.dataFields.push(u.getDataField(e,n))}));var r=n.responseCode,i=n.resultType;t.success="Failure"!==i&&"Timeout"!==i,void 0===r?t.setResult(0,"HRESULT"):t.setResult(r,"ResponseCode",n.eventTagId),u.sendOTelActivity(t)}else T(n,"eventActionData not defined",e)},this.getDataField=function(e,t){switch(typeof t){case"number":return{classification:E.DataClassification.SystemMetadata,dataType:isFinite(t)&&Math.floor(t)===t?E.DataFieldType.Int64:E.DataFieldType.Double,name:e,value:t};case"boolean":return{classification:E.DataClassification.SystemMetadata,dataType:E.DataFieldType.Boolean,name:e,value:t};default:return{classification:E.DataClassification.SystemMetadata,dataType:E.DataFieldType.String,name:e,value:t.toString()}}},T(e.ariaTenantToken&&e.nexusTenantToken,"must supply tokens"),this.eventNamePrefix=(o=(i=e).eventNamePrefix,s=i.feature,"Office."+i.project+"."+s+"."+(o||"")),r.addSink(t),r.setTenantToken("Office."+e.project,e.ariaTenantToken,e.nexusTenantToken)}return e.prototype.sendTraceMessage=function(e){var t=this,n=e?e.messageData:null;if(n){var r={correlationId:e.metadata.correlationId,eventTagId:n.eventTagId,logLevel:n.logLevel,message:n.message,messageDetails:n.messageDetails,sessionId:e.metadata.sessionId},i=[];X(r,(function(e,n){return i.push(t.getDataField(e,n))})),this.sendEvent("Message",e.eventFlags,i),w("OTelSink: 0x"+n.eventTagId.toString(16)+" "+n.message+","+r)}},e.prototype.sendEventEntry=function(e){var t=this,n=e?e.eventActionData:null;if(n){var r=[],i=e.eventFlags;G(a(e,["eventFlags"]),(function(e,n){r.push(t.getDataField(e,n))}));var o=function(e){var t=null;return e?(e.eventActionData?t=e.eventActionData.eventActionType:e.messageData&&(t="Message"),t):(T(e,"Invalid logEntry"),t)}(e)||"EventError";if(this.sendEvent(o,i,r),o&&"message"!==o.toLowerCase())r.push({classification:E.DataClassification.SystemMetadata,dataType:E.DataFieldType.String,name:"SourceEvent",value:o}),this.sendEvent("Aggregated",i,r);w("OTelSink: 0x"+n.eventTagId.toString(16)+" "+n.eventActionType+","+r)}},e.prototype.sendEvent=function(e,t,n){T(e,"eventName not defined",e,n),T(n&&n.length>0,"dataFieldInfo not valid",e,n);var r={dataFields:n,eventFlags:t,eventName:this.getOTelActivityName(e)};this.sendOTelEvent(r)},e.prototype.createOTelEvent=function(e,t){return this.telemetryLogger.createActivity({eventFlags:t,eventName:e})},e.prototype.getOTelActivityName=function(e){return""+this.eventNamePrefix+e},e}();function fo(e){void 0===e&&(e=!1);var t=e,n=function(e){return e&&-1!==e.indexOf("owsclg")};t||(t=!!n("undefined"!=typeof window&&window.location.search));t||(t=!!n("undefined"!=typeof document&&document.referrer));t&&(p=!0,ee.removeSinks(x.name),ee.addSink(new x))}function vo(e,t,n){var r=t.customMetadata,i=t.customSessionId,o=t.contentStorageUrl,a=t.enableFullEvents;ee.clearSinks(),function(e,t,n){var r={BuildTimeStamp:"2023-04-20T00:22:31.313Z",CustomMetadata:e,CustomSessionId:t,Environment:I(te(n))};return _.setConfiguration(r),ee.setConfiguration(r),r}(r,i,o).Environment===S.Prod&&function(e,t,n,r){void 0===r&&(r=!0);var i=[pe("Session.Id",n),pe("App.Platform","Web"),pe("App.Name","OfficeWebSurfaces")];if(t){var o=new Ie(void 0,i);ee.addSink(new lo(e,t,!1,o))}else{var a=new co(i,{endpointUrl:oo.PUBLIC});a.setFullEventsEnabled(r),ee.addSink(new lo(e,a))}}(e,n,i,a),fo()}var po=[],ho=Date.now(),go={},mo=!1,yo="",bo=function(){return ho},wo=function(){return go},Co=function(){return mo},To=function(){return yo},Eo=function(e){return po.push(e)},So=function(){var e=wo();return e.fabricDependencies||(e.fabricDependencies=function(){if("React"in window&&"ReactDOM"in window&&"Fabric"in window){var e=window.React,t=e.createElement,n=e.useEffect,r=e.useMemo,i=e.useRef,o=e.useState,a=window.ReactDOM,s=a.render,u=a.unmountComponentAtNode,c=window.Fabric,l=c.Coachmark,f=c.Customizer,d=c.DefaultPalette,v=c.DirectionalHint,p=c.TeachingBubble,h=c.TeachingBubbleContent,g=c.ThemeGenerator,m=c.createTheme,y=c.isDark,b=c.getContrastRatio;return{Coachmark:l,Customizer:f,DefaultPalette:d,DirectionalHint:v,TeachingBubble:p,TeachingBubbleContent:h,ThemeGenerator:g,createElement:t,createTheme:m,getColorFromString:c.getColorFromString,getContrastRatio:b,isDark:y,registerIcons:c.registerIcons,render:s,styled:c.styled,themeRulesStandardCreator:c.themeRulesStandardCreator,unmountComponentAtNode:u,useEffect:n,useMemo:r,useRef:i,useState:o}}}()),e.fabricDependencies},xo=function(){return s(void 0,void 0,void 0,(function(){var e,t,r,i,o;return u(this,(function(a){switch(a.label){case 0:e=wo(),a.label=1;case 1:return a.trys.push([1,4,,5]),So()?[3,3]:(n.p=null!==(o=null!==(i=e.fabricPackagePath)&&void 0!==i?i:void 0)&&void 0!==o?o:function(){for(var e=document.getElementsByTagName("script"),t=0;t<e.length;t++){var n=/(.*\/)officewebsurfaces.core(\.min)?\.js/.exec(e[t].src);if(n)return n[1]}return""}(),n.p.endsWith("/")||(n.p+="/"),t=e,[4,n.e(1).then(n.bind(null,53))]);case 2:t.fabricDependencies=a.sent().fabricDependencies,a.label=3;case 3:return[3,5];case 4:throw r=a.sent(),ee.error(593359773,"failed to load fabric dependencies",r),r;case 5:return[2,e.fabricDependencies]}}))}))},ko=function(e){var t=e||{},n={ariaTenantToken:"cf7a002ba9374401bace61695550f784-d6d47427-ea71-43a3-ac3d-e25a6b4df199-6870",eventNamePrefix:"",feature:"Web",nexusTenantToken:1783,project:"ProgrammableSurfaces"};n&&n.ariaTenantToken&&n.nexusTenantToken||console.log("FG-OWS-OTEL config not valid",n),n&&vo(n,{customSessionId:t.logSessionId||R()},t.telemetrySink),function(e){try{var t=!1,n=e.logSettings;if(!t&&"string"==typeof n){var r=n;if("{"===r[0]){var i=JSON.parse(r);n=i.content||i}}!t&&n&&(t=!!n.consoleLog),t&&fo(!0)}catch(t){console.log("FG-OWS-OTEL invalid log options",e,t)}}(t);var r=t.telemetryGroup||{},i={hostAppId:t.appId,hostBuild:t.build,hostEnv:t.env,hostLocale:t.originalLocale,surfaceId:t.surfaceId,hostAudience:r.audienceGroup,hostPlatform:r.platform};ee.updateCustomData(i),ee.event(593602525,"Init",{customData:o(o({buildTime:"2023-04-20T00:22:31.313Z",hostFlights:r.flights,loadDelay:W(),loadTime:t.surfaceInitTime?Date.now()-t.surfaceInitTime:void 0},J()),V())})},Do=function(e,t,n,r,i,o,a){return void 0===a&&(a=-1),ee.userActionEvent(e,t,{customData:{button:n,elapsedTime:Date.now()-i,itemCount:a,renderIndex:r,surfaceId:o}})},Io=function(e,t,n){return void 0===t&&(t=!1),s(void 0,void 0,void 0,(function(){return u(this,(function(n){switch(n.label){case 0:return go=e||{},mo=t,ko(e),e.preloadFabricPackage?[4,xo()]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}}))}))},_o=function(e){var t=e.attributes,n=void 0===t?{}:t,r=e.classNames,i=void 0===r?[]:r,o=e.id,a=void 0===o?"":o,s=e.parentElement,u=void 0===s?document.body||document:s,c=document.createElement("div");return Object.keys(n).forEach((function(e){return c.setAttribute(e,n[e])})),i.forEach((function(e){return c.classList.add(e)})),a&&(c.id=a),u.appendChild(c),c},Oo=function(e,t){return document.getElementById(e)||_o({id:e,parentElement:t})},Ao=function(e){if(e)for(var t=0,n=e;t<n.length;t++){var r=n[t];try{var i=document.querySelector(r);if(i)return{selector:r,targetElement:i}}catch(e){ee.local("query selector error",e)}}},Po=function(e){return Ao(e)||{selector:null==e?void 0:e[0]}},Lo=function(e){e.parentElement?e.parentElement.removeChild(e):e.remove&&e.remove()},No=function(e,t,n){var r=function(){n(),e.removeEventListener(t,r)};return e.addEventListener(t,r),function(){return e.removeEventListener(t,r)}},Mo=function(e,t){return No(e,"click",t)},Fo=0,Bo=Date.now(),Ro=function(){return"MS-OWS-id-"+Bo+"-"+ ++Fo},Uo=function(e,t){window&&window.removeEventListener(e,t)};function jo(e){return null!=e}var Ho,zo=function(e){return s(void 0,void 0,Promise,(function(){return u(this,(function(t){return[2,new Promise((function(t,n){if(document.querySelector('script[src="'+e+'"]'))t(e);else{var r=document.createElement("script");r.src=e,r.onload=function(){return t(e)},r.onerror=function(e,t,i,o,a){r.remove();var s=a&&a.stack;ee.error(594366469,"error loading script "+t+", "+i+", "+o+", "+s),n(null)},document.head.appendChild(r)}}))]}))}))},qo=function(e){return"sequence"===e.surfaceType},Ko=function(){return To()+"-App"},Wo=function(){Do(ee.reserve(593504402),"SurfaceUnload","unload",0,bo(),wo().surfaceId),Uo("beforeunload",Wo)},Vo=function(e){void 0===e&&(e=!1),e&&Uo("beforeunload",Wo),po.forEach((function(e){return e()})),po=[],function(){var e,t=document.getElementById(Ko());t&&(null===(e=So())||void 0===e||e.unmountComponentAtNode(t));var n=t&&t.parentElement;n&&n.getAttribute("data-ows")&&Lo(n)}()},Jo=["anchorHint","closeButtonAction","closeButtonActionParams","closeButtonAriaLabel","backgroundColor","disableHostTheme","imageFetchCorsMode","isControl","position","preventAutoDismiss","smallHeadline"],Qo=function(e,t){return{alias:t,defaultValue:e}},Xo=Qo(0),Go=Qo(!1),$o=Qo({}),Zo=Qo(""),Yo={backgroundColor:Zo,beaconColor:Zo,buttonHoverColor:Zo,primaryButtonHoverColor:Zo,primaryColor:Zo,secondaryColor:Zo,textColor:Zo,creativeId:Zo,payloadId:Zo,surfaceName:Zo,actionBeaconUrl:Zo,actionUrl:Zo,impressionBeaconUrl:Zo,isAA:Go,isControl:Go,isControl1:Go,telemetryEventName:Zo,treatmentType:Xo,delayLoad:Xo,eventDispatchDelay:Xo,fullRenderCheck:Go,preFetchDelay:Xo,renderCheckDelay:Xo,timeout:Xo,version:Zo,alternativeTriggerSelectors:Qo([]),anchorElementSelectors:Qo([]),anchorValidation:Zo,customTheme:Qo({}),disableHostTheme:Go,closeButtonAction:Zo,closeButtonActionParams:Qo({}),primaryButtonAction:Zo,primaryButtonActionParams:Qo({}),secondaryButtonAction:Zo,secondaryButtonActionParams:Qo({}),surfaceType:Qo("teaching"),targetAction:Zo,targetHidingClickSelectors:Qo([]),targetHidingElementSelectors:Qo([]),useNativeRender:Go,customProperties:Qo({}),alertAriaText:Zo,anchorHint:Qo("bottomCenter"),closeButtonAriaLabel:Zo,description:Zo,footer:Zo,hasCloseButton:Go,illustrationImage:Zo,imageAriaLabel:Zo,imageFetchCorsMode:Qo("no-cors"),position:Qo("top"),preventAutoDismiss:Go,primaryButton:Zo,primaryButtonAriaDescription:Zo,primaryButtonText:Qo("","primaryButton"),secondaryButton:Zo,secondaryButtonAriaDescription:Zo,secondaryButtonText:Qo("","secondaryButton"),smallHeadline:Go,title:Zo,itemCount:Xo,customStyles:$o,hasCoachMark:Go,localizedStyles:Qo({})},ea=function(e,t){void 0===t&&(t=!0);var n=function(e,t){return function(n){var r=t[n.trim().toLowerCase()];if(r){var i=e[n],o="string"==typeof i&&i.trim();if(o?e[r]=o:r!==n&&(e[r]=i),o)try{var a=Yo[r];switch(a&&typeof a.defaultValue){case"boolean":var s=o.toLowerCase();e[r]="t"===s[0]||"y"===s[0];break;case"number":e[r]=parseInt(o,10);break;default:"["!==o[0]&&"{"!==o[0]||(e[r]=JSON.parse(o))}}catch(e){ee.error(593504394,"error parsing surface param",n,i,e)}}}}(e,(Ho||(Ho={},Object.keys(Yo).forEach((function(e){Ho[e.toLowerCase()]=e}))),Ho));Object.keys(e).forEach(n),t&&!e.surfaceType&&(e.surfaceType=e.hasCoachMark?"coachmark":"teaching");var r=function(t){t&&(ea(t,!1),Object.keys(t).forEach((function(n){e[n]=t[n]})))};r(e.customStyles),r(e.customProperties),Object.keys(Yo).forEach((function(t){var n=t,r=Yo[n],i=r&&r.alias;i&&void 0===e[n]&&void 0!==e[i]&&(e[n]=e[i])}))},ta=function(e,t){for(var n=e.toString(),r={},i=0,o=Object.keys(t);i<o.length;i++){var a=o[i];if(a.endsWith(n)){var s=a.substring(0,a.length-1);r[s]=t[a]}}return ea(r),r.surfaceType=r.surfaceType||"teaching",Jo.forEach((function(e){void 0===r[e]&&void 0!==t[e]&&(r[e]=t[e])})),t.itemCount>1&&"teaching"===r.surfaceType&&void 0===r.footer&&(r.footer=e+" of "+t.itemCount),r},na=function(e,t,n){try{if(e&&t){var r=wo(),i=!1;try{r&&r.beaconCallback&&(r.beaconCallback({actionName:e,actionUrl:t}),i=!0)}catch(e){ee.warn(592315552,"pageContext.beaconCallback call failed. Sending POST request to SetCampaignAction endpoint with actionName and actionUrl",e)}if(!i)!function(e,t,n){t?window&&window.fetch?window.fetch(t,n).then((function(e){e.ok||ee.error(595656793,"fetching url was not successful with status "+e.status)})).catch((function(t){return ee.error(595687457,"error fetching url "+e,t&&t.message)})):ee.error(595687456,"fetch not available"):ee.error(595687455,"invalid url")}("Beacon-"+e,n.actionUrl||"https://messaging.action.office.com/setcampaignaction",{body:JSON.stringify({actionName:encodeURIComponent(e),actionUrl:encodeURIComponent(t)}),headers:{"Content-Type":"application/json;charset=utf-8"},method:"POST"})}else ee.warn(593504403,"actionName or actionUrl were undefined for beacon callback",e,t)}catch(e){ee.error(593504404,"failed to perform beacon callback",e)}},ra=function(e,t){return na(e,t.actionBeaconUrl,t)},ia=function(e,t){var n=function(e){switch(e){case"isAA":return"AASHOWED";case"isControl":return"CONTROLSHOWED";case"auto dismiss":case"close":return"dismiss";case"primary":return"click1";case"secondary":return"click2";case"error":default:return}}(e);if(n)return na(n,t.actionBeaconUrl,t)},oa=!1,aa=function(e){var t,n;oa||(n={disableWarnings:!0},void 0===(t=void 0)&&(t="https://static2.sharepointonline.com/files/fabric/assets/icons/"),(0,e.registerIcons)({fontFace:{fontFamily:'"FabricMDL2Icons"',src:"url('"+t+"fabric-icons-a13498cf.woff') format('woff')"},icons:{Cancel:""},style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"}},n),oa=!0)},sa=function(e,t){e&&!e.startsWith("data:image")&&(window.fetch?window.fetch(e,{mode:t||"no-cors"}).catch((function(t){return ee.error(593504400,"failed to pre fetch image",e,t&&t.message)})):(new Image).src=e)},ua=function(e){!function(e){if(qo(e))for(var t=0,n=Object.keys(e);t<n.length;t++){var r=n[t];r.startsWith("illustrationImage")&&sa(e[r],e.imageFetchCorsMode)}else e.illustrationImage&&sa(e.illustrationImage,e.imageFetchCorsMode)}(e);var t=So();t&&aa(t)},ca=function(e){if(e&&(e.globalMethod||e.globalType)){var t=window,n=e.globalMethod?e.globalMethod.trim().split("."):[];if(n.length>0){"window"===n[0].toLowerCase()&&n.shift();var r=n.reduce((function(e,t){return e&&e[t]}),t);if(r&&r!==t){var i=e.delayLoad||10;return void U(i).then((function(){var t;r.apply(null,null!==(t=e.methodParams)&&void 0!==t?t:e)})).catch((function(e){ee.error(561850442,"failed to execute global method "+n,e)}))}}var o=t[e.globalType||""];if(o){var a=new o(e),s=a[e.invocationMethod||""];if(s){i=e.delayLoad||10;U(i).then((function(){var t;s.call(a,null!==(t=e.methodParams)&&void 0!==t?t:e)})).catch((function(e){ee.error(574142366,"failed to execute script method",e)}))}}}},la=function(e,t){if(!e)return"none";if("function"==typeof e)return e(),"callback";var n,r=e.toLowerCase();if("script"!==r&&0!==r.indexOf("/")&&-1===r.indexOf(":")&&(r="https://"+r),0===r.indexOf("http"))return window.open(r)||ee.error(574142367,"window.open reference is null for url button click action",r),"url";if(0===r.indexOf("event")){var i=null==t?void 0:t.eventName;if(i||(i=e.trim().split(":")[1]),!i)return ee.error(574142368,"Invalid event name",e),"error";var o={detail:t};return document.dispatchEvent(new CustomEvent(i,o)),"event"}return t?0===r.indexOf("script")?(t.script?(n=t.script,s(void 0,void 0,Promise,(function(){return u(this,(function(e){return[2,Array.isArray(n)?Promise.all(n.map(zo)):zo(n)]}))}))).then((function(){ca(t)})).catch((function(e){ee.error(574142369,"Script error "+t.script+" "+e)})):ca(t),"script"):"unhandled":"none"},fa=function(e,t,n,r,i,o,a){var s="error";try{s=la(i,o)}catch(e){ee.error(574142370,"error invoking input action")}ee.userActionEvent(e,"SurfaceButtonClicked",{customData:{action:s,button:t,eventType:a||"",selector:n,surfaceType:r}})},da=function(e,t){return e?e.startsWith(".")?function(e){var t=e.split(" ").filter((function(e){return e.startsWith(".")})).reduce((function(e,t){var n=e[0],r=e[1],i=_o({classNames:t.split(".").filter((function(e){return e})),parentElement:r});return[n||i,i]}),[]),n=t[0],r=t[1],i=getComputedStyle(r).color;return Lo(n),i}(e)||t:e:t},va=n(16),pa=window&&window.navigator&&(-1!==window.navigator.userAgent.indexOf("MSIE")||-1!==window.navigator.appVersion.indexOf("Trident/")),ha=pa?"15px":"10px",ga=function(e,t){var n,r,i,o;return{ariaDescribedBy:Ro()+"-TD",ariaLabelledBy:Ro()+"-TL",calloutProps:{directionalHint:t.anchorHint&&e.DirectionalHint[t.anchorHint],id:"obf-DynamicWebSurfaces",preventDismissOnLostFocus:null!==(n=t.preventAutoDismiss)&&void 0!==n?n:!t.focused,setInitialFocus:t.focused},closeButtonAriaLabel:null!==(r=t.closeButtonAriaLabel)&&void 0!==r?r:"Close",focusTrapZoneProps:{disableFirstFocus:!t.focused,forceFocusInsideTrap:!1},footerContent:t.footer,hasCloseIcon:null===(i=t.hasCloseButton)||void 0===i||i,hasSmallHeadline:null!==(o=t.smallHeadline)&&void 0!==o&&o,headline:t.title,illustrationImage:{"aria-label":t.imageAriaLabel,onLoadingStateChange:t.onImageLoaded,src:t.illustrationImage,styles:pa?ya():void 0},isWide:ma(t),onDismiss:t.onCalloutDismiss,primaryButtonProps:{ariaDescription:t.primaryButtonAriaDescription,ariaLabel:t.primaryButtonText,onClick:t.onPrimaryButtonClick,text:t.primaryButtonText},secondaryButtonProps:t.secondaryButtonText?{ariaDescription:t.secondaryButtonAriaDescription,ariaLabel:t.secondaryButtonText,onClick:t.onSecondaryButtonClick,text:t.secondaryButtonText}:void 0,styles:{content:{marginLeft:ma(t)?ha:void 0}},target:t.targetElement}},ma=function(e){return e&&"left"===e.position},ya=function(){return{image:{objectFit:"contain",height:"100%",width:"100%"}}},ba=function(e){return e.styled(function(e){return function(t){var n,r=e.createElement,i=e.Coachmark,a=e.DirectionalHint,s=e.TeachingBubbleContent,u=e.useEffect,c=(0,e.useRef)();u((function(){setTimeout((function(){var e,t;try{var n=null===(t=null===(e=c.current)||void 0===e?void 0:e._entityHost)||void 0===t?void 0:t.current;n&&!n.id&&(n.id="obf-DynamicWebSurfaces")}catch(e){ee.error(594882953,"error setting coachmark id",e)}}),1e3)}),[]);var l=t.anchorHint||"bottomCenter";return r(i,{ariaAlertText:t.alertAriaText||t.title,ariaDescribedByText:t.description,ariaLabelledByText:t.title,color:t.theme&&t.theme.palette.themePrimary,componentRef:c,isCollapsed:!t.focused,isPositionForced:!1,onAnimationOpenEnd:t.onFocused,onDismiss:t.onCalloutDismiss,persistentBeak:!0,positioningContainerProps:{directionalHint:a[l]},preventDismissOnLostFocus:null!==(n=t.preventAutoDismiss)&&void 0!==n?n:!t.focused,preventFocusOnMount:!t.focused,target:t.targetElement},r(s,o({},ga(e,t),{styles:t.styles}),t.description))}}(e),{},void 0,{scope:"TeachingBubble"})},wa=["description","primaryButtonText","selector","surfaceType","targetElement"],Ca=function(e,t,n,r,i,o,a){return function(){fa(e,t,n.selector,n.surfaceType,i,o,a),r(!0),n.onClosed&&n.onClosed(t)}},Ta=function(e,t){return function(n){var r,i;if(-1!==(null===(i=null===(r=null==n?void 0:n.currentTarget)||void 0===r?void 0:r.className)||void 0===i?void 0:i.indexOf("ms-TeachingBubble-closebutton")))Ca(ee.reserve(595858951),"close",e,t,e.closeButtonAction,e.closeButtonActionParams,n.type)();else{if(e.preventAutoDismiss)return void(n&&"click"===n.type&&ee.userActionEvent(593504390,"SurfaceDismissPrevented",{customData:{autoDismiss:!0,eventType:"click",surfaceType:e.surfaceType}}));Ca(ee.reserve(595858950),"auto dismiss",e,t,e.closeButtonAction,e.closeButtonActionParams,n&&n.type)()}}},Ea=function(e,t){return function(){ee.userActionEvent(593504391,"SurfaceFocused",{customData:{elapsedTime:Date.now()-e}}),null==t||t()}},Sa=function(e){return function(t){return ee.userActionEvent(593504392,"ImageLoaded",{customData:{elapsedTime:Date.now()-e,imageLoadedState:t}})}},xa=function(e,t){return Ca(ee.reserve(595858952),"primary",e,t,e.primaryButtonAction,e.primaryButtonActionParams)},ka=function(e,t){return Ca(ee.reserve(595858953),"secondary",e,t,e.secondaryButtonAction,e.secondaryButtonActionParams)},Da=function(e){return function(t){var n=e.createElement,r=e.Customizer,i=e.useEffect,a=e.useMemo,s=e.useState,u=s(!1),l=u[0],f=u[1],d=s(!1),v=d[0],p=d[1],h=a((function(){return ba(e)}),[]),g=a((function(){return function(e){return function(t){var n=e.createElement,r=e.TeachingBubble,i=e.useEffect,a=(0,e.useRef)();return i((function(){var e=function(e){var n,r,i;Object(va.a)(null!==(i=null===(r=null===(n=a.current)||void 0===n?void 0:n.rootElement)||void 0===r?void 0:r.current)&&void 0!==i?i:null,e.target)&&t.onFocused()};return document.addEventListener("click",e),document.addEventListener("focus",e),function(){document.removeEventListener("click",e),document.removeEventListener("focus",e)}}),[]),n("div",null,n("div",{role:"alert",style:{height:0,opacity:0,pointerEvents:"none",position:"fixed",width:0}},t.alertAriaText||t.title),n(r,o({},ga(e,t),{componentRef:a}),t.description))}}(e)}),[]);if(i((function(){var e=function(e){e&&9!==e.keyCode&&"Tab"!==e.key&&117!==e.keyCode&&"F6"!==e.key||p(!0)};return document.addEventListener("keyup",e),function(){return document.removeEventListener("keyup",e)}}),[]),l||!function(e){var t=wa.filter((function(t){return!jo(e[t])}));return!t.length||(ee.error.apply(ee,c([593504388,"Invalid props passed to OfficeWebServiceContainer"],t)),!1)}(t))return null;var m=Date.now(),y=o(o({},t),{focused:v,onCalloutDismiss:Ta(t,f),onFocused:Ea(m,(function(){var e;p(!0),null===(e=t.onUpdated)||void 0===e||e.call(t)})),onImageLoaded:Sa(m),onPrimaryButtonClick:xa(t,f),onSecondaryButtonClick:ka(t,f)}),b=function(){switch(t.surfaceType){case"coachmark":return n(h,o({},y));case"teaching":return n(g,o({},y));default:return ee.error(593504393,"attempted to render unknown surface",t.surfaceType),null}}();if(!b)return null;var w=function(e,t,n){var r,i=t||{},a=i.scopedSettings,s=void 0===a?{}:a,u=i.settings,c=void 0===u?{}:u,l=function(e,t,n){var r=e.getColorFromString,i=e.getContrastRatio,o=e.DefaultPalette,a=e.ThemeGenerator,s=(0,e.themeRulesStandardCreator)();a.setSlot(s.primaryColor,t,!1,!0),a.setSlot(s.themeTertiary,n,!1,!0);var u=i(r(o.white),s.themePrimary.color)>i(r(o.black),s.themePrimary.color);return a.setSlot(s.white,u?o.white:o.black,!1,!0),a.getThemeAsJson(s)}(e,n.primaryColor||!n.disableHostTheme&&n.primaryColour||n.backgroundColor||e.DefaultPalette.neutralLighter,n.secondaryColor||!n.disableHostTheme&&n.secondaryColour||e.DefaultPalette.neutralSecondary),f=null!==(r=c.theme)&&void 0!==r?r:e.createTheme({palette:l}),d=f.palette;return o(o({},t),{scopedSettings:s,settings:o(o({},c),{theme:o(o({},f),{palette:o(o({},d),{themeDark:da(n.buttonHoverColor,d.themeDark),themeDarkAlt:da(n.buttonHoverColor,d.themeDarkAlt),themeLighter:da(n.primaryButtonHoverColor,d.themeLighter),themePrimary:da(n.backgroundColor,d.themePrimary),themeTertiary:da(n.beaconColor,d.themeTertiary),white:da(n.textColor,d.white)})})})})}(e,t.customTheme,t);return w?n(r,o({},w),b):b}},Ia=function(e){var t=e.isAlternateTrigger,n=void 0!==t&&t,r=e.surfaceParams,i=e.targetElementInfo,o=i.selector,a=i.targetElement,s=e.onClick,u=Date.now();return Mo(a,(function(){ee.userActionEvent(590432290,"TargetElementClicked",{customData:{isAlternateTrigger:n,selector:o,timeToClick:Date.now()-u}}),ra("conversion",r);var e=r&&r.targetAction;e&&"function"==typeof e&&e(),s()}))},_a=function(e,t,n,r,i){var a=t.selector,c=t.targetElement;return s(void 0,void 0,void 0,(function(){var t,s,l,f,d,v,p,h,g;return u(this,(function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),(t=document.getElementById(To()))||(t=_o({attributes:(g={},g["data-ows"]="true",g.style="all: initial",g),id:To()})),s=Oo(Ko(),t),[4,xo()];case 1:return l=u.sent(),f=l.createElement,d=l.render,v=l.setDefaultTarget,aa(l),v&&(p=Oo(To()+"-Layer",t),v("#"+p.id)),d(f(Da(l),o(o(o({},wo()),e),{onClosed:i,onUpdated:r,selector:a,targetElement:c})),s,n),[3,3];case 2:if(h=u.sent(),ee.error(593504384,"error thrown in renderInternal",a,h),i&&i("error"),Co())throw h;return[3,3];case 3:return[2]}}))}))},Oa=function(e,t,n){var r,i,o=Ao(e.anchorElementSelectors);if(o){var a=o.selector,s=o.targetElement,u=s&&s.getBoundingClientRect()||{},c=u.bottom,l=u.left,f=u.right,d=u.top;ee.event(593504385,"SurfaceSelectorMatched",{customData:{anchorHint:e.anchorHint,selector:a,bottom:c,left:l,right:f,top:d}})}else ee.error(593504386,"Couldn't find element",e.anchorElementSelectors);return e.isAA?(r="SurfaceAATriggered",i="isAA"):(0===e.treatmentType||e.isControl)&&(r="SurfaceControlTriggered",i="isControl"),void 0!==r&&void 0!==i?(e.anchorElementSelectors&&!o||t&&t(r),void(n&&n(i))):o||void(n&&n("error"))},Aa=function(e,t){return null==e?void 0:e.map((function(e){return Ao([e])})).filter(jo).forEach((function(e){return Eo(t(e))}))},Pa=function(e,t,n,r,i,o){return void 0===t&&(t=!0),function(){return s(void 0,void 0,void 0,(function(){var a,s,c;return u(this,(function(u){switch(u.label){case 0:return(a=Oa(e,r,o))?(null===(c=e.targetHidingElementSelectors)||void 0===c?void 0:c.map((function(e){return Ao([e])})).filter(jo).some((function(e){return t=a.targetElement,n=e.targetElement,r=t.getBoundingClientRect(),!((i=n.getBoundingClientRect()).right<r.left||i.left>r.right||i.top>r.bottom||i.bottom<r.top);var t,n,r,i})))?(ee.warn(590432320,"Target covered",{selector:a.selector}),ra("dismiss",e),[2]):(Eo(Ia({onClick:s=function(){t&&Vo()},surfaceParams:e,targetElementInfo:a})),Aa(e.alternativeTriggerSelectors,(function(t){return Ia({isAlternateTrigger:!0,onClick:s,surfaceParams:e,targetElementInfo:t})})),Aa(e.targetHidingClickSelectors,(function(t){return function(e){var t=e.surfaceParams,n=e.targetElementInfo,r=n.selector,i=n.targetElement,o=e.onClick,a=Date.now();return Mo(i,(function(){ee.userActionEvent(590432291,"HidingElementClicked",{customData:{selector:r,timeToClick:Date.now()-a}}),ra("dismiss",t),o()}))}({onClick:s,surfaceParams:e,targetElementInfo:t})})),Eo(function(e,t,n){if(void 0===n&&(n=!0),n){var r=new IntersectionObserver((function(e){e.some((function(e){return!e.isIntersecting}))&&(t(),r.disconnect())}));return r.observe(e),function(){return r.disconnect()}}var i=new MutationObserver((function(n){n.forEach((function(n){("childList"===n.type&&Array.prototype.slice.call(n.removedNodes).filter((function(t){return t===e})).length||"attributes"===n.type&&n.target===e&&("none"===e.style.display||"hidden"===e.style.visibility))&&(t(),i.disconnect())}))}));return e.parentElement?i.observe(e.parentElement,{attributeFilter:["style"],childList:!0,subtree:!0}):i.observe(e,{attributeFilter:["style"]}),function(){return i.disconnect()}}(a.targetElement,(function(){ee.warn(590432321,"Target removed",{selector:a.selector}),ra("dismiss",e),Vo()}))),Eo(No(window,"resize",(function(){ee.warn(590432322,"Page resized",{selector:a.selector}),ra("dismiss",e),Vo()}))),e.useNativeRender||!n?[3,2]:[4,Fa(o,i,n,r,e,a,bo(),wo().surfaceId)]):[2];case 1:return u.sent(),[3,4];case 2:return[4,_a(e,a,r,i,o)];case 3:u.sent(),u.label=4;case 4:return[2]}}))}))}},La=function(e,t,n,r,i,o,a){return void 0===n&&(n=!0),s(void 0,void 0,void 0,(function(){var s;return u(this,(function(u){switch(u.label){case 0:return yo=t,s=Pa(e,n,r,i,o,a),void 0!==e.delayLoad&&e.delayLoad>0?(U(e.delayLoad).then(s).catch((function(e){ee.error(593504387,"failed to render delay loaded surface",e),a&&a("error")})),[3,3]):[3,1];case 1:return[4,s()];case 2:u.sent(),u.label=3;case 3:return[2]}}))}))},Na=function(e,t,n,r,i,o,a,c){return s(void 0,void 0,void 0,(function(){return u(this,(function(l){switch(l.label){case 0:return n>e.itemCount?(ee.assert(n<=e.itemCount,"inconsistent state"),[2]):[4,La(ta(n,e),r,!1,t,i,a,(function(i){return s(void 0,void 0,void 0,(function(){return u(this,(function(s){switch(s.label){case 0:return Vo(!0),"error"===i&&n<=1?(c&&c(i),[2]):(Do(ee.reserve(593504395),"SurfaceDismissed",i,n,bo(),wo().surfaceId,e.itemCount),ia(i,e),n<e.itemCount&&("primary"===i||"error"===i)?[4,Na(e,t,n+1,r,void 0,o,a,c)]:[3,2]);case 1:return s.sent(),o&&o(i,n),[3,3];case 2:c&&c(i),s.label=3;case 3:return[2]}}))}))}))];case 1:return l.sent(),[2]}}))}))},Ma=function(e,t,n,r,i,a,c,l){return s(void 0,void 0,void 0,(function(){var f,d,v;return u(this,(function(p){switch(p.label){case 0:if(d=function(e,t,n,r,i,a){for(var s=function(t,r,i){void 0===r&&(r=!1);var o=r?void 0:t+1,a=n();try{a&&t>=0&&t<a.length&&a.slice(t,o).reverse().forEach((function(e){e&&e()})),r&&i&&fa(ee.reserve(561850440),"close",void 0,i.surfaceType,i.closeButtonAction,i.closeButtonActionParams)}catch(n){ee.error(593602519,"failed to dismiss surface "+(t+1)+" of "+e.itemCount+(r?"plus all remaining surfaces":void 0),n)}},u=[],c=function(n){var c=ta(n,e),l=Po(c.anchorElementSelectors),f=n-1,d=function(n){if("error"===n&&f<1)t&&t(n);else{switch(Do(ee.reserve(593602520),"SurfaceDismissed",n,f+1,i,a,e.itemCount),ia(n,e),n){case"primary":fa(ee.reserve(521421474),"primary",null==l?void 0:l.selector,c.surfaceType,c.primaryButtonAction,c.primaryButtonActionParams);break;case"secondary":fa(ee.reserve(521421475),"secondary",null==l?void 0:l.selector,c.surfaceType,c.secondaryButtonAction,c.secondaryButtonActionParams);break;case"close":fa(ee.reserve(521421504),"close",null==l?void 0:l.selector,c.surfaceType,c.closeButtonAction,c.closeButtonActionParams)}f<e.itemCount-1&&("primary"===n||"error"===n)?s(f,!1,u[f]):(t&&t(n),s(f,!0,u[f]))}};u.push(o(o(o({},c),l),{onClosed:function(){return d("close")},onUnsupportedSurfaceType:r(c,d),primaryButtonAction:c.primaryButtonText&&function(){return d("primary")},secondaryButtonAction:c.secondaryButtonText&&function(){return d("secondary")}}))},l=1;l<=e.itemCount;l++)c(l);return u}(l,t,(function(){return f}),(function(e,t){return function(){return s(void 0,void 0,void 0,(function(){var r;return u(this,(function(i){switch(i.label){case 0:return(r=Oa(e,c,t))?[4,_a(e,r,c,n,t)]:[2];case 1:return i.sent(),[2]}}))}))}}),e,a),!Oa(d[0],c,t))return[2];p.label=1;case 1:return p.trys.push([1,3,,5]),[4,r(d)];case 2:return f=p.sent(),ee.info(593602521,"host render succeeded (multi-surface)"),null==c||c(),[3,5];case 3:return v=p.sent(),ee.error(593602522,"error with host rendering (multi-surface), falling back to internal renderer",v),[4,Na(l,r,1,i,c,n,n,t)];case 4:return p.sent(),[3,5];case 5:return[2]}}))}))},Fa=function(e,t,n,r,i,a,c,l){return s(void 0,void 0,void 0,(function(){var s,f,d;return u(this,(function(u){switch(u.label){case 0:f=function(t){var n;null==e||e(t),null===(n=null==s?void 0:s[0])||void 0===n||n.call(s)},u.label=1;case 1:return u.trys.push([1,3,,5]),[4,n([o(o(o({},i),a),{onClosed:function(e){f(e)},onFullRenderCompleted:function(e){e||Do(ee.reserve(526401607),"SurfaceFullRenderCompleted","full render complete",0,c,l)},onUnsupportedSurfaceType:function(){return _a(i,a,r,t,f)},primaryButtonAction:i.primaryButtonText&&function(){fa(ee.reserve(574144658),"primary",null==a?void 0:a.selector,i.surfaceType,i.primaryButtonAction,i.primaryButtonActionParams),f("primary")},secondaryButtonAction:i.secondaryButtonText&&function(){fa(ee.reserve(574144659),"secondary",null==a?void 0:a.selector,i.surfaceType,i.secondaryButtonAction,i.secondaryButtonActionParams),f("secondary")}})])];case 2:return s=u.sent(),ee.info(593602523,"host render succeeded"),null==r||r(),[3,5];case 3:return d=u.sent(),ee.error(593602524,"error with host rendering, falling back to internal renderer",d),[4,_a(i,a,r,t,e)];case 4:return u.sent(),[3,5];case 5:return[2]}}))}))},Ba=function(e,t,n,r){return function(i,a,s){var u;void 0===i&&(i="SurfaceLaunched"),void 0===a&&(a=!0),u=Date.now(),ho=u,ee.event(593504396,i,{customData:o(o(o({creativeId:r.creativeId,payloadId:r.payloadId,surfaceId:n,surfaceName:r.surfaceName,elapsedTime:bo()-t,error:s||"",result:a,surfaceType:r.surfaceType},J()),V()),{isAA:r.isAA,isControl:r.isControl,telemetryEventName:r.telemetryEventName,treatmentType:r.treatmentType})}),Ra("Opened",e,n,r),s||function(e){na("impression",e.impressionBeaconUrl,e)}(r)}},Ra=function(e,t,n,r,i){void 0===i&&(i=!0);var o={detail:{action:e,creativeId:r.creativeId,id:n,isAA:r.isAA,isControl:r.isControl,isHidden:Ua(r),payloadId:r.payloadId,success:i,surfaceType:r.surfaceType,telemetryEventName:r.telemetryEventName,treatmentType:r.treatmentType,renderTargetId:t}};try{document.dispatchEvent(new CustomEvent("FGWebSurfaceEvent",o))}catch(e){ee.error(593602575,"failed to dispatch event",e)}},Ua=function(e){return e.isAA||e.isControl||e.isControl1||0===e.treatmentType},ja=function(e,t,n,r){return s(void 0,void 0,void 0,(function(){var i,o,a,s,c,l,f,d;return u(this,(function(u){switch(u.label){case 0:if(ee.updateCustomData({impressionId:null!=r?r:R()}),i=t||"obf-WebSurfacesContainer",!e)return ee.error(593504397,"surface params are not provided"),[2];ea(e),o=Ba(i,Date.now(),n,e),u.label=1;case 1:return u.trys.push([1,9,,10]),Ua(e)||(v="beforeunload",p=Wo,window&&window.addEventListener(v,p),a=e.preFetchDelay||10,U(a).then((function(){ua(e)})).catch((function(e){return ee.error(593504398,"failed to pre-load resources",e)}))),s=function(t){Do(ee.reserve(593504399),"SurfaceCompleted",t,0,bo(),n),Uo("beforeunload",Wo),ia(t,e),Ra("Dismissed",i,n,e),!e.useNativeRender&&l&&fa(ee.reserve(561850441),"close",void 0,e.surfaceType,e.closeButtonAction,e.closeButtonActionParams)},c=function(){return Ra("Updated",i,n,e)},l=wo().renderCallback,qo(e)?e.useNativeRender||!l?[3,3]:[4,Ma(bo(),s,c,l,i,n,o,e)]:[3,6];case 2:return u.sent(),[3,5];case 3:return[4,Na(e,l,1,i,o,c,c,s)];case 4:u.sent(),u.label=5;case 5:return[3,8];case 6:return[4,La(e,i,!0,l,o,c,s)];case 7:u.sent(),u.label=8;case 8:return function(e){if(!Ua(e)){var t=document.documentElement||document.body,n=["div[class^='entityHost']","div[class^='pulsingBeacon']","div[class~='ms-PositioningContainer-layerHost]","div[class^='calloutMain']","div[aria-roledescription='Teaching notification']","div[class~='ms-TeachingBubble-content']"],r=!1,i=e.fullRenderCheck||!1,o=e.renderCheckDelay||(i?5e3:2e3),a=new MutationObserver((function(e){for(var t=function(e){if(n.some((function(t){return 1===e.target.querySelectorAll(t).length})))return r=!0,a.disconnect(),{value:void 0}},i=0,o=e;i<o.length;i++){var s=t(o[i]);if("object"==typeof s)return s.value}}));i&&a.observe(t,{attributes:!0,childList:!0,subtree:!0}),U(o).then((function(){i||(r=n.some((function(e){return 1===document.querySelectorAll(e).length}))),r||(i&&a.disconnect(),ee.error(527974729,"failed to render surface "+e.surfaceType,e.creativeId))})).catch((function(e){return ee.error(527974730,"failed to log surface rendering",e)}))}}(e),function(e){if(e&&!Ua(e))try{var t=Po(e.anchorElementSelectors),n=t.selector,r=t.targetElement;if(!r)return;var i=r.getBoundingClientRect();if(i.height<1||i.width<1)ee.error(526401692,"target element "+n+" of surface "+e.surfaceType+" is hidden",e.creativeId)}catch(t){ee.error(526401693,"failed to verify target element of surface "+e.surfaceType+", "+e.creativeId,t)}}(e),[3,10];case 9:if(f=u.sent(),d="SurfaceLaunched",0===e.treatmentType||e.isControl?d="SurfaceControlTriggered":e.isAA&&(d="SurfaceAATriggered"),o(d,!1,f&&f.message),Co())throw f;return[3,10];case 10:return[2]}var v,p}))}))}},,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s}));var r=n(0),i=n(3),o=((Object(i.a)()||{}).Symbol,(Object(i.a)()||{}).Reflect,r.a,function(e,t){return(o=r.b.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t[r.i](n)&&(e[n]=t[n])})(e,t)});function a(e,t){function n(){this.constructor=e}typeof t!==r.h&&null!==t&&Object(i.c)("Class extends value "+String(t)+" is not a constructor or null"),o(e,t),e[r.k]=null===t?Object(i.b)(t):(n[r.k]=t[r.k],new n)}function s(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(5);function i(e,t,n){void 0===n&&(n=!0);var i=!1;if(e&&t)if(n)if(e===t)i=!0;else for(i=!1;t;){var o=Object(r.a)(t);if(o===e){i=!0;break}t=o}else e.contains&&(i=e.contains(t));return i}}]);
//# sourceMappingURL=officewebsurfaces.core.min.js.map