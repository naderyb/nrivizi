"use strict";(self.odspNextWebpackJsonp=self.odspNextWebpackJsonp||[]).push([["plt.odsp-common"],[,function(e,t,n){n.d(t,{a:function(){return p},b:function(){return p},c:function(){return d}});var a=n(120),i="KillSwitchOverrides",r="".concat(i,"_").concat("enableKillSwitches"),o="".concat(i,"_").concat("disableKillSwitches");function s(e){try{var t=document.cookie.match("(^|;)\\s*"+e+"\\s*=\\s*([^;]+)");return t?t.pop():""}catch(e){return""}}function c(e){var t=[],n=[];for(var a in e)(e[a]?t:n).push(a);try{document.cookie="".concat(r,"=").concat(t.join(","),";path=/;samesite=none;secure;").concat(t.length?"":"expires=Thu, 01 Jan 1970 00:00:01 GMT;"),document.cookie="".concat(o,"=").concat(n.join(","),";path=/;samesite=none;secure;").concat(n.length?"":"expires=Thu, 01 Jan 1970 00:00:01 GMT;")}catch(e){}}function d(){if(u){for(var e=[],t=0,n=Object.keys(u);t<n.length;t++){var a=n[t];e.push(u[a]?a:"!".concat(a))}return e.join(",")}}function l(){return function(e,t,n,i){if(t)for(var r=0,o=t.split(",");r<o.length;r++){var s=o[r];e[a.normalizeUpper(s,!1)]=!0}if(n)for(var c=0,d=n.split(",");c<d.length;c++)s=d[c],e[a.normalizeUpper(s,!1)]=!1;return e}({},s(r),s(o))}var u={},f=function(){u=l();var e=function(){var e={};try{var t=location.search?location.search.substring(1):"";if(t)for(var n=t.split("&"),a=0,i=n;a<i.length;a++){var r=i[a].split("=");r.length>1&&void 0!==r[0]&&void 0!==r[1]&&(e[r[0]]=decodeURIComponent(r[1].replace(/\+/g," ")))}}catch(e){}return e}();e.enableKillSwitches,e.disableKillSwitches,e.debugKillSwitches,c(u);try{window.__debugSetKillSwitch=function(e,t){void 0===t&&(t=!0);var n=l();n[a.normalizeUpper(e,!1)]=!!t,c(n)}}catch(e){}f=function(){}},p=function(){function e(){}return e.initKillSwitches=function(t){e._killSwitch=m({killSwitches:t||{}})},e.isActivated=function(t,n,a){var i;if(f(),e._killSwitch)return e.isActivated=e._killSwitch.isActivated,e._killSwitch.isActivated(t,n,a);try{if(window._spPageContextInfo){var r=m(window._spPageContextInfo);return(null===(i=window._spPageContextInfo)||void 0===i?void 0:i.killSwitches)&&(e.isActivated=r.isActivated),r.isActivated(t,n,a)}if(window.Flight){var o=void 0;if(window.Flight.KillSwitches){o={};for(var s=0,c=Object.keys(window.Flight.KillSwitches);s<c.length;s++){var d=c[s];o[window.Flight.KillSwitches[d]]=!0}}var l=m({killSwitches:o});return o&&(e.isActivated=l.isActivated),l.isActivated(t,n,a)}}catch(e){return!1}return!1},e}();function m(e){var t=e&&e.killSwitches;return{isActivated:function(e,n,i){var r=!1;if(e){var o=a.normalizeUpper(e,!1);o in u?r=!!u[o]:t&&(r=!!t[o])}return r}}}}
,,,function(e,t,n){n.d(t,{a:function(){return d},b:function(){return s.a}});var a=n(0),i=n(1),r=n(90),o=n(12),s=n(35),c=!i.a.isActivated("56657a27-2eea-4b49-bda1-5111181509cf","06/18/2024","Include isNucleusEnabled for Qos events"),d=function(e){function t(t,n){return e.call(this,function(e){return c&&e&&(e.isNucleusEnabled=!!window.__isListDataSyncEnabled),e}(t),n)||this}return(0,a.d)(t,e),t.prototype.end=function(t){return t&&t.extraData&&this.data.extraData&&(t=(0,a.a)((0,a.a)({},t),{extraData:(0,a.a)((0,a.a)({},this.data.extraData),t.extraData)})),e.prototype.end.call(this,t)},t}((0,r.a)({eventName:"Qos,",shortEventName:"Qos"},{name:{isKey:!0,isPrefixingDisabled:!0,type:o.a.String},startTimeOverride:{isPrefixingDisabled:!0,type:o.a.Number},resultCode:{isPrefixingDisabled:!0,type:o.a.String},resultType:{typeRef:s.a,isPrefixingDisabled:!0,type:o.a.Enum},error:{isPrefixingDisabled:!0,type:o.a.String},stackTrace:{isPrefixingDisabled:!0,type:o.a.String},extraData:o.a.Object,extraMetrics:{isPrefixingDisabled:!0,type:o.a.Object},privacyClassification:{isPrefixingDisabled:!0,type:o.a.String},objectType:{isPrefixingDisabled:!0,type:o.a.String},persistence:{isPrefixingDisabled:!0,type:o.a.Boolean},isNucleusEnabled:{isPrefixingDisabled:!0,type:o.a.Boolean}}).withData({privacyClassification:o.b.requiredService,privacyDataTypes:["productAndServicePerformance"]}))}
,,function(e,t,n){n.d(t,{a:function(){return o}});var a=n(156),i=n(238),r=0,o=function(){function e(e){this.id=++r,"string"==typeof e?(this.name=e,this.factory=void 0,this.loader=void 0):(this.name=e.name,this.factory=e.factory,this.loader=e.loader)}return Object.defineProperty(e.prototype,"key",{get:function(){return this},enumerable:!1,configurable:!0}),e.prototype.toString=function(){return"Resource #".concat(this.id,' "').concat(this.name,'"')},e}();Object.defineProperty(o.prototype,"flags",{value:a.a.none}),Object.defineProperties(o.prototype,i.b)}
,function(e,t,n){n.d(t,{a:function(){return K},b:function(){return G}});var a=n(0),i=n(242);function r(e){window.setTimeout(function(){i.c(V,h,{error:e})},0)}var o,s,c,d,l,u,f,p,m,_,h="error",b="Canceled",g=1;function v(){}function y(e,t){e._value=t,e._setState(V.isPromise(t)?c:f)}function S(e,t,n,a,i,r){return{exception:e,error:t,promise:n,handler:r,id:a,parent:i}}function D(e,t,n,a){var i=null==n?void 0:n._isException;return S(i?t:null,i?null:t,e,null==n?void 0:n._errorId,n,a)}function I(e,t,n){var a=null==n?void 0:n._isException,i=null==n?void 0:n._errorId;return e instanceof V&&M(e,i,a),S(a?t:null,a?null:t,e,i,n)}function x(e,t){var n=++g;return e instanceof V&&M(e,n),S(null,t,e,n)}function C(e,t){var n=++g;return e instanceof V&&M(e,n,!0),S(t,null,e,n)}function O(e,t,n){k(e,{c:t,e:n})}function w(e,t,n,a){e._value=t,L(e,t,n,a),e._setState(m)}function E(e,t){var n,a,i=e._value,r=e._listeners;if(r)for(e._listeners=null,n=0,a=r.length;n<a;n++){var o=r[n],s=o.c,d=o.promise;if(d){try{d._setCompleteValue(s?s(i):i)}catch(e){d._setExceptionValue(e)}d._state!==c&&d._listeners&&t.push(d)}else N.prototype.done.call(e,s)}}function A(e,t){var n,a,i=e._value,r=e._listeners;if(r)for(e._listeners=null,n=0,a=r.length;n<a;n++){var o=r[n],s=o.e,d=o.promise;if(d){try{s?(s.handlesOnError||L(d,i,D,e,s),d._setCompleteValue(s(i))):d._setChainedErrorValue(i,e)}catch(e){d._setExceptionValue(e)}d._state!==c&&d._listeners&&t.push(d)}else H.prototype.done.call(e,void 0,s)}}function L(e,t,n,a,r){t instanceof Error&&t.message===b||i.c(V,h,n(e,t,a,r))}function k(e,t){var n=e._listeners;n?n.push(t):n=[t],e._listeners=n}function M(e,t,n){e._isException=n||!1,e._errorId=t}function P(e,t,n,a){e._value=t,L(e,t,n,a),e._setState(_)}function T(e,t){var n;n=V.isPromise(t)?c:p,e._value=t,e._setState(n)}function U(e,t,n){var a=new z(e);return k(e,{promise:a,c:t,e:n}),a}o={name:"created",enter:function(e){e._setState(s)},cancel:v,done:v,then:v,_completed:v,_error:v,_notify:v,_setCompleteValue:v,_setErrorValue:v},s={name:"working",enter:v,cancel:function(e){e._setState(l)},done:O,then:U,_completed:y,_error:w,_notify:v,_setCompleteValue:T,_setErrorValue:P},c={name:"waiting",enter:function(e){var t=e._value;if(t instanceof z&&t._state!==_&&t._state!==p)k(t,{promise:e});else{var n=function(a){t._errorId?e._chainedError(a,t):(L(e,a,D,t,n),e._error(a))};n.handlesOnError=!0,t.then(e._completed.bind(e),n)}},cancel:function(e){e._setState(d)},done:O,then:U,_completed:y,_error:w,_notify:v,_setCompleteValue:T,_setErrorValue:P},d={name:"waiting_canceled",enter:function(e){e._setState(u);var t=e._value;V.is(t)&&t.cancel()},cancel:v,done:O,then:U,_completed:y,_error:w,_notify:v,_setCompleteValue:T,_setErrorValue:P},l={name:"canceled",enter:function(e){e._setState(u),e._cancelAction()},cancel:v,done:O,then:U,_completed:y,_error:w,_notify:v,_setCompleteValue:T,_setErrorValue:P},u={name:"canceling",enter:function(e){var t=new Error(b);t.name=t.message,t._handled=!0,e._value=t,e._setState(m)},cancel:v,done:v,then:v,_completed:v,_error:v,_notify:v,_setCompleteValue:v,_setErrorValue:v},f={name:"complete_notify",enter:function(e){if(e._listeners)for(var t=[e],n=void 0;t.length;)(n=t.shift())&&n._state._notify(n,t);e._setState(p)},cancel:v,done:function(e,t,n){return N.prototype.done.call(e,t)},then:function(e,t,n){return N.prototype.then.call(e,t,n)},_completed:v,_error:v,_notify:E,_setCompleteValue:v,_setErrorValue:v},p={name:"success",enter:function(e){e._cleanupAction()},cancel:v,done:function(e,t,n){return N.prototype.done.call(e,t)},then:function(e,t,n){return N.prototype.then.call(e,t)},_completed:v,_error:v,_notify:E,_setCompleteValue:v,_setErrorValue:v},m={name:"error_notify",enter:function(e){if(e._listeners)for(var t=[e],n=void 0;t.length;)(n=t.shift())&&n._state._notify(n,t);e._setState(_)},cancel:v,done:function(e,t,n){return H.prototype.done.call(e,t,n)},then:function(e,t,n){return H.prototype.then.call(e,t,n)},_completed:v,_error:v,_notify:A,_setCompleteValue:v,_setErrorValue:v},_={name:"error",enter:function(e){e._cleanupAction()},cancel:v,done:function(e,t,n){return H.prototype.done.call(e,t,n)},then:function(e,t,n){return H.prototype.then.call(e,t,n)},_completed:v,_error:v,_notify:A,_setCompleteValue:v,_setErrorValue:v};var F,H=function(){function e(e,t){void 0===t&&(t=x),this._value=e,L(this,e,t)}return e.prototype.cancel=function(){},e.prototype.done=function(e,t){var n=this._value;if(t)try{t.handlesOnError||L(this,n,D,this,t);var a=t(n);return void(V.is(a)&&a.done())}catch(e){n=e}n instanceof Error&&n.message===b||r(n)},e.prototype.then=function(e,t){if(!t)return this;var n,a=this._value;try{t.handlesOnError||L(this,a,D,this,t),n=new N(t(a))}catch(e){n=e===a?this:new R(e)}return n},e.prototype.catch=function(e){return this.then(void 0,e)},e}(),R=function(e){function t(t){return e.call(this,t,C)||this}return(0,a.d)(t,e),t}(H),N=function(){function e(e){if(V.isPromise(e)){var t=new z(null);return t._setCompleteValue(e),t}this._value=e}return e.prototype.cancel=function(){},e.prototype.done=function(e,t){if(e)try{var n=e(this._value);V.is(n)&&n.done()}catch(e){r(e)}},e.prototype.then=function(t,n){var a;try{var i=t?t(this._value):this._value;a=this._isSameValue(i,this)?this:new e(i)}catch(e){a=new R(e)}return a},e.prototype.catch=function(e){return this.then(void 0)},e.prototype._isSameValue=function(e,t){return e===this._value},e}();function B(e){var t;return new V(function(n){t=window.setTimeout(n,e)},function(){t&&window.clearTimeout(t)})}function j(e){var t=e;return function(){for(var e=0,n=Object.keys(t);e<n.length;e++){var a=n[e];V.as(t[a]).cancel()}}}var V=function(){function e(e,t){this._init(e,t)}return Object.defineProperty(e,"cancel",{get:function(){return F||(F=new H(new Error(b)))},enumerable:!1,configurable:!0}),e.any=function(t){return new e(function(n,a){var i=Object.keys(t),r=i.length;0===r&&n();for(var o=t,s=function(t){var i=e.as(o[t]);i.then(function(){n({key:t,value:i})},function(o){o instanceof Error&&o.name===b?0==--r&&n(e.cancel):a({key:t,value:i})})},c=0,d=i;c<d.length;c++)s(d[c])},j(t))},e.race=function(t){return new e(function(n,a){var i=Object.keys(t),r=i.length;0===r&&n();for(var o=t,s=0,c=i;s<c.length;s++){var d=c[s];e.as(o[d]).then(n,function(t){t instanceof Error&&t.name===b?0==--r&&n(e.cancel):a(t)})}},j(t))},e.as=function(t){return e.is(t)?t:new N(t)},e.is=function(t){return e.isPromise(t)&&"function"==typeof t.cancel},e.isPromise=function(e){return!!e&&"object"==typeof e&&"function"==typeof e.then},e.isCanceled=function(e){return e instanceof Error&&e.name===b},e.all=function(t){return new e(function(n,a){for(var i=Object.keys(t),r=Array.isArray(t)?[]:{},o=Array.isArray(t)?[]:{},s=i.length,c=function(){if(0==--s){var t=Object.keys(r);0===t.length?n(o):t.every(function(t){return e.isCanceled(r[t])})?n(e.cancel):a(r)}},d=function(n){var a=t[n];void 0===a?s--:e.then(a,function(e){o[n]=e,c()},function(e){r[n]=e,c()})},l=0,u=i;l<u.length;l++)d(u[l]);0===s&&n(o)},j(t))},e.then=function(t,n,a){return e.as(t).then(n,a)},e.thenEach=function(t,n,a){for(var i=Array.isArray(t)?[]:{},r=0,o=Object.keys(t);r<o.length;r++){var s=o[r];i[s]=e.then(t[s],n,a)}return e.all(i)},e.serial=function(t){return t.reduce(function(e,t){return e.then(t)},e.wrap())},e.timeout=function(e,t){var n=B(e);return t?function(e,t){var n=function(){e.cancel()};return e.then(function(){t.cancel()}),t.then(n,n),t}(n,t):n},e.wrap=function(e){return new N(e)},e.resolve=function(t){return e.wrap(t)},e.wrapError=function(e){return new H(e)},e.reject=function(t){return e.wrapError(t)},e.prototype.cancel=function(){this._state.cancel(this),this._run()},e.prototype.done=function(e,t){this._state.done(this,e,t)},e.prototype.then=function(e,t){return this._state.then(this,e,t)},e.prototype.catch=function(e){return this.then(void 0,e)},e.prototype._init=function(e,t){this._oncancel=t,this._setState(o),this._run();try{e?e(this._completed.bind(this),this._error.bind(this)):this._setExceptionValue(new Error("No init value for Promise"))}catch(e){this._setExceptionValue(e)}},e.prototype._cancelAction=function(){if(this._oncancel)try{this._oncancel()}catch(e){}},e.prototype._cleanupAction=function(){this._oncancel=void 0},e.prototype._chainedError=function(e,t){var n=this._state._error(this,e,I,t);return this._run(),n},e.prototype._completed=function(e){var t=this._state._completed(this,e);return this._run(),t},e.prototype._error=function(e){var t=this._state._error(this,e,x);return this._run(),t},e.prototype._setState=function(e){this._nextState=e},e.prototype._setCompleteValue=function(e){this._state._setCompleteValue(this,e),this._run()},e.prototype._setChainedErrorValue=function(e,t){var n=this._state._setErrorValue(this,e,I,t);return this._run(),n},e.prototype._setExceptionValue=function(e){var t=this._state._setErrorValue(this,e,C);return this._run(),t},e.prototype._run=function(){for(;this._nextState;)this._state=this._nextState,this._nextState=void 0,this._state.enter(this)},e.prototype._isSameValue=function(e,t){return e===this._value},e}();i.a(V,h);var z=function(e){function t(t){var n=e.call(this)||this;return n._creator=t,n._initThen(),n}return(0,a.d)(t,e),t.prototype._init=function(){},t.prototype._cancelAction=function(){this._creator&&this._creator.cancel()},t.prototype._cleanupAction=function(){this._creator=null},t.prototype._initThen=function(){this._setState(o),this._run()},t}(V),G=function(e){function t(t){var n=e.call(this)||this;return n._oncancel=t,n._initSignal(),n}return(0,a.d)(t,e),t.prototype._init=function(){},t.prototype._cancelAction=function(){this._oncancel&&this._oncancel()},t.prototype._cleanupAction=function(){this._oncancel=void 0},t.prototype._initSignal=function(){this._setState(o),this._run()},t}(V),K=V;t.c=K}
,,,function(e,t,n){n.d(t,{b:function(){return g}});var a=n(65),i=n(1),r=n(30),o=n(240),s=i.a.isActivated("26b61085-e68c-4a13-a8de-ae84ba2d96d2","1/16/2023","Validate if window object is present or not"),c={ODB:587,ODC:"AllowFeatureOverrides",Fallback:!1},d={ODB:357,Fallback:!1},l={ODB:342,Fallback:!1},u={ODB:60763,ODC:"AllowFeatureOverrides",Fallback:!1},f="FeatureOverrides",p={},m="".concat(f,"_").concat("enableFeatures"),_="".concat(f,"_").concat("disableFeatures");function h(e){var t=document.cookie.match("(^|;)\\s*"+e+"\\s*=\\s*([^;]+)");return t?t.pop():""}function b(e){var t=[],n=[];for(var a in e)(e[a]?t:n).push(a);try{document.cookie="".concat(m,"=").concat(t.join(","),";path=/;samesite=none;secure;").concat(t.length?"":"expires=Thu, 01 Jan 1970 00:00:01 GMT;"),document.cookie="".concat(_,"=").concat(n.join(","),";path=/;samesite=none;secure;").concat(n.length?"":"expires=Thu, 01 Jan 1970 00:00:01 GMT;")}catch(e){}}function g(){if(p){for(var e=[],t=0,n=Object.keys(p);t<n.length;t++){var a=n[t];e.push(p[a]?a:"!".concat(a))}return e.join(",")}}function v(e,t,n,a){if(t)for(var i=0,r=t.split(",");i<r.length;i++)e[l=r[i]]=!0;if(n)for(var o=0,s=n.split(",");o<s.length;o++)e[l=s[o]]=!1;if(a)for(var c=0,d=a.split(",");c<d.length;c++){var l;"!"===(l=d[c])[0]?e[l.slice(1)]=!1:e[l]=!0}return e}var y=function(){function e(){}return Object.defineProperty(e,"Overrides",{get:function(){return p},enumerable:!1,configurable:!0}),e.evaluateCanOverride=function(){s||"undefined"!=typeof window?e.CanOverride=r.a.isFeatureEnabled(c)||r.a.isFeatureEnabled(d)||r.a.isFeatureEnabled(l)||r.a.isFeatureEnabled(u)||!(!(null===window||void 0===window?void 0:window.Flight)||"dev"!==window.Flight.version&&!window.Flight.devMode):e.CanOverride=!1},e.isFeatureEnabled=function(t,n){return e._isFeatureEnabled(t,n)},e.isECSFeatureEnabled=function(t,n){return e._isECSFeatureEnabled(t,n)},e._isFeatureEnabled=function(t,n){if(e.CanOverride){if(t.ODB in p)return p[t.ODB];if(t.ODC in p)return p[t.ODC]}return n?(0,o.b)(t,n):r.a.isFeatureEnabled(t)},e._isECSFeatureEnabled=function(e,t){return t?(0,o.a)(e,t):r.a.isFeatureEnabled(e)},e.AllowFeatureOverrides=c,e.SPODebugOnlyCookieRedirect=d,e.ClientDebugFeatureOverrides=u,e}();t.a=y,y.evaluateCanOverride(),y.CanOverride&&function(){p=v({},h(m),h(_),void 0);var e=location.search?location.search.substring(1):"",t=(0,a.a)(e),n=t.enableFeatures,i=t.disableFeatures,r=t.debugFlights;v(p,n,i,r),b(p);try{window.__debugSetFeature=function(e,t){void 0===t&&(t=!0),p[e]=!!t,b(p)}}catch(e){}}()}
,,function(e,t,n){n.d(t,{a:function(){return c},b:function(){return s}});var a={};n.r(a),n.d(a,{optionalDiagnostic:function(){return r},requiredDiagnostic:function(){return i},requiredService:function(){return o}});var i="requiredDiagnostic",r="optionalDiagnostic",o="requiredService",s=a,c={String:1,Number:2,Boolean:3,Object:4,Array:5,Enum:6}}
,,,,,,,function(e,t,n){n.d(t,{a:function(){return c},b:function(){return s},c:function(){return r},d:function(){return i},e:function(){return d},f:function(){return o}});var a=/\{(\d+)\}/g;function i(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return e.replace(a,function(e,n){var a=t[Number(n)];return null===a?"":"".concat(a)})}function r(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var i,r=[],o=0;i=a.exec(e);){var s=i[0],c=parseInt(s.replace(/\{|\}+/g,""),10),d=t[c];i.index>o&&r.push(e.substring(o,i.index)),o=a.lastIndex,r.push(d)}return o!==e.length&&r.push(e.substring(o,e.length)),r}function o(e,t){for(var n=e.toString();n.length<t;)n="0".concat(n);return n}function s(e,t){return e&&t?e.toUpperCase()===t.toUpperCase():e===t}function c(e){return e?e[0].toUpperCase()+e.substr(1):e}function d(e,t,n){if(n=Number(n),void 0===e||void 0===t||void 0===n)return"";for(var a="",i=-1,r=t.split("||"),o=0,s=r.length;o<s;o++){var c=r[o];if(c){for(var d=0,l=c.split(",");d<l.length;d++){var u=l[d];if(u)if(isNaN(Number(u))){if(-1!==u.indexOf("-")){var f=u.split("-");if(2!==f.length)continue;var p=void 0,m=void 0;if("*"===u[0]){var _=f[0].substring(1),h=f[1];if(isNaN(Number(_))||isNaN(Number(h)))continue;p=parseInt(_,10),m=parseInt(h,10);for(var b=void 0,g=p;g<=m;g++){var v="[0-9]*"+g;if(new RegExp("^".concat(v,"$")).test(n.toString())){b=!0;break}}if(b){i=o;break}}else{if(""===f[0])p=0;else{if(isNaN(Number(f[0])))continue;p=parseInt(f[0],10)}if(n>=p){if(""===f[1]){i=o;break}if(isNaN(Number(f[1])))continue;if(n<=(m=parseInt(f[1],10))){i=o;break}}}}else if(-1!==u.indexOf("*")&&(v=u.trim().replace(/\*/g,"[0-9]*"),new RegExp("^".concat(v,"$")).test(n.toString()))){i=o;break}}else if(n===parseInt(u,10)){i=o;break}}if(-1!==i)break}}if(-1!==i){var y=e.split("||");y[i]&&(a=y[i])}return a}}
,,function(e,t,n){n.d(t,{$:function(){return ot},$b:function(){return k},A:function(){return Y},Ab:function(){return je},B:function(){return ze},Bb:function(){return Qe},C:function(){return Ge},Cb:function(){return Ue},D:function(){return P},Db:function(){return He},E:function(){return tt},Eb:function(){return Be},F:function(){return st},Fb:function(){return at},G:function(){return ct},Gb:function(){return q},H:function(){return De},Hb:function(){return _e},I:function(){return $},Ib:function(){return f},J:function(){return y},Jb:function(){return X},K:function(){return oe},Kb:function(){return N},L:function(){return Z},Lb:function(){return ht},M:function(){return v},Mb:function(){return V},N:function(){return u},Nb:function(){return Me},O:function(){return ne},Ob:function(){return b},P:function(){return j},Pb:function(){return z},Q:function(){return ke},Qb:function(){return xe},R:function(){return ie},Rb:function(){return Le},S:function(){return I},Sb:function(){return F},T:function(){return O},Tb:function(){return p},U:function(){return rt},Ub:function(){return Dt},V:function(){return yt},Vb:function(){return Pe},W:function(){return D},Wb:function(){return K},X:function(){return w},Xb:function(){return gt},Y:function(){return L},Yb:function(){return bt},Z:function(){return re},Zb:function(){return nt},_:function(){return $e},_b:function(){return Fe},_c:function(){return vt},a:function(){return le},ab:function(){return Ct},ac:function(){return ge},b:function(){return de},bb:function(){return ft},bc:function(){return We},c:function(){return ce},cb:function(){return H},cc:function(){return ye},d:function(){return qe},db:function(){return it},dc:function(){return Je},e:function(){return fe},eb:function(){return x},ec:function(){return E},f:function(){return ue},fb:function(){return Ie},fc:function(){return lt},g:function(){return U},gb:function(){return S},gc:function(){return J},h:function(){return c},hb:function(){return T},hc:function(){return Q},i:function(){return Ae},ib:function(){return A},ic:function(){return l},j:function(){return _t},jb:function(){return Ye},k:function(){return Lt},kb:function(){return B},l:function(){return et},lb:function(){return we},lc:function(){return g},m:function(){return mt},mb:function(){return Ot},mc:function(){return Se},n:function(){return xt},nb:function(){return At},nc:function(){return ae},o:function(){return Ce},ob:function(){return _},oc:function(){return R},p:function(){return Oe},pb:function(){return me},pc:function(){return ut},q:function(){return Ee},qb:function(){return W},r:function(){return kt},rb:function(){return St},rc:function(){return M},s:function(){return pt},sb:function(){return se},sc:function(){return Re},t:function(){return Et},tb:function(){return h},tc:function(){return ee},u:function(){return be},ub:function(){return Te},uc:function(){return wt},v:function(){return C},vb:function(){return he},vc:function(){return dt},w:function(){return ve},wb:function(){return m},x:function(){return Xe},xb:function(){return Ne},y:function(){return Ve},yb:function(){return Ze},yc:function(){return te},z:function(){return Ke},zb:function(){return It}});var a=n(10),i=n(30),r=n(1),o=n(117),s=window._spPageContextInfo,c=(s&&"21"===s.webTemplate&&s.listBaseTemplate,{ODB:1466}),d=[];function l(){return!0}function u(){return a.a.isFeatureEnabled({ODB:1977})}function f(){return a.a.isFeatureEnabled({ODB:60345})}function p(){return a.a.isFeatureEnabled({ODC:!0,ODB:!1,ECS:1081438,OneDrive:void 0})}function m(){return!a.a.isFeatureEnabled({ODC:(e="ODCHideNonPremiumLinkFeatures",t=d.filter(function(t){return t.flightStringId===e})[0],t?t.flightEnabled:e),ODB:!1,OneDrive:void 0});var e,t}function _(){return r.b.isActivated("4429323f-4400-4a98-a83b-4e27f4c42109","04/18/2024","Fix shared with update")||a.a.isFeatureEnabled({ECS:1253990})}function h(){return!r.b.isActivated("a0f6091d-e62c-4e67-b0a6-72bbb134892d","02/10/2023","fixPeoplePickerOdcCustomerPromise")&&!a.a.isFeatureEnabled({ECS:1069468})}function b(){return!a.a.isFeatureEnabled({ODC:r.b.isActivated("12EA7E85-1736-4E83-9E6E-E6F9610A692B","08/15/2023","FamilySharingWacKS"),ODB:!1,OneDrive:void 0})}function g(){return r.b.isActivated("bdd26309-eb3c-4f4f-9d14-ceef3e92cc6f","04/18/2024","update callout to use tooltip")||a.a.isFeatureEnabled({ECS:1254087})}function v(){return!r.b.isActivated("da13eadb-9185-4fff-895e-e7d4e149be07","01/18/2023","external sharing in people picker")&&!a.a.isFeatureEnabled({ECS:1056503})}function y(){return!r.b.isActivated("34614db0-da1b-4a32-8252-3c0fb8f80913","09/19/2023","enable the premium features for M365 basic plan users")&&!a.a.isFeatureEnabled({ECS:1169459})&&a.a.isFeatureEnabled({ODB:60907})}function S(){return!r.b.isActivated("4e2301ca-b8b4-48c0-b35a-006b9c31b18c","12/28/2023","re share the existing link to others")&&!a.a.isFeatureEnabled({ECS:1146219})&&a.a.isFeatureEnabled({ODB:61265})}function D(){return!r.b.isActivated("cb7d2c6b-f7da-457b-aca2-d8b94f0ababb","01/18/2023","fixLinkSettingsOpenLog")&&!a.a.isFeatureEnabled({ECS:1064203})}function I(){return!r.b.isActivated("29f3b27d-c021-4576-a5d9-09aabcfc99fb","04/06/2023","fixCopyLinkViewState")&&!a.a.isFeatureEnabled({ECS:1094346})}function x(){return!r.b.isActivated("b94c9c2c-6f5f-4f91-b002-0bd352472576","01/05/2023","fixOnAudienceChange")&&!a.a.isFeatureEnabled({ECS:1061682})}function C(){return!r.b.isActivated("2850737d-dafe-4c55-b488-74552ad19451","04/25/2023","changeCustomerPromiseTimeOut")&&!a.a.isFeatureEnabled({ECS:1086659})}function O(){return!r.b.isActivated("fd9b2be1-792b-4b24-b915-b69e7b79c2cb","04/13/2023","fixCopyToClipboard")&&!a.a.isFeatureEnabled({ECS:1083754})}function w(){return!r.b.isActivated("03fde877-4287-4f2a-9c7f-da996bdcb7a6","04/24/2023","fixLinkSettingsOtherSettings")&&!a.a.isFeatureEnabled({ECS:1083754})}function E(){return!r.b.isActivated("65dd8983-4519-47bf-9156-e7618de4084f","05/14/2023","simplifiedExternalSharingDisabledString")&&!a.a.isFeatureEnabled({ECS:1091332})}function A(){return!r.b.isActivated("3678da5a-a9b1-4dd4-9a03-0f586704406b","05/22/2023","fixRequireSignInAndPSLCreateLink")&&!a.a.isFeatureEnabled({ECS:1093387})}function L(){return!r.b.isActivated("2153f182-6d03-4ca4-909f-8064ad3c3f6f","07/27/2023","fixLinkSettingsPeoplePicker")&&!a.a.isFeatureEnabled({ECS:1113931})}function k(){return!r.b.isActivated("03db8451-92a3-47a5-be55-af82ccce6e39","06/13/2023","simplifiedCopyCommandNotification")&&!a.a.isFeatureEnabled({ECS:1093764})}function M(){return!r.b.isActivated("aad6691b-4c47-4bfc-bc4a-24962f4f9669","07/26/2023","supportExternalSharingForExistingAudience")&&!a.a.isFeatureEnabled({ECS:1113615})}function P(){return!r.b.isActivated("177e3f91-46d3-41ba-8c8f-8dc1fad68910","02/12/2024","copyPermissionMaxWaitEnabled")&&!a.a.isFeatureEnabled({ECS:1230381})}function T(){return!r.b.isActivated("c654fb63-ee65-4e9c-95d4-ac304f3b2025","02/12/2024","initCPWithHostSessionId")&&!a.a.isFeatureEnabled({ECS:1230509})}function U(){return!r.b.isActivated("1dee4d47-8282-45c8-937b-7c1636991a61","02/20/2024","ShareDialogSingleCxP")&&!a.a.isFeatureEnabled({ECS:1233537})&&a.a.isFeatureEnabled({ODB:61483})}function F(){return!r.b.isActivated("c56bb19f-9436-4e7a-bc9a-55347c3f1db4","02/20/2024","ShareDialogSingleCxP")&&!a.a.isFeatureEnabled({ECS:1251387})}function H(){return!r.b.isActivated("70804dcd-05a5-476e-8599-c2a14e37cff7","05/29/2024","graduateCleanUpDefaultLink")&&!a.a.isFeatureEnabled({ECS:1266299})}function R(){return a.a.isFeatureEnabled({ODB:60149})}function N(){return!r.b.isActivated("dcfb2c5d-46bc-4a7f-8970-f5066f36bb16","10/12/2021","Share To Teams in web")}function B(){return!r.b.isActivated("e6dbe5d1-55f9-439b-a975-1931c6bf9c90","02/25/2021","People picker improvements")&&!a.a.isFeatureEnabled({ECS:1005398})}function j(){return a.a.isFeatureEnabled({ODC:!0,ODB:!1,OneDrive:void 0})}function V(){return!r.b.isActivated("6acc2587-8c04-4366-960a-8754df787145","10/03/2022","People picker 3s search with non mail security group indexing")&&!a.a.isFeatureEnabled({ECS:1044963})&&a.a.isFeatureEnabled({ODB:1596})||G()}function z(){return!r.b.isActivated("640c23cc-ecfe-4ae0-860b-fec999027e92","08/02/2023","People picker 3s search enabled for XP")&&!a.a.isFeatureEnabled({ECS:1115472})||G()}function G(){return a.a.isFeatureEnabled({ODC:!0,ODB:!1,ECS:1076914,OneDrive:void 0})}function K(){return!r.b.isActivated("eed24e3c-2a9b-47cf-9505-3fe89cb0e1e7","12/11/2022","Default message text with document summary")&&a.a.isFeatureEnabled({ODB:1785})}function W(){return!r.b.isActivated("429328b1-73c4-4346-b204-29ce8a8d354d","12/21/2022","Enable rendering a message bar in the default, copy link, or manage access sharing dialog.")&&!r.b.isActivated("be539d36-bc68-42bf-ba3a-494ed392aa9e","09/29/2022","Disable new page sharing experience")&&(i.a.isFeatureEnabled({ODB:1556})||pe(s))}function q(){return!r.b.isActivated("edfd6634-3e54-499a-95e2-a38aa2b4e82e","07/05/2023","Set the default share dialog permission to read")&&!i.a.isFeatureEnabled({ECS:1107924})}function Q(){return!r.b.isActivated("da505fd8-1316-4d4e-ad83-5f0ed0ef406b","09/28/2023","Enable simplified dialog use in SharePoint pages.")&&i.a.isFeatureEnabled({ODB:61243})}function Y(){return!r.b.isActivated("2a092b3f-6729-4a0a-a847-7c2e1dc366e9","1/24/2023","Contextual Sharing Feature")&&!i.a.isFeatureEnabled({ECS:1065461})&&a.a.isFeatureEnabled({ODB:1743})}function J(){return!r.b.isActivated("a8bec832-0254-4c5f-b857-80899d980423","03/27/2024","KS for using updated gradient and width for SWS progress indicator")}function X(){return!r.b.isActivated("dcd269d2-1d02-4ab8-b1e1-7afc6e285a60","03/12/2024","Has SWS show failed result for a parroted response")}function Z(){return!r.b.isActivated("d685ea9e-632d-414f-9b9c-6982bc1c6eec","01/24/2023","Disables expiration date picker based on get/delete submitOnlyLink status.")}function $(){return!r.b.isActivated("a8176101-afe0-4540-975d-cd326db8ee52","01/23/2023","Allows file request sharelink to be edited from manage access pane.")}function ee(){return r.b.isActivated("00ece790-28cb-4228-b947-70c6cf959b9e","6/5/2023","Simplified Sharing Dialog v2")||i.a.isFeatureEnabled({ECS:1098348})}function te(){return r.b.isActivated("c34e5556-e4c2-4fa7-b6fe-e5b41dfaa583","06/20/23","KS to make set Address Bar link capability async")}function ne(){return a.a.isFeatureEnabled({ODB:61409})}function ae(){return r.b.isActivated("64103F30-0A20-4BC5-9C23-767B39B7E1B0","05/20/2024","Killswitch for simplified Share Dialog for Multi share in COB")||a.a.isFeatureEnabled({ECS:1262035})}function ie(){return r.b.isActivated("90B5CA46-A849-4E92-A681-90E0F95E962B","06/20/2024","Killswitch for fix copy reshare link in COB simplified Share Dialog")||a.a.isFeatureEnabled({ECS:1277241})}function re(){return r.b.isActivated("6f986fc9-cf86-4f2d-8441-d526e25b5dfa","03/08/2024","KS for fixing ui issue in manage access for COB")||i.a.isFeatureEnabled({ECS:1239525})}function oe(){return r.b.isActivated("ccfe8581-04e5-4529-b8c4-d2b8512f0b1a","03/23/2023","KS for showing search directory, and filtering personas based on email to remove duplicates")||i.a.isFeatureEnabled({ECS:1078726})}function se(){return!r.b.isActivated("c675bcf5-0efe-428c-ae4d-7b3b4819af14","04/10/2023","KS for enabling floodgate survey in sharedialog")&&a.a.isFeatureEnabled({ODB:60170})}function ce(){return!r.b.isActivated("0ae84b78-8aca-4ce2-99f0-b796e7751887","06/21/2023","KS for AugLoop SharePoint-Copilot workflow integration with SWS")&&a.a.isFeatureEnabled({ODB:60001})}function de(){return!r.b.isActivated("8c0c3ca2-27a1-4644-872e-1ce56e2c8a96","08/25/2023","KS for AugLoop Office text-summarization workflow integration with SWS")&&a.a.isFeatureEnabled({ODB:1695})}function le(){return!r.b.isActivated("82469b8b-301b-46b6-8ec5-062ef91ec309","05/17/2024","KS for ASHA for SWS")&&!a.a.isFeatureEnabled({ECS:1264010})}function ue(){return!r.b.isActivated("23a9aa53-f059-4bea-982d-85f6fd841126","09/14/2023","KS for enforcing short Gpt Summary")}function fe(){return!r.b.isActivated("38138b0a-96a2-4b99-832c-3ded871b882c","02/20/2024","KS for enabling tier2 language for Share with Summary")&&a.a.isFeatureEnabled({ODB:61482})}var pe=function(e){return!(r.b.isActivated("5d592717-97ec-4339-9b65-4439dc0307b3","05/01/2023","Disable the O365 page sharing experience experiment")||!a.a.isFeatureEnabled({ODB:60600}))&&1===(0,o.c)(90174,e)};function me(){return!r.b.isActivated("f514a55e-51bb-431a-aebb-67b7e65ca19b","05/05/2023","Incorporates document summary into existing message text field")}function _e(){return!r.b.isActivated("ef557ef0-37fd-4f00-9d9f-6167a43ee9e6","05/23/2023","Do not show the SharingInfoBar after share is clicked in the dialog.")}function he(){return!r.b.isActivated("541bdd69-82d9-4f32-96a2-7713a587bfa5","05/11/2023","Kill Switch to revert 1DS migration")&&a.a.isFeatureEnabled({ECS:1091625,ODB:61025})}function be(){return!r.b.isActivated("2f4012ac-033e-4a40-8562-2e6d0e36fc89","06/16/2023","Allows for measuring distance between message and summary strings for telemetry/logging purposes")}function ge(){return r.b.isActivated("d87ac6da-0b38-4349-b400-70765ba93cf0","07/30/2023","Skip inheritedFrom information for COB ManageAcess when empty inheritedFrom property is returned")||i.a.isFeatureEnabled({ECS:1114780})}function ve(){return!r.b.isActivated("ba2947e0-437f-4681-b19b-56da10ad5472","08/07/2023","Increases character limitation for message box in share dialog iff summary is present")&&!i.a.isFeatureEnabled({ECS:1116735})&&(ce()||de())}function ye(){return!r.b.isActivated("a09408d4-a987-46a2-87fb-8e3c205ba638","08/31/2023","Adds summarization feature to mobile share dialog")}function Se(){return!r.b.isActivated("af85e3bd-16e3-43ad-acf2-ee6302f0b0c8","03/11/2024","Summary button icons updated")}function De(){return!r.b.isActivated("a87c8112-4263-4ff7-a537-45cc43f63997","10/26/2023","Lets summary button increase based on text height, KS for backup if it doesn't look/behave as expected")}function Ie(){return!r.b.isActivated("b8ce5932-4150-4518-b07c-5eaac04209fc","12/05/2023","Includes sensitivity label at the start of the message text")&&!i.a.isFeatureEnabled({ECS:1173996})}function xe(){return!r.b.isActivated("bb399db8-d12a-41cf-b8ff-842ab535aff2","01/31/2024","Add shield icon to share dialog next sensitivity label")&&de()}function Ce(){return!r.b.isActivated("adda2eb9-fafe-48ca-aea3-cb0d3750e4b1","01/25/2024","Add AI disclaimer below message box in share dialog V1")}function Oe(){return!r.b.isActivated("e2ca369b-23cb-428b-b5b3-f8477f6449b3","01/25/2024","Add AI disclaimer below message box in share dialog V2")}function we(){return!r.b.isActivated("b51e45fe-eb94-43ac-9e79-5767035ba4c1","11/26/2023","Add hover border none for ShareHintDetail")}function Ee(){return!r.b.isActivated("ad194ef7-ea9b-4951-a833-a75a435a1f22","02/02/2024","Add copilot feedback buttons (thumbs up / thumbs down) to share dialog")||a.a.isFeatureEnabled({ECS:1229015})}function Ae(){return!r.b.isActivated("99d6e434-0d22-42a7-831e-0a41ff977f44","02/14/2024","Add copilot helper to sharing store for share dialog")||a.a.isFeatureEnabled({ECS:1231452})}function Le(){return r.b.isActivated("eace855f-1ff6-4ee2-8bff-a8ae5b055046","12/13/2023","render limited sharing info bar ks")||a.a.isFeatureEnabled({ECS:1174630})}function ke(){return!r.b.isActivated("a5b26527-647a-48ee-85ff-c3c2c3db7fa9","03/07/2024","Restrict copilot button for token based share dialog")}function Me(){return!r.b.isActivated("b2c2ec02-f4b6-40e7-9d4a-641549bff5f8","01/25/2024","Restrict copilot summarization capability for higher sensitivity files")}function Pe(){return!r.b.isActivated("ddb7c09d-2ef1-4d30-8339-b45aadbd21bf","03/11/2024","KS for sending a JSON string for share with summary email")&&!a.a.isFeatureEnabled({ECS:1242130})&&a.a.isFeatureEnabled({ODB:61583})}function Te(){return!r.b.isActivated("dba74520-dd6d-4cf2-9c21-011559ce032c","03/22/2024","KS for including process sessionId in feedback for SWS")}function Ue(){return!r.b.isActivated("a9b357fd-4a84-4204-9ae1-87657e1ffec2","03/29/2024","If summary was in error state, then starting a new message shouldn't reset button state")}function Fe(){return!r.b.isActivated("a40695ab-3e3b-459d-91f9-f0818989b0cd","04/04/2024","Increase the share dialog message limit to 1500")&&!a.a.isFeatureEnabled({ECS:1249113})&&a.a.isFeatureEnabled({ODB:61635})}function He(){return!r.b.isActivated("b7f2d887-b96d-49c2-a012-27a03409eaa8","04/11/2024","Log the reason for disabling SWS feature")&&!a.a.isFeatureEnabled({ECS:1251439})}function Re(){return!r.b.isActivated("aa74c8cb-4799-4e8b-b251-be26a439673e","05/09/2024","Improves styling for longer disclaimers")}function Ne(){return!r.b.isActivated("a0dc66d9-550c-4066-8cf7-e934c2686b61","06/04/2024","Switch to markdown annotation for SWS")&&a.a.isFeatureEnabled({ODB:61883})}function Be(){return!r.b.isActivated("ffaafc6b-0bcf-4658-981a-803f441c8f1d","06/13/2024","Parsing out markdown output for SWS via library")}function je(){return!r.b.isActivated("caa3f3a0-256a-4742-af51-10ad7408d5df","06/13/2024","Parsing out markdown output for SWS via custom regex")}function Ve(){return!r.b.isActivated("aa51e166-f202-4497-be57-05dd2e8004a9","07/10/2024","Checking updated copilot feedback compliance policy")}function ze(){return!r.b.isActivated("b3324043-1391-47e0-8614-54d672f9ce23","07/10/2024","Supporting the copilot feedback form theming")}function Ge(){return!r.b.isActivated("ba1e290e-d9e1-4a5e-ab85-a83c318e2d4e","07/10/2024","Using updated compliance policy retrieval")}function Ke(){return!r.b.isActivated("afe794dc-9720-4c9a-8af1-682aff7bf60b","07/24/2024","Adding back in chat response metadata")}function We(){return!r.b.isActivated("a91366dd-367a-4251-ba20-80f8f9c376c9","07/23/2024","Using flight for shredder service")}function qe(){return r.b.isActivated("87830933-6BAB-41F0-B9C2-18FF72C8BD36","02/19/2024","Killswitch to disable SuiteNav for COB")||a.a.isFeatureEnabled({ECS:1252799})}function Qe(){return a.a.isFeatureEnabled({ODB:61570})}function Ye(){return r.b.isActivated("1675dcd1-2c70-420e-8f22-53f843cb6405","03/11/2024","Save link settings")||a.a.isFeatureEnabled({ECS:1240512})}function Je(){return r.b.isActivated("42ba9856-fb92-429a-9759-8060aeb7197d","03/08/2024","update cob strings")||a.a.isFeatureEnabled({ECS:1239782})}function Xe(){return r.b.isActivated("fca8d09b-84b0-40e9-bdf0-c4de5894c301","03/15/2024","Check if permission item exists")||a.a.isFeatureEnabled({ECS:1242231})}function Ze(){return r.b.isActivated("85AF52C5-8829-475D-A8BE-0691616A127C","03/15/2024","Set Peoplepicker AllowEmailAddress To GSI value")||a.a.isFeatureEnabled({ECS:1241903})}function $e(){return r.b.isActivated("d62a393a-8ba6-48ce-bd61-ce52e7a4597a","03/18/2024","fix People picker non mail SG not showing up for search directory")||a.a.isFeatureEnabled({ECS:1242780})}function et(){return r.b.isActivated("3d59aad1-8d63-4530-b8db-ef5288f5c3d8","03/20/2024","added RAC status codes and errors")||a.a.isECSFeatureEnabled({ECS:1243679})}function tt(){return r.b.isActivated("e7cef9af-92d2-4cfe-8c5e-7714614bb24f","03/25/2024","use direct sharing abilities to determine roles in role selector")||a.a.isFeatureEnabled({ECS:1245091})}function nt(){return r.b.isActivated("8e3e11bf-7eff-4918-9172-894fb5758f42","03/28/2024","show simplified share notification when mode is link settings")||a.a.isFeatureEnabled({ECS:1246957})}function at(){return r.b.isActivated("a2c4b5c2-b9cd-4ac9-859c-54df4ebc01be","03/31/2024","refactor external sharing to use GSI abilities")||a.a.isFeatureEnabled({ECS:1247103})}function it(){return r.b.isActivated("200f831c-197e-4c85-a49b-6bd14127e4ed","04/03/2024","Hide stop sharing for non owners")||a.a.isFeatureEnabled({ECS:1248778})}function rt(){return r.b.isActivated("6967cd22-db4f-4858-884c-3cfb8268a56b","04/03/2024","KS for fixing double owners in sites")||i.a.isFeatureEnabled({ECS:1248688})}function ot(){return r.b.isActivated("804718de-5d0f-41b8-b0cc-e61d1099fd9e","05/31/2024","KS for fixing owa post message")||i.a.isFeatureEnabled({ECS:1266954})}function st(){return i.a.isFeatureEnabled({ODB:61663})}function ct(){return r.b.isActivated("9e8ce715-6bb4-42b4-806c-ac3e4207b56c","04/11/2024","KS for rendering company wide sharing banner")||i.a.isFeatureEnabled({ECS:1251392})}function dt(){return r.b.isActivated("28149d98-4834-4d96-8379-9357c4244f2b","04/15/2023","KS to use array name to determine length of header")||i.a.isFeatureEnabled({ECS:1252731})}function lt(){return r.b.isActivated("fef14f7d-40e9-4d65-9b09-2359315d55c0","04/10/2024","KS for updating isSPO logic")||i.a.isFeatureEnabled({ECS:1251004})}function ut(){return r.b.isActivated("3e60e583-a500-4418-a926-53e94b684d93","05/07/2024","KS for using sharing role from link")||i.a.isFeatureEnabled({ECS:1259645})}function ft(){return r.b.isActivated("286e75ba-d9af-4b08-91be-16af67d4b4a7","03/21/2024","log instant load logger")||a.a.isFeatureEnabled({ECS:1244374})}function pt(){return r.b.isActivated("2853B05B-5D54-4037-94C9-B362D2B510B2","05/11/2024","handle cookie retire")||a.a.isFeatureEnabled({ECS:1261055})}function mt(){return r.b.isActivated("ab5c4674-c0bc-407d-8766-8aca378d0197","05/14/2024","add share completed")||a.a.isFeatureEnabled({ECS:1261908})}function _t(){return r.b.isActivated("ddb63db0-b4ac-450c-9a60-7a9730481a4e","07/17/2024","add copy button clicked")||a.a.isFeatureEnabled({ECS:1292358})}function ht(){return r.b.isActivated("58cfbb9e-8b61-4f01-b66e-ca40d7566b00","05/22/2024","Use custom config if customLabeledAudience is defined")||a.a.isFeatureEnabled({ECS:1264512})}function bt(){return r.b.isActivated("4afb9cae-d2ee-4bba-99b3-235ddefb13c7","06/06/2024","Show emails in COB")||a.a.isFeatureEnabled({ECS:1269292})}function gt(){return r.b.isActivated("68a90ae4-829a-417e-8518-549227a0ca16","06/12/2024","Show policy tip for existing guest")||a.a.isFeatureEnabled({ECS:1272118})}function vt(){return r.b.isActivated("e8e349d7-43ed-4aad-a7a2-4561162da784","06/21/2024","isReadingAllowedForGrantAcccess")||a.a.isFeatureEnabled({ECS:1278641})}function yt(){return r.b.isActivated("ed9e2ead-f4bd-469a-a01b-d691d8776295","06/24/2024","Fix large text buttons")||a.a.isFeatureEnabled({ECS:1279311})}function St(){return r.b.isActivated("483aee4d-5ed8-466a-96c0-27d3a33640c2","06/27/2024","change share type sent to host app")||a.a.isFeatureEnabled({ECS:1280801})}function Dt(){return r.b.isActivated("9c11822a-dd93-41ec-918b-f91d42b1a57f","07/17/2024","Provided Function Description Arial Label KS")||a.a.isFeatureEnabled({ECS:1292472})}function It(){return r.b.isActivated("406763a6-4f97-46fe-80f4-a516930030e9","07/17/2024","send sharedialog.load result to host")||a.a.isFeatureEnabled({ECS:1292822})}function xt(){return r.b.isActivated("3a1fa58d-bff7-4b1e-8646-3fbd4c15ffd4","07/25/2024","add wv2 to telemetry")||a.a.isFeatureEnabled({ECS:1301786})}function Ct(){return r.b.isActivated("c69db8ef-3482-4ed6-b904-8844226b0870","07/31/2024","fix platform detection bug in IE")||a.a.isFeatureEnabled({ECS:1392945})}function Ot(){return!r.b.isActivated("a17f4c7f-797d-4621-b6ea-2a674ce55f4d","08/12/2024","increased role selector height")&&!a.a.isFeatureEnabled({ECS:1415104})&&a.a.isFeatureEnabled({ODB:62035})}function wt(){return r.b.isActivated("69c20f8e-c76d-4f3b-a11b-1fa983dbace9","08/09/2024","update grant access message field char count and aria live")||a.a.isFeatureEnabled({ECS:1414688})}function Et(){return r.b.isActivated("ff4f62c3-61dd-4fcb-9639-ce6378f27176","08/16/2024","bypass copy to clipboard by browser")||a.a.isFeatureEnabled({ECS:1417055})}function At(){return r.b.isActivated("8765ca09-3d0c-4f45-933a-d37b6a816394","08/30/2024","Fix Persona styles in permission pivot (principal details)")||a.a.isFeatureEnabled({ECS:1421883})}function Lt(){return r.b.isActivated("3fa8ef41-badd-45d3-bc59-39fab6f5e50a")||a.a.isFeatureEnabled({ECS:1425991})}function kt(){return r.b.isActivated("e05b172d-cea3-403c-b776-47e08b3aa964")||a.a.isFeatureEnabled({ECS:1435183})}}
,,,function(e,t,n){n.d(t,{a:function(){return j},b:function(){return I},c:function(){return Me},d:function(){return x},e:function(){return Te},f:function(){return ke},g:function(){return Ue},h:function(){return Se},i:function(){return De},j:function(){return Ge},k:function(){return fe},l:function(){return se},m:function(){return Ce},n:function(){return H},o:function(){return ae},p:function(){return ne},q:function(){return xe},r:function(){return be},s:function(){return de},t:function(){return ye},u:function(){return ge},v:function(){return ue},w:function(){return Fe},x:function(){return te},y:function(){return ee},z:function(){return ve},A:function(){return re},B:function(){return ce},C:function(){return Ve},D:function(){return me},E:function(){return Ae},F:function(){return le},G:function(){return Re},H:function(){return Ee},I:function(){return Y},J:function(){return Q},K:function(){return we},L:function(){return X},M:function(){return Z},N:function(){return Pe},O:function(){return J},P:function(){return $},Q:function(){return ie},R:function(){return V},S:function(){return Ie},T:function(){return _e},U:function(){return Le},V:function(){return q},W:function(){return he},X:function(){return B},Y:function(){return ze},Z:function(){return R},_:function(){return N},$:function(){return Oe},eb:function(){return je},nb:function(){return Ne},tb:function(){return Be},ab:function(){return z},ib:function(){return K},rb:function(){return G}});var a=n(0),i=n(52),r=n(39),o=n(32),s=n(82),c=n(41),d=n(40),l=n(79),u=n(107),f=n(19),p=n(20),m=n(55),_=n(177),h=n(132),b=n(21),g=/[<>&'"\\]/g,v=/(&lt;|&gt;|&amp;|&quot;|&#39;|&#92;)/g,y={"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&#39;","\\":"&#92;"},S={"&lt;":"<","&gt;":">","&amp;":"&","&quot;":'"',"&#39;":"'","&#92;":"\\"};function D(e){return y[e]}var I,x,C=function(){function e(){}return e.encodeText=function(e){return e?e.replace(g,D):""},e.decode=function(e){return e?e.replace(v,function(e){return S[e]}):""},e}(),O=n(71),w=n(4),E=n(115),A=n(435),L=n(57),k=n(134),M=n(97),P=n(31),T=n(72),U=n(135),F=n(29),H=[p.vk,p.Be,p.wk,p.Qk,p.Ik,p.Ud,p.Ii],R=[p.Aj,p.xj,p.kj,p.Mj,p.Lj,p.gj,p.wj],N=[p.vj,p.bj,p.Dj,p.mj,p.Ij,p.Sj,p.yj,p._j,p.Ej,p.Oj,p.Cj,p.hj],B=[p.ie,p.Ed,p.Le,p.Z,p.Me,p.oe,p.re,p.cb,p.Ti,p.Rf,p.Ff,p.Ec],j="|spo-grid-all-users/";function V(){var e=new P.a(location.href);return e.getPath(!0).indexOf("/_layouts/15/sharedialog.aspx")>=0&&"true"===e.getQueryParameter("crossdomain")}function z(e,t){return W(e,t=t||26)}function G(e,t){return W(e,t=t||25)}function K(e,t){return W(e,t=t||20)}function W(e,t){if(!e)return"";var n=t,a=Math.floor(n/2);if((new F.a).isIE)return e;if(b.ab()||Array.from){var i=Array.from(e);if(i&&!b.vc()?i.length<=n:e.length<=n)return e;var r=i.slice(0,a).join(""),o=i.slice(i.length-a).join("");return"".concat(r,"...").concat(o)}return e}function q(e){return e.userRole===i.a.none&&e.defaultLinkKind===r.a.uninitialized}function Q(e,t){switch(e){case"anonymous":return t?r.a.anonymousEdit:r.a.anonymousView;case"organization":return t?r.a.organizationEdit:r.a.organizationView;case"users":return r.a.flexible;default:return r.a.direct}}function Y(e){switch(e){case"anonymous":return o.a.anyone;case"organization":return o.a.organization;case"users":return o.a.specificPeople;default:return o.a.existing}}function J(e){switch(e){case r.a.anonymousEdit:case r.a.anonymousView:return"anonymous";case r.a.organizationEdit:case r.a.organizationView:return"organization";case r.a.flexible:return"users";default:return"existingAccess"}}function X(e){switch(e){case o.a.anyone:return"anyone";case o.a.organization:return"organization";case o.a.specificPeople:case o.a.specificPeopleFlex:case o.a.customLabeledSpecificPeople:return"specificPeople";case o.a.existing:default:return"existingAccess"}}function Z(e){switch(e){case o.a.anyone:return s.a.anyone;case o.a.organization:return s.a.organization;case o.a.specificPeople:case o.a.specificPeopleFlex:case o.a.customLabeledSpecificPeople:return s.a.specificPeople;case o.a.existing:default:return s.a.existing}}function $(e){switch(e){case 1:return"created";case 2:return"updated";default:return"uninitialized"}}function ee(e,t,n){var a=t.sharingLinkKind,i=t.audience,s=window.require?window.require.toUrl("odsp-media/images/sharedialog"):"https://res-1.cdn.office.net/files/fabric-cdn-prod_20240610.001/assets/icons/sharing",c=m.k(e)?"directrecipients.svg":"peopleinchat.svg";switch(a){case r.a.organizationView:case r.a.organizationEdit:return"".concat(s,"/companyonly.svg");case r.a.anonymousView:case r.a.anonymousEdit:return"".concat(s,"/anyone.svg");case r.a.flexible:return t.audience===o.a.customLabeledSpecificPeople?n&&n.iconUrl||"".concat(s,"/").concat(c):"".concat(s,"/specificpeople.svg");default:return i===o.a.customLabeledSpecificPeople?n&&n.iconUrl||"".concat(s,"/").concat(c):window.require?"".concat(s,"/existingaccess.svg"):"".concat(s,"/existingaccess.svg?v2")}}function te(e){if(e.isCreateOnlyLink)return"FileRequest";if(e.isAddressBarLink)return"Favicon";switch(e.sharingLinkKind){case r.a.requestAccess:return"Mail";case r.a.organizationView:case r.a.organizationEdit:return"Work";case r.a.anonymousView:case r.a.anonymousEdit:return"Globe";case r.a.flexible:return e.audience===o.a.anyone?"Globe":e.audience===o.a.organization?"Work":"AddFriend";default:return"Link"}}function ne(){return{palette:{themeName:"ODB Dark Mode",themeDescription:"ODB dark mode",themePrimary:"#3AA0F3",themeLighterAlt:"#092c47",themeLighter:"#043862",themeLight:"#004c87",themeTertiary:"#0078D4",themeSecondary:"#0078d4",themeDarkAlt:"#6CB8F6",themeDarker:"#82c7ff",themeDark:"#82C7FF",neutralLighterAlt:"#292827",neutralLighter:"#323130",neutralLight:"#3B3A39",neutralQuaternaryAlt:"#484644",neutralQuaternary:"#3b3a39",neutralTertiaryAlt:"#484644",neutralTertiary:"#797775",neutralSecondaryAlt:"#979693",neutralSecondary:"#a19f9d",neutralPrimary:"#f3f2f1",neutralPrimaryAlt:"#c8c6c4",neutralDark:"#faf9f8",black:"#ffffff",white:"#252423",redDark:"#F1707B",primaryBackground:"#1b1a19",primaryText:"#f3f2f1",whiteTranslucent40:"rgba(0,0,0,.5)",freOverlayColor:"rgba(0,0,0,.5)",shareSuccessIcon:"#92C353",wordColor:"#296FE6",powerpointColor:"#CA5010",excelColor:"#10893C",excelPrimaryColor:"#10893C",excelShade10Color:"#0F7937",excelShade20Color:"#0A5325",powerpointPrimaryColor:"#CA5010",powerpointShade10Color:"#B1470E",powerpointShade20Color:"#79310A",wordPrimaryColor:"#296FE6",wordShade10Color:"#2461CA",wordShade20Color:"#19428A",wordIconColor:"#598FEC",powerpointIconColor:"#D67540",excelIconColor:"#37A660",visoIconColor:"#598FEC",oneNoteIconColor:"#D0AFE2",oneUpPaneBackground:"rgba(27, 26, 25, .75)"},semanticColors:{bodyBackground:"#1b1a19",bodyStandoutBackground:"#3B3A39",buttonText:"#ffffff",buttonTextPressed:"#faf9f8",buttonTextHovered:"#f3f2f1",bodySubtext:"#a19f9d",disabledBackground:"#484644",errorText:"#F1707B",inputBackgroundChecked:"#3AA0F3",menuBackground:"#323130",menuItemBackgroundHovered:"#484644",menuItemBackgroundPressed:"#3b3a39",menuDivider:"#484644",menuIcon:"#6CB8F6",menuHeader:"#ffffff",menuItemText:"#f3f2f1",menuItemTextHovered:"#faf9f8",messageText:"#f3f2f1",primaryButtonBackground:"#0078D4",primaryButtonBackgroundHovered:"#004c87",primaryButtonBackgroundPressed:"#043862",primaryButtonText:"#ffffff",primaryButtonTextHovered:"#ffffff",primaryButtonTextPressed:"#ffffff",primaryButtonTextDisabled:"#605e5c",variantBorder:"#3b3a39",infoBackground:"#323130",infoIcon:"#c8c6c4",errorIcon:"#F1707B",warningIcon:"#c8c6c4",blockingIcon:"#442726",severeWarningIcon:"#FCE100",successIcon:"#92C353",errorBackground:"#442726",blockingBackground:"#442726",warningBackground:"#433519",severeWarningBackground:"#4F2A0F",successBackground:"#393D1B"}}}function ae(e,t,n,a){var i=m.k(e);switch(n&&n.audienceType||i&&"recipient"){case"channel":switch(t){case"edit":return p.Dg;case"review":return _.a[a]?p.Ig:p.xg;default:return p.Cg}case"team":switch(t){case"edit":return p.Lg;case"review":return _.a[a]?p.kg:p.Mg;default:return p.Pg}case"recipient":switch(t){case"edit":return p.Qh;case"review":return _.a[a]?p.Yh:p.Jh;default:return p.Xh}default:switch(t){case"edit":return p.Og;case"review":return _.a[a]?p.wg:p.Eg;default:return p.Ag}}}function ie(){var e=window.require&&window.require.toUrl("plt.resx-plt.js"),t=e&&e.split("/"),n=t&&t.length>2&&t[t.length-2];return n&&1===["ar","arc","dv","he","nqo","fa","ps","sd","syr","ur","yi","ji"].filter(function(e){return n===e}).length}function re(e){var t=e.sharingLink,n=e.companyName,a=e.clientId,i=e.isListSharing,s=e.customLabeledAudienceConfig,c=e.fileExtension,d=e.isAccessSummaryLink,l=e.isFolder,u=t.sharingLinkKind,m=t.audience;if(t.isAddressBarLink)return p.B;if(t.isCreateOnlyLink)return!t.allowsAnonymousAccess&&n?f.d(l?p.Ad:p.yi,n):l?p.Ld:p.yi;if(d)return p.g;switch(u){case r.a.requestAccess:var h=t.invitees[0],b=h.primaryText||h.email||h.id;return f.d(p.di,b);case r.a.organizationView:return f.d(p.Sc,n);case r.a.organizationEdit:return f.d(p._c,n);case r.a.anonymousView:return p.T;case r.a.anonymousEdit:return p.J;case r.a.direct:return m===o.a.customLabeledSpecificPeople?t.isReview?s&&s.entityName?f.d(p.Oc,s.entityName):ae(a,"review",s,c):t.isEdit?s&&s.entityName?f.d(p.xc,s.entityName):ae(a,"edit",s):s&&s.entityName?f.d(p.wc,s.entityName):ae(a,"view",s):p.ad;case r.a.flexible:return m===o.a.existing?p.ad:m===o.a.anyone?t.blockDownload?t.hasPassword?p.V:p.U:t.hasPassword?t.isReview?_.a[c]?p.P:p.Q:t.isEdit?p.O:p.R:t.isManageList?p.K:t.isReview?_.a[c]?p.N:p.S:t.isEdit?i?p.L:p.J:p.T:m===o.a.customLabeledSpecificPeople?t.isManageList?s&&s.entityName?f.d(p.Cc,s.entityName):ae(a,"edit",s):t.isReview?s&&s.entityName?f.d(p.Oc,s.entityName):ae(a,"review",s,c):t.isEdit?s&&s.entityName?f.d(i?p.Cc:p.xc,s.entityName):ae(a,"edit",s):s&&s.entityName?f.d(p.wc,s.entityName):ae(a,"view",s):t.audience===o.a.organization?t.blockDownload?f.d(p.Dc,n):t.isManageList?f.d(p.hc,n):t.isReview?_.a[c]?f.d(p.vc,n):f.d(p.yc,n):t.isEdit?f.d(i?p.bc:p._c,n):f.d(p.Sc,n):t.blockDownload?p.Jj:t.isManageList?p.Gj:t.isReview?_.a[c]?p.kh:p.Mh:t.isEdit?i?p.Kj:p.zj:p.Yj;default:return""}}function oe(e){return{principalId:e.id,name:e.primaryText,image:e.imageUrl,isResolved:!0,principalName:e.loginName,userId:e.loginName,email:e.email,job:e.secondaryText,isExternal:e.isExternal,principalType:e.type}}function se(e){return{id:e.principalId,primaryText:e.name,imageUrl:e.image,loginName:e.userId,email:e.email,secondaryText:e.job,isExternal:e.isExternal,type:e.principalType}}function ce(e){for(var t=[],n=e.principals,a=e.invitees,i=0,r=n;i<r.length;i++){var o=r[i];t.push(oe(o))}for(var s=function(e){0===(!0===e.isExternal?t.filter(function(t){return t.email===e.email}):t.filter(function(t){return t.principalName===e.loginName})).length&&t.push(oe(e))},c=0,d=a;c<d.length;c++)s(d[c]);return t}function de(e){if(!e)return 0;var t=0,n=e.length,a=0,i=!1;if(0===e.length)return 0;for(;a<n;){var r=null,o=e[a];" "===o?r=a+1<n&&" "===e[a+1]||i?"&#160;":" ":"\n"===o?(r="<br />",i=!0):('"'===o?r="&quot;&quot;&quot;":"&"===o?r="&amp;":"'"===o?r="&#39;":"<"===o?r="&lt;":">"===o?r="&gt;":"\r"===o&&(r=" "),i=!1),t+=null!==r?r.length:1,a++}return t}function le(e,t,n,a){var r,o;switch(e){case i.a.manageList:r="EditListPencil",o=p.hb;break;case i.a.edit:r="Edit",o=t?p.bb:p.yb;break;case i.a.view:r="View",o=p.kb;break;case i.a.review:r="Feedback",o=p.Cb;break;case i.a.owner:r="Signin",o=p.Hd;break;case i.a.restrictedview:r="BlockDownloadIcon",o=p.Eb;break;case i.a.submit:r="FileRequest",o=a?p.Ob:p.Ib;break;case i.a.none:r="Delete",o=p.Vc}return{name:r,title:n?o.toLowerCase():o}}function ue(e){var t=i.a.none,n=pe(),a=e.accessMap;return null==a||a.forEach(function(e){var a=me(e);n.indexOf(a)>n.indexOf(t)&&(t=a)}),t}function fe(e,t,n){void 0===n&&(n=x.GREATERTHAN_OREQUAL);var a=pe();switch(n){case x.GREATERTHAN:return a.indexOf(e)>a.indexOf(t);case x.GREATERTHAN_OREQUAL:default:return a.indexOf(e)>=a.indexOf(t)}}function pe(){return[i.a.none,i.a.submit,i.a.restrictedview,i.a.view,i.a.review,i.a.edit,i.a.manageList,i.a.owner]}function me(e){var t=e.role,n=e.rawPermission;if(e.isSPO);else if(b.x()||n){if(n.roles){t=i.a.view;for(var a=0,r=n.roles;a<r.length;a++)"write"===r[a]&&(t=i.a.edit)}n.link&&n.link.type&&("edit"===n.link.type?t=i.a.edit:"view"===n.link.type&&(t=i.a.view))}return t}function _e(e){return e===i.a.edit||(0,b.Ib)()&&e===i.a.manageList}function he(e){return(0,b.ib)()&&e===o.a.specificPeople||e===o.a.specificPeopleFlex}function be(e,t){var n=(0,b.Ib)()&&m.d(e)&&(null==t?void 0:t.sharedObjectType)===h.a.list,a=(null==t?void 0:t.sharedObjectType)===h.a.list&&(t.userRole===i.a.manageList||t.userRole===i.a.owner);return n||a?i.a.manageList:i.a.edit}function ge(e,t){var n=I.none,a=t;if(!e||e.getTime()===new Date(0).getTime())return n;var i=new Date;i.setHours(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds());var r=Math.floor((e.getTime()-i.getTime())/864e5);return r<1?n=I.pastDate:r>730?n=I.overMax:r>a&&-1!==a&&(n=I.adminPolicy),n}function ve(e,t){return e===o.a.anyone?t?r.a.anonymousEdit:r.a.anonymousView:e===o.a.organization?t?r.a.organizationEdit:r.a.organizationView:e===o.a.specificPeople||e===o.a.existing?r.a.direct:r.a.flexible}function ye(e,t){switch(e){case I.pastDate:return p.yg;case I.adminPolicy:return f.d(p.D,t);case I.overMax:return f.d(p.ke,730);case I.adminRequired:return p._i;default:return""}}function Se(e){return e.canAddExternalPrincipal||e.canAddInternalPrincipal}function De(e){return!!(e&&e.organizationLinkAbilities&&e.organizationLinkAbilities.canManageReadLink)&&e.organizationLinkAbilities.canManageReadLink.enabled}function Ie(e,t,n){return m.k(e)||t===c.a.linkSettings&&m.m(e)&&n&&(!!n.entityName||!!n.audienceType)}function xe(e){var t=e;if(-1===t)return null;var n=new Date;return n.setDate(n.getDate()+t),n}function Ce(e){var t,n;return(0,a.b)(this,void 0,void 0,function(){var i,r,o,s,l,u,f,p,_,h,g,v,y,S,D,I,x;return(0,a.e)(this,function(k){switch(k.label){case 0:if((0,M.a)())return window.sessionStorage.setItem("copiedLink",(null===(t=e.textField)||void 0===t?void 0:t.value)||e.linkUrl),[2,!0];if(i=!1,r=!b.t()&&e.bypassBrowserCopyToClipboard,m.g(e.clientId)||r)return[3,8];o=null,s=new w.a({name:"shareLinkCopyFromBrowser"}),l=new w.a({name:"shareLinkExecCopyCommandToClipboard"}),u=e.textField,(0,b.T)()&&!u&&((u=document.createElement("textarea")).textContent=e.linkUrl,u.style.top="0",u.style.left="0",u.style.position="absolute",u.style.opacity="0",document.body.appendChild(u));try{u.focus(),u.setSelectionRange(0,u.value.length),i=document.execCommand("copy"),l.end({resultType:w.b.Success})}catch(e){o=e,D=new L.a({code:"exeCopyCommandError",innerError:e}),l.end((0,A.a)((0,E.a)(e),{resultCode:D.code}))}if(!window.navigator||!window.navigator.clipboard)return[3,7];f=new w.a({name:"shareLinkClipboardWrite"}),k.label=1;case 1:return k.trys.push([1,6,,7]),"write"in window.navigator.clipboard&&e.itemName?(p=(null==u?void 0:u.value)||e.linkUrl,_="text/plain",h="text/html",g=new Blob([p],{type:_}),v=new Blob(["<a href=".concat(p,">").concat(C.encodeText(e.itemName),"</a>")],{type:h}),y=[new ClipboardItem((x={},x[_]=g,x[h]=v,x))],[4,window.navigator.clipboard.write(y)]):[3,3];case 2:return k.sent(),[3,5];case 3:return[4,window.navigator.clipboard.writeText((null==u?void 0:u.value)||e.linkUrl)];case 4:k.sent(),k.label=5;case 5:return i=!0,f.end({resultType:w.b.Success}),[3,7];case 6:return S=k.sent(),o=S,D=new L.a({code:"clipboardWriteError",innerError:S}),f.end((0,A.a)((0,E.a)(S),{resultCode:D.code})),[3,7];case 7:(0,b.T)()&&!e.textField&&document.body.removeChild(u),I={resultType:w.b.Success},i||(I=(0,A.a)((0,E.a)(o),{resultCode:(null==o?void 0:o.code)||"copyFromBrowserError"})),I.extraData=(0,a.a)((0,a.a)((0,a.a)({},I.extraData),e.extraQosData),{clientId:d.a[e.clientId],mode:c.a[null===(n=e.extraQosData)||void 0===n?void 0:n.mode],isCrossDomainSharePointHosted:V()}),s.end(I),k.label=8;case 8:try{i=(0,b.$b)()?(0,O.d)(e.linkUrl)||i:(0,O.d)(e.linkUrl)}catch(e){}return[2,i]}})})}function Oe(e,t){return e&&e.toLowerCase().indexOf("/_layouts/15/userphoto.aspx")>=0&&location.href.toLowerCase().indexOf("sharedialog.aspx")<0&&(m.i(t)||m.p(t))}function we(e,t,n){return T.c()&&e.isCreateOnlyLink?i.a.submit:e.isManageList?i.a.manageList:e.isEdit?be(t,n):e.isReview?i.a.review:e.blockDownload?i.a.restrictedview:i.a.view}function Ee(e,t){var n=e.sharingLinks,a=e.sharingPrincipals,o=t?n:n.filter(function(e){var t=new Date(e.expiration);return e.isActive&&e.sharingLinkKind!==r.a.direct&&(!e.expiration||t.getTime()>Date.now())&&(!e.isAddressBarLink||e.isAddressBarLink&&e.principals.length>0)&&!0!==e.isUnhealthy}),s=!!o.length;if(!s&&a.length)for(var c=0,d=a;c<d.length;c++)if(d[c].role!==i.a.owner){s=!0;break}return{shared:s,activeLinks:o,sharingPrincipals:a}}function Ae(e){var t;switch(e){case l.a.user:t="user";break;case l.a.none:t="none";break;default:t="group"}return t}function Le(e){var t=new Date(null),n=new Date(0),a=e instanceof Date&&!isNaN(e.getTime()),i=!1;if(a)try{var r=new Date(e),o=r.getFullYear&&r.getFullYear();0!==o&&1!==o||(i=!0)}catch(e){}return!e||e===t||e===n||i||!a}!function(e){e[e.none=0]="none",e[e.pastDate=1]="pastDate",e[e.adminPolicy=2]="adminPolicy",e[e.overMax=3]="overMax",e[e.adminRequired=4]="adminRequired"}(I||(I={})),function(e){e[e.GREATERTHAN=0]="GREATERTHAN",e[e.GREATERTHAN_OREQUAL=1]="GREATERTHAN_OREQUAL"}(x||(x={}));var ke,Me,Pe=function(e,t,n){if(n){var a=n.expiration,i=n.hasPassword,r=(n.preventDownload,[]);return a&&a.getTime()!==new Date(0).getTime()&&r.push({icon:"Calendar",tooltip:"".concat(f.d(p.md,(0,k.d)(a)))}),i&&r.push({icon:"Lock",tooltip:p.Ki}),n.audience!==o.a.existing&&n.isReview&&_.a[t.fileExtension]&&r.push({icon:"Feedback",tooltip:p.Nf}),n.audience===o.a.anyone&&n.trackLinkUsers&&r.push({icon:"ReminderPerson",tooltip:m.d(e)?p.hi:p.gi}),r}},Te=340,Ue=480,Fe=function(e){var t=e.clientId,n=e.companyName,a=e.currentSettings,s=e.customLabeledAudienceConfig,c=e.sharingInformation,d=e.sharingStore;if(!a||!c)return"";if((null==n?void 0:n.length)>p.Vb.length&&(n=p.Vb),("video"===(0,U.a)(c.fileExtension)||Be(t,d))&&a.sharingRole===i.a.restrictedview||a.preventDownload){if(a.audience===o.a.anyone)return p.U;if(a.audience===o.a.organization)return f.d(p.Dc,n);if(a.audience===o.a.specificPeopleFlex)return p.Jj;if(a.preventDownload&&a.sharingRole===i.a.restrictedview&&a.audience===o.a.specificPeople)return p.oi}switch(a.sharingLinkKind){case r.a.direct:return a.audience===o.a.specificPeople?c.requiresAccessApproval?p.oi:a.sharingRole?_e(a.sharingRole)?p.zj:a.sharingRole===i.a.review?_.a[c.fileExtension]?p.qj:p.Qj:p.Yj:a.isEdit?p.zj:p.Yj:p.ad;case r.a.organizationView:return f.d(p.Sc,n);case r.a.organizationEdit:return f.d(p._c,n);case r.a.anonymousView:return p.T;case r.a.anonymousEdit:return p.J;case r.a.flexible:return He(t,n,a,s,c);default:return""}},He=function(e,t,n,a,r){return n.audience===o.a.existing?p.ad:n.audience===o.a.specificPeopleFlex?n.sharingRole?n.sharingRole==i.a.manageList?p.Wj:_e(n.sharingRole)?p.zj:n.sharingRole===i.a.review?_.a[r.fileExtension]?p.qj:p.Qj:p.Yj:n.isEdit?p.zj:p.Yj:n.audience===o.a.customLabeledSpecificPeople?n.sharingRole===i.a.review?a&&a.entityName?f.d(p.Oc,a.entityName):ae(e,"review",a,r.fileExtension):n.isEdit?a&&a.entityName?f.d(p.xc,a.entityName):ae(e,"edit",a):a&&a.entityName?f.d(p.wc,a.entityName):ae(e,"view",a):n.audience===o.a.organization?n.sharingRole===i.a.review?_.a[r.fileExtension]?f.d(p.vc,t):f.d(p.yc,t):n.sharingRole==i.a.manageList?f.d(p.gc,t):n.isEdit?f.d(p._c,t):f.d(p.Sc,t):n.audience===o.a.anyone?n.sharingRole===i.a.review?_.a[r.fileExtension]?p.N:p.S:n.sharingRole==i.a.manageList?p.M:n.isEdit?p.J:p.T:""};function Re(e){switch(e){case i.a.review:return p.Si;case i.a.edit:case i.a.manageList:return p.Yc}return p.Kk}function Ne(e,t){return t&&t.isCOB&&t.isCOB()}function Be(e,t){return t&&!b.tc()&&!t.isConsumer()&&!(!(0,b.hc)()&&e===d.a.sharePointPages)&&!m.d(e)&&!t.isCOB()}function je(e){var t=e.userRole===i.a.owner||e.userRole===i.a.edit;return b.F()&&!b.G()&&t&&e.discoverableByOrganizationEnabled}function Ve(e,t,n){var a=e.url;if(t!==u.a.copy&&t!==u.a.outlook)return a;var i=function(){var e=new Uint8Array(6);(window.crypto||window.msCrypto).getRandomValues(e);for(var t=[],n=0;n<e.length;n++)t.push("abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"[e[n]%62]);return t.join("")}(),r=new P.a(a);(0,M.a)()||r.setQueryParameter("e",i);var o=n.getNavId();o&&r.setQueryParameter("nav",o);var s=n.getInvitationId();return s&&r.setQueryParameter("inviteid",s),r.toString()}function ze(e){if(e){if(e.indexOf("The invited user already exists in the directory as object ID")>=0){var t=e.indexOf("ID");return e.substring(0,t+"ID".length)}if(e.indexOf("Couldn't resolve user")>=0)return t=e.indexOf("user"),e.substring(0,t+"user".length)}return e}function Ge(e){return"loop"===e||"fluid"===e}!function(e){e[e.none=0]="none",e[e.send=1]="send",e[e.copy=2]="copy"}(ke||(ke={})),function(e){e.unseen="unseen",e.seeing="seeing",e.dismissed="dismissed"}(Me||(Me={}))}
,,,,function(e,t,n){n.d(t,{a:function(){return s}});var a=n(0),i=n(49);function r(e,t){return new this(e,i.b.Single,t)}function o(e){return new this(null,i.b.Single,e)}function s(e,t,n){var s=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return(0,a.d)(n,e),n.logData=t?r:o,n}(i.c);return(0,i.d)(s.prototype,e,t||{},n),s}}
,function(e,t,n){n.d(t,{a:function(){return i}});var a=n(0),i=function(e){var t="undefined"!=typeof window?window:"undefined"!=typeof self?self:void 0;e||(e=t&&t.navigator&&navigator.userAgent||"");var n,i=e,r=e.toLowerCase(),o=function(e){var t;function n(n){return t=RegExp("".concat(n,"(\\d+)([\\d.]*)")).exec(e)}e=e.toLowerCase();var a=n("msie ")||n("trident.*rv:"),i=t&&"9"===t[1],r=!t&&n("(?:edge|edgios)/"),o=!t&&n("edg/"),s=!t&&n("fxios|firefox/"),c=!t&&n("(?:chrome|crios)/"),d=!t&&/safari\/(\d+)/.test(e);d&&n("version/");var l=!t&&/compatible; [a-z]+;/.test(e);return l&&n("trident/"),{browserName:a||l?"IE":r?"Edge":o?"EdgeChromium":s?"Firefox":c?"Chrome":d?"Safari":"NA",isChrome:!!c,isEdge:!!r,isEdgeChromium:!!o,isFirefox:!!s,isIE:!!a||!!l,isIE9:!!i,isSafari:!!d,matchedBrowser:t}}(r),s={browserMajor:(n=o.matchedBrowser)&&parseInt(n[1],10)||0,browserMinor:n&&n[2]&&n[2].slice(1)||"0"},c=function(e){e=e.toLowerCase();var t=/windows phone|wpdesktop/.test(e),n=t||/ipad|iphone|ipod|android/.exec(e),a=n&&n[0],i="android"===a,r="ipad"===a,o=!!a&&!i,s=!n&&e.indexOf("macintosh")>-1,c=!n&&e.indexOf("windows nt")>-1;return{isAndroid:i,isIOS:o,isIPad:r,isMac:s,isWindows:c,isWinPhone:!!t,isMobile:!!n,osName:c?"Windows":t?"Windows Phone":s?"OSX":o?"IOS":i?"Android":"NA"}}(r),d=c.isMobile,l=/electron\/\\d+[\\d.]*/.test(r),u=r.indexOf("winappwipenabled")>-1,f=!("undefined"==typeof window||!window.matchMedia)&&(window.matchMedia("(display-mode: standalone)").matches||window.matchMedia("(display-mode: minimal-ui)").matches),p=/[\s\(](os|os x|windows (?:phone|nt)|android) ([\d._]+)/.exec(r),m=!1,_=!1,h=!1,b=!1;if(t&&t.document){var g=document.createElement("style");g.type="text/css",m=!g.styleSheet,_="addBehavior"in HTMLDivElement.prototype;var v=document.createElement("input");v.type="file";var y=t.File,S=y&&y.prototype;b=!(!S||!(S.slice||S.mozSlice||S.webkitSlice)),h="webkitdirectory"in v&&!l}return(0,a.a)((0,a.a)((0,a.a)((0,a.a)({},o),s),c),{isElectron:l,osVersion:p?p[2]:"NA",isWindows81:!d&&/windows (?:8\.1|nt 6\.3)/.test(r),isWindows10:!d&&r.indexOf("windows nt 10")>-1,isWindows7:!d&&r.indexOf("windows nt 6.1")>-1,isWinAppWipEnabled:u,isPWA:f,areCSS3TransitionsSupported:!o.isIE||s.browserMajor>9,areTouchEventsSupported:!!t&&"ontouchstart"in t,isFolderUploadSupported:h,isHtml5FileUploadSupported:b,isRetinaSupported:!!t&&t.devicePixelRatio>1,isUnlimitedStyleSheetsSupported:m,isWebDavSupported:_,userAgent:i})}}
,function(e,t,n){var a,i,r,o,s,c,d=n(240),l=!1;function u(){var e;a=window.PageContext;var t=window.Flight;i=t&&t.Ramps,r=window.FilesConfig;var n=window.Flighting,d=window._spPageContextInfo;c=null===(e=window.Flight)||void 0===e?void 0:e.ecsRolloutsEnabled,!o&&d&&(!d.ExpFeatures&&n&&n.ExpFeatures&&(d.ExpFeatures=n.ExpFeatures),f.initSPExpFeatures(d.ExpFeatures)),!s&&d&&(null==d?void 0:d.ECSExpFeatures)&&f.initSPECSExpFeatures(d.ECSExpFeatures),l=!0}var f=function(){function e(){}return e.initSPExpFeatures=function(e){o=e},e.initSPECSExpFeatures=function(e){s={ClientFeatures:new Set(null!=e?e:[])}},e.isFeatureEnabled=function(e){l||u();var t=!!e.Fallback,n=e.ODB,f=e.ODC,p=e.ECS,m=e.OneDrive,_=e.ODBECS;return void 0!==n&&o&&(t=(0,d.b)(e,o)),void 0!==f&&r&&("boolean"==typeof f?t=f:(i&&i[f]||r&&r[f])&&(t=!0)),void 0!==p&&c&&c.indexOf(p)>=0&&(t=!0),void 0!==m&&a&&(t=m),void 0!==_&&s&&(t=(0,d.a)(e,s)),t},e.On={Fallback:!0},e.Off={},e}();t.a=f}
,function(e,t,n){n.d(t,{a:function(){return d}});var a,i=n(245),r=n(19);!function(e){e[e.scheme=0]="scheme",e[e.authority=1]="authority",e[e.path=2]="path",e[e.query=3]="query"}(a||(a={}));var o=/[;\/?:@&=$,]/,s=/[\/?]/;function c(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n.toLowerCase()]=e[n].toLowerCase());return t}var d=function(){function e(e,t){this._scheme="",this._user="",this._host="",this._port="",this._path="",this._pathSegments=[],this._pathEncoded="",this._query={},this._fragment="",t&&(this._queryCaseInsensitive=!!t.queryCaseInsensitive,this._pathCaseInsensitive=!!t.pathCaseInsensitive),this._parseURI(e)}return e.concatenate=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var a="",i=0;i<t.length;i++){var r=t[i];i>0&&(r=e.ensureNoPrecedingSlash(r)),i<t.length-1&&(r=e.ensureTrailingSlash(r)),a+=r}return a},e.ensureNoPrecedingSlash=function(e){return"/"===e[0]?e.substr(1):e},e.ensureTrailingSlash=function(e){return"/"!==e[e.length-1]?e+"/":e},e.prototype.getScheme=function(){return this._scheme},e.prototype.setScheme=function(e){this._scheme=e},e.prototype.getAuthority=function(){return this._getAuthority(!1)},e.prototype.setAuthority=function(e){this._parseAuthority(e)},e.prototype.getUser=function(){return this._user},e.prototype.getHost=function(){return this._host},e.prototype.getPort=function(){return this._port},e.prototype.getPath=function(e){var t=this._path;return e&&null!==t&&t.lastIndexOf("/")===t.length-1&&(t=t.slice(0,-1)),t},e.prototype.getLeftPart=function(e){var t=this._scheme+"://";return e===a.authority&&(t+=this.getAuthority()),e===a.path&&(t+=this.getPath()),e===a.query&&(t+=this.getQuery()),t},e.prototype.setPath=function(e){"mailto"!==this.getScheme().toLowerCase()&&e&&"/"!==e[0]&&(e="/"+e),this._parsePath(e)},e.prototype.getPathSegments=function(){return this._pathSegments},e.prototype.getLastPathSegment=function(){var e=this._pathSegments;return e[e.length-1]||""},e.prototype.getQuery=function(e){return this._serializeQuery(e)},e.prototype.setQuery=function(e){this.setQueryFromObject(this._deserializeQuery(e))},e.prototype.getQueryAsObject=function(){return this._query},e.prototype.setQueryFromObject=function(e){for(var t in this._query={},e)e.hasOwnProperty(t)&&this.setQueryParameter(t,e[t])},e.prototype.getQueryParameter=function(e){var t=null,n=this._query;if(this._queryCaseInsensitive)for(var a in e=e.toLowerCase(),n)n.hasOwnProperty(a)&&a.toLowerCase()===e&&(t=n[a]);else t=n[e];return t||null},e.prototype.setQueryParameter=function(e,t,n){void 0===n&&(n=!0);var a=this._decodeQueryString(t);(a||n)&&(this._query[this._decodeQueryString(e)]=a)},e.prototype.removeQueryParameter=function(e){delete this._query[this._decodeQueryString(e)]},e.prototype.getFragment=function(){return this._fragment},e.prototype.setFragment=function(e){"#"===e[0]&&(e=e.substring(1)),this._fragment=this._decodeQueryString(e)},e.prototype.equals=function(e){return(0,r.b)(this._scheme,e.getScheme())&&this._user===e.getUser()&&(0,r.b)(this._host,e.getHost())&&this._port===e.getPort()&&this._fragment===e.getFragment()&&this._equalsCaseAppropriate(this.getPath(!0),e.getPath(!0),this._pathCaseInsensitive)&&this._equalsCaseAppropriate(this.getQuery(),e.getQuery(),this._queryCaseInsensitive)},e.prototype.equivalent=function(e){return(0,r.b)(this._scheme,e.getScheme())&&(0,r.b)(this._user,e.getUser())&&(0,r.b)(this._host,e.getHost())&&(0,r.b)(this._port,e.getPort())&&(0,r.b)(this.getPath(!0),e.getPath(!0))&&(0,i.a)(c(this.getQueryAsObject()),c(e.getQueryAsObject()))&&(0,r.b)(this._fragment,e.getFragment())},e.prototype.toString=function(e){return this._getStringInternal(!0,e)},e.prototype.getDecodedStringForDisplay=function(){return this._getStringInternal(!1)},e.prototype.getStringWithoutQueryAndFragment=function(){return this._getStringWithoutQueryAndFragmentInternal(!0)},e.prototype._equalsCaseAppropriate=function(e,t,n){return n?(0,r.b)(e,t):e===t},e.prototype._getStringInternal=function(e,t){var n=this._getStringWithoutQueryAndFragmentInternal(e,t),a=this.getQuery(e);return a&&(n+="?"+a),this._fragment&&(n+="#"+(e?encodeURIComponent(this._fragment):this._fragment)),n},e.prototype._getStringWithoutQueryAndFragmentInternal=function(e,t){var n="";this._scheme&&(n+=(e?encodeURIComponent(this._scheme):this._scheme)+":");var a=this._getAuthority(e,t);return a&&(n+="//"+a),this._pathEncoded&&(n+=e?this._pathEncoded:this._path),n},e.prototype._deserializeQuery=function(e){var t={};0===e.indexOf("?")&&(e=e.substring(1));for(var n=0,a=e.split(/[;&]+/);n<a.length;n++){var i=a[n],r=i.indexOf("=");r<0&&(r=i.length),r>0&&(t[i.substr(0,r)]=i.substr(r+1))}return t},e.prototype._serializeQuery=function(e){var t="";for(var n in this._query)if(this._query.hasOwnProperty(n)){var a=n,i=this._query[n];e&&(a=encodeURIComponent(a),i=encodeURIComponent(i)),t+=null===i||""===i?a+"=&":a+"="+i+"&"}return""!==t&&(t=t.slice(0,-1)),t},e.prototype._parseURI=function(e){var t=e,n=t.indexOf("#");if(n>=0){var a=t.substring(n+1);this.setFragment(a),t=t.substring(0,n)}var i=t.search(o);if(i>=0){":"===t[i]&&(this.setScheme(t.substring(0,i)),t=t.substring(i+1));var r="";if(0===t.indexOf("//")){var c=(t=t.substring(2)).search(s);if(c>=0?(r=t.substring(0,c),t=t.substring(c)):(r=t,t=""),this.setAuthority(r),!t)return void this.setPath("")}var d=t.indexOf("?");d>=0&&(this.setQuery(t.substring(d+1)),t=t.substring(0,d)),this.setPath(t)}else this.setPath(t)},e.prototype._parseAuthority=function(e){this._host=e;var t=e.lastIndexOf("@");t>=0&&(this._host=this._host.substring(t+1));var n=this._host.indexOf(":");if(!(t<0&&n<0)){var a=e;t<0?this._host=a:(this._user=a.substring(0,t),this._host=a.substring(t+1)),n>=0&&(this._port=this._host.substring(n+1),this._host=this._host.substring(0,n)),this._user=decodeURIComponent(this._user),this._host=decodeURIComponent(this._host)}},e.prototype._parsePath=function(e){try{this._path=decodeURIComponent(e)}catch(t){this._path=e}var t=this._pathSegments=[];this._pathEncoded=e;for(var n=e.split("/"),a=0;a<n.length;++a)try{t[a]=decodeURIComponent(n[a])}catch(e){t[a]=n[a]}""===t[0]&&t.shift(),""===t[t.length-1]&&t.pop()},e.prototype._getAuthority=function(e,t){void 0===t&&(t={});var n,a,i,r=t&&t.doNotPercentEncodeHost,o="";return e?(n=encodeURIComponent(this._user).replace("%3A",":"),a=r?this._host:encodeURIComponent(this._host),i=encodeURIComponent(this._port)):(n=this._user,a=this._host,i=this._port),""!==n&&(o=n+"@"),""!==this._host&&(o+=a),""!==this._port&&(o+=":"+i),o},e.prototype._decodeQueryString=function(e){var t=e;try{t=decodeURIComponent(e.replace(/\+/g," "))}catch(e){}return t},e}()}
,function(e,t){var n;!function(e){e[e.specificPeople=0]="specificPeople",e[e.organization=1]="organization",e[e.anyone=2]="anyone",e[e.existing=3]="existing",e[e.specificPeopleFlex=4]="specificPeopleFlex",e[e.customLabeledSpecificPeople=5]="customLabeledSpecificPeople",e[e.direct=6]="direct"}(n||(n={})),t.a=n}
,,function(e,t,n){n.d(t,{a:function(){return a}});var a={FluentUIV9ShimOverallControl:60077,FluentUIV9ShimDefaultButton:60337,FluentUIV9ShimPrimaryButton:60344,FluentUIV9ShimIconButton:60355,FluentUIV9ShimActionButton:60356,FluentUIV9ShimImage:60357,FluentUIV9ShimToggle:60461,FluentUIV9ShimCommandBarButton:60466,FluentUIV9ShimCommandBar:60480,FluentUIV9ShimCommandButton:60501,FluentUIV9ShimTooltipHost:60634,FluentUIV9ShimTooltip:60633,FluentUIV9ShimLink:60405,FluentUIV9ShimStack:60413,FluentUIV9ShimCheckbox:60414,FluentUIV9ShimDialog:60426,FluentUIV9ShimChoiceGroup:60415,FluentUIV9ShimPersona:60419,FluentUIV9ShimFacepile:60569,FluentUIV9ShimPivot:60105,FluentUIV9ShimContextualMenu:60556,FluentUIV9ShimOverlay:60547,FluentUIV9ShimOverflowSet:60555,FluentUIV9ShimIcon:60446,FluentUIV9ShimSpinner:60450,FluentUIV9ShimSlider:60454,FluentUIV9ShimLayer:60460,FluentUIV9ShimText:60566,FluentUIV9ShimCustomizer:60650,FluentUIV9ShimThemeProvider:60567,FluentUIV9ShimSpinButton:60557,FluentUIV9ShimLabel:60382,FluentUIV9ShimSeparator:60384,FluentUIV9ShimCompoundButton:60540,FluentUIV9ShimTextField:61154,FluentUIV9ShimShimmer:61344,FluentUIV9ShimFocusTrapZone:60457,FluentUIV9ShimFocusZone:61362,FluentUIV9ShimPanel:61363,FluentUIV9ShimProgressIndicator:61364,FluentUIV9ShimDatePicker:61369,FluentUIV9ShimMessageBar:61378,FluentUIV9ShimDropdown:61379,FluentUIV9ShimCallout:61380,FluentUIV9ShimModal:61381,FluentUIV9ShimLayoutGroup:61383,FluentUIV9ShimComboBox:61384,FluentUIV9ShimCard:61385}}
,function(e,t,n){var a;n.d(t,{a:function(){return a}}),function(e){e[e.Success=0]="Success",e[e.Failure=1]="Failure",e[e.ExpectedFailure=2]="ExpectedFailure"}(a||(a={}))}
,function(e,t,n){n.d(t,{a:function(){return S},b:function(){return _},c:function(){return g},d:function(){return v}});var a=n(0),i=n(589),r=n(590),o=n(1);function s(e,t){var n=[];return"object"!=typeof e?e:function e(a){var i=null;return a&&(i=Array.isArray(a)?[]:Object.create(Object.getPrototypeOf(a)),Object.keys(a).forEach(function(r){if(!t.has(r.toString().toLowerCase())){var o=a[r];if("object"==typeof o){if(-1!==n.indexOf(o))throw new Error("Cannot perform DeepCopy() because a circular reference was encountered, object: ".concat(a,", ")+"property: ".concat(r));n.push(o),i[r]=e(o),n.pop()}else i[r]=o}})),i}(e)}var c=n(50),d=o.a.isActivated("EB7740CE-D54F-42A3-882D-B78CE93D82DF"),l=o.a.isActivated("070BC6CB-A7B9-4309-943B-4EF5336ABEC6"),u=l||o.a.isActivated("618FD44A-3BE9-48D0-99B8-B6910ED3731A"),f=new Set(["error","stack","trace","message"]),p=new Set(["additionalpostdata","alttitle","applicationname","debugginginfo","debugmessage","deferredlistdata","error","errorcodes","errorinfo","errormessage","errorstack","fcilongtasks","fileid","filelisturl","host","message","name","nextlink","pathname","rawerror","rawurl","resourcelocation","result","serverfileref","serverlisturl","siteurls","source","stack","targetfield","trace","ttilongtasks","url","vnexttheme applied","vnexttheme","webabsoluteurl"]);function m(e,t,n){if(!e)return e;var a;a=Array.isArray(e)?[]:Object.create(Object.getPrototypeOf(e));for(var i=0,r=Object.keys(e);i<r.length;i++){var o=r[i];if(d||!u||"string"!=typeof o||!n.has(o.toLowerCase())){var s=e[o],l=(0,c.a)(s);if(void 0!==l){if("safe"!==l.type){void 0!==l.value&&(a[o]=l.value);continue}s=l.value}else if(!d&&!u&&"string"==typeof o&&n.has(o.toLowerCase()))continue;if("object"==typeof s){if(-1!==t.indexOf(s))continue;t.push(s),a[o]=m(s,t,"extraData"===o?p:n),t.pop()}else a[o]=s}}return a}var _=!o.a.isActivated("8CBB4128-F78B-4AD1-BD52-84FE010DC6BD"),h=!o.a.isActivated("E9B1CF83-F41B-46C4-B8EF-2A7210450947"),b=function(){function e(e){var t=this;this._onBeforeUnload=function(){try{for(var e=function(e){try{t._startedEvents.forEach(function(t,n){e(n)})}catch(e){}},n=0,a=t._onBeforeUnloadHandlers;n<a.length;n++)e(a[n])}catch(e){}t._startedEvents.clear();for(var i=0,r=t._unloadHandlers;i<r.length;i++){var o=r[i];try{o()}catch(e){}}},this._handlers=[],this._eventHandlers=[],this._buffer=new r.a(500),this._hasBufferOverflown=!1,this._unloadHandlers=[],this._onBeforeUnloadHandlers=[],this._startedEvents=new Map,this._managerName=e.sourceName,"undefined"!=typeof window&&window&&window.addEventListener&&window.addEventListener("beforeunload",this._onBeforeUnload)}return Object.defineProperty(e.prototype,"startDate",{get:function(){return window.performance&&window.performance.timing&&window.performance.timing.navigationStart?new Date(window.performance.timing.navigationStart):new Date},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"startTime",{get:function(){return this.startDate.getTime()},enumerable:!1,configurable:!0}),e.prototype.getTime=function(){return(new Date).getTime()},e.prototype.cleanString=function(e){return e},e.prototype.addEventHandler=function(t){var n=this,a=t.handler,i="".concat(this._managerName,"-").concat(t.sourceName);if(e._handlerNameCounts[i]){var r=++e._handlerNameCounts[i];i+="-".concat(r)}else e._handlerNameCounts[i]=1;if(this._eventHandlers.push({handleEvent:a,sourceName:i}),t.handleMissedEvents)for(var o=0,s=this._buffer.getAll();o<s.length;o++){var c=s[o];a(c(i))}return function(){return n.removeEventHandler(a)}},e.prototype.removeEventHandler=function(e){for(var t=this._eventHandlers,n=0;n<t.length;n++)if(t[n].handleEvent===e){t.splice(n,1);break}},e.prototype.addLogHandler=function(e){var t=this._handlers,n=this._buffer;return t.push(e),n.getAll().map(function(e){return e("")})},e.prototype.removeLogHandler=function(e){for(var t=this._handlers,n=0;n<t.length;n++)if(t[n]===e){t.splice(n,1);break}},e.prototype.logEvent=function(e,t){var n=this._buffer,r=this._startedEvents||new Map;t===i.a.End?r.delete(e):t===i.a.Start&&r.set(e,!0);var o=function(n){if(!l)return function(e){var t=e.event,n=e.eventSource,a=e.eventType,i=m(t.data,[t,t.data],f),r=m(t.context,[t,t.context],p);return r["Debug.EventSource"]=n,Object.freeze({data:i,context:r,eventType:a,id:t.id,vector:t.vector,endTime:t.endTime,parentId:t.parentId,metadata:t.metadata,critical:t.critical,eventName:t.eventName,startTime:t.startTime,shortEventName:t.shortEventName,isEventTypePrefixingDisabled:t.isEventTypePrefixingDisabled})}({event:e,eventSource:n,eventType:t});var i,r,o=h?s(e.data,f):(i=e.data,r=[],"object"!=typeof i?i:function e(t){var n=null;return t&&(n=Array.isArray(t)?[]:Object.create(Object.getPrototypeOf(t)),Object.keys(t).forEach(function(a){var i=t[a];if("object"==typeof i){if(-1!==r.indexOf(i))throw new Error("Cannot perform DeepCopy() because a circular reference was encountered, object: ".concat(t,", ")+"property: ".concat(a));r.push(i),n[a]=e(i),r.pop()}else n[a]=i})),n}(i));h&&(delete o.extraData,e.data.extraData&&(o.extraData=s(e.data.extraData,p)));var c=h?s(e.context,p):(0,a.a)({},e.context);return Object.freeze({data:o,context:(0,a.a)((0,a.a)({},c),_&&n?{"Debug.EventSource":n}:{}),id:e.id,critical:e.critical,endTime:e.endTime,eventName:e.eventName,shortEventName:e.shortEventName,parentId:e.parentId,startTime:e.startTime,eventType:t,metadata:e.metadata,vector:e.vector,isEventTypePrefixingDisabled:e.isEventTypePrefixingDisabled})},c=n.isFull;n.push(o);var d=(_?this._eventHandlers:this._handlers).length;!this._hasBufferOverflown&&c&&(this._hasBufferOverflown=!0,0===d&&D(new Error("Logging buffer overflow hit before any logging handler was registered")));for(var u=0;u<d;u++)try{if(_){var b=this._eventHandlers[u];b.handleEvent(o(b.sourceName))}else this._handlers[u](o(""))}catch(e){D(e)}},e.prototype.isFeatureEnabled=function(e){return!0},e.prototype.addFeatureEnabler=function(e){},e.prototype.removeFeatureEnabler=function(e){},e.prototype.getStack=function(){var e;try{var t=window;t.______ExpectedError______&&t.______ExpectedError______()}catch(t){e=t}return e&&e.stack||void 0},e.prototype.addUnloadHandler=function(e){this._unloadHandlers.push(e)},e.prototype.removeUnloadHandler=function(e){var t=this._unloadHandlers,n=t.indexOf(e);n>-1&&t.splice(n,1)},e.prototype.addOnBeforeUnloadHandler=function(e){this._onBeforeUnloadHandlers.push(e)},e.prototype.removeOnBeforeUnloadHandler=function(e){var t=this._onBeforeUnloadHandlers,n=t.indexOf(e);n>-1&&t.splice(n,1)},e.prototype.registerCustomBeforeUnload=function(e){e.addCallback(this._onBeforeUnload)},e.prototype.dispose=function(){"undefined"!=typeof window&&window&&window.removeEventListener&&window.removeEventListener("beforeunload",this._onBeforeUnload),this._onBeforeUnload()},e._handlerNameCounts={},e}();function g(e){return new b(e)}function v(e){return _&&!e.addEventHandler&&(e.addEventHandler=function(t){var n=e.addLogHandler(t.handler);if(t.handleMissedEvents)for(var a=0,i=n;a<i.length;a++){var r=i[a];t.handler(r)}return function(){return e.removeLogHandler(t.handler)}},e.removeEventHandler=function(t){e.removeLogHandler(t)}),e}var y,S=(y=function(){return g({sourceName:"Global"})},v("undefined"!=typeof window?window.ODSP_TELEMETRY_MANAGER=window.ODSP_TELEMETRY_MANAGER||y():"undefined"!=typeof self?self.ODSP_TELEMETRY_MANAGER=self.ODSP_TELEMETRY_MANAGER||y():y()));function D(e){console.error("Telemetry Manager:",e)}}
,function(e,t,n){n.d(t,{a:function(){return r}});var a,i=/^data:((?:\w+\/(?:(?!;).)+)?)((?:;[\w\W]*?[^;])*),(.+)$/;!function(e){e[e.absolute=0]="absolute",e[e.relative=1]="relative",e[e.serverRelative=2]="serverRelative",e[e.dataUrl=3]="dataUrl"}(a||(a={}));var r=function(e,t){var n;void 0===e&&(e="");var r=null!==(n=null==t?void 0:t.allowDataUrl)&&void 0!==n&&n,o=e.indexOf("//"),s=e.indexOf("/"),c=o>-1&&o<=s?o+"//".length:-1,d=function(e,t){if(t>-1){var n=e.indexOf("/",t);return n>-1?e.slice(0,n):e}return""}(e,c),l=d&&d.slice(c),u=e.slice(d.length),f=d?a.absolute:r&&i.test(e)?a.dataUrl:"/"===u[0]?a.serverRelative:a.relative,p=u.split("/");this.authority=d,this.domain=l,this.format=f,this.path=u,this.segments=p,this.value=e}}
,function(e,t,n){var a=n(120);t.a=a}
,function(e,t,n){var a;n.d(t,{a:function(){return a}}),function(e){e[e.uninitialized=0]="uninitialized",e[e.direct=1]="direct",e[e.organizationView=2]="organizationView",e[e.organizationEdit=3]="organizationEdit",e[e.anonymousView=4]="anonymousView",e[e.anonymousEdit=5]="anonymousEdit",e[e.flexible=6]="flexible",e[e.requestAccess=7]="requestAccess"}(a||(a={}))}
,function(e,t,n){var a;n.d(t,{a:function(){return o},b:function(){return r}}),function(e){e[e.unknown=1]="unknown",e[e.odb=2]="odb",e[e.sharePoint=3]="sharePoint",e[e.ngsc=4]="ngsc",e[e.word=5]="word",e[e.powerpoint=6]="powerpoint",e[e.excel=7]="excel",e[e.onenoteWeb=8]="onenoteWeb",e[e.wac=9]="wac",e[e.visio=10]="visio",e[e.officecom=11]="officecom",e[e.listPart=12]="listPart",e[e.outlookWeb=13]="outlookWeb",e[e.odIos=14]="odIos",e[e.odAndroid=15]="odAndroid",e[e.teams=16]="teams",e[e.sample=17]="sample",e[e.odc=18]="odc",e[e.wordAndroid=19]="wordAndroid",e[e.excelAndroid=20]="excelAndroid",e[e.powerpointAndroid=21]="powerpointAndroid",e[e.wordIos=22]="wordIos",e[e.excelIos=23]="excelIos",e[e.powerpointIos=24]="powerpointIos",e[e.onenote=25]="onenote",e[e.teamsIos=26]="teamsIos",e[e.teamsAndroid=27]="teamsAndroid",e[e.onenoteIos=28]="onenoteIos",e[e.visioIos=29]="visioIos",e[e.onenoteAndroid=30]="onenoteAndroid",e[e.visioAndroid=31]="visioAndroid",e[e.outlookWindows=32]="outlookWindows",e[e.outlookMac=33]="outlookMac",e[e.onenoteUWP=34]="onenoteUWP",e[e.officemobileIos=35]="officemobileIos",e[e.officemobileAndroid=36]="officemobileAndroid",e[e.odcWac=37]="odcWac",e[e.outlookGroupsWeb=38]="outlookGroupsWeb",e[e.fluid=39]="fluid",e[e.modernFileExplorer=40]="modernFileExplorer",e[e.listsHome=41]="listsHome",e[e.listsIos=42]="listsIos",e[e.edgeEnterpriseNtp=43]="edgeEnterpriseNtp",e[e.officeFeed=44]="officeFeed",e[e.searchUx=45]="searchUx",e[e.consumerList=46]="consumerList",e[e.shareDemo=47]="shareDemo",e[e.onePlayer=48]="onePlayer",e[e.windowsShare=49]="windowsShare",e[e.streamIos=50]="streamIos",e[e.streamAndroid=51]="streamAndroid",e[e.loopIos=52]="loopIos",e[e.outlookAndroid=53]="outlookAndroid",e[e.outlookiOS=54]="outlookiOS",e[e.whiteboard=55]="whiteboard",e[e.businesscentral=56]="businesscentral",e[e.mslens=57]="mslens",e[e.pbidesktop=58]="pbidesktop",e[e.oneup=59]="oneup",e[e.sharePointPages=60]="sharePointPages",e[e.streamOnline=61]="streamOnline",e[e.npe=62]="npe",e[e.designer=63]="designer",e[e.designerIos=64]="designerIos",e[e.designerAndroid=65]="designerAndroid"}(a||(a={}));var i=void 0;function r(e){if(void 0===i)for(var t in i={},a){var n=parseInt(t);if(!isNaN(n)){var r=a[n].toLowerCase();i[r]=n}}var o=e?e.toLowerCase():"";return i[o]||a.unknown}var o=a}
,function(e,t){var n;!function(e){e[e.share=1]="share",e[e.copy=2]="copy",e[e.atMention=3]="atMention",e[e.linkSettings=4]="linkSettings",e[e.manageAccess=5]="manageAccess",e[e.notify=6]="notify",e[e.addPeople=7]="addPeople"}(n||(n={})),t.a=n}
,function(e,t,n){n.d(t,{a:function(){return l}});var a=n("react-lib"),i=n(1),r=n(10),o=n(34),s={forceEnabledFlights:[],forceDisabledFlights:[],flights:void 0,flightsMap:void 0,isInitialized:!1,queryParams:void 0};function c(e,t){if(-1!==s.forceEnabledFlights.indexOf(e))return!0;if(-1!==s.forceDisabledFlights.indexOf(e))return!1;if(!t||0===t.length)return!1;var n=Object.values(o.a).indexOf(e);if(-1===n)return console.error("The flight which needs to be checked is not in the fluent UI V9 component flights list"),!1;if(t.length<1+(n>>5))return console.error("The fluent UI V9 component flights list is not initialized correctly"),!1;var a=1<<(31&n);return 0!=(t[n>>5]&a)}var d=n(269);function l(e,t,n,l,u){var f=a.useContext(d.a),p=function(e){return window.__FUIV9Flights?function(e){return s.isInitialized||(s.flights||(s.flights=window.__FUIV9Flights),function(e){if(e&&e.length>0){var t=e.split(",");s.forceEnabledFlights=[],s.forceDisabledFlights=[];for(var n=0,a=t;n<a.length;n++){var i=a[n];if("!"===i[0]){var r=parseInt(i.slice(1),10);isNaN(r)||s.forceDisabledFlights.push(r)}else r=parseInt(i,10),isNaN(r)||s.forceEnabledFlights.push(r)}}}(function(e){if(s.queryParams||(s.queryParams=new URLSearchParams(window.location.search)),s.queryParams.has(e))return s.queryParams.get(e)}("debugFlights")),function(){if(new Set(s.forceEnabledFlights.concat(s.forceDisabledFlights)).size<s.forceEnabledFlights.length+s.forceDisabledFlights.length)throw new Error("There are flights that are forced to be both enabled and disabled")}(),s.isInitialized=!0),!(!e||e<0)&&c(o.a.FluentUIV9ShimOverallControl,s.flights)&&c(e,s.flights)}(e):function(e){if(!s.flightsMap){s.flightsMap=new Map;for(var t=0,n=Object.keys(o.a);t<n.length;t++){var a=n[t],i=o.a[a];s.flightsMap.set(i,a)}}var c={ODB:e,ODC:s.flightsMap.get(e)},d={ODB:o.a.FluentUIV9ShimOverallControl,ODC:s.flightsMap.get(o.a.FluentUIV9ShimOverallControl)};return r.a.isFeatureEnabled(d)&&r.a.isFeatureEnabled(c)}(e)}(l)&&f;u&&(p=p&&!i.a.isActivated(u));var m=p?t:e;return a.createElement(m,n)}}
,,function(e,t,n){n.d(t,{a:function(){return s},b:function(){return o},c:function(){return r},d:function(){return c}});var a=n(0),i=n("react-lib");function r(e,t){var n=(0,a.a)({},e);return Object.keys(n).forEach(function(e){t.has(e)&&delete n[e]}),n}function o(e,t){return r(e,t)}var s=function(e){var t={};return e?(e.ariaLabel&&(t["aria-label"]=e.ariaLabel),e.ariaLabelledBy&&(t["aria-labelledby"]=e.ariaLabelledBy),e.ariaDescribedBy&&(t["aria-describedby"]=e.ariaDescribedBy),e["aria-live"]&&(t["aria-live"]=e["aria-live"]),t):t},c=function(){var e=i.useState(null),t=e[0],n=e[1];return i.useEffect(function(){var e;if(t){var n=t.parentElement,a=null===(e=null==n?void 0:n._virtual)||void 0===e?void 0:e.parent;a&&!document.contains(a)&&(n._virtual={parent:document.body})}},[t]),n}}
,,,,,function(e,t,n){n.d(t,{a:function(){return a},b:function(){return u.a},c:function(){return _},d:function(){return p}});var a,i=n(0),r=n(158),o=n(50),s=n(36),c=n(12),d=n(120),l=function(){function e(e,t){e?(this.root=e.root,this.parent=e.current):this.root=this.parent=d.Empty,this.current=t||d.generate()}return e._getCorrelationVector=function(){var t;return"undefined"!=typeof window?t=window.rootVector:"undefined"!=typeof self&&(t=self.rootVector),t||new e},e.prototype.toString=function(){return"".concat(this.root,"#").concat(this.parent,"#").concat(this.current)},e.RootVector=e._getCorrelationVector(),e}(),u=n(589),f=0;function p(e,t,n,a){(0,r.a)(e,t);var o={};for(var s in n)if(Object.prototype.hasOwnProperty.call(n,s)){var d=n[s],l=o[s]="number"==typeof d?{type:d}:d;l.definedInName=t.shortEventName,l.type===c.a.Number&&(l.isMetric=!0)}e.metadata=a?(0,i.a)((0,i.a)({},a.prototype.metadata),o):o}!function(e){e[e.Consumer=0]="Consumer",e[e.ConsumerAnonymous=1]="ConsumerAnonymous",e[e.Business=2]="Business",e[e.BusinessAnonymous=3]="BusinessAnonymous",e[e.Unknown=4]="Unknown",e[e.ConsumerOnSPO=5]="ConsumerOnSPO"}(a||(a={}));var m=new WeakMap,_=function(){function e(e,t,n){this.context={},this.data={},this.context=(0,i.a)({},this.addContext({})),this.id=f++,n&&(this.parentId=n.id),this.startTime=e&&e.startTimeOverride||s.a.getTime(),this.vector=new l(n?n.vector:l.RootVector),e&&this._setData(e),this._logEvent(t)}return e.isTypeOf=function(e){return e.eventName?e.eventName.indexOf(this.prototype.shortEventName+",")>=0:!!e.prototype&&e.prototype.shortEventName===this.prototype.shortEventName},e.withManager=function(e){if(!e||e===s.a)return this;var t=m.get(e);t||(t=new WeakMap,m.set(e,t));var n=t.get(this);if(n)return n;var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.d)(t,e),t}(this);return a.prototype.manager=e,n=a,t.set(this,n),n},e.withData=function(e){if(!e)return this;var t="function"!=typeof e?function(t){return(0,i.a)((0,i.a)({},e),t)}:e,n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return(0,i.d)(n,e),n.prototype.addData=function(n){var a=(0,i.a)((0,i.a)({},n),t(n));return(0,i.a)((0,i.a)({},a),e.prototype.addData.call(this,a))},n}(this);return n},e.withContext=function(e){if(!e)return this;var t="function"!=typeof e?function(t){return(0,i.a)((0,i.a)({},e),t)}:e,n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return(0,i.d)(n,e),n.prototype.addContext=function(n){var a=(0,i.a)((0,i.a)({},n),t(n));return(0,i.a)((0,i.a)({},a),e.prototype.addContext.call(this,a))},n}(this);return n},e.from=function(e){return e?this.withManager(e.prototype.manager).withContext(function(t){return e.prototype.addContext(t)}).withData(function(t){return e.prototype.addData(t)}):this},e.prototype.addContext=function(e){return b(this.manager,e,{})},e.prototype.addData=function(e){return e},e.prototype._setData=function(e){var t=(0,i.a)((0,i.a)({},this.addData(this.data)),e);!function(e,t,n,a){for(var i=0,r=Object.keys(n);i<r.length;i++){var o=r[i];o in t&&h(e,n,a,o,t[o])}}(this.manager,this.metadata,t,this.data)},e.prototype._logEvent=function(e){this.manager.logEvent(this,e)},e}();function h(e,t,n,a,i){var r=t[a];switch(typeof r){case"string":var s=e.cleanString(r,a,i);return void(void 0!==s&&(n[a]=s));case"undefined":return;case"object":return void((0,o.c)(r)?n[a]=r:r&&Object.getPrototypeOf(r)===Object.prototype?n[a]=b(e,r,{}):n[a]=r);default:return void(n[a]=r)}}function b(e,t,n){for(var a=0,i=Object.keys(t);a<i.length;a++)h(e,t,n,i[a]);return n}var g=_.prototype;g.eventName="EventBase,",g.shortEventName="EventBase",g.critical=!1,g.manager=s.a}
,function(e,t,n){n.d(t,{a:function(){return s},b:function(){return o},c:function(){return r},d:function(){return a},e:function(){return i}});var a=n(1).a.isActivated("B2C1A853-F84A-4734-A7AD-F678D75067F2");function i(e,t){if(a)return e;if(void 0!==e&&""!==e){var n=void 0===t?"safe":"boolean"==typeof t?t?"safe":"unsafe":t;return{_value:o(e),_type:n,__isPrivacyDataWrapper:!0}}}function r(e){return!!e&&!0===e.__isPrivacyDataWrapper}function o(e){return r(e)?e._value:e}function s(e){if(r(e)){var t=void 0;return"safe"===e._type?t=e._value:"string"==typeof e._value&&(t="<scrubbed-".concat(e._type,"-dropped>")),{type:e._type,value:t}}}}
,function(e,t){var n;!function(e){e[e.none=0]="none",e[e.session=1]="session",e[e.local=2]="local",e[e.sharedMemory=3]="sharedMemory"}(n||(n={})),t.a=n}
,function(e,t,n){var a;n.d(t,{a:function(){return a}}),function(e){e[e.none=0]="none",e[e.view=1]="view",e[e.edit=2]="edit",e[e.owner=3]="owner",e[e.review=6]="review",e[e.restrictedview=7]="restrictedview",e[e.submit=8]="submit",e[e.manageList=9]="manageList"}(a||(a={}))}
,function(e,t,n){var a;n.d(t,{a:function(){return a}}),function(e){e[e.invalid=-1]="invalid",e[e.teamSite=1]="teamSite",e[e.meetings=2]="meetings",e[e.centralAdmin=3]="centralAdmin",e[e.wiki=4]="wiki",e[e.documentCenter=7]="documentCenter",e[e.blog=9]="blog",e[e.tenantAdmin=16]="tenantAdmin",e[e.app=17]="app",e[e.appCatalog=18]="appCatalog",e[e.mySite=21]="mySite",e[e.subgroup=39]="subgroup",e[e.publishingPortal=52]="publishingPortal",e[e.mySiteHost=54]="mySiteHost",e[e.enterpriseWiki=56]="enterpriseWiki",e[e.group=64]="group",e[e.pointPublishingPersonal=66]="pointPublishingPersonal",e[e.sitePagePublishing=68]="sitePagePublishing",e[e.teamChannel=69]="teamChannel",e[e.projectWebAppSite=6221]="projectWebAppSite",e[e.contentCenter=6001]="contentCenter"}(a||(a={}));for(var i={},r=0,o=Object.keys(a);r<o.length;r++){var s=o[r];"string"==typeof s&&(i[s.toUpperCase()]=a[s])}t.b=a}
,,function(e,t,n){n.d(t,{a:function(){return p},b:function(){return _},c:function(){return l},d:function(){return s},e:function(){return b},f:function(){return d},g:function(){return u},h:function(){return o},i:function(){return r},j:function(){return y},k:function(){return c},l:function(){return g},m:function(){return S},n:function(){return v},o:function(){return h},p:function(){return I},q:function(){return f},r:function(){return m},s:function(){return D}});var a=n(40),i=n(21);function r(e){return h(e)||g(e)||b(e)||v(e)||y(e)||function(e){return e===a.a.officemobileIos||e===a.a.officemobileAndroid}(e)}function o(e){return e===a.a.odb||e===a.a.sharePoint||e===a.a.odc||e===a.a.npe||e===a.a.consumerList||e===a.a.oneup||e===a.a.sharePointPages}function s(e){return e===a.a.consumerList}function c(e){return e===a.a.outlookWeb||e===a.a.outlookWindows||e===a.a.outlookMac||e===a.a.outlookAndroid||e===a.a.outlookiOS}function d(e){return e===a.a.odIos||e===a.a.wordIos||e===a.a.excelIos||e===a.a.visioIos||e===a.a.onenoteIos||e===a.a.powerpointIos||e===a.a.teamsIos||e===a.a.officemobileIos||e===a.a.listsIos||e===a.a.streamIos||e===a.a.loopIos||e===a.a.outlookiOS}function l(e){return e===a.a.odAndroid||e===a.a.wordAndroid||e===a.a.excelAndroid||e===a.a.visioAndroid||e===a.a.onenoteAndroid||e===a.a.powerpointAndroid||e===a.a.teamsAndroid||e===a.a.officemobileAndroid||e===a.a.streamAndroid||e===a.a.outlookAndroid}function u(e){return d(e)||l(e)}function f(e){return o(e)||e===a.a.onenoteWeb||e===a.a.outlookWeb||e===a.a.officecom||e===a.a.teams||e===a.a.sample||e===a.a.outlookGroupsWeb||e===a.a.fluid||e===a.a.odcWac||e===a.a.wac||e===a.a.businesscentral||e===a.a.listPart||e===a.a.listsHome||e===a.a.shareDemo||e===a.a.streamOnline||u(e)}function p(e){return o(e)||e===a.a.listPart||e===a.a.shareDemo}function m(e){var t=!!i.$()&&(e===a.a.word||e===a.a.excel||e===a.a.powerpoint);return o(e)||e===a.a.officecom||e===a.a.wac||e===a.a.businesscentral||t}function _(e){return u(e)||S(e)}function h(e){return e===a.a.word||e===a.a.wordAndroid||e===a.a.wordIos}function b(e){return e===a.a.excel||e===a.a.excelAndroid||e===a.a.excelIos}function g(e){return e===a.a.powerpoint||e===a.a.powerpointAndroid||e===a.a.powerpointIos}function v(e){return e===a.a.visio||e===a.a.visioIos||e===a.a.visioAndroid}function y(e){return e===a.a.onenote||e===a.a.onenoteWeb||e===a.a.onenoteUWP||e===a.a.onenoteIos||e===a.a.onenoteAndroid}function S(e){return e===a.a.teams||e===a.a.teamsIos||e===a.a.teamsAndroid}function D(e){return e===a.a.odc||e===a.a.npe||i.Ob()&&e===a.a.odcWac}function I(e){return e===a.a.word||e===a.a.excel||e===a.a.powerpoint||e===a.a.ngsc||e===a.a.visio||e===a.a.windowsShare}}
,function(e,t,n){n.d(t,{a:function(){return K},b:function(){return W},c:function(){return q},d:function(){return Q},e:function(){return Y}});var a=n(307),i=n(466),r=n(319),o=n(198),s=n(468),c=n(0),d=n("react-lib"),l=n(3),u=n(43),f=n(83),p=n(178),m={defaultButton:{minWidth:"80px",height:"32px",verticalAlign:"initial","& .ms-ButtonShim-icon":{fontSize:p.a.fontSizeBase400},"& .ms-ButtonShim-label":{fontWeight:p.a.fontWeightSemibold}},primaryButtonHC:{"@media (forced-colors: active)":(0,c.a)((0,c.a)({backgroundColor:"WindowText !important"},f.a.borderColor("WindowText !important")),{color:"Window !important",forcedColorAdjust:"none",":hover":(0,c.a)((0,c.a)({backgroundColor:"Highlight !important"},f.a.borderColor("Highlight !important")),{color:"Window !important"}),":hover:active":(0,c.a)((0,c.a)({backgroundColor:"WindowText !important"},f.a.borderColor("WindowText !important")),{color:"Window !important"})})},primaryButtonDisabledHC:{"@media (forced-colors: active)":(0,c.a)((0,c.a)({backgroundColor:"Window !important"},f.a.borderColor("GrayText !important")),{color:"GrayText !important",forcedColorAdjust:"none"})},actionButton:(0,c.a)((0,c.a)((0,c.a)({backgroundColor:"transparent",minWidth:"auto",height:"40px"},f.a.padding("0","4px")),f.a.border("1px","solid","transparent")),{"& .ms-ButtonShim-flexContainer":{justifyContent:"flex-start"},"& .ms-ButtonShim-icon":{fontSize:p.a.fontSizeBase400,color:p.a.colorBrandBackgroundHover},"& .ms-ButtonShim-label":{whiteSpace:"unset"},"&:hover":(0,c.a)((0,c.a)({backgroundColor:"transparent",color:p.a.colorBrandBackground},f.a.border("1px","solid","transparent")),{"@media (forced-colors: active)":{color:"Highlight","& .ms-ButtonShim-icon":{color:"Highlight"}}}),"&:hover:active":(0,c.a)({backgroundColor:"transparent"},f.a.border("1px","solid","transparent"))}),actionButtonV2:(0,c.a)({},f.a.transition("unset")),actionButtonChecked:{backgroundColor:p.a.colorNeutralBackground1Selected,color:p.a.colorNeutralForeground1,":hover":{backgroundColor:p.a.colorNeutralBackground1Hover}},actionButtonDisabled:{backgroundColor:p.a.colorNeutralBackground1,color:p.a.colorNeutralForegroundDisabled,"& .ms-ButtonShim-icon":{color:p.a.colorNeutralForegroundDisabled},":hover":{backgroundColor:p.a.colorNeutralBackground1,color:p.a.colorNeutralForegroundDisabled,cursor:"default"},":hover:active":{backgroundColor:p.a.colorNeutralBackground1,color:p.a.colorNeutralForegroundDisabled,cursor:"default"}},actionButtonDisabledV2:{backgroundColor:"transparent"},iconButton:(0,c.a)((0,c.a)((0,c.a)((0,c.a)((0,c.a)({width:"32px",height:"32px",minWidth:"auto",color:p.a.colorBrandForegroundLink,backgroundColor:"transparent",verticalAlign:"initial"},f.a.padding("0","4px")),f.a.outline("transparent")),f.a.overflow("inherit")),f.a.border("0")),{"&:hover":{color:p.a.colorBrandBackgroundHover,backgroundColor:p.a.colorNeutralBackground1Hover},"&:active":{color:p.a.colorBrandBackgroundPressed,backgroundColor:p.a.colorNeutralBackground1Pressed},"&:active, &:hover:active":{color:p.a.colorBrandBackgroundPressed,backgroundColor:p.a.colorNeutralBackground1Pressed}}),iconButtonChecked:{color:p.a.colorCompoundBrandBackgroundHover,backgroundColor:p.a.colorNeutralBackground1Selected,"&:hover":{color:p.a.colorCompoundBrandBackgroundHover,backgroundColor:p.a.colorNeutralBackground1Selected}},commandBarButton:(0,c.a)((0,c.a)((0,c.a)((0,c.a)({minWidth:"40px",height:"100%"},f.a.padding("0","4px")),f.a.outline("transparent")),f.a.border("0")),{"& .ms-ButtonShim-icon":(0,c.a)({fontSize:p.a.fontSizeBase400,color:p.a.colorBrandBackground},f.a.margin("0","4px"))}),commandBarButtonChecked:{backgroundColor:p.a.colorNeutralBackground1Selected,color:p.a.colorNeutralForeground1,":hover":{backgroundColor:p.a.colorNeutralBackground1Hover}},commandBarButtonDisabled:{backgroundColor:p.a.colorNeutralBackground1,color:p.a.colorNeutralForegroundDisabled,"& .ms-ButtonShim-icon":{color:p.a.colorNeutralForegroundDisabled},":hover":{backgroundColor:p.a.colorNeutralBackground1,color:p.a.colorNeutralForegroundDisabled,cursor:"default"},":hover:active":{backgroundColor:p.a.colorNeutralBackground1,color:p.a.colorNeutralForegroundDisabled,cursor:"default"}},splitButton:(0,c.a)((0,c.a)({position:"relative",display:"inline-flex",borderTopRightRadius:0,borderBottomRightRadius:0,marginRight:0,alignItems:"center"},f.a.outline("transparent")),{"::after":{content:'""',position:"absolute",bottom:"8px",width:"1px",right:"22px",top:"8px",backgroundColor:p.a.colorNeutralStroke1},"& > .fui-SplitButton__primaryActionButton":{height:"32px",fontWeight:"unset",marginRight:"0 !important",borderTopRightRadius:"0 !important",borderBottomRightRadius:"0 !important",borderRightColor:"transparent",":hover":{borderTopRightRadius:"0 !important",borderBottomRightRadius:"0 !important",borderRightColor:"transparent","& .ms-ButtonShim-textContainer":{color:p.a.colorNeutralForeground1}},"& .ms-ButtonShim-flexContainer":{display:"flex",alignItems:"center",alignSelf:"center","& .ms-ButtonShim-textContainer":{height:"unset !important",color:p.a.colorNeutralForeground1}},"&[disabled]":{"& .ms-ButtonShim-flexContainer .ms-ButtonShim-textContainer":{color:"".concat(p.a.colorNeutralForegroundDisabled)},":hover":{"& .ms-ButtonShim-flexContainer .ms-ButtonShim-textContainer":{color:"".concat(p.a.colorNeutralForegroundDisabled)}}},"& .ms-ButtonShim-label":(0,c.a)({},f.a.margin("0","4px")),"& .ms-ButtonShim-icon":(0,c.a)({color:"inherit"},f.a.margin("0","4px"))},"& > .fui-SplitButton__menuButton":{height:"32px",borderTopLeftRadius:"0 !important",borderBottomLeftRadius:"0 !important"},"& > .ms-ButtonShim-menuButton":(0,c.a)((0,c.a)({marginLeft:"0 !important"},f.a.border("none")),{"& .ms-ButtonShim-flexContainer":{display:"flex",alignItems:"center"},"& .fui-MenuButton__menuIcon":{display:"none"}}),"& > .ms-ButtonShim--primary":(0,c.a)({},f.a.padding(0,"16px")),"& > .ms-ButtonShim--commandBar":{borderRightWidth:"1px"},"& > .ms-ButtonShim--default":(0,c.a)((0,c.a)((0,c.a)({},f.a.borderColor(p.a.colorNeutralStroke1)),f.a.padding(0,"16px")),{":hover":(0,c.a)({},f.a.borderColor(p.a.colorNeutralStroke1)),":hover:active":(0,c.a)({},f.a.borderColor(p.a.colorNeutralStroke1)),"& ~ .ms-ButtonShim-menuButton":(0,c.a)((0,c.a)({},f.a.borderWidth(p.a.strokeWidthThin)),{borderLeftWidth:"0",":hover":{backgroundColor:p.a.semanticButtonBackgroundHovered},":hover:active":{backgroundColor:p.a.semanticButtonBackgroundPressed}}),'& ~ .ms-ButtonShim-menuButton[aria-expanded="true"]':{backgroundColor:p.a.semanticButtonBackgroundPressed}})}),menuButton:(0,c.a)((0,c.a)({display:"inline-flex"},f.a.padding(0)),{"&.ms-menuButtonShim":{minWidth:"53px",width:"auto","& .ms-ButtonShim-flexContainer":{display:"flex",alignItems:"center","& .ms-ButtonShim-textContainer":{lineHeight:p.a.lineHeightBase100}},"& .ms-ButtonShim-label":(0,c.a)({},f.a.margin("0","4px")),"& .ms-ButtonShim-icon":(0,c.a)({},f.a.margin("0","4px")),"& .ms-ButtonShim-menuIcon":(0,c.a)({height:"16px",lineHeight:p.a.lineHeightBase200,fontSize:p.a.fontSizeBase200,textAlign:"center",flexShrink:0,alignSelf:"center"},f.a.margin("0","4px"))}}),menuIconButton:(0,c.a)((0,c.a)({},f.a.padding(0,"4px")),{color:p.a.colorBrandBackground,"& .ms-ButtonShim-icon":(0,c.a)({fontSize:p.a.fontSizeBase400},f.a.margin("0","4px"))}),menuActionButton:(0,c.a)((0,c.a)({fontWeight:p.a.fontWeightRegular},f.a.padding(0,"4px")),{"& .ms-ButtonShim-icon":(0,c.a)({},f.a.margin("0","4px")),":hover":(0,c.a)({},f.a.border("none")),":hover:active":(0,c.a)({},f.a.border("none"))}),menuCommandBarButton:(0,c.a)((0,c.a)((0,c.a)({fontWeight:p.a.fontWeightRegular},f.a.padding(0)),f.a.margin("0","2px")),{"& .ms-ButtonShim-flexContainer":{flexWrap:"nowrap",justifyContent:"center",alignItems:"center","& .ms-ButtonShim-label":(0,c.a)((0,c.a)({},f.a.margin("0","4px")),{lineHeight:"100%",display:"block",fontWeight:"normal"})}}),primaryMenuButton:(0,c.a)((0,c.a)({},f.a.padding(0,"16px")),{"&.ms-menuButtonShim":{"& .ms-ButtonShim-menuIcon":{fontSize:p.a.fontSizeBase200,color:p.a.colorNeutralForegroundOnBrand}}}),defaultMenuButton:(0,c.a)((0,c.a)({},f.a.padding(0,"16px")),{"&.ms-menuButtonShim":{"& .ms-ButtonShim-menuIcon":{fontSize:p.a.fontSizeBase200,color:p.a.colorNeutralForeground1}}}),menuPopover:{minWidth:"180px",overflowY:"auto",overflowX:"hidden"},hiddenContentStyles:(0,c.a)((0,c.a)((0,c.a)((0,c.a)((0,c.a)({position:"absolute",width:"1px",height:"1px"},f.a.margin(0)),f.a.padding(0)),f.a.border(0)),f.a.overflow("hidden")),{whiteSpace:"nowrap"})},_={root:{minWidth:"80px",height:"32px",verticalAlign:"initial","& .ms-ButtonShim-icon":{fontSize:p.a.fontSizeBase400},"& .ms-ButtonShim-label":{fontWeight:p.a.fontWeightSemibold},color:p.a.colorNeutralForegroundOnBrand,backgroundColor:p.a.semanticPrimaryButtonBackground,":hover":{backgroundColor:p.a.semanticPrimaryButtonBackgroundHovered,color:p.a.semanticPrimaryButtonTextHovered}},rootHC:m.primaryButtonHC,checked:{backgroundColor:p.a.semanticPrimaryButtonBackgroundPressed,color:p.a.semanticPrimaryButtonTextPressed,":hover":{backgroundColor:p.a.semanticPrimaryButtonBackgroundPressed,color:p.a.semanticPrimaryButtonTextPressed},":active:hover":{backgroundColor:p.a.semanticPrimaryButtonBackgroundPressed,color:p.a.semanticPrimaryButtonTextPressed}},disabled:{color:p.a.colorNeutralStroke1,backgroundColor:p.a.colorNeutralBackgroundDisabled,":hover":{cursor:"default",color:p.a.colorNeutralStroke1,backgroundColor:p.a.colorNeutralBackgroundDisabled},":hover:active":{backgroundColor:p.a.colorNeutralBackgroundDisabled,color:p.a.colorNeutralStroke1,cursor:"default"}},disabledHC:m.primaryButtonDisabledHC},h={root:(0,c.a)((0,c.a)((0,c.a)((0,c.a)({},m.defaultButton),{backgroundColor:p.a.semanticButtonBackground}),f.a.borderColor(p.a.semanticButtonBorder)),{":hover":(0,c.a)({backgroundColor:p.a.semanticButtonBackgroundHovered},f.a.borderColor(p.a.semanticButtonBorder)),":hover:active":(0,c.a)({backgroundColor:p.a.semanticButtonBackgroundPressed},f.a.borderColor(p.a.semanticButtonBorder))}),checked:{backgroundColor:p.a.semanticButtonBackgroundPressed,":hover":{backgroundColor:p.a.semanticButtonBackgroundPressed},":hover:active":{backgroundColor:p.a.semanticButtonBackgroundPressed}},disabled:{backgroundColor:p.a.semanticButtonBackgroundDisabled,color:p.a.semanticButtonTextDisabled,":hover":{color:p.a.semanticButtonTextDisabled,backgroundColor:p.a.semanticButtonBackgroundDisabled,cursor:"default"},":hover:active":{backgroundColor:p.a.semanticButtonBackgroundDisabled,color:p.a.semanticButtonTextDisabled,cursor:"default"}}},b={root:(0,c.a)((0,c.a)((0,c.a)({position:"relative",display:"inline-block",cursor:"pointer",textAlign:"center",userSelect:"none",boxSizing:"border-box"},f.a.padding("0","16px")),f.a.outline("transparent")),{fontWeight:p.a.fontWeightRegular,justifyContent:"unset","& .ms-ButtonShim-flexContainer":{display:"flex",height:"100%",flexWrap:"nowrap",justifyContent:"center",alignItems:"center"},"& .ms-ButtonShim-label":(0,c.a)({display:"block",lineHeight:"100%"},f.a.margin("0","4px")),"& .ms-ButtonShim-icon":(0,c.a)({marginRight:"0",width:"unset",fontSize:p.a.fontSizeBase400,textAlign:"center",flexShrink:0,lineHeight:"16px",height:p.a.fontSizeBase400},f.a.margin("0","4px"))}),actionButton:m.actionButton,actionButtonV2:m.actionButtonV2,actionButtonChecked:m.actionButtonChecked,actionButtonDisabled:m.actionButtonDisabled,actionButtonDisabledV2:m.actionButtonDisabledV2,iconButton:m.iconButton,iconButtonChecked:(0,c.a)((0,c.a)({},m.iconButtonChecked),{"&:active, &:hover:active":{color:p.a.colorCompoundBrandBackgroundHover,backgroundColor:p.a.colorNeutralBackground1Selected}}),iconButtonDisabled:{backgroundColor:p.a.semanticDisabledBackground,color:p.a.semanticDisabledText,"&:hover":{backgroundColor:p.a.semanticDisabledBackground,color:p.a.semanticDisabledText,cursor:"default"},"&:active, &:hover:active":{backgroundColor:p.a.semanticDisabledBackground,color:p.a.semanticDisabledText,cursor:"default"}},iconButtonDisabledIcon:{"& .ms-ButtonShim-icon":{color:p.a.semanticDisabledText}},commandBarButton:m.commandBarButton,commandBarButtonChecked:m.commandBarButtonChecked,commandBarButtonDisabled:m.commandBarButtonDisabled,splitButton:m.splitButton,menuButton:m.menuButton,menuIconButton:m.menuIconButton,menuActionButton:m.menuActionButton,menuCommandBarButton:m.menuCommandBarButton,primaryMenuButton:m.primaryMenuButton,defaultMenuButton:m.defaultMenuButton,menuPopover:m.menuPopover,hiddenContentStyles:m.hiddenContentStyles},g=(0,u.a)(b),v=(0,u.a)(h),y=(0,u.a)(_);function S(){return g()}var D=n(45),I=n(317),x=n(5),C=n(2),O=n(13),w=n(309),E=n(142),A=new Set(["className","allowDisabledFocus","onRenderAriaDescription","icon","key","uniqueId","onRenderChildren","onRenderText","ariaLabel","ariaHidden","getClassNames","defaultRender","ariaDescription","data","elementRef","checked","defaultChecked","componentRef","toggle","getSplitButtonClassNames","href","iconProps","keyTipProps","menuAs","menuIconProps","menuProps","menuTriggerKeyCode","onMenuClick","onRenderDescription","onRenderIcon","onRenderMenuIcon","persistMenu","primary","primaryActionButtonProps","primaryDisabled","secondaryText","split","splitButtonAriaLabel","splitButtonMenuProps","styles","text","theme","toggle"]),L=n(44),k=n(106),M=(0,x.a)({useStaticStyles:!0}),P=(0,x.a)({useStaticStyles:!1});function T(e,t,n){var a,i,r=e.text,o=e.children,s=e.menuIcon,u=void 0===s?void 0!==(i=e.menuIconProps)?d.createElement(E.a,(0,c.a)({iconName:"ChevronDown"},i,{className:(0,l.a)("ms-Button-menuIcon ms-ButtonShim-menuIcon",null==i?void 0:i.className)})):null:s,f=e.onRenderText,p=e.onRenderChildren,m=e.ariaDescription,_=null;return(r||"string"==typeof o)&&(_=f?f(e):d.createElement("span",{className:(0,l.a)("ms-Button-textContainer","ms-ButtonShim-textContainer",n.textContainer)},function(e,t){var n=e.text,a=e.children;return void 0===n&&"string"==typeof a&&(n=a),null===n||void 0===n&&"string"!=typeof a?null:d.createElement("span",{className:(0,l.a)("ms-Button-label","ms-ButtonShim-label",t.label)},n)}(e,n))),d.createElement("span",{className:(0,l.a)("ms-Button-flexContainer","ms-ButtonShim-flexContainer",e.split?n.splitButtonFlexContainer:n.flexContainer)},t,_,p?p(e):"string"==typeof o?null:o,u,m&&d.createElement("span",{className:null===(a=e.v9Styles)||void 0===a?void 0:a.hiddenContentStyles,id:e["aria-describedby"]},m))}function U(){return null}var F=d.forwardRef(function(e,t){var n,a=S(),r=e.variantClassName,s=e.className,u=(0,c.f)(e,["variantClassName","className"]),f=(0,D.a)(),p=(0,c.a)((0,c.a)({},u),((n={className:(0,l.a)(a.root,r,s,e.toggle?e.primary?"ms-Button--compoundPrimary":"ms-Button--compound":""),v9Styles:a})["aria-describedby"]=f,n)),m=t||e.elementRef||d.createRef();return function(e,t){var n=(0,d.useMemo)(function(){return{current:"function"==typeof t?t:null==t?void 0:t.current,component:t,focus:function(){var e;"function"!=typeof t&&(null===(e=null==t?void 0:t.current)||void 0===e||e.focus())},dismissMenu:function(){},openMenu:function(){}}},[]);(0,d.useImperativeHandle)(e.componentRef||void 0,function(){return n})}(p,m),p.menuProps?p.className.indexOf("ms-Button--icon")>-1?d.createElement(o.a,(0,c.a)({},e)):d.createElement(i.a,(0,c.a)({},e)):d.createElement(I.a,(0,c.a)({},function(e){var t,n,a,i=e.iconProps,r=(0,c.a)((0,c.a)({},M(function(e){var t=e.styles,n=void 0===t?{}:t,a=e.checked,i=e.disabled;return{root:[null==n?void 0:n.root,!i&&!a&&{selectors:{":focus":n.rootFocused,":hover":n.rootHovered,":active":n.rootPressed}},a&&["is-checked",n.rootChecked],a&&{selectors:{":hover":n.rootCheckedHovered,":active":n.rootCheckedPressed}},i&&["is-disabled",n.rootDisabled],i&&a&&[n.rootCheckedDisabled],!i&&a&&{selectors:{":hover":n.rootCheckedHovered,":active":n.rootCheckedPressed}}],flexContainer:n.flexContainer,textContainer:n.textContainer,label:[n.label,a&&n.labelChecked,i&&n.labelDisabled],icon:[n.icon,a&&n.iconChecked,i&&n.iconDisabled],menuIcon:n.menuIcon}}(e))),P(function(e){var t=e.styles,n=void 0===t?{}:t;return{splitButtonContainer:n.splitButtonContainer,splitButtonMenuButton:n.splitButtonMenuButton,splitButtonFlexContainer:n.splitButtonFlexContainer}}(e)));if(i&&(i.className=(0,l.a)("ms-Icon ms-Button-icon ms-ButtonShim-icon",null==i?void 0:i.className,r.icon),!(0,k.g)())){var o=(0,C.z)(i.iconName);o&&o.subset.fontFace&&(i.style=(0,c.a)((0,c.a)({},i.style),{fontFamily:o.subset.fontFace.fontFamily}))}var s=null;if(e.onRenderIcon)s=e.onRenderIcon(e);else if(null==i?void 0:i.iconName)s=d.createElement(O.a,(0,c.a)({},i));else if(null==i?void 0:i.imageProps){var u=i.imageProps,f=void 0===u?{}:u,p=(0,c.f)(i,["imageProps"]);s=d.createElement(w.a,(0,c.a)({imageProps:f},p))}var m=e.disabled||e.primaryDisabled,_=(0,l.a)("ms-Button",r.root,m?"is-disabled":void 0,e.checked?"is-checked":void 0,e.baseClassName,e.variantClassName,e.className),h=!(!1===e["data-is-focusable"]||e.disabled&&!e.allowDisabledFocus||e.menuProps&&e.onClick&&!0===e.split),b={v8ClassNames:r,appearance:e.primary?"primary":e.split?"transparent":void 0,className:_,disabled:m&&!e.allowDisabledFocus,disabledFocusable:e.allowDisabledFocus&&e.disabled||void 0,"aria-hidden":e.ariaHidden,"aria-label":e.ariaLabel||e["aria-label"],"data-is-focusable":h,"aria-pressed":e.toggle?!!e.checked:void 0,"aria-disabled":m,as:void 0!==e.href?"a":void 0,href:null!==(t=e.href)&&void 0!==t?t:void 0,role:null!==(n=e.role)&&void 0!==n?n:void 0!==e.href?"link":void 0,target:e.target,key:e.key||e.uniqueId,secondaryContent:e.secondaryText||(null===(a=e.onRenderDescription)||void 0===a?void 0:a.call(e,e))||e.description||void 0,children:T(e,s,r)};return(0,c.a)((0,c.a)({"data-automationid":"splitbuttonprimary"},(0,L.b)(e,A)),b)}(p),{ref:m}))}),H=n(197),R=d.forwardRef(function(e,t){var n=S(),i=(0,H.a)("ActionButton",e);if(e.menuProps)return d.createElement(a.a,(0,c.a)({},e));var r=[],o=[];r.push(n.actionButton,n.actionButtonV2),i.disabled&&o.push(n.actionButtonDisabled,n.actionButtonDisabledV2);var s=(0,c.a)((0,c.a)({},i),{variantClassName:l.a.apply(void 0,(0,c.g)((0,c.g)((0,c.g)([i.variantClassName,"ms-Button--action","ms-Button--command"],r,!1),[i.checked&&n.actionButtonChecked],!1),o,!1))});return d.createElement(F,(0,c.a)({},s,{ref:t}))}),N=d.forwardRef(function(e,t){var n=S(),a=(0,H.a)("CommandBarButton",e);return e.menuProps?d.createElement(i.a,(0,c.a)({},e)):d.createElement(F,(0,c.a)({tabIndex:!1===a["data-is-focusable"]?-1:void 0},a,{ref:t,variantClassName:(0,l.a)(a.variantClassName,"ms-Button--commandBar ms-ButtonShim--commandBar",n.commandBarButton,a.checked&&n.commandBarButtonChecked,a.disabled&&n.commandBarButtonDisabled)}))});N.displayName="CommandBarButtonShim";var B=d.forwardRef(function(e,t){var n=v(),a=y(),i=e.primary?a:n,o=(0,H.a)("DefaultButton",e);if(e.menuProps&&e.menuProps)return d.createElement(r.a,(0,c.a)({},e,{ref:t}));var s=(0,l.a)(i.root,e.checked&&i.checked,e.disabled&&i.disabled,o.variantClassName,e.primary?"ms-Button--primary ms-ButtonShim--primary":"ms-Button--default ms-ButtonShim--default");return d.createElement(F,(0,c.a)({},o,{ref:t,variantClassName:s}))});B.displayName="DefaultButtonShim";var j=d.forwardRef(function(e,t){var n=(0,H.a)("IconButton",(0,c.a)((0,c.a)({},e),{text:void 0})),a=S();"string"==typeof n.children&&delete n.children;var i=[];return n.disabled&&(i.push(a.iconButtonDisabled),i.push(a.iconButtonDisabledIcon)),d.createElement(F,(0,c.a)({},n,{onRenderDescription:U,ref:t,variantClassName:l.a.apply(void 0,(0,c.g)([n.variantClassName,"ms-Button--icon","ms-ButtonShim--icon",a.iconButton,n.checked&&a.iconButtonChecked],i,!1))}))});j.displayName="IconButtonShim";var V=d.forwardRef(function(e,t){var n=y(),a=(0,H.a)("PrimaryButton",e);if(e.menuProps)return d.createElement(s.a,(0,c.a)({},e));var i=a.disabled||a.primaryDisabled,r=[n.root];r.push(n.rootHC),i&&(r.push(n.disabled),r.push(n.disabledHC));var o=l.a.apply(void 0,(0,c.g)([a.variantClassName,e.checked&&n.checked,i&&n.disabled],r,!1));return d.createElement(B,(0,c.a)({},a,{ref:t,primary:!0,variantClassName:o}))});V.displayName="PrimaryButtonShim";var z=n(42),G=n(34),K=function(e){return(0,z.a)(a.a,R,e,G.a.FluentUIV9ShimActionButton)},W=function(e){return(0,z.a)(i.a,N,e,G.a.FluentUIV9ShimCommandBarButton)},q=function(e){return(0,z.a)(r.a,B,e,G.a.FluentUIV9ShimDefaultButton)},Q=function(e){return(0,z.a)(o.a,j,e,G.a.FluentUIV9ShimIconButton)},Y=function(e){return(0,z.a)(s.a,V,e,G.a.FluentUIV9ShimPrimaryButton)}}
,function(e,t,n){n.d(t,{a:function(){return r},b:function(){return o},c:function(){return i},d:function(){return s}});var a=n(0);function i(e){return function(t){return t||e}}var r=function(e){function t(t){var n=e.call(this,t)||this;n.name="ApiError";var i=t.innerError||void 0,r=i?(0,a.a)((0,a.a)((0,a.a)((0,a.a)((0,a.a)({},"string"==typeof i.correlationId?{correlationId:i.correlationId}:{}),"boolean"==typeof i.isExpected?{isExpected:i.isExpected}:{}),"string"==typeof i.name?{code:i.name}:{}),"string"==typeof i.code?{code:i.code}:{}),"object"==typeof i.extraData?{extraData:i.extraData}:{}):{},o=t.correlationId,c=void 0===o?r.correlationId:o,d=t.isExpected,l=void 0===d?r.isExpected:d,u=t.extraData;return n.correlationId=c,n.isExpected=!!l,n.code=s(t.code)?t.code(r.code)||"":t.code||r.code||"",n.extraData=(0,a.a)((0,a.a)({},r.extraData||{}),u||{}),n}return(0,a.d)(t,e),t}(n(378).a);function o(e,t){return function(n){return e(t(n))}}function s(e){return"function"==typeof e}}
,function(e,t,n){n.d(t,{a:function(){return r}});var a=n(242);function i(e){setTimeout(function(){throw e},0)}var r=function(){function e(t,n){void 0===n&&(n=i),this._id=e._uniqueId++,this._parent=t,this._onError=n,this._eventRecords=[]}return e.raise=function(e,t,n,i){return a.c(e,t,n,i)},e.isObserved=function(e,t){var n=e&&e.__events__;return!!n&&!!n[t]},e.isDeclared=function(e,t){var n=e&&e.__declaredEvents;return!!n&&!!n[t]},e.stopPropagation=function(e){e.stopPropagation&&e.stopPropagation()},e.prototype.dispose=function(){this._isDisposed||(this._isDisposed=!0,this.off(),this._parent=null)},e.prototype.onAll=function(e,t,n){for(var a in t)this.on(e,a,t[a],n)},e.prototype.on=function(t,n,i,r){var o=this;if(n.indexOf(",")>-1)for(var s=n.split(/[ ,]+/),c=0;c<s.length;c++)this.on(t,s[c],i,r);else{var d=this._parent,l={target:t,eventName:n,parent:d,callback:i,objectCallback:null,elementCallback:null,useCapture:r};if((s=t.__events__=t.__events__||{})[n]=s[n]||{count:0},s[n][this._id]=s[n][this._id]||[],s[n][this._id].push(l),s[n].count++,a.b(t)){var u=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(!o._isDisposed){var a;try{if(!1===(a=i.apply(d,t))&&t[0]&&t[0].preventDefault){var r=t[0];r.preventDefault(),e.stopPropagation(r)}}catch(r){o._onError(r)}return a}};l.elementCallback=u,t.addEventListener(n,u,r)}else l.objectCallback=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!o._isDisposed)return i.apply(d,e)};this._eventRecords.push(l)}},e.prototype.off=function(e,t,n,a){for(var i=0;i<this._eventRecords.length;i++){var r=this._eventRecords[i];if(!(e&&e!==r.target||t&&t!==r.eventName||n&&n!==r.callback||"boolean"==typeof a&&a!==r.useCapture)){var o=r.target.__events__,s=o[r.eventName],c=s?s[this._id]:null;c&&(1!==c.length&&n?(s.count--,c.splice(c.indexOf(r),1)):(s.count-=c.length,delete o[r.eventName][this._id]),s.count||delete o[r.eventName]),r.elementCallback&&r.target.removeEventListener&&r.target.removeEventListener(r.eventName,r.elementCallback,r.useCapture),this._eventRecords.splice(i--,1)}}},e.prototype.raise=function(t,n,a){return e.raise(this._parent,t,n,a)},e.prototype.declare=function(e){var t=this._parent.__declaredEvents=this._parent.__declaredEvents||{};if("string"==typeof e)t[e]=!0;else for(var n=0;n<e.length;n++)t[e[n]]=!0},e._uniqueId=0,e}()}
,function(e,t,n){var a=n(51),i=function(){function e(t,n){void 0===n&&(n=a.a.none),e.init(),this.dataStoreKey=t,this.defaultCachingType=n,n===a.a.none?this.dataStore={}:(void 0===e._dataStore[this.dataStoreKey]&&(e._dataStore[this.dataStoreKey]={}),this.dataStore=e._dataStore[this.dataStoreKey])}return e.hasStorageType=function(t){switch(e.init(),t){case a.a.none:case a.a.sharedMemory:return!0;case a.a.session:return!!e._sessionStorage;case a.a.local:return!!e._localStorage;default:return!1}},e.init=function(){if(!e._initialized){try{"localStorage"in window&&window.localStorage&&e.testStorage(window.localStorage)&&(e._localStorage=window.localStorage)}catch(e){}try{"sessionStorage"in window&&window.sessionStorage&&e.testStorage(window.sessionStorage)&&(e._sessionStorage=window.sessionStorage)}catch(e){}null==e._localStorage&&(e._localStorage=e._sessionStorage),e._initialized=!0}},e.testStorage=function(e){var t="BrowserStorageTest",n=!1;try{e.setItem(t,"1"),"1"===e.getItem(t)&&(n=!0),e.removeItem(t)}catch(e){}return n},e.prototype.setValue=function(e,t,n,a){void 0===a&&(a=!0),e=a?this.normalizeKey(e):e,this.dataStore[e]=t;var i=this.getStorage(n);if(i)try{var r=[],o=JSON.stringify(t,function(e,t){if("object"==typeof t&&null!==t){if(-1!==r.indexOf(t))return;r.push(t)}return t});r=null,i.setItem(this.dataStoreKey+e,o)}catch(e){}},e.prototype.getValue=function(e,t,n,a){void 0===n&&(n=!0),void 0===a&&(a=!1),e=n?this.normalizeKey(e):e;var i=this.dataStore[e],r=this.getStorage(t);if((void 0===i||a)&&r){var o=r.getItem(this.dataStoreKey+e);if(o)try{i=JSON.parse(o),this.dataStore[e]=i}catch(e){i=void 0}}return i},e.prototype.remove=function(e,t,n){void 0===n&&(n=!0),e=n?this.normalizeKey(e):e;var a=this.getStorage(t);a&&a.removeItem(this.dataStoreKey+e),delete this.dataStore[e]},e.prototype.getStorage=function(t){switch(t||this.defaultCachingType){case a.a.none:case a.a.sharedMemory:return null;case a.a.session:return e._sessionStorage;case a.a.local:return e._localStorage;default:return null}},e.prototype.normalizeKey=function(e){return e&&e.toLowerCase()||""},e._sessionStorage=null,e._localStorage=null,e._dataStore={},e._initialized=!1,e}();t.a=i}
,,function(e,t,n){n.d(t,{a:function(){return E}});var a=n(282),i=n(0),r=n("react-lib"),o=n(43),s=n(3),c=n(446),d=n(5),l=n(182),u=n(445),f=n(44),p=r.createElement(r.Fragment,null),m=[0,300,500],_=["above-start","above","above-end","above","below-start","below","below-end","below","before-top","before","before-bottom","after-top","after","after-bottom"],h=new Set(["componentRef","calloutProps","content","onRenderContent","delay","maxWidth","targetElement","directionalHint","directionalHintForRTL","theme","styles"]),b=new Set((0,i.g)((0,i.g)([],Array.from(h),!0),["closeDelay","setAriaDescribedBy","onTooltipToggle","hostClassName","hostStyles"],!1)),g=(0,d.a)({useStaticStyles:!0}),v=(0,d.a)({useStaticStyles:!0}),y=(0,d.a)({useStaticStyles:!0}),S=new Set(["calloutProps","className","closeDelay","componentRef","content","delay","directionalHint","directionalHintForRTL","hostClassName","id","onTooltipToggle","overflowMode","setAriaDescribedBy","styles","theme","tooltipProps"]);function D(e,t){if(t){var n=e.overflowMode;if(void 0!==n)switch(n){case l.a.Parent:return t.parentElement;case l.a.Self:return t}return t}}var I=n(106),x=(0,o.a)({root:{display:"inline"}}),C=function(e){var t,n=r.useState(),a=n[0],o=n[1],d=function(e,t){var n=e.id,a=e.content,o=e.tooltipProps,c=e.calloutProps,d=e.setAriaDescribedBy,l=void 0===d||d,h=e.hostClassName,I=void 0===h?"":h,x=e.directionalHint,C=e.closeDelay,O=e.children,w=e.styles,E=e.onTooltipToggle;return function(e){var t=e.content,n=void 0===t?p:t,a=e.className,o=e.hostClassName,c=void 0===o?"":o,d=e.id,l=e.styles,h=e.hostStyles,S=e.calloutProps,D=e.delay,I=e.children,x=e.closeDelay,C=e.setAriaDescribedBy,O=void 0===C||C,w=e.directionalHint,E=e.onTooltipToggle,A=g(l),L=v(null==S?void 0:S.styles),k=y(h),M=r.createElement("div",{className:(0,s.a)(a,A.root,A.content,L.calloutMain)},(null==e?void 0:e.onRenderContent)?e.onRenderContent(e,function(e){return(null==e?void 0:e.content)?r.createElement(r.Fragment,null,e.content):null})||p:n);return(0,i.a)({content:(0,u.a)(M,{defaultProps:{role:"tooltip",id:d,className:L.beakCurtain},required:!0}),children:I,appearance:(null==S?void 0:S.styles)?"normal":void 0,withArrow:!0,hostClassName:(0,s.a)(c,k.root),relationship:O?"description":"inaccessible",positioning:w?_[w]:"above",showDelay:D?m[D]:250,hideDelay:x||250,onVisibleChange:function(e,t){return null==E?void 0:E(t.visible)}},(0,f.b)(e,b))}((0,i.a)((0,i.a)({id:n,content:a,children:O,calloutProps:c,hostClassName:I,closeDelay:C,setAriaDescribedBy:l,directionalHint:x,hostStyles:w,targetElement:D(e,t),onTooltipToggle:E},o),(0,f.b)(e,S)))}(e,a),l=d.hostClassName,h=d.children,C=(0,i.f)(d,["hostClassName","children"]),O=x(),w=(t=C.content.children.props.children)===p||null==t||""===t;return r.useEffect(function(){if(!(0,I.f)()){var e=null==a?void 0:a.getAttribute("aria-describedby"),t=null==a?void 0:a.getAttribute("aria-labelledby"),n=null==a?void 0:a.firstElementChild;n&&(e&&(null==a||a.removeAttribute("aria-describedby"),n.setAttribute("aria-describedby",e)),t&&(null==a||a.removeAttribute("aria-labelledby"),n.setAttribute("aria-labelledby",t)))}},[a,h]),w?r.createElement("div",{className:(0,s.a)("ms-TooltipHost ms-TooltipHostShim",l,O.root)},h):r.createElement(c.a,(0,i.a)({},C),r.createElement("div",{className:(0,s.a)("ms-TooltipHost ms-TooltipHostShim",l,O.root),ref:o},h))};C.displayName="TooltipHostShim";var O=n(42),w=n(34),E=function(e){return(0,O.a)(a.a,C,e,w.a.FluentUIV9ShimTooltipHost)}}
,,,,function(e,t,n){function a(e){var t={};if(e)for(var n=e.split("&"),a=0;a<n.length;a++){var i=n[a].split("=");void 0!==i[1]&&(i[1]=i[1].replace(/\+/g," "),t[i[0]]=decodeURIComponent(i[1]))}return t}n.d(t,{a:function(){return a}})}
,,,,function(e,t,n){n.d(t,{a:function(){return o},b:function(){return s}});var a=n(6),i=n(399),r=n(400);function o(e,t,n){return new a.a({name:e,factory:new i.a(t,n)})}function s(e,t,n){return new a.a({name:e,factory:new r.a(t,n)})}}
,,function(e,t,n){n.d(t,{A:function(){return v},B:function(){return K},C:function(){return O},D:function(){return P},a:function(){return E},b:function(){return b},c:function(){return _},d:function(){return S},e:function(){return z},f:function(){return h},g:function(){return N},h:function(){return w},i:function(){return B},j:function(){return R},k:function(){return j},l:function(){return D},m:function(){return x},n:function(){return V},o:function(){return H},p:function(){return L},q:function(){return A},r:function(){return M},s:function(){return F},t:function(){return T},u:function(){return I},v:function(){return U},w:function(){return C},x:function(){return G},y:function(){return y},z:function(){return g}});var a=n(40),i=n(41),r=n(32),o=n(133),s=n(4),c=n(24),d=n(21),l=n(115),u=n(435),f=n(57),p=n(55),m=!1;function _(){window.parent.postMessage(JSON.stringify({name:"share_copyLinkClicked"}),"*")}function h(){try{window.external.Dismiss()}catch(e){window.parent.postMessage(JSON.stringify({name:"share_dismiss"}),"*")}}function b(){window.parent.postMessage(JSON.stringify({name:"share_copyLinkNotificationShown"}),"*")}function g(e,t){try{window.external.ShareCompleted(e)}catch(a){var n={name:"share_completed",shareType:e,scope:t};window.parent.postMessage(JSON.stringify(n),"*")}}function v(e,t,n,a){try{window.external.ShareFailed(e,t,n,a)}catch(r){var i={name:"share_failed",shareType:e,rawError:t,errorCategory:n,errorMessage:a};window.parent.postMessage(JSON.stringify(i),"*")}}function y(e){try{window.external.ShareClicked(e)}catch(n){var t={name:"share_clicked",shareType:e};window.parent.postMessage(JSON.stringify(t),"*")}}function S(e){var t=!1,n=!1,a=new s.a({name:"sharingCopyToClipboardInterop"});try{var i=window.external;(0,d.$b)()||(n=!i.CopyToClipboard),t=i.CopyToClipboard(e),n=(0,d.$b)()?null==t||t:t||void 0===t,a.end({resultType:s.b.Success})}catch(t){if(!(i=window.external).CopyToClipboard){var r={name:"share_copyToClipboard",url:e};window.parent.postMessage(JSON.stringify(r),"*")}var o=new f.a({code:"windowExternalCopyToClipboardError",innerError:t});a.end((0,u.a)((0,l.a)(t),{resultCode:o.code}))}return n}function D(){var e=!1;try{e=window.external.IsSendCopyEnabled()}catch(e){}return e}function I(){try{window.external.SendCopy()}catch(e){window.parent.postMessage(JSON.stringify({name:"share_sendCopy"}),"*")}}function x(){var e=!1;try{e=window.external.IsSendPdfEnabled()}catch(e){}return e}function C(){try{window.external.SendPdf()}catch(e){window.parent.postMessage(JSON.stringify({name:"share_sendPdf"}),"*")}}function O(e,t,n){var a=t?t.length:0;try{window.external.SendLinkViaTeams(e.url)}catch(t){var i={name:"share_teamsClicked",sharingLink:e.url};window.parent.postMessage(JSON.stringify(i),"*")}try{window.external.SendLinkViaTeamsWithContext(e.url,t,a,n)}catch(i){var r={name:"share_teamsClickedWithContext",sharingLink:e.url,recipients:t,numRecipients:a,body:n};window.parent.postMessage(JSON.stringify(r),"*")}}function w(e){try{window.external.GrantAccessCompleted(e)}catch(n){var t={name:"share_grantAccessCompleted",successful:e};window.parent.postMessage(JSON.stringify(t),"*")}}function E(e,t){void 0===t&&(t="");try{window.external.AddPeopleCompleted(e,t)}catch(a){var n={name:"share_addPeopleCompleted",successful:e,completionMessage:t};window.parent.postMessage(JSON.stringify(n),"*")}}function A(e,t,n,r,o,c){if(!p.i(t)){m?function(e,t,n,r,o,c){var d=a.a[t]||"unknown";new s.a({name:"ShareV3.".concat(i.a[n],".AfterPageLoad"),startTimeOverride:e||void 0}).end({resultType:o?s.b.Failure:s.b.Success,extraData:{clientId:d,scenario:r,isError:!!o,correlationId:c,error:o}})}(e,t,n,r,o.isStubFile?"file uploading":o.errorMessage||"unknown error",c):(k(e,t,n,r,o.errorMessage||"unknown error",c),m=!0);try{window.external.PageError(o.error,o.errorCategory,o.errorMessage,o.debugErrorMessage)}catch(e){var d={name:"share_error",error:o.error,errorCategory:o.errorCategory,errorMessage:o.errorMessage,debugErrorMessage:o.debugErrorMessage};window.parent.postMessage(JSON.stringify(d),"*")}}}function L(){window.parent.postMessage(JSON.stringify({name:"share_outlookClicked"}),"*")}function k(e,t,n,r,o,c){if(e){var d=a.a[t]||"unknown";new s.a({name:"ShareV3.".concat(i.a[n],".PageLoaded"),startTimeOverride:e}).end({resultType:o?s.b.Failure:s.b.Success,extraData:{clientId:d,scenario:r,isError:!!o,correlationId:c,error:o}})}}function M(e,t,n,a,i){if(m){k(e,t,n,a,void 0,i),r=new s.a({name:"Sharing.post_share_ready_instant_load"});try{o={name:"share_instantLoadReady"},window.parent.postMessage(JSON.stringify(o),"*"),r.end({resultType:s.b.Success})}catch(e){r.end({resultType:s.b.Failure,resultCode:"post_share_ready_instant_load_failure"})}}else{k(e,t,n,a,void 0,i);try{window.external.PageFinishedLoading(),new s.a({name:"Sharing.post_webview_share_ready"}).end({resultType:s.b.Success})}catch(e){var r=new s.a({name:"Sharing.post_iframe_share_ready"});try{var o={name:"share_ready"};window.parent.postMessage(JSON.stringify(o),"*"),r.end({resultType:s.b.Success})}catch(e){r.end({resultType:s.b.Failure,resultCode:"post_share_ready_failure"})}}m=!0}}function P(){try{window.external.UIReady()}catch(e){window.parent.postMessage(JSON.stringify({name:"share_uiReady"}),"*")}}function T(){window.parent.postMessage(JSON.stringify({name:"share_readyForRecipients"}),"*")}function U(){window.parent.postMessage(JSON.stringify({name:"share_sendClicked"}),"*")}function F(){try{window.external.PeoplePickerFocused()}catch(e){window.parent.postMessage(JSON.stringify({name:"share_peoplePickerFocused"}),"*")}}function H(e,t,n,a,i){var o,s=(0,c.y)(i,e,n),d={sharingLink:e,companyName:t,clientId:i,isListSharing:a,customLabeledAudienceConfig:n},l=(0,c.A)(d),u=(0,c.L)(e.audience),f=(0,c.P)(e.status),p=e.audience===r.a.existing?"00000000-0000-0000-0000-000000000000":e.shareId,m=!1;try{window.external.LinkSettingsCompleted(p,e.url,s,l,u),m=!0}catch(e){}var _={id:p,expirationDateTime:null===(o=e.expiration)||void 0===o?void 0:o.toISOString(),hasPassword:!!e.hasPassword,link:{type:e.isReview?"review":e.isEdit?"edit":"view",blocksDownload:!!e.blockDownload,preventsDownload:!!e.blockDownload,createOnly:!!e.isCreateOnlyLink,iconUrl:s,localizedDescription:l,webUrl:e.url,scope:u,customLabeledAudience:e.audience===r.a.customLabeledSpecificPeople,status:f,createdDateTime:e.created}};try{window.external.LinkSettingsCompletedV2(JSON.stringify(_)),m=!0}catch(e){}if(!m){var h={name:"share_linkSettingsCompleted",type:e.isReview?"review":e.isEdit?"edit":"view",shareId:p,linkUrl:e.url,iconUrl:s,linkDescription:l,scope:u,blocksDownload:!!e.blockDownload,customLabeledAudience:e.audience===r.a.customLabeledSpecificPeople};window.parent.postMessage(JSON.stringify(h),"*"),window.parent.postMessage(JSON.stringify({name:"share_linkSettingsCompletedV2",permissions:_}),"*")}}function R(){var e=!1;try{e=window.external.IsDarkMode()}catch(e){}return e}function N(){var e=void 0;try{e=window.parent.GetShareDialogTheme()}catch(e){}return e}function B(){window.parent.postMessage(JSON.stringify({name:"share_manageAccessClicked"}),"*")}function j(){try{return window.external.IsMoreAppsEnabled()}catch(e){return!1}}function V(){try{return window.external.IsTeamsEnabled()}catch(e){return!1}}function z(){try{return window.external.CheckSendViaOutlookAvailability()}catch(e){return o.a.none}}function G(e,t,n,a){try{window.external.SendViaOutlookWithContext(e,t,n,a)}catch(r){var i={name:"share_outlookWithContext",recipients:e,numRecipients:t,body:n,sharingLink:a};window.parent.postMessage(JSON.stringify(i),"*")}}function K(e){try{window.external.PageStartedLoading()}catch(n){var t={name:"share_started",manifest:e};window.parent.postMessage(JSON.stringify(t),"*")}}}
,function(e,t,n){n.d(t,{a:function(){return u},b:function(){return f},c:function(){return h},d:function(){return _},e:function(){return b},f:function(){return m},g:function(){return p}});var a,i,r,o,s,c,d=n(117),l=n(21);function u(e){a=(0,d.b)(90076,e),i=(0,d.b)(90022,e),r=(0,d.b)(90128,e),o=(0,d.b)(90058,e),s=(0,d.b)(90222,e),c=(0,d.b)(90315,e)}function f(){try{if(sessionStorage.getItem("externalSharingConfirmationDialog"))return parseInt(sessionStorage.getItem("externalSharingConfirmationDialog"))}catch(e){}return o&&l.M()?(o.logExposure(),o.variantToDisplay):0}function p(){return a&&l.ic()?(a.logExposure(),a.variantToDisplay):0}function m(){return i&&l.Kb()?(i.logExposure(),i.variantToDisplay):0}function _(){return l.kb()&&r?(r.logExposure(),r.variantToDisplay):0}function h(){try{if(sessionStorage.getItem("linkReShareExperiment"))return parseInt(sessionStorage.getItem("linkReShareExperiment"))}catch(e){}return l.gb()?1:s?(s.logExposure(),s.variantToDisplay):0}function b(){try{if(sessionStorage.getItem("roleSelectorExperiment"))return parseInt(sessionStorage.getItem("roleSelectorExperiment"))}catch(e){}return l.mb()?1:c?(c.logExposure(),c.variantToDisplay):0}}
,,,,,,function(e,t,n){var a=n(91);t.a=a}
,function(e,t){var n;!function(e){e[e.none=0]="none",e[e.user=1]="user",e[e.distributionList=2]="distributionList",e[e.securityGroup=4]="securityGroup",e[e.sharePointGroup=8]="sharePointGroup",e[e.ConsumerGroup=16]="ConsumerGroup",e[e.all=15]="all"}(n||(n={})),t.a=n}
,function(e,t,n){var a,i,r;n.d(t,{a:function(){return a},b:function(){return i},c:function(){return r}}),function(e){e[e.regularUser=0]="regularUser",e[e.externalUser=1]="externalUser",e[e.group=2]="group",e[e.application=3]="application",e[e.linkedinUser=4]="linkedinUser"}(a||(a={})),function(e){e.graph="graph",e.sharepointSearch="sharepointSearch",e.substrate="substrate"}(i||(i={})),function(e){e.unified="unifiedGroup",e.securityGroup="securityGroup",e.SPGroup="SPGroup",e.PublicDistributionList="PublicDistributionList",e.family="family"}(r||(r={}))}
,function(e,t,n){var a;!function(e){e[e.File=0]="File",e[e.Folder=1]="Folder",e[e.Media=2]="Media",e[e.OneNote=3]="OneNote",e[e.Unknown=4]="Unknown",e[e.Error=5]="Error",e[e.App=6]="App",e[e.Subsite=7]="Subsite",e[e.Shortcut=8]="Shortcut",e[e.Album=9]="Album",e[e.MultiShare=10]="MultiShare"}(a||(a={})),t.a=a}
,function(e,t,n){n.d(t,{a:function(){return a}});var a={uninitialized:-1,anyone:0,organization:1,specificPeople:2,existing:3}}
,,,,,,,function(e,t,n){n.d(t,{a:function(){return r}});var a=n(28),i=n(12),r=(0,a.a)({eventName:"Engagement,",shortEventName:"Engagement"},{name:{isKey:!0,isPrefixingDisabled:!0,type:i.a.String},isIntentional:{isPrefixingDisabled:!0,type:i.a.Boolean},scenario:{isPrefixingDisabled:!0,type:i.a.String},location:{isPrefixingDisabled:!0,type:i.a.String},usageType:{isPrefixingDisabled:!0,type:i.a.String},currentPage:{isPrefixingDisabled:!0,type:i.a.String},previousPage:{isPrefixingDisabled:!0,type:i.a.String},experiment:{isPrefixingDisabled:!0,type:i.a.Object},siteId:{isPrefixingDisabled:!0,type:i.a.String},webId:{isPrefixingDisabled:!0,type:i.a.String},listId:{isPrefixingDisabled:!0,type:i.a.String},groupId:{isPrefixingDisabled:!0,type:i.a.String},docId:{isPrefixingDisabled:!0,type:i.a.String},webTemplateId:{isPrefixingDisabled:!0,type:i.a.String},listTemplateId:{isPrefixingDisabled:!0,type:i.a.String},siteType:{isPrefixingDisabled:!0,type:i.a.String},feature:{isPrefixingDisabled:!0,type:i.a.String},component:{isPrefixingDisabled:!0,type:i.a.String},extraData:i.a.Object,objectType:{isPrefixingDisabled:!0,type:i.a.String},datasource:{isPrefixingDisabled:!0,type:i.a.String},action:{isPrefixingDisabled:!0,type:i.a.String},privacyClassification:{isPrefixingDisabled:!0,type:i.a.String}}).withData({privacyClassification:i.b.optionalDiagnostic,privacyDataTypes:["browsingHistory"]})}
,function(e,t,n){n.d(t,{a:function(){return f}});var a=n(0),i=n(1),r=n(50),o=n(49),s=n(36),c=n(12),d=n(91),l=i.a.isActivated("4A5EF84E-0C1D-4359-91A1-6904CDD59B88"),u=function(e){function t(t,n){return e.call(this,t,o.b.Start,n)||this}return(0,a.d)(t,e),t.prototype.setTimeout=function(e,t){var n=this;this._clearTimeout(),this.timeoutId=window.setTimeout(function(){n.end(t)},e)},t.prototype.end=function(e){if(!this.endTime){this.endTime=e&&e.endTimeOverride||s.a.getTime();var t=(0,a.a)({duration:this.endTime-this.startTime},e);if(this._setData(t),r.d||!this.data.error||(0,r.c)(this.data.error)||(this.data.error=(0,r.e)(this.data.error,!1)),this._logEvent(o.b.End),l&&this._isQosEvent()){var n=this.data;n.error&&d.log((0,r.b)(n.error),n.name,n.resultCode,n.resultType)}this._clearTimeout()}},t.prototype._clearTimeout=function(){this.timeoutId&&(window.clearTimeout(this.timeoutId),this.timeoutId=void 0)},t.prototype._isQosEvent=function(){return this.eventName.indexOf("Qos,")>=0},t}(o.c);function f(e,t,n){var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.d)(t,e),t}(u),r=(0,a.a)((0,a.a)({},t),{duration:{isPrefixingDisabled:!0,type:c.a.Number}});return(0,o.d)(i.prototype,e,r,n),i}}
,function(e,t,n){n.r(t),n.d(t,{getErrorMessage:function(){return b},isExpectedError:function(){return g},log:function(){return h},logError:function(){return _},verbose:function(){return m}});var a=n(28),i=n(12),r=n(218),o=(0,a.a)({eventName:"CaughtError,Trace,",shortEventName:"CaughtError",critical:!0},{stack:i.a.String,extraData:i.a.Object,privacyClassification:{isPrefixingDisabled:!0,type:i.a.String}},r.a).withData({privacyClassification:i.b.requiredService}),s=n(35),c=(0,a.a)({eventName:"QosError,CaughtError,Trace,",shortEventName:"QosError",critical:!0},{name:{isKey:!0,type:i.a.String},resultCode:i.a.String,resultType:{typeRef:s.a,type:i.a.Enum}},o).withData({privacyClassification:i.b.requiredDiagnostic}),d=n(377),l=n(590),u=n(241),f="Canceled",p=new l.a(50);function m(e,t){p.push({name:t,message:e})}function _(e,t,n){var a;if(!e||function(e){return e===f||(null==e?void 0:e.name)===f||(null==e?void 0:e.message)===f}(e)||"object"==typeof e&&e.isExpected)try{if("true"===sessionStorage.getItem("suppressErrorHandling"))return}catch(e){}else{for(var i,r=b(e),s=null!==(a=null==e?void 0:e.stack)&&void 0!==a?a:"";i=p.popOldest();)d.a.logData(i);n&&n.eventName?c.logData({name:n.eventName,resultCode:n.resultCode,resultType:n.resultType,extraData:t||{},message:r,stack:s}):o.logData({extraData:t||{},message:r,stack:s})}}function h(e,t,n,a){_(e,void 0,{eventName:t,resultCode:n,resultType:a})}function b(e){var t,n;return e?"object"==typeof e?null!==(n=null!==(t=e.message)&&void 0!==t?t:e.description)&&void 0!==n?n:(0,u.a)(e):e.toString():""}function g(e,t){if(!0===e.isExpected)return!0;void 0===e.message&&void 0===e.code&&console.error('Error message and code are both undefined. "error" must specify at least message or code');for(var n=function(e,t){return!(!e||!t||0!==e.localeCompare(t,void 0,{sensitivity:"base"})&&e!==t)},a=!1,i=0,r=t;i<r.length;i++){var o=r[i],s=n(o.code,e.code),c=n(o.message,e.message);if(o.code&&e.code&&o.message&&e.message?a=s&&c:o.code&&e.code?a=s:o.message&&e.message&&(a=c),a)return a}return a}}
,,,,function(e,t,n){function a(){}function i(e){setTimeout(function(){throw e},0)}n.d(t,{a:function(){return r}});var r=function(){function e(e,t){void 0===t&&(t=i),this._isDisposed=!1,this._parent=e||null,this._onErrorHandler=t,this._timeoutIds=null,this._immediateIds=null,this._animationFrameIds=null,this._intervalIds=null}return e.prototype.dispose=function(){if(!this._isDisposed){if(this._isDisposed=!0,this._parent=null,this._timeoutIds){for(var e=0,t=Object.keys(this._timeoutIds);e<t.length;e++){var n=t[e];this.clearTimeout(Number(n))}this._timeoutIds=null}if(this._immediateIds){for(var a=0,i=Object.keys(this._immediateIds);a<i.length;a++)n=i[a],this.clearImmediate(Number(n));this._immediateIds=null}if(this._intervalIds){for(var r=0,o=Object.keys(this._intervalIds);r<o.length;r++)n=o[r],this.clearInterval(Number(n));this._intervalIds=null}if(this._animationFrameIds){for(var s=0,c=Object.keys(this._animationFrameIds);s<c.length;s++)n=c[s],this.cancelAnimationFrame(Number(n));this._animationFrameIds=null}}},e.prototype.setTimeout=function(e,t){var n=this,a=0;if(!this._isDisposed){var i=this._timeoutIds||(this._timeoutIds={}),r=this._parent;a=setTimeout(function(){try{delete i[a],e.apply(r)}catch(e){n._logError(e)}},t),i[a]=!0}return a},e.prototype.clearTimeout=function(e){var t=this._timeoutIds;t&&t[e]&&(clearTimeout(e),delete t[e])},e.prototype.setImmediate=function(e){var t=this,n=0;if(!this._isDisposed){var a=this._immediateIds||(this._immediateIds={}),i=this._parent,r=function(){try{delete a[n],e.apply(i)}catch(e){t._logError(e)}};n=window.setImmediate?window.setImmediate(r):window.setTimeout(r,0),a[n]=!0}return n},e.prototype.clearImmediate=function(e){var t=this._immediateIds;t&&t[e]&&(window.clearImmediate?window.clearImmediate(e):window.clearTimeout(e),delete t[e])},e.prototype.setInterval=function(e,t){var n=this,a=0;if(!this._isDisposed){this._intervalIds||(this._intervalIds={});var i=this._parent;a=setInterval(function(){try{e.apply(i)}catch(e){n._logError(e)}},t),this._intervalIds[a]=!0}return a},e.prototype.clearInterval=function(e){this._intervalIds&&this._intervalIds[e]&&(clearInterval(e),delete this._intervalIds[e])},e.prototype.throttle=function(e,t,n){var i=this;if(void 0===n&&(n={}),this._isDisposed)return a;var r,o,s=t||0,c=n.leading,d=void 0===c||c,l=n.trailing,u=void 0===l||l,f=0,p=null,m=this._parent,_=function(t){var n=(new Date).getTime(),a=n-f,c=d?s-a:s;return a>=s&&(!t||d)?(f=n,p&&(i.clearTimeout(p),p=null),r=e.apply(m,o)):null===p&&u&&(p=i.setTimeout(_,c)),r};return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o=e,_(!0)}},e.prototype.debounce=function(e,t,n){var i=this;if(void 0===n&&(n={}),this._isDisposed)return a;var r,o,s=t||0,c=n.leading,d=void 0!==c&&c,l=n.trailing,u=void 0===l||l,f=n.maxWait,p=void 0===f?NaN:f,m=0,_=(new Date).getTime(),h=null,b=this._parent,g=function(t){var n=(new Date).getTime(),a=!1;t&&(d&&n-m>=s&&(a=!0),m=n);var c=n-m,l=s-c,f=n-_,v=!1;return isNaN(p)||(f>=p&&h?v=!0:l=Math.min(l,p-f)),c>=s||v||a?(h&&(i.clearTimeout(h),h=null),_=n,r=e.apply(b,o)):null!==h&&t||!u||(h=i.setTimeout(g,l)),r};return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o=e,g(!0)}},e.prototype.requestAnimationFrame=function(e){var t=this,n=0;if(!this._isDisposed){var a=this._animationFrameIds||(this._animationFrameIds={}),i=this._parent,r=function(){try{delete a[n],e.apply(i)}catch(e){t._logError(e)}};n=window.requestAnimationFrame?window.requestAnimationFrame(r):window.setTimeout(r,0),a[n]=!0}return n},e.prototype.cancelAnimationFrame=function(e){var t=this._animationFrameIds;t&&t[e]&&(window.cancelAnimationFrame?window.cancelAnimationFrame(e):window.clearTimeout(e),delete t[e])},e.prototype._logError=function(e){this._onErrorHandler&&this._onErrorHandler(e)},e}()}
,function(e,t,n){n.d(t,{a:function(){return u},b:function(){return l}});var a,i,r=n(10),o=n(1);!function(e){e[e.none=0]="none",e[e.standard=1]="standard",e[e.compact=2]="compact",e[e.minimal=3]="minimal",e[e.extended=4]="extended"}(a||(a={})),function(e){e[e.left=0]="left",e[e.middle=1]="middle",e[e.right=2]="right"}(i||(i={}));var s,c=o.b.isActivated("F9624ACA-9230-4329-9616-969638C4D4CB","05/08/2022","Include Personal Site Id in generated Server Url for Freemium lists"),d="undefined"!=typeof window&&r.a.isFeatureEnabled({ODB:1737});function l(e){var t=e.webAbsoluteUrl,n=e.webServerRelativeUrl,a=e.isSiteListsHost;return"/"===n||""===n||!c&&a||d&&(null==e?void 0:e.isUnifiedAdminUrl)?t:t.substring(0,t.lastIndexOf(n))}function u(e){return"/"===e.webServerRelativeUrl?"":e.webServerRelativeUrl}!function(e){e[e.FooterEnabled=2]="FooterEnabled",e[e.MegaMenuEnabled=128]="MegaMenuEnabled",e[e.FooterEmphasis0=256]="FooterEmphasis0",e[e.FooterEmphasis1=512]="FooterEmphasis1",e[e.FooterLayout0=1024]="FooterLayout0",e[e.FooterLayout1=2048]="FooterLayout1",e[e.HideTitleInHeader=33554432]="HideTitleInHeader",e[e.HorizontalQuickLaunch=1]="HorizontalQuickLaunch"}(s||(s={}))}
,function(e,t,n){n.d(t,{a:function(){return a}});var a=function(){try{return!!window.sessionStorage.getItem("_isRunningTABTest")}catch(e){return console.log("No session storage accessible: "+e),!1}}}
,function(e,t,n){n.d(t,{a:function(){return a}});var a={generic:0,getSharingInformation:1,shareLink:2,shareObject:3,permissions:4,item:5,me:6,drive:7,invite:8,createLink:9};t.b={authFailure:1,serverFailure:2,invalidItem:3,invalidWebAbsoluteUrl:4,generic:5,objectNotSupported:6,invalidEmail:7,linkNoLongerAvailable:8}}
,function(e,t){var n=function(){function e(){}return e.encodeURIComponent=function(e,t,n,a){var i="",r=0;if(!e)return"";var o=e.length;for(r=0;r<o;r++){var s=e.charCodeAt(r),c=e.charAt(r);if(t&&("#"===c||"?"===c)){i+=e.substr(r);break}n&&"&"===c?i+=c:s<=127?a||s>=97&&s<=122||s>=65&&s<=90||s>=48&&s<=57||t&&s>=32&&s<=95&&" \"%<>'&".indexOf(c)<0?i+=c:s<=15?i+="%0"+s.toString(16).toUpperCase():s<=127&&(i+="%"+s.toString(16).toUpperCase()):s<=2047?(i+="%"+(192|s>>6).toString(16).toUpperCase(),i+="%"+(128|63&s).toString(16).toUpperCase()):55296!=(64512&s)?(i+="%"+(224|s>>12).toString(16).toUpperCase(),i+="%"+(128|(4032&s)>>6).toString(16).toUpperCase(),i+="%"+(128|63&s).toString(16).toUpperCase()):r<e.length-1&&(s=(1023&s)<<10,r++,s|=1023&e.charCodeAt(r),i+="%"+(240|(s+=65536)>>18).toString(16).toUpperCase(),i+="%"+(128|(258048&s)>>12).toString(16).toUpperCase(),i+="%"+(128|(4032&s)>>6).toString(16).toUpperCase(),i+="%"+(128|63&s).toString(16).toUpperCase())}return i},e.escapeUrlForCallback=function(t){var n=t.indexOf("#"),a=t.indexOf("?");if(n>0&&(-1===a||n<a)){var i=t.substr(0,n);a>0&&(i+=t.substr(a)),t=i}return e.encodeURIComponent(t,!0,!1,!0)},e.encodeRestUriStringToken=function(t,n){return t&&(t=(t=t.replace(/'/g,"''")).replace(/%27/g,"%27%27"),n||(t=e.encodeURIComponent(t))),t},e}();t.a=n}
,function(e,t,n){n.d(t,{a:function(){return C}});var a,i,r=n(270),o=n(0),s=n("react-lib"),c=n(43),d=n(83),l=n(3),u=n(429),f=n(5),p=n(101),m=n(44),_=new Set(["ariaLabel","ariaLive","className","componentRef","label","labelPosition","styles","size","theme","type"]),h={top:"above",right:"after",bottom:"below",left:"before"},b=((a={})[p.a.xSmall]="extra-tiny",a[p.a.small]="extra-tiny",a[p.a.medium]="tiny",a[p.a.large]="small",a),g=((i={})[p.b.normal]="tiny",i[p.b.large]="small",i),v=n(106),y=(0,f.a)({useStaticStyles:!0}),S=(0,c.a)({spinner:(0,o.a)({},d.a.overflow("hidden"))}),D=function(e){var t=function(e){var t,n=e.labelPosition?h[e.labelPosition]:"below";e.type&&(t=g[e.type]),t=void 0!==e.size?b[e.size]:null!=t?t:"tiny";var a={ref:e.componentRef,labelPosition:n,size:t,label:e.label,className:e.className};return(0,o.a)((0,o.a)({},a),(0,m.b)(e,_))}(e),n=y(e.styles,{theme:e.theme}),a=S();return t.label&&(t.label={className:(0,l.a)("ms-Label",n.label),children:t.label}),t.className=(0,l.a)("ms-Spinner",n.root,e.className),(0,v.j)()&&(t.spinner={className:a.spinner}),s.createElement(u.a,(0,o.a)({},t))};D.displayName="SpinnerShim";var I=n(42),x=n(34),C=function(e){return(0,I.a)(r.a,D,e,x.a.FluentUIV9ShimSpinner)}}
,,,,,,function(e,t,n){n.d(t,{a:function(){return s},b:function(){return l},c:function(){return c},d:function(){return r},e:function(){return o},f:function(){return i},g:function(){return u},h:function(){return p},i:function(){return f},j:function(){return d}});var a=n(1);function i(){return a.b.isActivated("f6c0b3d3-2a6b-4b1f-8d6b-0d0c8c9e4a3b")}function r(){return a.b.isActivated("a7d3d5c3-5e7d-4f3d-8f6c-1f2d8b3b2b7d")}function o(){return a.b.isActivated("5e49e708-9893-49f1-a434-07833cc41dcc")}function s(){return a.b.isActivated("537ce842-578a-404a-bce4-46ab01997882")}function c(){return a.b.isActivated("9d77f6bc-b916-495f-b5ef-6679104b1dae")}function d(){return a.b.isActivated("a4c46f85-d94f-41d7-b9f9-86437989792a")}function l(){return a.b.isActivated("cc29b11c-05b7-45d4-8957-68c74e250454")}function u(){return a.b.isActivated("df222c86-e3c7-4687-b0ef-857d3fe9aae0")}function f(){return a.b.isActivated("9d99f474-55ce-4a7b-aec3-de73bb989b0a")}function p(){return a.b.isActivated("f49ea922-2c1c-456d-90de-3f6bd8f7f850")}}
,function(e,t){var n;!function(e){e[e.share=0]="share",e[e.copy=1]="copy",e[e.outlook=2]="outlook",e[e.nonOutlook=3]="nonOutlook",e[e.moreApps=4]="moreApps",e[e.mobileShareToTeams=5]="mobileShareToTeams",e[e.webShareToTeams=6]="webShareToTeams",e[e.grantAccess=7]="grantAccess"}(n||(n={})),t.a=n}
,,,,,function(e,t,n){n.d(t,{a:function(){return u},b:function(){return l}});var a=n(0),i=n(61),r=n(14),o=n("react-lib"),s={gapSpace:0},c={styles:{content:{fontSize:"0.75rem"}},maxWidth:"300px"},d=0;function l(e,t,n){var l=(n=n||{}).tooltipId?n.tooltipId:"od-Share-tooltip-".concat(d);d++;var u=n.targetElementId?(0,a.a)((0,a.a)({},s),{target:"#".concat(n.targetElementId)}):s;return o.createElement(i.a,{id:l,content:t,directionalHint:void 0===n.position?r.a.topCenter:n.position,calloutProps:u,tooltipProps:c,styles:n.styles},e)}function u(e,t,n,a){return o.createElement("span",{tabIndex:-1,"aria-hidden":!!a,className:"od-Share-screenReaderOnly","aria-live":t,role:n},e||"")}}
,,,function(e,t,n){n.d(t,{a:function(){return f}});var a=n(0),i=n(1),r=n(37),o=n(50),s="cdn.office.net",c=void 0,d=n(553),l=n(4),u=i.a.isActivated("2C9E2041-2438-49D5-AB48-429FD2A74192");function f(e,t){var i,p,m=e||void 0,_=u?void 0:function(e){var t;try{var a=null!==(t=e.stack)&&void 0!==t?t:"string"==typeof e?e:void 0;if(!a)return;for(var i=[],d=!1,l=a.split("\n"),u=function(){var e;if(!c){c=[s];var t=n.p||"undefined"!=typeof window&&(null===(e=window.require)||void 0===e?void 0:e.toUrl(""));t&&t.indexOf(s)<0&&new r.a(t).authority&&c.push(new r.a(t).authority)}return c}(),f=1;f<l.length;f++){for(var p=l[f],m=!1,_=0,h=u;_<h.length;_++){var b=h[_];if(p.includes(b)){m=!0;break}}m?(d=!0,i.push(p)):i.push("<scrubbed-stack-line>")}return d?(0,o.e)(i.join("\n")):(0,o.e)("<scrubbed-stack>")}catch(e){return}}(null==e?void 0:e.stack);return(0,a.a)((0,a.a)((0,a.a)({error:(0,d.a)(e),resultCode:m&&(i=m,p=[],"object"==typeof i.extraData&&i.extraData&&void 0!==i.extraData.status&&p.push("[".concat(i.extraData.status,"]")),"string"==typeof i.code&&p.push("".concat(i.code)),p.join(" "))||e&&e.name||(e?"Unknown":void 0)},m?(0,a.a)({},"boolean"==typeof m.isExpected?{resultType:m.isExpected?l.b.ExpectedFailure:l.b.Failure}:{resultType:l.b.Failure}):{resultType:l.b.Success}),_?{stackTrace:_}:{}),{extraData:(0,a.a)((0,a.a)((0,a.a)({},u?{stack:e&&e.stack}:{}),m?(0,a.a)((0,a.a)((0,a.a)({},"object"==typeof m.innerError?{innerError:f(m.innerError)}:{}),"string"==typeof m.correlationId?{CorrelationId:m.correlationId}:{}),"object"==typeof m.extraData?(0,a.a)({},m.extraData):{}):{}),(null==t?void 0:t.extraData)||{})})}}
,function(e,t,n){n.d(t,{a:function(){return i}});var a=n(36);function i(){var e=window.CUSTOMERPROMISE_MANAGER=window.CUSTOMERPROMISE_MANAGER||(0,a.c)({sourceName:"CustomerPromise"});return(0,a.d)(e)}}
,function(e,t,n){n.d(t,{a:function(){return x},b:function(){return I},c:function(){return D},d:function(){return C}});var a=n(65),i=n(1),r=n(28),o=n(12),s=(0,r.a)({eventName:"ExperimentFlight,",shortEventName:"ExperimentFlight"},{experimentId:{isPrefixingDisabled:!0,type:o.a.Number},variant:{isPrefixingDisabled:!0,type:o.a.Number},isAATest:{isPrefixingDisabled:!0,type:o.a.Boolean},isOverride:{isPrefixingDisabled:!0,type:o.a.Boolean},isLoggedAtExposure:{isPrefixingDisabled:!0,type:o.a.Boolean},serverTime:{isPrefixingDisabled:!0,type:o.a.String}});function c(e){var t=e.charCodeAt(0);return t>=65&&t<=90?t-65:t>=97&&t<=122?t-71:t>=48&&t<=57?t+4:43===t?62:63}function d(e,t){var n=t.toString(36);n=Array(4-n.length).join("0")+n;for(var a=0;a<e.length;a++)for(var i=0;i<e[a].length-2;i+=3)if(e[a].substring(i,i+3)===n)return a+4;return 0}function l(e,t){if(t>Math.floor(3*e.length/2)-1)return 0;var n=Math.floor(t/3*2);switch(t%3){case 0:return c(e[n])>>2;case 1:return(3&c(e[n]))<<2|c(e[n+1])>>4;case 2:return 15&c(e[n])}return 0}var u=n(421),f="FeatureOverrides_experiments";function p(e){return"number"==typeof e}function m(e){return Array.isArray(e)&&2===e.length&&p(e[0])&&p(e[1])}function _(e){try{var t=e&&JSON.parse(e);if(Array.isArray(t))return t.filter(m)}catch(e){}return[]}var h=function(){function e(){}return Object.defineProperty(e,"experimentOverrides",{get:function(){return e._experimentOverridesData||(e._experimentOverridesData=function(){try{for(var e=new Map,t=_((0,u.b)(f)),n=0,i=t;n<i.length;n++){var r=i[n];e.set(r[0],r[1])}for(var o=window&&window.location&&window.location.search?_((0,a.a)(window.location.search.substr(1)).expOverrides):[],s=0,c=o;s<c.length;s++)r=c[s],e.set(r[0],r[1]);var d=Array.from(e);return(0,u.c)(f,JSON.stringify(d)),d}catch(e){return[]}}()),e._experimentOverridesData},enumerable:!1,configurable:!0}),e.clear=function(){e._experimentOverridesData=void 0,(0,u.a)(f)},e._experimentOverridesData=void 0,e}(),b=9e4,g="experimentLogCacheTime",v="experimentLogCache",y=!i.a.isActivated("4F6F5B50-178E-40E9-B992-A49FC5B41195"),S=function(){function e(e,t,n){var i;if(this._isAATest=!1,this._isOverride=!1,this._serverTime="",this._shouldLogVariantPropertyAccess=!1,this._loggedPropertyAccess=!1,this._loggedExposure=!1,this._variantToDisplay=0,this._experimentId=e,this._shouldLogVariantPropertyAccess=n,this._serverTime=null!==(i=null==t?void 0:t.serverTime)&&void 0!==i?i:"",y)for(var r=0,o=h.experimentOverrides;r<o.length;r++){var s=o[r];if(s[0]===e)return void this._setProperties(s[1],s[1],!1,!0)}else if(window&&window.location&&window.location.search){var c=(0,a.a)(window.location.search.substr(1)).expOverrides;if(c){var u=void 0;try{u=JSON.parse(c)}catch(e){u=[]}for(var f=0,p=u;f<p.length;f++){var m=p[f];if(m&&2===m.length&&m[0]===e)return void this._setProperties(m[1],m[1],!1,!0)}}}if(!t||void 0===t.experimentData||void 0===t.experimentDataLookup||void 0===t.serverTime||this._experimentId<b)return this._variantToDisplay=0,void(this._variantToLog=void 0);var _=e-b,g=l(t.experimentData,_);if(0===g)this._setProperties(0,void 0,!1,!1);else if(g>=1&&g<=4)this._setProperties(g-1,g-1,!1,!1);else if(5===g){var v=d(t.experimentDataLookup,_);this._setProperties(v,v,!1,!1)}else g>=6&&g<=9?this._setProperties(0,g-6,!0,!1):10===g?this._setProperties(0,d(t.experimentDataLookup,_),!0,!1):g>=11&&g<=14?this._setProperties(g-11,g-11,!1,!0):(v=d(t.experimentDataLookup,_),this._setProperties(v,v,!1,!0));this._saveExperiments()}return Object.defineProperty(e.prototype,"variantToDisplay",{get:function(){return this._shouldLogVariantPropertyAccess&&this._logInternal(!1),this._variantToDisplay},enumerable:!1,configurable:!0}),e.getExperimentTags=function(e){if(void 0===e.experimentData||void 0===e.experimentDataLookup||void 0===e.serverTime)return[];for(var t=[],n=b;n<=90499;n++){var a=n-b,i=l(e.experimentData,a),r=void 0;if(0!==i){if(i>=1&&i<=4)r=(i-1).toString();else{if(5!==i)continue;r=d(e.experimentDataLookup,a).toString()}if(void 0!==r){var o="".concat(n.toString(),"-").concat(r);-1===t.indexOf(o)&&t.push(o)}}}return t},e._getItemFromSessionStorageNoThrow=function(e){try{return sessionStorage.getItem(e)}catch(e){return null}},e._setItemInSessionStorageNoThrow=function(e,t){try{sessionStorage.setItem(e,t)}catch(e){}},e.prototype.logExposure=function(){this._logInternal(!0)},e.prototype._saveExperiments=function(){window.ODSP_EXPERIMENTS=window.ODSP_EXPERIMENTS||{},window.ODSP_EXPERIMENTS[this._experimentId]=this},e.prototype._logInternal=function(t){var n=void 0!==this._variantToLog&&(t&&!this._loggedExposure||!t&&!this._loggedPropertyAccess),a=null,i=null;if(n&&(a=e._getItemFromSessionStorageNoThrow(g),i=e._getItemFromSessionStorageNoThrow(v),n=a!==this._serverTime||!i||-1===i.indexOf(this._experimentId.toString()+t)),n&&void 0!==this._variantToLog){var r={experimentId:this._experimentId,variant:this._variantToLog,isAATest:this._isAATest,isOverride:this._isOverride,isLoggedAtExposure:t,serverTime:this._serverTime};s.logData(r),t?this._loggedExposure=!0:this._loggedPropertyAccess=!0,a===this._serverTime?e._setItemInSessionStorageNoThrow(v,(null!=i?i:"")+this._experimentId.toString()+t):(e._setItemInSessionStorageNoThrow(g,this._serverTime),e._setItemInSessionStorageNoThrow(v,this._experimentId.toString()+t))}},e.prototype._setProperties=function(e,t,n,a){this._variantToDisplay=e,this._variantToLog=t,this._isAATest=n,this._isOverride=a},e}();function D(e,t){var n=new S(e,t,!1);return n.logExposure(),n.variantToDisplay}function I(e,t){return new S(e,t,!0)}function x(e,t){return new S(e,t,!1).variantToDisplay}function C(e){if(!e)return!1;if(!window.ODSP_EXPERIMENT_TAGS||0===window.ODSP_EXPERIMENT_TAGS.length){var t=S.getExperimentTags(e);if(0===t.length)return!1;window.ODSP_EXPERIMENT_TAGS=t}return!0}}
,function(e,t,n){n.d(t,{a:function(){return _e},b:function(){return he}});var a=n(0),i=n(7),r=n(244);function o(e){var t,n=e.adjustRetries,a=e.async,i=e.beforeRetry,o=e.callback,s=e.canRetry,c=void 0===s?function(){return!0}:s,d=e.delay,l=e.resetAttemptsOnRestart,u=e.shouldRestart,f=e.retries,p=0,m=new r.a(function(){t.cancel()});function _(e){u&&u()?(l&&(p=0),b()):m.complete(e)}function h(e){n&&(f=n(e)),p<f&&c(e)?(p++,i&&i(),"number"==typeof d&&a?a.setTimeout(b,d):b()):m.error(e)}function b(){(t=o()).then(_,h)}return b(),m.getPromise()}var s=n(207),c=n(89),d=n(4),l=n(122),u=n(57),f=n(37),p=n(247),m="SPServiceResponse",_=function(e){function t(n){var i=this,r=n.errorData,o=n.innerError instanceof t&&n.innerError.errorData,s=n.errorData||o||{status:0},c=s.message,d=void 0===c?void 0:c,l=s.correlationId,u=void 0===l?void 0:l,f=s.code,p=void 0===f?void 0:f,m=(0,a.f)(s,["message","correlationId","code"]),_="object"==typeof d?d?JSON.stringify(d):"".concat(d):d,h=r&&r.codes||{order:[],map:{}};if(o&&o.codes)for(var b=0,g=o.codes.order;b<g.length;b++){var v=g[b];h.map[v]||(h.order.push(v),h.map[v]=o.codes.map[v])}var y=(0,a.a)((0,a.a)((0,a.a)((0,a.a)((0,a.a)({},"string"==typeof u?{correlationId:u}:{}),"string"==typeof p?{code:p}:{}),"string"==typeof _?{message:_}:{}),n),{extraData:(0,a.a)((0,a.a)({},n.extraData||{}),{hasAuthChallenge:!!s.authenticate,status:s.status,infected:s.infected,groupThrottle:s.groupThrottle,statusText:s.statusText})});(i=e.call(this,y)||this).name="GetDataError",i.codes=h,i.errorData=s;for(var S=0,D=Object.keys(m);S<D.length;S++)i[v=D[S]]=m[v];return i}return(0,a.d)(t,e),t}(u.a),h="Unknown",b="Canceled",g="NoConnection",v="Offline",y="XSPOErrorMessage",S="UrlTooLong",D=n(31),I=n(159),x=n(1),C=n(10),O="MS-CV",w="Retry-After",E="WWW-Authenticate",A="x-ms-diagnostics",L="X-SubStatusCode",k="X-SPO-ErrorCode",M="X-SPO-ErrorMessage",P="X-MSDAVEXT_Error",T="SPSQLQueryCount",U="SPClientServiceRequestDuration",F="SPGroupThrottle",H="X-ServiceWorkerFetchInfo",R="x-virus-infected",N="X-Msedge-Ref",B=function(){function e(e,t,n){this._request=e,this._url=t,this._webAbsoluteUrl=n&&n.webAbsoluteUrl,this._isCanaryRequest=n&&n.isCanaryRequest}return e.prototype.getSourceUrl=function(){return this._url},e.prototype.getAllResponseHeaders=function(){return this._request.getAllResponseHeaders()},e.prototype.getCorrelationId=function(){return this.getResponseHeader("SPRequestGuid")},e.prototype.getServiceWorkerDataSourceHeader=function(){return this.getResponseHeader("X-SERVICEWORKER-DATA-SOURCE")},e.prototype.getStatus=function(){var e=-1;try{e=this._request.status}catch(e){}return"number"==typeof e?e:-1},e.prototype.getAuthenticationRedirect=function(){return this.getResponseHeader("X-Forms_Based_Auth_Required")},e.prototype.getResponseType=function(){return this._request.responseType},e.prototype.getResponseText=function(){return this._request.responseType&&"text"!==this._request.responseType?this._request.response:this._request.responseText},e.prototype.getErrorResponseText=function(){return"blob"===this._request.responseType?{status:this._request.status,statusText:this._request.statusText,infected:!!this.getResponseHeader(R),authenticate:this.getResponseHeader(E)}:this.getResponseText()},e.prototype.parseError=function(){var e=this,t=new r.a;return this._request.responseType&&"text"!==this._request.responseType?"blob"===this._request.responseType?function(e){var t,n=new r.a,a=function(){if(t.result){var e=void 0;try{e=JSON.parse(t.result),n.complete(e)}catch(e){n.complete({message:"Unable to parse blob result."})}}},i=function(){n.complete({message:"Unable to read blob error response."})};try{(t=new FileReader).addEventListener("load",a),t.addEventListener("error",i),t.readAsText(e)}catch(e){i()}return n.getPromise().then(function(e){return t&&(t.removeEventListener("load",a),t.removeEventListener("error",i)),e})}(this._request.response).then(function(n){var a={data:n,status:e.getStatus(),statusText:e._request.statusText,infected:!!e.getResponseHeader(R),authenticate:e.getResponseHeader(E)};t.complete(a)}):t.complete(this._request.response):t.complete(this._request.responseText),t.getPromise()},e.prototype.getValue=function(t){var n;switch(t){case e.DataValueKeys.SourceURL:n=this.getSourceUrl();break;case e.DataValueKeys.CorrelationId:n=this.getCorrelationId();break;case e.DataValueKeys.Status:n=this.getStatus();break;case e.DataValueKeys.AuthenticationRedirect:n=this.getAuthenticationRedirect();break;case e.DataValueKeys.ResponseText:n=this.getResponseText();break;case e.DataValueKeys.ErrorResponseText:n=this.getErrorResponseText()}return n},e.prototype.getRedirectUrl=function(){return this._isCanaryRequest?403===this.getStatus()?this.shouldRedirectToErrorCustomPromptLocation()?this.getRedirectToErrorCustomPromptLocation():this.getRedirectLoginPageUrl():this.getAccessDeniedRedirectUrl():403===this.getStatus()||401===this.getStatus()?this.shouldRedirectToErrorCustomPromptLocation()?this.getRedirectToErrorCustomPromptLocation():this.getRedirectLoginPageUrl():void 0},e.prototype.getRedirectLoginPageUrl=function(){var e,t=this.getAuthenticationRedirect();if(t){var n=new D.a(t);n.setQueryParameter("ReturnUrl",I.b(window.location.href)),e=n.toString()}else if(!x.a.isActivated("E01ED707-3C9F-4CD5-8ADF-8A5484D4A861","04/18/2023","Construct redirectUrl targetting Default.aspx")){var a=x.a.isActivated("46AD8143-4179-406B-83E3-582A1DD3F543","07/21/2023","Use location to determine redirectUrl, in case of cross site calls")?new f.a(this._url).authority:new f.a(window.location.href).authority;a&&(e="".concat(a,"/_forms/Default.aspx?ReturnUrl=").concat(encodeURIComponent(location.href)));var i=this.getResponseHeader("Reauthid");if(C.a.isFeatureEnabled({ODB:60017})&&i){var r=new URL(location.href);r.searchParams.append("reauthid",i),e=r.toString()}}return e},e.prototype.getAccessDeniedRedirectUrl=function(){var e;if(this._webAbsoluteUrl){var t=this._webAbsoluteUrl+"/_layouts/15/AccessDenied.aspx";if(t){var n=new D.a(t);n.setQueryParameter("Source",I.b(window.location.href)),n.setQueryParameter("Type","list"),n.setQueryParameter("correlation",I.b(this.getCorrelationId())),e=n.toString()}}return e},e.prototype.getRedirectToErrorCustomPromptLocation=function(){var e=this.getResponseHeader("X-SPO-ErrorCustomPromptLocation"),t=new D.a(e);return t.setQueryParameter("ReturnUrl",window.location.href),t.toString()},e.prototype.shouldRedirectToErrorCustomPromptLocation=function(){var e=this.getResponseHeader(k),t=this.getResponseHeader("sharepointerror");return"9.3"===e||"-2130575129"===t},e.prototype.getResponseHeadersDictionary=function(){var e={},t=this.getAllResponseHeaders();if(t){var n=t.trim().split(/[\r\n]+/);n&&n.length>0&&n.forEach(function(t){var n=t.split(": "),a=n.shift(),i=n.join(": ");e[a]=i})}return this.getResponseHeadersDictionary=function(){return e},e},e.prototype.getResponseHeader=function(e){var t=this.getResponseHeadersDictionary();return t[e.toLowerCase()]||t[e]||this._request.getResponseHeader(e)},e.prototype.getHeaderNumberValue=function(e){var t=this.getResponseHeader(e),n=Number(t);return isNaN(n)?void 0:n},e.DataValueKeys={SourceURL:"SourceUrl",CorrelationId:"CorrelationId",Status:"Status",AuthenticationRedirect:"AuthenticationRedirect",ResponseText:"ResponseText",ErrorResponseText:"ErrorResponseText",GroupThrottle:"GroupThrottle"},e}(),j=n(246),V=n(58),z=n(121),G=x.a.isActivated("94486333-390c-4bb2-9cbf-371c7042f19a"),K=C.a.isFeatureEnabled({ODB:60886}),W=x.a.isActivated("A822F129-AEE4-4E61-A630-5B52B95F9DC3"),q=function(){function e(e){var t;void 0===e&&(e={}),this._scope=new z.a,this._events=this._scope.attach(new V.a(this));var n=e.webAbsoluteUrl||e.webUrl;this._webServerRelativeUrl=e.webServerRelativeUrl||n&&new D.a(n).getPath(),"/"===this._webServerRelativeUrl&&(this._webServerRelativeUrl=""),x.a.isActivated("5F6AAA43-30D4-4E2C-B9CF-76C77A7F48DE","10/04/2022","Always use token provider to fetch tokens")?n?(this._webAbsoluteUrl=n,this._alwaysGetDigest=!0):this._alwaysGetDigest=!1:this._alwaysGetDigest=null!==(t=e.alwaysGetDigest)&&void 0!==t&&t,this._needsRequestDigest=!1!==e.needsRequestDigest,this._needsRequestDigest&&this._tryLoadDigest(e.formDigest),this._requestCanaryForAuth=!1,this._engagement=e.engagement,this._operationName=e.operationName}return e._isValidFormDigest=function(e){return!!(e&&e.serverTime&&Date.now()-new Date(e.serverTime).getTime()<1e3*(e.formDigestTimeoutSeconds-60))},e.prototype.dispose=function(){this._scope.dispose()},e.prototype.abort=function(){if(this._currentRequest){var e=this._currentRequest;e.isCancelled=!0,e.abort(),this._currentRequest=void 0}},e.prototype.isRequestActive=function(){return!!this._currentRequest},e.prototype.getServerDataFromUrl=function(e){var t=this,n=e.url,a=e.successCallback,i=e.failureCallback,r=e.uploadProgressCallback,o=e.additionalPostData,s=e.isRest,c=void 0===s||s,d=e.method,l=void 0===d?"POST":d,u=e.withCredentials,f=e.additionalHeaders,p=e.contentType,m=e.noRedirect,_=e.responseType,h=e.needsRequestDigest,b=void 0===h?this._needsRequestDigest:h,g=(new Date).toISOString(),v=new XMLHttpRequest;v.open(l,n,!0),"boolean"==typeof u&&(v.withCredentials=u),_&&(v.responseType=_);var y=o instanceof FormData;p?v.setRequestHeader("Content-Type",p):y||(c?v.setRequestHeader("Content-Type","application/json;odata=verbose"):v.setRequestHeader("Content-Type","application/x-www-form-urlencoded"));var S=!1;if(f)for(var D in f)D&&(v.setRequestHeader(D,f[D]),"accept"===D.toLowerCase()&&(S=!0));S||v.setRequestHeader("accept","application/json;odata=verbose"),this._currentRequest=v;var I=function(e){b&&e&&v.setRequestHeader("x-requestdigest",e),t._events.on(v,"readystatechange",function(){t._onReadyStateChange(v,n,a,i,!!m,g)}),r&&v.upload&&t._events.on(v.upload,"progress",function(e){r(e)}),v.send(o)};b?this._ensureRequestDigest(I,i):I()},e.prototype.ensureRequestDigest=function(e,t){this._ensureRequestDigest(e,t)},e.prototype._ensureRequestDigest=function(t,n){var a=e._formDigests[this._webServerRelativeUrl];!this._alwaysGetDigest&&e._isValidFormDigest(a)?t(a.formDigestValue):this._ensureRequestDigestWorker(t,n)},e.prototype._ensureRequestDigestWorker=function(t,n){var a=this,i=new Date,r=new e({needsRequestDigest:!1,webServerRelativeUrl:this._webServerRelativeUrl,webUrl:void 0});t||(r._requestCanaryForAuth=!0);var o=this._webAbsoluteUrl||this._webServerRelativeUrl;"string"==typeof o?(e._requestDigestPromise||(e._requestDigestPromise=new Promise(function(s,c){r.getServerDataFromUrl({url:D.a.concatenate(o,"/_api/contextinfo"),successCallback:function(t){var n=t.getResponseText(),r=JSON.parse(n).d.GetContextWebInformation;e._formDigests[a._webServerRelativeUrl]={serverTime:i.toISOString(),formDigestValue:r.FormDigestValue,formDigestTimeoutSeconds:r.FormDigestTimeoutSeconds-60,updateFormDigestPageLoaded:new Date},s(e._formDigests[a._webServerRelativeUrl].formDigestValue),e._requestDigestPromise=void 0},failureCallback:function(a,i){W?(t?t(void 0):n&&n(a,i),c(void 0)):c({serverData:a,error:i}),e._requestDigestPromise=void 0},method:"POST",noRedirect:!!n})})),W?e._requestDigestPromise.then(function(e){return t&&t(e),e}):e._requestDigestPromise.then(function(e){return t&&t(e),e}).catch(function(e){var a=e.serverData,i=e.error;t?t(void 0):n&&n(a,i)})):n&&n(void 0,new u.a({code:"MissingWebForDigestAuth",isExpected:!1}))},e.prototype._onReadyStateChange=function(t,n,a,i,r,o){var s;if(4===t.readyState)if(this._currentRequest=void 0,this._events.off(t),t.upload&&this._events.off(t.upload),(s=t)&&s.isCancelled)i(void 0,new j.a);else if(function(e){try{if(4===e.readyState&&(void 0===e.status||0===e.status))return!1}catch(e){return!1}return!0}(t)){var c=new B(t,n,{webAbsoluteUrl:this._webAbsoluteUrl||this._webServerRelativeUrl,isCanaryRequest:this._requestCanaryForAuth}),d=c.getStatus(),l=!r&&c.shouldRedirectToErrorCustomPromptLocation();if(this._requestCanaryForAuth){if(this._requestCanaryForAuth=!1,403===d){var f=c.getRedirectLoginPageUrl();try{l?window.location.href=c.getRedirectToErrorCustomPromptLocation():i(c)}catch(e){}f&&!r&&(window.location.href=f)}else{f=c.getAccessDeniedRedirectUrl();try{i(c)}catch(e){}f&&!r&&(this._engagement&&this._engagement.logData({name:"AccessDeniedRedirect",isIntentional:!1,extraData:{originalOperation:this._operationName||""}}),window.location.href=f)}return}if(200===d||201===d||204===d||K&&!G&&202===d)return void a(c);if(403===d)return e._requestDigestPromise=void 0,void(r?this._ensureRequestDigestWorker(void 0,function(e,t){return i(c,t)}):l?window.location.href=c.getRedirectToErrorCustomPromptLocation():this._ensureRequestDigestWorker(void 0));401===d&&l&&(window.location.href=c.getRedirectToErrorCustomPromptLocation()),i(c)}else i(void 0,new u.a({code:g,isExpected:!0}))},e.prototype._tryLoadDigest=function(t){if(e._isValidFormDigest(t))e._formDigests[this._webServerRelativeUrl]=t;else{var n=e._formDigests[this._webServerRelativeUrl];e._isValidFormDigest(t)&&(!e._isValidFormDigest(n)||n&&new Date(n.serverTime).getTime()<new Date(t.serverTime).getTime())&&(e._formDigests[this._webServerRelativeUrl]=t)}},e._formDigests={},e._requestDigestPromise=void 0,e}();function Q(e){var t=e.options,n=t.url,r=t.authToken,o=t.telemetryHandler,s=t.useExactAuthToken,c=t.method,l=t.additionalHeaders,u=e.dataSyncClient,f=e.aadUserId,p=e.getData,m=function(){return p({url:n,telemetryHandler:o,authToken:r,useExactAuthToken:s})};return x.a.isActivated("26fb0edf-b3af-42db-b8ea-2858c7eacfe0")&&!f?m():i.c.resolve(u).then(function(e){return e?function(e){var t=function(e,t){return function(n,i,r){var o,s=n.eventData,c=s.extraData,l=void 0===c?{}:c,u={performanceEntry:l&&l.performanceEntry,httpStatus:l&&l.HttpStatus,responseHeaders:null===(o=n.serverData)||void 0===o?void 0:o.getResponseHeadersDictionary(),correlationId:l&&l.CorrelationId,succeeded:s&&s.resultType===d.b.Success||!1,resultCode:s&&s.resultCode,extraData:l},f=t&&t(n),p=x.a.isActivated("97E1912E-09BC-4111-9A67-EEA52ACC4BF3")?e.onRequestComplete(i,u):r(u);return l.dataSyncQos=e.getQosInfo(),(0,a.a)((0,a.a)({},f||{}),{eventData:(0,a.a)((0,a.a)({},f?f.eventData:s),{extraData:(0,a.a)((0,a.a)({},f?f.eventData.extraData:s.extraData),e.getQosInfo())}),canRetry:p&&(!f||f.canRetry)})}}(e,o);return e.getData({url:n,method:c,additionalHeaders:l},function(e){var n=e.endpoint,a=e.headers,i=e.onComplete;return p({url:n.url,authToken:n.authToken,telemetryHandler:function(e){return t(e,n,i)},useExactAuthToken:!0,additionalHeaders:a})},m)}(e):m()})}var Y=n(30),J=n(115),X=n(243),Z=x.a.isActivated("1A27D204-D190-440A-BD0E-C321879347A4");function $(e){var t=e.options,n=e.webAbsoluteUrl,r=e.apiEvent,o=e.tokenProvider,c=e.getData,d=e.qosName,l=t.url,p=new f.a(l),m="".concat(p.authority,"/{ length: ").concat(p.path.length,", segments: ").concat(p.segments.length," }"),_=function(e,t){if(!o.getAuthToken)return i.c.resolve({authToken:void 0});var n=new r({name:"".concat(d,".getAuthToken").concat(t?".retry":""),url:m});return i.c.resolve(o.getAuthToken(e)).then(function(e){return e&&"string"!=typeof e?(n.end({resultType:s.b.Success,resultCode:e.authToken?"tokenAuth":"cookieAuth",extraData:{AuthCorrelationId:e.correlationId,AuthExpiration:e.expiresOn}}),e):(n.end({resultType:s.b.Success,resultCode:e?"tokenAuth.string":"cookieAuth.string"}),{authToken:e})}).catch(function(e){return n.end((0,J.a)(e)),i.c.reject(e)})},h=function(e,t){if(!o.getFormDigest)return i.c.resolve(void 0);var n=new r({name:"".concat(d,".getAuthToken").concat(t?".retry":""),url:m});return i.c.resolve(o.getFormDigest(e)).then(function(e){return n.end({resultType:s.b.Success,resultCode:e?"newDigest":"sameDigest"}),e}).catch(function(e){return n.end((0,J.a)(e)),i.c.reject(e)})};if(!_&&!h)return c({url:l});if(Z&&n&&(x.a.isActivated("BCE56589-7ADA-489E-B936-97BC6F63C8CA")||"/"!==l[0])&&!(0,X.a)(l,encodeURI(n)))throw new u.a({code:"TargetUrlDoesNotBeginWithWebAbsoluteUrl"});var b={url:l,webAbsoluteUrl:n,claimsChallenge:t.claimsChallenge},g={url:l,webAbsoluteUrl:n,claimsChallenge:t.claimsChallenge};return _(b,!1).then(function(e){return e.authToken?e:h(g,!1).then(function(t){return e})}).then(function(e){if(!Z&&e.authToken&&n&&(x.a.isActivated("BCE56589-7ADA-489E-B936-97BC6F63C8CA")||"/"!==l[0])&&!(0,X.a)(l,encodeURI(n)))throw new u.a({code:"TargetUrlDoesNotBeginWithWebAbsoluteUrl"});return c({url:l,authToken:e.authToken,qosExtraData:{AuthCorrelationId:e.correlationId,AuthExpiration:e.expiresOn}}).catch(function(t){var n;if(ne(t))n={claimsChallenge:{authToken:e.authToken,claims:te(t),error:t}};else{if(!ie(t)&&!ae(t))return i.c.reject(t);n={expiration:{authToken:e.authToken,error:t}}}return _((0,a.a)((0,a.a)({},b),n),!0).then(function(n){if(!n.authToken){var r=void 0;if(ne(t))r={claimsChallenge:{claims:te(t),error:t}};else{if(!ie(t)&&!ae(t))return i.c.reject(t);r={expiration:{error:t}}}return h((0,a.a)((0,a.a)({},g),r),!0).then(function(e){return n})}return n.authToken===e.authToken?i.c.reject(t):n}).then(function(e){return c({url:l,authToken:e.authToken,qosExtraData:{AuthCorrelationId:e.correlationId,AuthExpiration:e.expiresOn}})}).catch(function(e){return i.c.reject(e)})})})}var ee="Bearer";function te(e){var t=e.authenticate,n='claims="';if(t){var a=t.indexOf(n);if(a>-1){var i=t.indexOf('"',a+n.length);if(i>-1){var r=t.slice(a+n.length,i);return x.a.isActivated("93E9F77D-7B3B-4760-B58F-1154E9E530ED","06/02/2022","Decode claims from base64")?r:atob(r)}}}}function ne(e){var t=e.authenticate;return!!(t&&t.slice(0,ee.length)===ee&&t.indexOf('error="insufficient_claims"')>-1)}function ae(e){return!!e.authenticate}function ie(e){var t=e.code;return"3000002,invalid_client"===t||"10013"===t||"917656"===t}var re=n(148);function oe(e,t){return void 0===t&&(t=re.a),function(e){function n(n){var i=e.call(this,n)||this;return n.pillar&&(i._customerPromise=new t({scenario:n.name,pillar:n.pillar,extraData:(0,a.a)((0,a.a)({},null==n?void 0:n.extraData),{isFromQosEvent:!0})}),n.veto&&(i._computeVeto=n.veto)),i}return(0,a.d)(n,e),n.prototype.end=function(t){this._customerPromise&&((null==t?void 0:t.resultType)===d.b.Success?this._customerPromise.end({resultType:null==t?void 0:t.resultType,errorCode:null==t?void 0:t.resultCode,extraData:(0,a.a)((0,a.a)({},null==t?void 0:t.extraData),{isFromQosEvent:!0})}):this._customerPromise.end({resultType:null==t?void 0:t.resultType,errorCode:null==t?void 0:t.resultCode,veto:this._computeVeto?this._computeVeto(t):"None",extraData:(0,a.a)((0,a.a)({},null==t?void 0:t.extraData),{isFromQosEvent:!0})})),e.prototype.end.call(this,t)},n}(e)}var se=n(50),ce=x.a.isActivated("937A3141-0674-4F3C-B6F6-AACCD3BFD1DD","07/12/2024","Disable collect sp perf metrics for Image tagging"),de="undefined"!=typeof window?window:void 0,le=de&&de.performance,ue=function(){function e(e,t){var n,a,i,r,o,d,l,u,f,p;this._dataRequestorContext=t.dataRequestorContext,this._tokenProvider=null!==(n=null==t?void 0:t.tokenProvider)&&void 0!==n?n:null===(a=this._dataRequestorContext)||void 0===a?void 0:a.tokenProvider,this._dataSyncClient=null!==(i=null==t?void 0:t.dataSyncClient)&&void 0!==i?i:null===(r=this._dataRequestorContext)||void 0===r?void 0:r.dataSyncClient,this._qosName=e.qosName,this._apiEvent=null!==(o=null==t?void 0:t.apiEvent)&&void 0!==o?o:s.a,this._engagement=null!==(d=null==t?void 0:t.engagement)&&void 0!==d?d:c.a,this._normalizeErrors=null===(l=e.normalizeErrors)||void 0===l||l,this._getDataWithTokenProvider=null!==(u=null==t?void 0:t.getDataWithTokenProvider)&&void 0!==u?u:$,this._getDataWithSyncClient=null!==(f=null==t?void 0:t.getDataWithSyncClient)&&void 0!==f?f:Q,this._offlineDetection=null==t?void 0:t.offlineDetection,this._noRedirect=null===(p=null==t?void 0:t.noRedirect)||void 0===p||p}return e.parseJSON=function(e){return e&&JSON.parse(e)||void 0},e.prototype.getData=function(e){var t=e.cancelToken,n=this._getData(e);if(t){var a=t.subscribe(function(){n.cancel()});return Promise.resolve(n).then(function(e){return a(),e}).catch(function(e){throw a(),e})}return Promise.resolve(n)},e.prototype._getData=function(t){var n=this,r=t.parseResponse,s=void 0===r?e.parseJSON:r,c=t.qosExtraData,l=t.additionalPostData,D=void 0===l?"":l,I=t.contentType,R=t.method,B=void 0===R?"POST":R,j=t.maxRetries,V=void 0===j?0:j,z=t.responseType,G=t.onUploadProgress,K=t.timeout,W=t.noTimeoutInLastRetry,Q=void 0!==W&&W,J=t.webAbsoluteUrl,X=t.allowOAuth,Z=void 0===X||X,$=t.customerPromise,ee=t.url,te=t.maxUrlLength,ne=void 0===te?2e3:te,ae=t.onBeforeRequest;if(ee.length>ne)throw new _({errorData:{code:"".concat(-6,",").concat(S),status:-1}});var ie=this._dataRequestorContext,re=this._tokenProvider,ue=this._getDataWithTokenProvider,fe=this._getDataWithSyncClient,pe=[];this._qosName&&pe.push(this._qosName),t.qosName&&pe.push(t.qosName);var me=pe.join("."),_e=function(e){var r=e.url,l=e.telemetryHandler,S=e.authToken,R=e.useExactAuthToken,j=void 0!==R&&R,W=e.additionalHeaders,X=!0,ee=new f.a(r),te="".concat(ee.authority,"/{ length: ").concat(ee.path.length,", segments: ").concat(ee.segments.length," }"),ne=function(e){var S=e.authToken,R=e.qosExtraData,ee=t.crossSiteCollectionCall,ne=void 0!==ee&&ee,ue=t.noRedirect,fe=void 0===ue?n._noRedirect:ue,pe=t.needsRequestDigest,_e=void 0===pe||pe,he=(0,a.a)((0,a.a)((0,a.a)({},t.additionalHeaders),W),ce||"ODSDataSource.ODSP.ImageTag.Feedback.UploadImage"!==me?{CollectSPPerfMetrics:T}:{});if(Z&&S){var be=!1;Y.a.isFeatureEnabled({ECS:86137})||S.split(" ").length>1&&(be=!0);var ge=j||be?S:"Bearer ".concat(S),ve=!1;for(var ye in he)ye&&"authorization"===ye.toLowerCase()&&(ve=!0);ve||(he.Authorization=ge),ne=!0,_e=!1,fe=!0}else Z&&C.a.isFeatureEnabled({ODB:60959})&&re&&(he.Authorization="Bearer");var Se,De,Ie=new q((0,a.a)((0,a.a)({},ie?{webServerRelativeUrl:ie.webServerRelativeUrl,webAbsoluteUrl:J||ie.webAbsoluteUrl,alwaysGetDigest:ne,formDigest:{serverTime:ie.serverTime,updateFormDigestPageLoaded:ie.updateFormDigestPageLoaded,formDigestValue:ie.formDigestValue,formDigestTimeoutSeconds:ie.formDigestTimeoutSeconds}}:{}),{needsRequestDigest:_e,engagement:n._engagement,operationName:n._qosName})),xe=de&&de.location&&new f.a(de.location.href).authority,Ce=new f.a(r).authority;return null==ae||ae(),function(e){var t=e.onExecute,n=e.onCancel,a=e.timeout,r=e.canRetry,s=e.noTimeoutInLastRetry,c=0,d=Math.max(e.maxRetries,0),l=function(){var e=new i.a(t,function(){n(c>=d||!r())});return a&&(!s||c<d)?i.a.timeout(a,e):e};return c<d?o({canRetry:r,retries:d,callback:l,beforeRetry:function(){c++}}):l()}({timeout:K,onExecute:function(e,i){var o=function(t,o){return function(u){var f=u.getResponseText();De=u.getServiceWorkerDataSourceHeader();var m,h,b,g,v=(0,p.a)(r,o),y=(0,a.a)((0,a.a)((0,a.a)((0,a.a)({},c||{}),{needsRequestDigest:_e,hasAuthToken:!!S,isCrossOrigin:!!xe&&xe!==Ce,CorrelationId:u.getCorrelationId()}),R||{}),{HttpStatus:u.getStatus(),serviceWorkerDataSource:De||void 0,rawRequestDuration:v.duration,performanceEntry:JSON.stringify(v),serviceWorkerFetchInfo:u.getResponseHeader(H)||void 0,SQLRT:u.getHeaderNumberValue(T),ServerDuration:u.getHeaderNumberValue(U)}),D=!1;try{!function(e,t){return"blob"===e&&!!t&&"object"==typeof t}(z,f)?h=s(f,u):b=f,D=!0}catch(e){m=e,g={resultType:d.b.Failure,resultCode:"InvalidJSON",error:(0,se.e)("object"==typeof e?JSON.stringify(e):e,!1),extraData:y}}if(g||(g={resultType:d.b.Success,extraData:y}),l&&(g=l({response:h,eventData:g,serverData:u}).eventData),null==t||t.end(g),D)try{e(b||h)}catch(e){}else i(n._normalizeErrors?new _({code:"-1,parse_response",innerError:m,errorData:{correlationId:u.getCorrelationId(),status:u.getStatus()}}):void 0);Ie=void 0}},f=function(e,o){return function(s,f){var b=(0,p.a)(r,o),I=(0,a.a)((0,a.a)({},c||{}),{needsRequestDigest:_e,hasAuthToken:!!S,isCrossOrigin:!!xe&&xe!==Ce,rawRequestDuration:b.duration,performanceEntry:JSON.stringify(b)}),C="undefined"!=typeof navigator&&!1===navigator.onLine;if(n._offlineDetection&&(C=n._offlineDetection.offline),!s){var T=h,U=!0,H=0;f&&f instanceof u.a&&(T=f.code,U=f.isExpected,H=-1),!C||T!==g&&T!==h||(T=v);var R={status:H,code:T},B={resultType:U?d.b.ExpectedFailure:d.b.Failure,resultCode:T,extraData:I};return l&&(B=l({eventData:B,errorData:R}).eventData),null==e||e.end(B),void i(n._normalizeErrors?new _({errorData:R,innerError:f}):R)}var j=function(r){var o=void 0,c=function(e){var t=!1,n={order:[],map:{}},a=e.getResponseHeader(A);if(a)try{var i=/(\d+)(?:;reason="([^"]+?)")?(?:;category="([^"]+?)")?/.exec(a),r=i[1],o=void 0===r?"-1":r,s=i[2],c=void 0===s?"":s,d=i[3],l=void 0===d?"unknown":d;switch(Number(o)){case 3e6:case 3000003:case 3000006:case 3001003:case 3001004:case 3001005:case 3002e3:case 3004009:case 3004010:case 3003e3:t=!0;break;default:t=!1}var u={source:A,code:"".concat(o,",").concat(l),message:c,isDisplayable:!0};n.order.push(u.source),n.map[u.source]=u}catch(e){}var f=e.getResponseHeader(P);if(f)try{var p=/(\d+);\s+(.+)/.exec(f),m=p[1],_=void 0===m?"-1":m,h=p[2];u={source:P,code:_,message:c=void 0===h?"":h,isDisplayable:!1},n.order.push(u.source),n.map[u.source]=u}catch(e){}var b=e.getResponseHeader(k);if(b){var g=e.getResponseHeader(M);u={source:k,code:b,message:g,isDisplayable:!0},n.order.push(u.source),n.map[u.source]=u}var v=e.getResponseHeader(L);return v&&(u={source:L,code:v},n.order.push(u.source),n.map[u.source]=u),{codes:n,isExpected:t}}(s),u=null==c?void 0:c.isExpected,f=null==c?void 0:c.codes;if("object"==typeof r&&"number"==typeof r.status)o=r;else if("string"==typeof r){var p=void 0;try{p=JSON.parse(r)}catch(e){}if(p)if(p.error_description)o={code:"-1,".concat(p.error||"Unknown"),message:p.error_description},"policy_enforced"===p.error&&(u=!0);else if("string"==typeof p.error)o={message:p.error};else if(p.error&&p.error.message&&p.error.message.value){var b={source:m,code:p.error.code,message:"".concat(p.error.message.value),isDisplayable:!0};f&&(f.order.push(b.source),f.map[b.source]=b),o=p.error}else o=p.error||p["odata.error"]||{responseData:p};else if(r&&400===s.getStatus()){var g;g=function(e){return/<html[^>]*>[\s\S]*?<body[^>]*>[\s\S]*?<\/body>[\s\S]*?<\/html>/i.test(e)}(r)?function(e){var t=e.match(/<body[^>]*>[\s\S]*<\/body>/i);return t?t[0]:""}(r).slice(0,1e3):r.slice(0,1e3),o={code:"-1,HTMLResult",message:g},I=(0,a.a)((0,a.a)({},I),{rawUrl:t.url,rawPayload:D})}}var v=s.getStatus(),S=s.getCorrelationId(),T=s.getResponseHeader(F),U=s.getResponseHeader(P);if(I=(0,a.a)((0,a.a)({},I),{CorrelationId:S,HttpStatus:v,GroupThrottle:T,MSCorrelationVector:s.getResponseHeader(O)}),(401===v&&U||403===v||404===v||429===v||503===v||-1===v||0===v&&C)&&(X=!1,u=!0),400===v){var H=function(e){var t,n={order:[],map:{}},a="No X-Msedge-Ref details",i=e.getResponseHeader(N);return i?t={source:L,code:"Non-Empty X-Msedge-Ref details",message:i}:x.a.isActivated("44F48045-1E39-41C1-962A-7F04F8093447")&&(t={source:L,code:a,message:a}),t&&(n.order.push(t.source),n.map[t.source]=t),{codes:n,isExpected:!1}}(s);f&&H&&(Array.prototype.push.apply(f.order,H.codes.order),H.codes.order.forEach(function(e){f.map[e]=H.codes.map[e]})),I.rawUrl||I.rawPayload||(I=(0,a.a)((0,a.a)({},I),{rawUrl:t.url,rawPayload:D}))}(o=o||{}).codes=f,o.status=v,o.retryAfter=s.getHeaderNumberValue(w),o.authenticate=s.getResponseHeader(E),o.authenticate&&(u=!0),S&&(o.correlationId=S),T&&(o.groupThrottle=T);var R=JSON.stringify(o);x.a.isActivated("C17CE162-3524-444F-85D5-8B5A0AA35544")||(o.targetUrl=s.getSourceUrl());var B=o["@error.redirectUrl"],j=s.getRedirectUrl()||B;j&&(u=!0,o.redirectUrl=j);var V=null==f?void 0:f.map.SPServiceResponse;V&&n._normalizeErrors&&(o.message=V.message);var z=null==f?void 0:f.order[0];z&&(b=f.map[z])&&(z===k&&b.message?(o.code=y,o.message=b.message):b.code&&(o.code=b.code)),o.code||(o.code=h);var G="[".concat(v,"] ").concat(o.code),K={resultType:u?d.b.ExpectedFailure:d.b.Failure,error:(0,se.e)(R,!1),resultCode:G,extraData:I};if(l){var W=l({eventData:K,errorData:o,serverData:s}),q=W.eventData,Q=W.canRetry;q&&(K=q),!0!==Q&&!1!==Q||(X=Q),K.resultType===d.b.ExpectedFailure&&(u=!0)}var Y=n._normalizeErrors?new _({errorData:o,isExpected:u}):o;Y.codes&&Y.codes&&(K.extraData||(K.extraData={}),K.extraData.errorCodes=JSON.stringify(Y.codes.map)),null==e||e.end(K),i(Y)},V=s.getResponseType();V&&"text"!==V?s.parseError().then(j):j(s.getResponseText())}};!function(){var e;e=Se=$?new(oe(n._apiEvent))({url:te,name:me,pillar:(null==$?void 0:$.pillar)?$.pillar:void 0,veto:(null==$?void 0:$.veto)?$.veto:void 0}):new n._apiEvent({url:te,name:me});var t=le&&le.now();Ie.getServerDataFromUrl({url:r,successCallback:o(e,t),failureCallback:f(e,t),uploadProgressCallback:G,additionalPostData:D,method:B,additionalHeaders:he,contentType:I,withCredentials:!S&&void 0,noRedirect:fe,responseType:z,needsRequestDigest:_e})}()},maxRetries:V,noTimeoutInLastRetry:Q,canRetry:function(){return X},onCancel:function(e){Ie&&(Ie.abort(),e&&Ie.dispose())}}).then(function(e){return Ie&&Ie.dispose(),e},function(e){return Ie&&Ie.dispose(),!Se.endTime&&i.a.isCanceled(e)&&Se.end({resultCode:b,resultType:d.b.ExpectedFailure}),i.a.reject(e)})};return S?i.a.resolve(S).then(function(e){return ne({url:r,authToken:e})}):(null==ie?void 0:ie.authToken)?i.a.resolve(ie.authToken).then(function(e){return ne({url:r,authToken:e})}):re?null==ue?void 0:ue({apiEvent:n._apiEvent,getData:ne,options:{url:r,authToken:t.authToken,qosExtraData:t.qosExtraData,claimsChallenge:t.claimsChallenge},webAbsoluteUrl:J||ie&&ie.webAbsoluteUrl,qosName:me,tokenProvider:re}):(null==ie?void 0:ie.getAuthToken)?i.a.resolve(ie.getAuthToken()).then(function(e){return ne({url:r,authToken:e})}):ne({url:r})},he={authToken:t.authToken,telemetryHandler:t.telemetryHandler,url:t.url,useExactAuthToken:t.useExactAuthToken,method:t.method,additionalHeaders:t.additionalHeaders};return this._dataSyncClient&&!t.skipSyncClient?null==fe?void 0:fe({options:he,aadUserId:null==ie?void 0:ie.aadUserId,dataSyncClient:this._dataSyncClient,getData:_e}):_e(he)},e}(),fe=x.a.isActivated("cb77018d-603a-46a1-8ddf-5a8f4e2fee2f"),pe="undefined"!=typeof window?window:void 0,me=pe&&pe.performance,_e=function(){function e(e,t){var n,i,r,o,d,l,u,f,p,m;if(fe)this._pageContext=t?t.pageContext:e.pageContext,this._tokenProvider=null!==(i=null==t?void 0:t.tokenProvider)&&void 0!==i?i:null===(r=this._pageContext)||void 0===r?void 0:r.tokenProvider,this._dataSyncClient=null!==(o=null==t?void 0:t.dataSyncClient)&&void 0!==o?o:null===(d=this._pageContext)||void 0===d?void 0:d.dataSyncClient,this._qosName=e.qosName,this._apiEvent=null!==(l=null==t?void 0:t.apiEvent)&&void 0!==l?l:s.a,this._engagement=null!==(u=null==t?void 0:t.engagement)&&void 0!==u?u:c.a,this._normalizeErrors=!!e.normalizeErrors,this._getDataWithTokenProvider=null!==(f=null==t?void 0:t.getDataWithTokenProvider)&&void 0!==f?f:$,this._getDataWithSyncClient=null!==(p=null==t?void 0:t.getDataWithSyncClient)&&void 0!==p?p:Q,this._offlineDetection=null==t?void 0:t.offlineDetection,this._noRedirect=null!==(m=null==t?void 0:t.noRedirect)&&void 0!==m?m:!!(null==t?void 0:t.tokenProvider)||void 0;else{var _=t?t.pageContext:e.pageContext;this._dataRequestorNew=new ue((0,a.a)((0,a.a)({},e),{normalizeErrors:!!e.normalizeErrors}),(0,a.a)((0,a.a)({},t||{}),{dataRequestorContext:_,noRedirect:null!==(n=null==t?void 0:t.noRedirect)&&void 0!==n?n:!!(null==t?void 0:t.tokenProvider)}))}}return e.parseJSON=function(e){return e&&JSON.parse(e)||void 0},e.prototype.getData=function(e){if(void 0!==this._dataRequestorNew){var t,n,r=function(){e.onBeforeRequest&&e.onBeforeRequest();var t=l.a.getRUMOneLogger(),n=Date.now();t&&(t.readTempData("appDataFetchStart")||t.saveTempData("appDataFetchStart",n))};if(e.cancelToken)return i.c.resolve(this._dataRequestorNew.getData((0,a.a)((0,a.a)({},e),{onBeforeRequest:r})));var o=new j.b;return this._dataRequestorNew.getData((0,a.a)((0,a.a)({},e),{onBeforeRequest:r,cancelToken:o.token})).then(function(e){null==t||t(e),null==o||o.dispose()}).catch(function(e){null==n||n(e),null==o||o.dispose()}),new i.c(function(e,a){t=e,n=a},function(){o.cancel()})}var s=this._oldGetData(e);return e.cancelToken?i.c.resolve(function(e,t){return(0,a.b)(this,void 0,void 0,function(){var n,i,r;return(0,a.e)(this,function(a){switch(a.label){case 0:n=t.subscribe(function(){e.cancel()}),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,e];case 2:return i=a.sent(),n(),[2,i];case 3:throw r=a.sent(),n(),r;case 4:return[2]}})})}(s,e.cancelToken)):s},e.prototype._oldGetData=function(t){var n=this,r=t.parseResponse,s=void 0===r?e.parseJSON:r,c=t.qosExtraData,D=t.additionalPostData,I=void 0===D?"":D,R=t.contentType,B=t.method,j=void 0===B?"POST":B,V=t.maxRetries,z=void 0===V?0:V,G=t.responseType,K=t.onUploadProgress,W=t.timeout,Q=t.noTimeoutInLastRetry,J=void 0!==Q&&Q,X=t.webAbsoluteUrl,Z=t.allowOAuth,$=void 0===Z||Z,ee=t.customerPromise,te=t.url,ne=t.maxUrlLength,ae=void 0===ne?2e3:ne;if(te.length>ae)throw new _({errorData:{code:"".concat(-6,",").concat(S),status:-1}});var ie=this._pageContext,re=this._tokenProvider,se=this._getDataWithTokenProvider,ce=this._getDataWithSyncClient,de=[];this._qosName&&de.push(this._qosName),t.qosName&&de.push(t.qosName);var le=de.join("."),ue=function(e){var r=e.url,S=e.telemetryHandler,D=e.authToken,B=e.useExactAuthToken,V=void 0!==B&&B,Q=e.additionalHeaders,Z=!0,te=new f.a(r),ne="".concat(te.authority,"/{ length: ").concat(te.path.length,", segments: ").concat(te.segments.length," }"),ae=function(e){var D=e.authToken,B=e.qosExtraData,te=t.crossSiteCollectionCall,ae=void 0!==te&&te,se=t.noRedirect,ce=void 0===se?n._noRedirect:se,de=t.needsRequestDigest,ue=void 0===de||de,fe=(0,a.a)((0,a.a)((0,a.a)({},t.additionalHeaders),Q),{CollectSPPerfMetrics:T});if($&&D){var _e=!1;Y.a.isFeatureEnabled({ECS:86137})||D.split(" ").length>1&&(_e=!0);var he=V||_e?D:"Bearer ".concat(D),be=!1;for(var ge in fe)ge&&"authorization"===ge.toLowerCase()&&(be=!0);be||(fe.Authorization=he),ae=!0,ue=!1,ce=!0}else $&&C.a.isFeatureEnabled({ODB:60959})&&re&&(fe.Authorization="Bearer");var ve,ye,Se=new q((0,a.a)((0,a.a)({},ie?{webServerRelativeUrl:ie.webServerRelativeUrl,webAbsoluteUrl:X||ie.webAbsoluteUrl,alwaysGetDigest:ae,formDigest:{serverTime:ie.serverTime,updateFormDigestPageLoaded:ie.updateFormDigestPageLoaded,formDigestValue:ie.formDigestValue,formDigestTimeoutSeconds:ie.formDigestTimeoutSeconds}}:{}),{needsRequestDigest:ue,engagement:n._engagement,operationName:n._qosName})),De=pe&&pe.location&&new f.a(pe.location.href).authority,Ie=new f.a(r).authority,xe=l.a.getRUMOneLogger(),Ce=Date.now();return xe&&(xe.readTempData("appDataFetchStart")||xe.saveTempData("appDataFetchStart",Ce)),function(e){var t=e.onExecute,n=e.onCancel,a=e.timeout,r=e.canRetry,s=e.noTimeoutInLastRetry,c=0,d=Math.max(e.maxRetries,0),l=function(){var e=new i.c(t,function(){n(c>=d||!r())});return a&&(!s||c<d)?i.c.timeout(a,e):e};return c<d?o({canRetry:r,retries:d,callback:l,beforeRetry:function(){c++}}):l()}({timeout:W,onExecute:function(e,i){var o=function(t,o){return function(l){var u=l.getResponseText();ye=l.getServiceWorkerDataSourceHeader();var f,m,h,b,g=(0,p.a)(r,o),v=(0,a.a)((0,a.a)((0,a.a)((0,a.a)({},c||{}),{needsRequestDigest:ue,hasAuthToken:!!D,isCrossOrigin:!!De&&De!==Ie,CorrelationId:l.getCorrelationId()}),B||{}),{HttpStatus:l.getStatus(),serviceWorkerDataSource:ye||void 0,rawRequestDuration:g.duration,performanceEntry:JSON.stringify(g),serviceWorkerFetchInfo:l.getResponseHeader(H)||void 0,SQLRT:l.getHeaderNumberValue(T),ServerDuration:l.getHeaderNumberValue(U)}),y=!1;try{!function(e,t){return"blob"===e&&t&&"object"==typeof t}(G,u)?m=s(u,l):h=u,y=!0}catch(e){f=e,b={resultType:d.b.Failure,resultCode:"InvalidJSON",error:"object"==typeof e?JSON.stringify(e):e,extraData:v}}if(b||(b={resultType:d.b.Success,extraData:v}),S&&(b=S({response:m,eventData:b,serverData:l}).eventData),t.end(b),y)try{e(h||m)}catch(e){}else i(n._normalizeErrors?new _({code:"-1,parse_response",innerError:f,errorData:{correlationId:l.getCorrelationId(),status:l.getStatus()}}):void 0);Se=void 0}},l=function(e,o){return function(s,l){var f=(0,p.a)(r,o),b=(0,a.a)((0,a.a)({},c||{}),{needsRequestDigest:ue,hasAuthToken:!!D,isCrossOrigin:!!De&&De!==Ie,rawRequestDuration:f.duration,performanceEntry:JSON.stringify(f)}),C="undefined"!=typeof navigator&&!1===navigator.onLine;if(n._offlineDetection&&(C=n._offlineDetection.offline),!s){var T=h,U=!0,H=0;l&&l instanceof u.a&&(T=l.code,U=l.isExpected,H=-1),!C||T!==g&&T!==h||(T=v);var R={status:H,code:T},B={resultType:U?d.b.ExpectedFailure:d.b.Failure,resultCode:T,extraData:b};return S&&(B=S({eventData:B,errorData:R}).eventData),e.end(B),void i(n._normalizeErrors?new _({errorData:R,innerError:l}):R)}var j=function(r){var o=void 0,c=function(e){var t=!1,n={order:[],map:{}},a=e.getResponseHeader(A);if(a)try{var i=/(\d+)(?:;reason="([^"]+?)")?(?:;category="([^"]+?)")?/.exec(a),r=i[1],o=void 0===r?"-1":r,s=i[2],c=void 0===s?"":s,d=i[3],l=void 0===d?"unknown":d;switch(Number(o)){case 3e6:case 3000003:case 3000006:case 3001003:case 3001004:case 3001005:case 3002e3:case 3004009:case 3004010:case 3003e3:t=!0;break;default:t=!1}var u={source:A,code:"".concat(o,",").concat(l),message:c,isDisplayable:!0};n.order.push(u.source),n.map[u.source]=u}catch(e){}var f=e.getResponseHeader(P);if(f)try{var p=/(\d+);\s+(.+)/.exec(f),m=p[1],_=void 0===m?"-1":m,h=p[2];u={source:P,code:_,message:c=void 0===h?"":h,isDisplayable:!1},n.order.push(u.source),n.map[u.source]=u}catch(e){}var b=e.getResponseHeader(k);if(b){var g=e.getResponseHeader(M);u={source:k,code:b,message:g,isDisplayable:!0},n.order.push(u.source),n.map[u.source]=u}var v=e.getResponseHeader(L);return v&&(u={source:L,code:v},n.order.push(u.source),n.map[u.source]=u),{codes:n,isExpected:t}}(s),l=c.isExpected,u=c.codes;if("object"==typeof r&&"number"==typeof r.status)o=r;else if("string"==typeof r){var f=void 0;try{f=JSON.parse(r)}catch(e){}if(f)if(f.error_description)o={code:"-1,".concat(f.error||"Unknown"),message:f.error_description},"policy_enforced"===f.error&&(l=!0);else if("string"==typeof f.error)o={message:f.error};else if(f.error&&f.error.message&&f.error.message.value){var p={source:m,code:f.error.code,message:"".concat(f.error.message.value),isDisplayable:!0};u.order.push(p.source),u.map[p.source]=p,o=f.error}else o=f.error||f["odata.error"]||{responseData:f};else if(r&&400===s.getStatus()){var g;g=function(e){return/<html[^>]*>[\s\S]*?<body[^>]*>[\s\S]*?<\/body>[\s\S]*?<\/html>/i.test(e)}(r)?function(e){var t=e.match(/<body[^>]*>[\s\S]*<\/body>/i);return t?t[0]:""}(r).slice(0,1e3):r.slice(0,1e3),o={code:"-1,HTMLResult",message:g},b=(0,a.a)((0,a.a)({},b),{rawUrl:t.url,rawPayload:I})}}var v=s.getStatus(),D=s.getCorrelationId(),T=s.getResponseHeader(F),U=s.getResponseHeader(P);if(b=(0,a.a)((0,a.a)({},b),{CorrelationId:D,HttpStatus:v,GroupThrottle:T,MSCorrelationVector:s.getResponseHeader(O)}),(401===v&&U||403===v||404===v||429===v||503===v||-1===v||0===v&&C)&&(Z=!1,l=!0),400===v){var H=function(e){var t,n={order:[],map:{}},a="No X-Msedge-Ref details",i=e.getResponseHeader(N);return i?t={source:L,code:"Non-Empty X-Msedge-Ref details",message:i}:x.a.isActivated("44F48045-1E39-41C1-962A-7F04F8093447")&&(t={source:L,code:a,message:a}),t&&(n.order.push(t.source),n.map[t.source]=t),{codes:n,isExpected:!1}}(s);Array.prototype.push.apply(u.order,H.codes.order),H.codes.order.forEach(function(e){u.map[e]=H.codes.map[e]}),b.rawUrl||b.rawPayload||(b=(0,a.a)((0,a.a)({},b),{rawUrl:t.url,rawPayload:I}))}(o=o||{}).codes=u,o.status=v,o.retryAfter=s.getHeaderNumberValue(w),o.authenticate=s.getResponseHeader(E),o.authenticate&&(l=!0),D&&(o.correlationId=D),T&&(o.groupThrottle=T);var R=JSON.stringify(o);x.a.isActivated("C17CE162-3524-444F-85D5-8B5A0AA35544")||(o.targetUrl=s.getSourceUrl());var B=o["@error.redirectUrl"],j=s.getRedirectUrl()||B;j&&(l=!0,o.redirectUrl=j);var V=u.map.SPServiceResponse;V&&n._normalizeErrors&&(o.message=V.message);var z=u.order[0];z&&(p=u.map[z])&&(z===k&&p.message?(o.code=y,o.message=p.message):p.code&&(o.code=p.code)),o.code||(o.code=h);var G="[".concat(v,"] ").concat(o.code),K={resultType:l?d.b.ExpectedFailure:d.b.Failure,error:R,resultCode:G,extraData:b};if(S){var W=S({eventData:K,errorData:o,serverData:s}),q=W.eventData,Q=W.canRetry;q&&(K=q),!0!==Q&&!1!==Q||(Z=Q),K.resultType===d.b.ExpectedFailure&&(l=!0)}var Y=n._normalizeErrors?new _({errorData:o,isExpected:l}):o;Y.codes&&Y.codes&&(K.extraData.errorCodes=JSON.stringify(Y.codes.map)),e.end(K),i(Y)},V=s.getResponseType();V&&"text"!==V?s.parseError().then(j):j(s.getResponseText())}};!function(){var e;e=ve=ee?new(oe(n._apiEvent))({url:ne,name:le,pillar:(null==ee?void 0:ee.pillar)?ee.pillar:void 0,veto:(null==ee?void 0:ee.veto)?ee.veto:void 0}):new n._apiEvent({url:ne,name:le});var t=me&&me.now();Se.getServerDataFromUrl({url:r,successCallback:o(e,t),failureCallback:l(e,t),uploadProgressCallback:K,additionalPostData:I,method:j,additionalHeaders:fe,contentType:R,withCredentials:!D&&void 0,noRedirect:ce,responseType:G,needsRequestDigest:ue})}()},maxRetries:z,noTimeoutInLastRetry:J,canRetry:function(){return Z},onCancel:function(e){Se&&(Se.abort(),e&&Se.dispose())}}).then(function(e){return Se&&Se.dispose(),e},function(e){return Se&&Se.dispose(),!ve.endTime&&i.c.isCanceled(e)&&ve.end({resultCode:b,resultType:d.b.ExpectedFailure}),i.c.reject(e)})};return D?i.c.resolve(D).then(function(e){return ae({url:r,authToken:e})}):(null==ie?void 0:ie.authToken)?i.c.resolve(ie.authToken).then(function(e){return ae({url:r,authToken:e})}):re?se({apiEvent:n._apiEvent,getData:ae,options:{url:r,authToken:t.authToken,qosExtraData:t.qosExtraData,claimsChallenge:t.claimsChallenge},webAbsoluteUrl:X||ie&&ie.webAbsoluteUrl,qosName:le,tokenProvider:re}):(null==ie?void 0:ie.getAuthToken)?i.c.resolve(ie.getAuthToken()).then(function(e){return ae({url:r,authToken:e})}):ae({url:r})},fe={authToken:t.authToken,telemetryHandler:t.telemetryHandler,url:t.url,useExactAuthToken:t.useExactAuthToken,method:t.method,additionalHeaders:t.additionalHeaders};return this._dataSyncClient&&!t.skipSyncClient?ce({options:fe,aadUserId:null==ie?void 0:ie.aadUserId,dataSyncClient:this._dataSyncClient,getData:ue}):ue(fe)},e}(),he=_e}
,,function(e,t,n){function a(e,t){for(var n="";n.length<e;){var a=16*(null!=t?t:Math.random)();n+=(a|=0).toString(16)}return n}function i(){return crypto.getRandomValues(new Uint32Array(1))[0]/4294967296}n.r(t),n.d(t,{Empty:function(){return r},_guidRegEx:function(){return o},cryptoRandom:function(){return i},generate:function(){return s},isValidGuid:function(){return u},normalizeDashes:function(){return l},normalizeLower:function(){return c},normalizeUpper:function(){return d}});var r="00000000-0000-0000-0000-000000000000",o=/^[0-9a-f]{8}-?[0-9a-f]{4}-?[0-9a-f]{4}-?[0-9a-f]{4}-?[0-9a-f]{12}$/i;function s(e){var t=[];t.push(a(8,e)),t.push(a(4,e));var n="4"+a(3,e);t.push(n);var i=a(4,e),r=parseInt(i[0],16);return r&=3,i=(r|=8).toString(16)+i.substr(1),t.push(i),t.push(a(12,e)),t.join("-")}function c(e,t){return void 0===t&&(t=!1),e?f(e.toLowerCase(),t):""}function d(e,t){return void 0===t&&(t=!1),e?f(e.toUpperCase(),t):""}function l(e,t){if(void 0===t&&(t=!1),e){var n=e.replace(/[^A-Fa-f0-9]/g,"");if(32===n.length)return f("".concat(n.slice(0,8),"-").concat(n.slice(8,12),"-").concat(n.slice(12,16),"-").concat(n.slice(16,20),"-").concat(n.slice(20)),t)}return""}function u(e){return!(!e||!o.test(c(e)))}function f(e,t){var n=e.match(/^\{(.*)\}$/);return n?t?n[0]:n[1]:t?"{"+e+"}":e}}
,function(e,t,n){n.d(t,{a:function(){return i}});var a=n(239),i=function(){function e(){this._disposables={},this._lastDisposableId=0,this.isDisposed=!1}return e.prototype.attach=function(e){var t=this,n="".concat(++this._lastDisposableId),i=(0,a.a)(e,function(){delete t._disposables[n]});return this._disposables[n]=i,i},e.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0);for(var e=this._disposables,t=0,n=Object.keys(e);t<n.length;t++){var i=n[t],r=e[i];r&&(0,a.b)(r)&&r.dispose(),delete e[i]}},e}()}
,function(e,t,n){n.d(t,{a:function(){return W},b:function(){return q}});var a,i=n(0),r=n(95),o=n(591),s=n(28),c=n(12),d=(0,s.a)({eventName:"RUMOneDataUpload,",shortEventName:"RUMOneDataUpload"},{streamName:c.a.String,dictionary:c.a.Object,privacyClassification:{isPrefixingDisabled:!0,type:c.a.String},persistence:{isPrefixingDisabled:!0,type:c.a.String}}).withData({privacyClassification:c.b.requiredService}),l=n(29),u=n(123),f=n(1),p=n(31);!function(e){e[e.own=0]="own",e[e.cors=1]="cors"}(a||(a={}));var m,_=function(e,t,n,a,i,r,o){this.url=e,this.duration=t,this.correlationId=n,this.status=a,this.startTime=i,this.endTime=r,this.name=o,this.clientDurationInMilliseconds=new Date(r).getTime()-new Date(i).getTime(),this.origin=e&&new p.a(e).getHost()},h="undefined"==typeof window?self:window,b=function(){function e(){var e;this._requestIdGenerator=(e=0,function(){return(e++).toString()}),this.apis=[],this._apiBuffer={}}return e.prototype.reset=function(){this.apis=[],this._apiBuffer={}},e.prototype.startTracking=function(e){var t=this,n=e.ignore,a=void 0===n?function(e){return!1}:n,r=e.getAPIName,o=void 0===r?function(e){}:r,s=function(e){var n=e.id,a=e.request,i=e.type,r=new _;r.startTime=(new Date).toISOString(),r.startTimeRelative=t._now(),"fetch"===i&&(r.url="string"==typeof a?a:a.url),t._apiBuffer[n]=r};return this._instrument({fetch:{onRequest:s,onResponse:function(e){try{var n=e.response,r=e.id,s=t._apiBuffer[r];if(s&&!a(s.url)){var c=void 0,d=void 0;try{c=n.headers.get("SPClientServiceRequestDuration"),d=n.headers.get("SPSQLQueryCount")}catch(e){}var l=void 0;try{l=n.headers.get("SPRequestGuid")}catch(e){}s.name=o(s.url),s=(0,i.a)((0,i.a)({},s),(0,i.a)((0,i.a)((0,i.a)({endTime:(new Date).toISOString(),endTimeRelative:t._now(),clientDurationInMilliseconds:t._now()-s.startTimeRelative,status:n.status},c?{duration:Number(c)}:{}),d?{sqlRT:Number(d)}:{}),l?{correlationId:l}:{})),t.apis.push(s)}}catch(e){}}},xhr:{onRequest:s,onResponse:function(e){var n,r;try{var s=e.request,c=e.id,d=t._apiBuffer[c],l=s.responseURL||s.requestUrl;if(d&&!a(l)){var u=null!==(r=null===(n=s.getAllResponseHeaders())||void 0===n?void 0:n.toLowerCase())&&void 0!==r?r:"",f=u.indexOf("spclientservicerequestduration:")>=0&&s.getResponseHeader("SPClientServiceRequestDuration"),p=u.indexOf("spsqlquerycount:")>=0&&s.getResponseHeader("SPSQLQueryCount"),m=u.indexOf("sprequestguid:")>=0&&s.getResponseHeader("SPRequestGuid");d.name=o(l),d=(0,i.a)((0,i.a)({},d),(0,i.a)((0,i.a)((0,i.a)((0,i.a)({endTime:(new Date).toISOString(),endTimeRelative:t._now(),clientDurationInMilliseconds:t._now()-d.startTimeRelative,status:s.status},f?{duration:Number(f)}:{}),p?{sqlRT:Number(p)}:{}),m?{correlationId:m}:{}),{url:l})),t.apis.push(d)}}catch(e){}}}}),function(){t.stopTracking()}},e.prototype.stopTracking=function(){h.__RUMOneAPITrackerInstrumented=!1,this._originalXhrOpen&&(XMLHttpRequest.prototype.open=this._originalXhrOpen),this._originalXhrSend&&(XMLHttpRequest.prototype.send=this._originalXhrSend),this._originalFetch&&(h.fetch=this._originalFetch)},e.prototype.getData=function(){for(var e=0,t=0,n=[],r=0,o=this.apis;r<o.length;r++){var s=o[r];if(s){e++,t+=s.duration,s.origin||(s.origin=new p.a(s.url).getHost()),s.hostType=new p.a(window.location.href).getHost()===s.origin?a.own:a.cors;var c=(0,i.a)({},s);delete c.url,n.push(c)}}return{count:e,duration:t,calls:JSON.stringify(n)}},e.prototype._instrument=function(e){var t=this;if(!h.__RUMOneAPITrackerInstrumented){h.__RUMOneAPITrackerInstrumented=!0;var n=e.fetch,a=e.xhr;if("XMLHttpRequest"in h&&"undefined"!=typeof XMLHttpRequest){this._originalXhrSend=XMLHttpRequest.prototype.send,this._originalXhrOpen=XMLHttpRequest.prototype.open;var i=this;XMLHttpRequest.prototype.open=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.requestUrl=e[1],i._originalXhrOpen.apply(this,e)},XMLHttpRequest.prototype.send=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=i._requestIdGenerator();return a.onRequest({request:this,id:r,type:"xhr"}),this.addEventListener("readystatechange",function(){4===e.readyState&&a.onResponse({request:e,id:r,type:"xhr"})}),i._originalXhrSend.apply(this,t)}}"fetch"in h&&void 0!==h.fetch&&(this._originalFetch=h.fetch.bind(h),h.fetch=function(e,a){return new Promise(function(i,r){var o=t._requestIdGenerator();n.onRequest({request:e,id:o,type:"fetch"}),t._originalFetch(e,a).then(function(e){n.onResponse({response:e,id:o,type:"fetch"}),i(e)},function(e){r(e)})})})}},e.prototype._now=function(){return performance&&performance.now?Math.round(performance.now()):NaN},e}(),g=n(124);function v(){return m}n(391);var y=n(58);function S(){var e,t;(null===(e=window.__fci)||void 0===e?void 0:e.o)&&window.__fci.o.disconnect(),(null===(t=window.__fci)||void 0===t?void 0:t.e)&&(window.__fci.e=[]);var n=window.__tti&&window.__tti.e,a=window.__tti&&window.__tti.o;n&&(window.__tti.e=[]),a&&a.disconnect()}var D=["navigationStart","unloadEventStart","unloadEventEnd","fetchStart","redirectStart","redirectEnd","domainLookupStart","domainLookupEnd","connectStart","secureConnectionStart","connectEnd","requestStart","responseStart","responseEnd","domLoading","domComplete","loadEventStart","loadEventEnd"];function I(){var e=performance.getEntriesByType("navigation")[0];if(e)return e}function x(e){try{var t=window._spPageContextInfo,n=e.name;if(null==t?void 0:t.cdnPrefix){var a=t.cdnPrefix.replace(/bld$/,"");if(0===n.search(window.location.protocol+"//"+a))return!0}return!(!(null==t?void 0:t.cdnBaseUrl)||0!==n.search(t.cdnBaseUrl))||/(cdn(ppe)?|static(ppe)?)\.sharepointonline\.com|\.akamaihd\.net|akamai\.odsp\.cdn\.office\.net/i.test(n)}catch(e){return!1}}function C(e,t){for(var n=[],a=0;a<e.length;a++){var i=e[a];t.from&&!t.from(i)||t.requestType&&!t.requestType(i)||n.push(i)}return n}var O={CDN:x,SharePoint:function(e){return 0===e.name.search(window.location.protocol+"//"+window.location.host)},ThirdParty:function(e){return!O.SharePoint(e)&&O.CDN(e)}},w={HTML:function(e){return/html/i.test(e.initiatorType)},ASPX:function(e){return/\.aspx/i.test(e.name)},JS:function(e){return/script/i.test(e.initiatorType)},CSS:function(e){return/link|css/i.test(e.initiatorType)},IMG:function(e){return/img/i.test(e.initiatorType)}};function E(e,t){var n;return t in e?((n={})[t]=Math.round(e[t]),n):{}}var A,L=n(160),k=f.a.isActivated("B718D8C8-6E65-4180-B2CE-BA403E6F88D2"),M=f.a.isActivated("A6C5C82F-9E30-43CD-89EC-46EB1CAFBF19"),P=f.a.isActivated("FCEB44F2-CEDB-4697-9E99-B915915CB7D4"),T=["EUPL","TTI"],U=function(){function e(e){void 0===e&&(e={}),this._data={},this._metadata={},this._stageReadyMap={EUPL:!1,TTI:!1},this._signals={EUPL:new L.a,TTI:new L.a}}return e.prototype.reset=function(){this._data={},this._metadata={},this._error=void 0,this._stageReadyMap={EUPL:!1,TTI:!1},this._signals={EUPL:new L.a,TTI:new L.a}},e.prototype.getPerformanceData=function(){for(var e=[],t=0,n=Object.keys(this._data);t<n.length;t++){var a=n[t];e.push(this._data[a])}return e},e.prototype.expectComponent=function(e){var t=e.id,n=e.stage;this._metadata[t]?this._metadata[t].stage=n:this._metadata[t]={id:t,stage:n};var a=!1;if(!M&&this._data[t]){var i="EUPL"!==n;this._data[t].ignoreForEUPL!==i&&(this._data[t].ignoreForEUPL=i,a=!0)}!k&&this._stageReadyMap[n]&&(this._stageReadyMap[n]=!1,"EUPL"===n&&this._stageReadyMap.TTI&&(this._stageReadyMap.TTI=!1),a=!0),a&&this._checkStages()},e.prototype.expectComponents=function(e){for(var t=e.stage,n=0,a=e.componentIds;n<a.length;n++){var i=a[n];this.expectComponent({id:i,stage:t})}},e.prototype.updateExpectedStage=function(e){var t=e.id,n=e.stage;this._metadata[t]&&(this._metadata[t].stage=n),this._data[t]&&(this._data[t].ignoreForEUPL="EUPL"!==n,this._checkStages())},e.prototype.getExpectedComponent=function(e){return this._metadata[e]},e.prototype.getMissingComponents=function(e){for(var t,n=[],a=0,i=Object.keys(this._metadata);a<i.length;a++){var r=i[a];"All"!==e&&this._metadata[r].stage!==e||(null===(t=this._data[r])||void 0===t?void 0:t.renderTime)||n.push(r)}return n},e.prototype.isStageReady=function(e){var t=e.stage;return"All"===t?this._isStageReady({stage:t}):this._stageReadyMap[t]},e.prototype.reportComponentData=function(e){var t=e.data;if(!this._data[t.controlId]){if(P)!t.renderTime&&t.renderTimeRequiredDataChecker(t)&&(t.renderTime=t.renderTimeCalculator(t));else{if(!t.renderTime)try{t.renderTimeRequiredDataChecker(t)&&(t.renderTime=t.renderTimeCalculator(t))}catch(e){this._setError("Error calculating render time for component",t),t.renderTime=-1}(!t.renderTime||t.renderTime<0)&&(this._setError("Invalid render time for component",t),t.renderTime=-1)}var n=this._metadata[t.controlId];n&&(t.ignoreForEUPL="EUPL"!==n.stage),this._data[t.controlId]=t,t.renderTime&&this._checkStages()}},e.prototype.waitForStageReady=function(e){var t=e.stage;return this._signals[t].promise},e.prototype.getError=function(){return this._error},e.prototype._setError=function(e,t){this._error||(this._error=e,t&&(this._error+=" (".concat(JSON.stringify({controlId:t.controlId,startTime:t.startTime,endTime:t.endTime,renderTime:t.renderTime}),")")))},e.prototype._checkStages=function(){for(var e=0,t=T;e<t.length;e++){var n=t[e];!this._stageReadyMap[n]&&this._isStageReady({stage:n})&&(this._stageReadyMap[n]=!0,this._signals[n].resolve())}},e.prototype._isStageReady=function(e){var t,n=e.stage;if("TTI"===n&&!this._stageReadyMap.EUPL)return!1;for(var a=0,i=0,r=Object.keys(this._metadata);i<r.length;i++){var o=r[i];if("All"===n||this._metadata[o].stage===n){if(!(null===(t=this._data[o])||void 0===t?void 0:t.renderTime))return!1;a++}}return"EUPL"!==n||a>=1},e}(),F=f.a.isActivated("2C1CFBE3-805E-49A9-9907-85661DF9A0BC"),H=f.a.isActivated("053E2926-8AB8-402D-A151-51775AB34D6F"),R=f.a.isActivated("5D81D1F6-0ECA-4158-8AB5-53DF6E23D89F"),N=f.a.isActivated("DBC44254-ECCD-42DF-9025-EA9C09A895D7"),B={checkInterval:100,error_timeout:3e4,max_markers:200};function j(e,t){d.logData((0,i.a)({streamName:e,dictionary:t},{persistence:"Critical"}))}!function(e){e[e.Incomplete=1]="Incomplete",e[e.ReadyToUpload=2]="ReadyToUpload",e[e.Uploaded=3]="Uploaded",e[e.TimeOut=4]="TimeOut",e[e.Skipped=5]="Skipped"}(A||(A={}));var V=["EUPL","ScenarioId"],z=/^[a-zA-Z0-9](([a-zA-Z0-9|_|\.]){0,98}[a-zA-Z0-9])?$/,G=/(?:\/api\/|\/_api\/)(.*?)(?:\(|\?|sharePoint\:|$)/;function K(e){return null==e}var W=function(){function e(e,t){var n=e.name,a=e.config,i=e.onLog;this._dataStartTime=Date.now(),this._name=n,this._config=a,this._keyMetrics=V.slice(0),this._rumoneData={},this._dataState=A.Incomplete,this._loggingFunctions=[],this._euplBreakDown={},this._ttiBreakDown={},this._serverMetrics={},this._isW3cTimingCollected=!1,this._isW3cResourceTimingCollected={},this._tempData={},this._settings={},this._emergencyUpdateFunc=this._emergencyUpload.bind(this),this._async=new r.a,this._apiTracker=new b,this._platformDetection=new l.a,this.components=t.componentPerformanceTracker,this.registerLoggingFunc(i),this.setPerfDataTimer(),this._hookUnloadEvent()}return e.getRUMOneLogger=function(t,n){var a=t||{},i=a.name,r=void 0===i?"__default_rumone__":i,o=a.config,s=void 0===o?B:o,c=a.onLog,d=void 0===c?j:c,l=(n||{}).componentPerformanceTracker,u=void 0===l?new U:l;if(!e._loggers[r])try{var f=new e({name:r,onLog:d,config:s},{componentPerformanceTracker:u});e._loggers[r]=f}catch(e){}return e._loggers[r]},e.prototype.registerLoggingFunc=function(e){var t=this,n=this._loggingFunctions.indexOf(e);return n<0&&this._loggingFunctions.push(e),function(){n>=0&&t._loggingFunctions.splice(n,1)}},Object.defineProperty(e.prototype,"KeyMetrics",{get:function(){return this._isTtiEnabled()&&(this.addExpectedKeyMetric("TTI"),H&&this.addExpectedKeyMetric("FCI")),this._keyMetrics},enumerable:!1,configurable:!0}),e.prototype.getPerformanceData=function(){return this._rumoneData},e.prototype.startAPIMeasurement=function(e){return this._apiTracker.startTracking(e)},e.prototype.undoAPIInstrument=function(){this._apiTracker.stopTracking()},e.prototype.resetLogger=function(){this.components.reset(),this._emergencyUpload(),this._dataStartTime=(new Date).getTime(),this._dataState=A.Incomplete,this._apiTracker.reset(),this._isW3cTimingCollected=!1,this._isW3cResourceTimingCollected={},this._tempData={},this._rumoneData={},this._settings={},this._keyMetrics=V.slice(0),this.clearPerfDataTimer(),this.setPerfDataTimer(),this._euplBreakDown={},this._ttiBreakDown={},this._serverMetrics={},this.clearResourceTimings(),(0,u.c)(this._getOwnMakers().map(function(e){return e.name})),e._markers[this._name]=[],this._unhookUnloadEvent(),this._hookUnloadEvent(),this._ttiPromise=void 0,this._fciPromise=void 0,m=void 0,this.logMessageInConsole("Reset performance Logger Done"),y.a.raise(this,"reset",{})},e.prototype.setSettings=function(e){this._settings=(0,i.a)((0,i.a)({},this._settings),e)},e.prototype.excludePageForPerfData=function(){this.setSettings({excludePageData:!0})},e.prototype.getPerformanceDataPropertyValue=function(e){return e&&this._rumoneData[e]},e.prototype.setPerformanceDataPropertyValue=function(e,t){return e&&z.test(e)?(this._rumoneData[e]=t,!0):(console.error("key ".concat(e," does not confrim to the Regex ").concat(z)),!1)},e.prototype.addExpectedControl=function(e){var t=this._normalizeControl(e);return this.components.expectComponent({id:t.controlId,stage:t.ignoreForEUPL?"TTI":"EUPL"})},e.prototype.ignoreExpectedControl=function(e){var t=this._normalizeControl(e);return this.components.updateExpectedStage({id:t.controlId,stage:"TTI"})},e.prototype.expectingControl=function(e){var t=this._normalizeControl(e);return!!this.components.getExpectedComponent(t.controlId)},e.prototype.writeServerCorrelationId=function(e){this._rumoneData.ServerCorrelationId=this._rumoneData.ServerCorrelationId||e},e.prototype.writeServerUrl=function(){this._rumoneData.ServerUrl=this._processEUIIUrl(location.href)},e.prototype.writeServerSideLatency=function(e,t){this.isCollected("ServerRequestDuration")||(this._rumoneData.ServerRequestDuration=e,this._rumoneData.IISLatency=t)},e.prototype.writeControlPerformanceData=function(e){if(e)return this.components.reportComponentData({data:e})},e.prototype.writeAPICallPerformanceData=function(e){e&&this._apiTracker.apis.push(e)},e.prototype.readAPICallPerformanceData=function(){return this._apiTracker.apis},e.prototype.writeAppCache=function(e){this.isCollected("AppCache")||(this._rumoneData.AppCache=e)},e.prototype.writePageTransitionType=function(e,t){this.isCollected("PageTransitionType")&&!t||e!==o.a.fullPageLoad&&e!==o.a.none&&e!==o.a.pageToPageNavigation&&e!==o.a.onePageAppNavigation||(this._rumoneData.PageTransitionType=e)},e.prototype.writeScenarioId=function(e,t){this.isCollected("ScenarioId")&&!t||(this._rumoneData.ScenarioId=e)},e.prototype.collectW3CPerfTimings=function(){if(!this._isW3cTimingCollected){var e=function(){var e,t=performance&&performance.timing;if(t){for(var n=[],a=0;a<D.length;a++){var i=t[D[a]];i&&n.push([(e=D[a],"secureConnectionStart"!==e?"W3c"+e.charAt(0).toUpperCase()+e.slice(1):"W3cSecureConnectStart"),Number(i)])}return n}}();if(e)for(var t=0,n=e;t<n.length;t++){var a=n[t];this._logRUMOneData.apply(this,a)}this._isW3cTimingCollected=!0,this._logRUMOneData("navigation",function(){var e=I();if(e&&e.toJSON){var t=e.toJSON();return delete t.name,t}}())}},e.prototype.collectW3cResourceTimings=function(e){void 0===e&&(e={});var t=e.logSummery,n=void 0===t||t,a=e.start,r=void 0===a?0:a,o=e.end,s=void 0===o?Math.round(this.now()):o,c=e.columnNameOverride,d=void 0===c?function(e){return e}:c,l="logSummery=".concat(n,"|start=").concat(r,"|end=").concat(s,"|columnNameOverride=").concat(d);if(!this._isW3cResourceTimingCollected[l]){var u=function(e){var t=e.logSummery,n=e.start,a=e.end,r=e.columnNameOverride;if(window.document&&(null===performance||void 0===performance?void 0:performance.getEntriesByType)){for(var o=function(e,t){for(var n=performance.getEntriesByType("resource"),a=document.getElementsByTagName("iframe"),i=0;i<a.length;i++){var r=null;try{r=a[i].contentWindow.performance}catch(e){}r&&r.getEntriesByType&&(n=n.concat(r.getEntriesByType("resource")))}return n.filter(function(n){return n.startTime>=e&&n.startTime<=t})}(n,a),s=[],c=Object.keys(O),d=0;d<c.length;d++){var l=c[d],u=C(o,{from:O[l],requestType:null});t&&s.push({key:r(l+"RequestCountTotal"),value:u.length});for(var f=Object.keys(w),p=0;p<f.length;p++){var m=f[p];t&&s.push({key:r(l+"RequestCount"+m),value:C(u,{from:null,requestType:w[m]}).length})}if(u.length>0&&(t&&s.push({key:r(l+"RequestDownloadTime"),value:Math.round(u.reduce(function(e,t){return e+t.duration},0)/u.length)}),"CDN"===l)){var _=JSON.stringify(u.map(function(e){return(0,i.a)((0,i.a)((0,i.a)((0,i.a)({name:e.name.split("/").map(function(e){return e.split("?")[0]}).filter(function(e){return e&&e.length>0}).slice(-1)[0].replace(/\(.*?\)/g,"()"),startTime:Math.round(e.startTime),duration:Math.round(e.duration),transferSize:e.transferSize||0,fetchStart:Math.round(e.fetchStart),requestStart:Math.round(e.requestStart),connect:Math.round(e.connectEnd-e.connectStart),domainLookup:Math.round(e.domainLookupEnd-e.domainLookupStart),redirect:Math.round(e.redirectEnd-e.redirectStart)},E(e,"workerStart")),E(e,"responseStart")),E(e,"responseEnd")),E(e,"secureConnectionStart"))}));s.push({key:r(l+"RequestNames"),value:_})}}return s}}({columnNameOverride:d,logSummery:n,start:r,end:s});if(u){for(var f=0,p=u;f<p.length;f++){var m=p[f];this._logRUMOneData(m.key,m.value)}this._isW3cResourceTimingCollected[l]=!0}}},e.prototype.saveTempData=function(e,t){this._tempData[e]=t},e.prototype.readTempData=function(e){return this._tempData[e]},e.prototype.writeRenderTime=function(e,t){this.isCollected("RenderTime")&&!t||(this._rumoneData.RenderTime=e)},e.prototype.writePreRenderTime=function(e){this.isCollected("PreRender")||(this._rumoneData.PreRender=e)},e.prototype.writePostRenderTime=function(e){this.isCollected("PostRender")||(this._rumoneData.PostRender=e)},e.prototype.writeDataFetchTime=function(e,t){this.isCollected("DataFetch")&&!t||(this._rumoneData.DataFetch=e)},e.prototype.writeAppInfo=function(e,t){this.isCollected("AppInfo")&&!t||(this._rumoneData.AppInfo=e)},e.prototype.isRunning=function(){return!(this._dataState===A.Uploaded||this._dataState===A.TimeOut||this._dataState===A.Skipped)},e.prototype.writeEUPLBreakdown=function(e,t){return this._writeBreakdown(this._euplBreakDown,e,t)},e.prototype.addEUPLBreakdown=function(e,t,n){return this._addBreakdown(this._euplBreakDown,e,t,n)},e.prototype.readEUPLBreakdown=function(e){return this._readBreakdown(this._euplBreakDown,e)},e.prototype.writeTTIBreakdown=function(e,t){return this._writeBreakdown(this._ttiBreakDown,e,t)},e.prototype.addTTIBreakdown=function(e,t,n){return this._addBreakdown(this._ttiBreakDown,e,t,n)},e.prototype.readTTIBreakdown=function(e){return this._readBreakdown(this._ttiBreakDown,e)},e.prototype.getStartTime=function(){var e=this._settings.getStartTime;return e?e():0},e.prototype.addFlights=function(e){if(e&&e.length>0){for(var t=JSON.parse(this.getPerformanceDataPropertyValue("Flights")||"[]"),n=0;n<e.length;n++){var a=e[n];a&&-1===t.indexOf(a)&&t.push(a)}this._rumoneData.Flights=JSON.stringify(t)}},e.prototype.addPerfFlights=function(e){this._rumoneData.PerfFlights=e},e.prototype.collectSPClientFlights=function(e){var t=e.ExpFeatures,n="";if(N||t&&t.length)for(var a=0,i=t;a<i.length;a++){var r=i[a];n+=this._numberToBinString(r).split("").reverse().join("")}this._rumoneData.Flights=n},e.prototype.collectODCClientRamps=function(e,t){for(var n=e.Ramps,a=void 0===n?{}:n,i=[],r=0,o=t;r<o.length;r++){var s=o[r];s.ODC&&"boolean"!=typeof s.ODC&&a[s.ODC]&&i.push(s.ODC)}this._rumoneData.Flights=JSON.stringify(i)},e.prototype.addServerMetrics=function(e,t){if(e)for(var n in e)n&&!K(e[n])&&(K(this._serverMetrics[n])||t)&&(this._serverMetrics[n]=e[n])},e.prototype.writeServerVersion=function(e){this._rumoneData.SharePointServerVersion=e},e.prototype.getComponentPerformanceData=function(){return this.components.getPerformanceData()},e.prototype.mark=function(t){(e._markers[this._name]=e._markers[this._name]||[]).push(t),(0,u.f)(t)},e.prototype.now=function(){return performance&&performance.now?Math.round(performance.now()):NaN},e.prototype.registerPreUploadDataHandler=function(e){this._preUploadDataHandler=e},e.prototype.getMarkerTime=function(e){return(0,u.e)(e)},e.prototype.addExpectedKeyMetric=function(e){this._keyMetrics&&-1===this._keyMetrics.indexOf(e)&&this._keyMetrics.push(e)},Object.defineProperty(e.prototype,"waitOnAddingExpectedControl",{get:function(){return this._settings.waitOnAddingExpectedControl},set:function(e){this.setSettings({waitOnAddingExpectedControl:e})},enumerable:!1,configurable:!0}),e.prototype._measureTTI=function(){var e=this,t=this._settings.getStartTime,a=this._settings.TTISettings.getAbsoluteEUPL,r=a?a(this._rumoneData.EUPL):this.now(),o=t?t():0,s=NaN,c=I();c&&(s=Math.round(function(e){for(var t=0,n=0,a=e;n<a.length;n++){var i=a[n];i>0&&(0===t||i<t)&&(t=i)}return t}([c.redirectStart,c.workerStart,c.fetchStart])),o>0&&s<o&&(s=o));var d=0,l=function(){var e=window.__tti&&window.__tti.e||[];return H?++d>=2&&S():S(),e};if(this._isTtiEnabled()&&!this._ttiPromise&&H){var f=l();this._ttiPromise=function(e){return(0,i.b)(this,void 0,void 0,function(){var t;return(0,i.e)(this,function(a){switch(a.label){case 0:return t=(0,i.a)({minValue:Math.round(window.performance&&performance.now?Math.round(performance.now()):Date.now()),useMutationObserver:!1,trackNetworkRequests:!1,requiredMainThreadQuietnessDurationInMilliseconds:1e3,requiredNetworkQuietnessDurationInMilliseconds:1e3},e),[4,n.e("deferred.odsp-common").then(n.bind(n,562))];case 1:return[2,a.sent().getFirstConsistentlyInteractive(t).then(function(e){return(0,i.a)((0,i.a)({},e||{}),{options:t})})]}})})}({minValue:r,initialEntries:f}),this._ttiPromise.then(function(t){var n=t||{},a=n.tti,i=n.longTasks,r=a;a=K(a)?NaN:Math.round(a)-o,K(e._rumoneData.TTI)?e.addEUPLBreakdown("currentTTI",{data:JSON.stringify(a),needFlatten:!1}):e.addEUPLBreakdown("prevTTI",{data:JSON.stringify(e._rumoneData.TTI),needFlatten:!1}),e._rumoneData.TTI=a,i&&(e._rumoneData.TTILongTasks=JSON.stringify(i),e._rumoneData.TTILongTasksPostFMPCount=i.filter(function(t){return t.end>e._rumoneData.EUPL}).length),e._logLastRequestBeforeTTI(a,i,"TTI"),e.collectW3cResourceTimings({logSummery:!1,start:r-(a-e._rumoneData.EUPL),end:r,columnNameOverride:function(e){return"".concat(e,"OfTTI")}});var s=v();s&&(e._rumoneData.CLS=s.cls,e._rumoneData.CLSFullResult=JSON.stringify(s)),y.a.raise(e,"measureTTI",e._rumoneData)})}this._isTtiEnabled()&&!this._fciPromise&&(this.logMessageInConsole("Starting TTI measurement"),f=l(),this._fciPromise=function(e){return(0,i.b)(this,void 0,void 0,function(){var t;return(0,i.e)(this,function(a){switch(a.label){case 0:return t=(0,i.a)((0,i.a)({},e),{requiredMainThreadCPUIdleDurationInMilliseconds:1e3}),[4,n.e("deferred.odsp-common").then(n.bind(n,563))];case 1:return[2,a.sent().getFirstCPUIdle(t)]}})})}({measurementStartTime:r,initialEntries:f,measureName:H?"FCI":"TTI"}),this._fciPromise.then(function(t){var n=(t||{}).longTasks,a=K(t.fci)?NaN:Math.round(t.fci)-o;if(!H){var i=v();i&&(e._rumoneData.CLS=i.cls,e._rumoneData.CLSFullResult=JSON.stringify(i)),e.collectW3cResourceTimings({logSummery:!1,start:o,end:t.fci,columnNameOverride:function(e){return"".concat(e,"OfTTI")}})}H?e._rumoneData.FCI=a:e._rumoneData.TTI=a,e.logMessageInConsole("Calculated TTI ".concat(a));var c=Math.round(t.fci);e._logRUMOneData("actionableTti",c-s),e._logRUMOneData("TtiData",{longTaskMinimum:r,ttiStartTime:o,ttiEndTime:c,actionableStartTime:s,isTtiSupported:"PerformanceLongTaskTiming"in window,hasHighResolutionTiming:u.a,isPerformanceNavigationSupported:"PerformanceNavigationTiming"in window}),n&&(H?(e._rumoneData.FCILongTasks=JSON.stringify(n),e._rumoneData.FCILongTasksPostFMPCount=n.filter(function(t){return t.end>e._rumoneData.EUPL}).length):(e._rumoneData.TTILongTasks=JSON.stringify(n),e._rumoneData.TTILongTasksPostFMPCount=n.filter(function(t){return t.end>e._rumoneData.EUPL}).length)),H?e._logLastRequestBeforeTTI(a,n,"FCI"):e._logLastRequestBeforeTTI(a,n,"TTI"),e.logMessageInConsole("Sending 'measureTTI' event"),y.a.raise(e,"measureTTI",e._rumoneData),e.logMessageInConsole("Completed TTI measurement")}))},e.prototype._logLastRequestBeforeTTI=function(e,t,n){var a=performance.getEntriesByType("resource");if(e&&t&&t.length>0&&a&&a.length>0){for(var i=t[t.length-1].start,r=a[0],o=0,s=a;o<s.length;o++){var c=s[o];c.responseEnd<i&&c.responseEnd>r.responseEnd&&(r=c)}var d,l;d=x(r)?r.name:this._processLastNetworkUrl(r.name),l=/\.aspx/i.test(r.name)?"ASPX":/\.js/i.test(r.name)?"JS":/\.css/i.test(r.name)?"CSS":/img/i.test(r.initiatorType)||/\.jpg|\.jpeg|\.png|\.gif/i.test(r.name)?"IMG":/aria\.microsoft\.com/i.test(r.name)?"Aria":/_api/i.test(r.name)?"API":"Other","TTI"===n?(this._rumoneData.TTILastRequestName=d,this._rumoneData.TTILastRequestType=l,this._rumoneData.TTILastRequestStartTime=r.startTime,this._rumoneData.TTILastRequestEndTime=r.responseEnd):(this._rumoneData.FCILastRequestName=d,this._rumoneData.FCILastRequestType=l,this._rumoneData.FCILastRequestStartTime=r.startTime,this._rumoneData.FCILastRequestEndTime=r.responseEnd)}},e.prototype._numberToBinString=function(e){var t=(e>>>0).toString(2);return"".concat(Array(32-t.length+1).join("0")).concat(t)},e.prototype._logRUMOneData=function(e,t){e&&(this._rumoneData[e]=t)},e.prototype.clearResourceTimings=function(){performance&&performance.clearResourceTimings&&performance.clearResourceTimings()},e.prototype._isBreakdownValue=function(e){return void 0!==e.needFlatten},e.prototype.collectMarks=function(){var e=this,t={},n=0;this._getOwnMakers().forEach(function(a){if(n<e._config.max_markers){var i=a.name.substr(u.b.length)+".mark".concat(n++);t[i]=Math.round(a.startTime)}}),this.writeEUPLBreakdown(JSON.stringify(t))},e.prototype._getOwnMakers=function(){var t=this,n=e._markers,a=[].concat.apply([],Object.keys(n).filter(function(e){return n.hasOwnProperty(e)&&e!==t._name}).map(function(e){return n[e]}));return(0,u.d)().filter(function(e){return-1===a.indexOf(e.name)})},e.prototype.logMessageInConsole=function(e){this.isRUMOneDebuggingEnabled&&console.log(e)},Object.defineProperty(e.prototype,"isRUMOneDebuggingEnabled",{get:function(){try{if("sessionStorage"in window&&window.sessionStorage){var e=window.sessionStorage.enableRUMOneDebugging;return e&&"true"===e.toLowerCase()&&"undefined"!=typeof console&&!!console}}catch(e){}return!1},enumerable:!1,configurable:!0}),e.prototype.logObjectForDebugging=function(e,t){if(this.isRUMOneDebuggingEnabled){var n="".concat(this._name," ").concat(e)+" : "+JSON.stringify(t);console.log(n)}},e.prototype.isCollected=function(e){return!K(this.getPerformanceDataPropertyValue(e))},e.prototype._normalizeControl=function(e){return"string"==typeof e?{controlId:e,ignoreForEUPL:!1}:e},e.prototype.setPerfDataTimer=function(){var e=this;this._perfDataTimer=this._async.setTimeout(function(){e.loopForDataCompleteness()},this._config.checkInterval)},e.prototype.clearPerfDataTimer=function(){K(this._perfDataTimer)||(this._async.clearTimeout(this._perfDataTimer),this._perfDataTimer=null)},e.prototype._hookUnloadEvent=function(){window.addEventListener&&window.addEventListener("beforeunload",this._emergencyUpdateFunc)},e.prototype._unhookUnloadEvent=function(){window.removeEventListener&&window.removeEventListener("beforeunload",this._emergencyUpdateFunc)},e.prototype._setFCP=function(){var e=NaN,t=performance&&performance.getEntriesByType&&performance.getEntriesByType("paint");if(t&&t.length>0){var n=t.filter(function(e){return"first-contentful-paint"===e.name});if(n&&1===n.length)e=n[0].startTime;else{var a=t.filter(function(e){return"first-paint"===e.name});a&&1===a.length&&(e=a[0].startTime)}}isNaN(e)||(this._rumoneData.FCP=Math.round(e))},e.prototype.collectSupplementaryData=function(){this._setFCP(),this.setAPIDataToRUMOne(),this.collectMarks(),this.writeServerUrl(),this.setBrowserInfo(),this.setReferrer(),this._collectMemoryData(),this._collectPageServerData(),this._setAppInfo(),this._setTestName(),this._collectExperiments(),this._rumoneData.DOMElements=document&&document.querySelectorAll("*").length,this._rumoneData.ServerMetrics=JSON.stringify(this._serverMetrics),this._rumoneData.EUPLBreakdown=JSON.stringify(this._euplBreakDown),this._rumoneData.TTIBreakdown=JSON.stringify(this._ttiBreakDown),this._normalizeTTI()},e.prototype._normalizeTTI=function(){var e;H&&this._rumoneData.PageTransitionType===o.a.fullPageLoad&&((null===(e=this._rumoneData.ScenarioId)||void 0===e?void 0:e.indexOf("SPPages"))>-1||this._rumoneData.ScenarioId.indexOf("VivaHome")>-1)&&(this._rumoneData.TTI=this._rumoneData.FCI||this._rumoneData.TTI)},e.prototype._collectExperiments=function(){var e=window.ODSP_EXPERIMENTS||{},t={};for(var n in e)if(e.hasOwnProperty(n)){var a=e[n];a&&a._serverTime&&Date.now()-new Date(a._serverTime).getTime()<1296e6&&(t[n]=e[n])}this._rumoneData.SPExperiments=JSON.stringify(t)},e.prototype._setTestName=function(){var e=new p.a(location.href).getQueryParameter("perftest");e&&!this._rumoneData.TestName&&(this._rumoneData.TestName=e)},e.prototype.loopForDataCompleteness=function(){if(this.clearPerfDataTimer(),!this._settings.waitOnAddingExpectedControl){if(this.isRUMOneDebuggingEnabled&&(this.logMessageInConsole("===================================================================="),this.logObjectForDebugging("RUMONE: ",this._rumoneData),this.logObjectForDebugging("RUMOne DataState: ",String(this.getReadableDataState(this._dataState))),this.logObjectForDebugging("Controls: ",this.getComponentPerformanceData()),this.logObjectForDebugging("API Performance Data: ",this._apiTracker.apis),this.logObjectForDebugging("Temp Data: ",this._tempData),this.logObjectForDebugging("EUPLBreakdown: ",this._euplBreakDown),this.logObjectForDebugging("TTIBreakdown: ",this._ttiBreakDown),this.logObjectForDebugging("ServerMetrics: ",this._serverMetrics),this.logMessageInConsole("====================================================================\n\n")),!this.isRunning())return;this._updateState()}this._checkTimeout(),this.isRunning()&&this.setPerfDataTimer()},e.prototype._updateState=function(){switch(this._dataState){case A.Incomplete:!this.components.isStageReady({stage:"EUPL"})||!R&&this.waitOnAddingExpectedControl||this.setEUPL();var e=this.components.isStageReady({stage:F?"All":"TTI"});this._isTtiEnabled()&&this.isCollected("EUPL")&&e&&this._measureTTI(),0===this._getMissedKeyMetrics().length&&e&&(this._dataState=A.ReadyToUpload);break;case A.ReadyToUpload:this._uploadPerfData({emergency:!1})}},e.prototype._checkTimeout=function(){if(this.isRunning()&&this._dataState!==A.ReadyToUpload){var e=Date.now();this._dataState===A.Incomplete&&e-this._dataStartTime<=this._config.error_timeout||(this._setError({reason:"TimeOut",details:{MissingMetrics:this._getMissedKeyMetrics(),MissingControls:this.components.getMissingComponents("TTI")}}),this._dataState=A.TimeOut,this._uploadPerfData({emergency:!1}))}},e.prototype._setError=function(e){this._rumoneData.RUMOneError||(this._rumoneData.RUMOneError=JSON.stringify(e))},e.prototype._getMissedKeyMetrics=function(){for(var e=[],t=0;t<this.KeyMetrics.length;t++)K(this.getPerformanceDataPropertyValue(this.KeyMetrics[t]))&&e.push(this.KeyMetrics[t]);return e},e.prototype._emergencyUpload=function(){this.isRunning()&&this._uploadPerfData({emergency:!0})},e.prototype._uploadPerfData=function(e){var t;this.writeControlDataToRUMOne(),this.collectSupplementaryData();var n,a=e.emergency;this._rumoneData.EmergencyUploaded=!!a;try{if(this._settings.excludePageData)this._dataState=A.Skipped,this.logMessageInConsole("Uploading perf data skipped as requested by the consumer");else if(a||this._dataState===A.ReadyToUpload||this._dataState===A.TimeOut)if(this._loggingFunctions&&this._loggingFunctions.length>0)if(this._rumoneData){var i=this.getPerformanceData();this._loggingFunctions.forEach(function(e){e("RUMOne",i)}),this._dataState=A.Uploaded,null===(t=this._preUploadDataHandler)||void 0===t||t.call(this),this.isRUMOneDebuggingEnabled&&(this.logMessageInConsole("Final Data uploaded"),this.logObjectForDebugging("RUMONE: ",i),this.logObjectForDebugging("RUMOne DataState: ",this.getReadableDataState(this._dataState)))}else console.error("Error: Uploading perf data called but perf data is not available");else console.error("Uploading perf data skipped as loggingFunc is not defined");else console.error("Error: Uploading perf data called with wrong data state ".concat(this._dataState))}catch(e){n="PerformanceLogger error writing RUMOne data: ".concat(e),"undefined"!=typeof console&&Boolean(console)&&console.error(n)}finally{this.isRunning()||(this._unhookUnloadEvent(),this.undoAPIInstrument())}},e.prototype._isTtiEnabled=function(){var e;return!!(null===(e=this._settings.TTISettings)||void 0===e?void 0:e.enabled)},e.prototype.getReadableDataState=function(e){for(var t in A)if(e===Number(A[t]))return t;return"NaN"},e.prototype.writeControlDataToRUMOne=function(){var e=this.components.getPerformanceData();if(e.length){var t=e.filter(function(e){return!!e.renderTime&&!e.ignoreForEUPL});t.sort(function(e,t){return t.renderTime-e.renderTime});for(var n=0;n<10&&n<t.length;n++)this._logRUMOneData("Control".concat(n+1,"Id"),t[n].controlId),this._logRUMOneData("Control".concat(n+1,"RenderTime"),t[n].renderTime);var a={};e.filter(function(e){return!!e.renderTime&&!!e.ignoreForEUPL}).forEach(function(e){a[e.controlId]={data:e.renderTime,needFlatten:e.needFlatten}}),Object.keys(a).length>0&&this.writeEUPLBreakdown(JSON.stringify(a),!0)}var i=this.components.getError();i&&this._setError({reason:"ControlPerformanceFailure",details:i})},e.prototype.setEUPL=function(){if(!this.isCollected("EUPL")){for(var e=this.now(),t=Date.now()-e,n=this._settings.getStartTime?this._settings.getStartTime():0,a=n,i=n,r=n,o=0,s=0,c=this.components.getPerformanceData();s<c.length;s++){var d=c[s];d.ignoreForEUPL||(d.renderTime&&o<d.renderTime&&(o=d.renderTime),d.endTime>a&&(a=d.endTime,d.endTime>e?i=d.endTime-t:r=d.endTime))}this._rumoneData.EUPL=o,this._logRUMOneData("euplData",{euplStartTime:n,euplEndTime:a}),this._logRUMOneData("euplFromStartTime",n-a),this._logRUMOneData("euplWithCorrections",n-i),this._logRUMOneData("euplWithAssertions",n-r),y.a.raise(this,"eupl",o)}},e.prototype.setBrowserInfo=function(){this._rumoneData.Browser=this._platformDetection.browserName+this._platformDetection.browserMajor,this._rumoneData.BrowserIsMobile=this._platformDetection.isMobile},e.prototype._collectMemoryData=function(){this.isCollected("UsedJSHeapSize")||"undefined"==typeof performance||void 0===performance.memory||(this._rumoneData.UsedJSHeapSize=performance.memory.usedJSHeapSize,this._rumoneData.TotalJSHeapSize=performance.memory.totalJSHeapSize)},e.prototype._collectPageServerData=function(){this.addServerMetrics({cpuDuration:window.g_cpuDuration,duration:window.g_duration,iisLatency:window.g_iisLatency,queryCount:window.g_queryCount,queryDuration:window.g_queryDuration,spPageContextDuration:window.g_pageContextDuration,deferred_cpuDuration:window.g_deferred_cpuDuration,deferred_duration:window.g_deferred_duration,deferred_iisLatency:window.g_deferred_iisLatency,deferred_queryCount:window.g_deferred_queryCount,deferred_queryDuration:window.g_deferred_queryDuration})},e.prototype.setAPIDataToRUMOne=function(){var e=this._apiTracker.getData();this._rumoneData.APICallCount=e.count,this._rumoneData.APICallDurationSum=e.duration,this._rumoneData.APICalls=e.calls},e.prototype.setReferrer=function(){this._rumoneData.Referrer=this._processEUIIUrl(document.referrer)},e.prototype._setAppInfo=function(){if(!this._rumoneData.AppInfo){var e=window._spModuleLink;if(e){var t=e.buildNumber,n=e.manifestName,a=e.scenarioName,i=JSON.stringify({buildNumber:t,manifestName:n,scenarioName:a});this._rumoneData.AppInfo=i}}},e.prototype._writeBreakdown=function(e,t,n){if(t)try{var a=JSON.parse(t);for(var i in a)a.hasOwnProperty(i)&&this._addBreakdown(e,i,a[i],n)}catch(e){this.logMessageInConsole("Failed to write EUPL breakdown data:"+e.toString())}},e.prototype._addBreakdown=function(e,t,n,a){if(t&&!K(n)){if(K(e[t])||a){var i=this._isBreakdownValue(n)?n.data:n;e[t]=null!=i?i:void 0}this._isBreakdownValue(n)&&n.needFlatten&&(!this.isCollected(t)||a)&&this._logRUMOneData(t,n.data)}},e.prototype._readBreakdown=function(e,t){return t?e[t]:e},e.prototype._processEUIIUrl=function(e){var t=new g.a(e||"");return"".concat(t.authority,"/{ length: ").concat(t.path.length,", segments: ").concat(t.segments.length," }")},e.prototype._processLastNetworkUrl=function(e){var t=new g.a(e||"");if(t.authority.indexOf("lpcres")>0)return e;if(t.authority.indexOf("shell.cdn.office")>0)return e;var n=G.exec(e),a="";return n&&n.length>0&&(a="".concat(n[0])),"".concat(t.authority).concat(a)},e._loggers={},e._markers={},e}(),q=W}
,function(e,t,n){n.d(t,{a:function(){return i},b:function(){return r},c:function(){return l},d:function(){return u},e:function(){return d},f:function(){return c}});var a=window.performance,i=void 0!==typeof a&&!!a&&"function"==typeof a.mark&&"function"==typeof a.clearMarks&&"function"==typeof a.now,r="EUPL.",o=0,s=window._perfMarks=window._perfMarks||[];function c(e,t){var n=f(e);(null==t||o<t)&&(i?a.mark(n):s.push({name:n,startTime:Date.now()}),o++)}function d(e,t){void 0===t&&(t=!0);var n=t?f(e):e;if(i){var r=a.getEntriesByName(n,"mark");return r&&r.length>0?Math.round(r[0].startTime):NaN}var o=s.filter(function(e){return e.name===n})[0];return o&&o.startTime}function l(e){var t=[];e&&(t=e.map(f)),i?a.getEntriesByType("mark").filter(function(e){return t.length>0?t.indexOf(e.name)>=0:0===e.name.lastIndexOf(r,0)}).forEach(function(e){a.clearMarks(e.name)}):s=[]}function u(){return i?a.getEntriesByType("mark").filter(function(e){return 0===e.name.lastIndexOf(r,0)}):s}function f(e){return 0===e.lastIndexOf(r,0)?e:r+e}}
,function(e,t,n){var a=n(37);t.a=a.a}
,function(e,t,n){n.d(t,{a:function(){return a},b:function(){return i}});var a=function(){function e(e){this.dependencies={value:e.lazy}}return e.prototype.create=function(e){return{instance:e.value()}},e}(),i=function(){function e(e){this._load=e}return e.prototype.load=function(){var e=this._load().then(function(e){return new a(e)});return this.load=function(){return e},e},e}()}
,function(e,t,n){var a=function(){function e(){}return e.invalidate=function(t){"undefined"!=typeof window&&(e.isRightToLeft=window.document&&"rtl"===document.documentElement.getAttribute("dir"),e.safeLeft=e.isRightToLeft?"right":"left",e.safeRight=e.isRightToLeft?"left":"right",t=t||window._spPageContextInfo&&window._spPageContextInfo.currentUICultureName,e.language=t||window.document&&(document.documentElement.getAttribute("lang")||document.documentElement.getAttribute("xml:lang"))||"en-us",e.cultureLCID=window._spPageContextInfo&&window._spPageContextInfo.currentCultureName||e.language)},e}();a.invalidate(),t.a=a}
,function(e,t,n){n.d(t,{a:function(){return p},b:function(){return _},c:function(){return f},d:function(){return m}});var a=n(39),i=n(32),r=n(52),o=n(65),s=n(1),c=n(30),d=s.b.isActivated("7853DF32-37BE-47FC-9ED5-B341B51F0667","07/07/2023","KS for COB simplified ShareDialog")||c.a.isFeatureEnabled({ECS:1131341}),l=c.a.isFeatureEnabled({ODB:61327,ODC:"COBNewShareDialog"}),u="https://my.microsoftpersonalcontent.com";function f(e,t,n){return e===a.a.anonymousEdit||e===a.a.anonymousView?i.a.anyone:e===a.a.organizationEdit||e===a.a.organizationView?i.a.organization:e===a.a.direct?i.a.specificPeople:e===a.a.flexible?t?i.a.anyone:!1===n?i.a.organization:i.a.specificPeopleFlex:void 0}function p(e,t){var n=!!e.filter(function(e){var t=new Date(e.expiration);return e.isActive&&e.sharingLinkKind!==a.a.direct&&(!e.expiration||t.getTime()>Date.now())&&!0!==e.isUnhealthy}).length;if(!n&&t.length)for(var i=0,o=t;i<o.length;i++)if(o[i].role!==r.a.owner){n=!0;break}return n}function m(){var e=window.location.search.substring(1),t=(0,o.a)(e),n=t.itemMigrated&&"true"===t.itemMigrated.toLowerCase(),a=_(window._spPageContextInfo);return!n&&a&&(n=!0),!d&&(!!window.FilesConfig&&l||!!n)}function _(e){if(e&&"ConsumerTenant"===e.tenantDisplayName&&0===e.webAbsoluteUrl.indexOf(u)){var t=e.webAbsoluteUrl.match(new RegExp("".concat(u,"/personal/(\\w+)")));if(t&&2===t.length)return t[1]}}}
,function(e,t,n){n.d(t,{a:function(){return c},b:function(){return d},c:function(){return l},d:function(){return u}});var a=n(262),i=n(30),r=n(1),o=n(53),s={ODB:r.b.isActivated("904afe8e-3cce-4ab4-ac2f-97b60197cf59","11/9/2021","Disable check for webTemplate mySite as qualification for isOdb"),ECS:108854},c=window._spPageContextInfo&&(window._spPageContextInfo.listBaseTemplate===a.a.mySiteDocumentLibrary||!i.a.isFeatureEnabled(s)&&Number(window._spPageContextInfo.webTemplate)===o.b.mySite),d=!!window.FilesConfig,l=c||d,u=!c&&!d}
,,,,function(e,t,n){var a;n.d(t,{a:function(){return a}}),function(e){e[e.unknown=0]="unknown",e[e.file=1]="file",e[e.folder=2]="folder",e[e.item=3]="item",e[e.list=4]="list",e[e.web=5]="web",e[e.max=6]="max"}(a||(a={}))}
,function(e,t){var n;!function(e){e[e.none=1]="none",e[e.available=2]="available",e[e.other=3]="other"}(n||(n={})),t.a=n}
,function(e,t,n){n.d(t,{a:function(){return A},b:function(){return k},c:function(){return O},d:function(){return E},e:function(){return L}});var a=n(126),i=n(19),r=n(277),o=n(436);function s(e,t,n,a){return o[["RelativeDateTime_",e,n?"Future":"",a?"Intervals":"",t?"_StartWithLowerCase":""].join("")]}function c(e,t,n,a){var r=s(t,!!a&&n,a),o=s(t,!1,a,!0);return((0,i.e)(r,o,e)||"").replace("{0}",e+"")}var d={};function l(e,t){return"undefined"!=typeof Intl&&Intl.DateTimeFormat?(d[t]||(d[t]=new Intl.DateTimeFormat(t)),d[t].format(e)):e.toLocaleDateString(t)}var u=n(1);function f(e){return function(e){return void 0===p&&function(){p={};var e=new Date(1900,0,1);try{for(var t={month:"long"},n=0,a=x;n<a.length;n++){var i=a[n];e.toLocaleDateString(i,t).match("M[0-9][0-9]")&&(p[i]=!0)}}catch(e){}}(),!!e&&(e=e.toLowerCase(),p[e])}(e)?"en":e}var p,m,_,h,b,g,v,y,S,D,I,x=["eu-es","af-za","az-latn-az","bs-latn-ba","cy-gb","ga-ie","gl-es","hy-am","is-is","ka-ge","kk-kz","km-kh","ky-kg","mk-mk","mn-mn","mt-mt","ne-np","nn-no","or-in","pa-in","sq-al","ur-pk","uz-latn-uz","ku-arab-iq","be-by","rw-rw","ti-et","tg-cyrl-tj","eu","af","az","bs","cy","ga","gl","ha","hy","ig","is","ka","kk","km","mk","mt","ne","nn","or","pa","si","sq","ur","uz","yo","zu","pa","ku"];!function(e){e[e.Sunday=0]="Sunday",e[e.Monday=1]="Monday",e[e.Tuesday=2]="Tuesday",e[e.Wednesday=3]="Wednesday",e[e.Thursday=4]="Thursday",e[e.Friday=5]="Friday",e[e.Saturday=6]="Saturday"}(m||(m={}));var C=function(){for(var e,t=0,n=u.b.isActivated("D98FB23B-FE73-4BA3-B3D5-28F1BE7C05C8")?[window.$Config&&window.$Config.mkt,a.a.language,navigator.language,"en"].filter(function(e){return!!e}):[window.$Config&&window.$Config.mkt,a.a.cultureLCID,a.a.language,navigator.language,"en"].filter(function(e){return!!e});t<n.length;t++){var i=n[t];try{(new Date).toLocaleDateString(i),e=i;break}catch(e){}}return f(e)}();function O(e,t,n){return void 0===t&&(t=!1),void 0===n&&(n=!1),function(e,t,n){void 0===n&&(n=!1);var a=Date.now()-e.getTime();if(a<-5*r.c)return l(e,t);if(a<r.c)return s("LessThanAMinute",n);if(a<r.h)return s("AboutAMinute",n);if(a<r.b)return c(Math.floor(a/r.c),"XMinutes");if(a<r.g)return s("AboutAnHour",n);if(a<r.a)return c(Math.floor(a/r.b),"XHours");if(a<r.f){var i=e.toLocaleTimeString(t);return s("YesterdayAndTime",n).replace("{0}",i)}return a<r.d?c(Math.floor(a/r.a),"XDays"):l(e,t)}(e,n?C:f(a.a.language),t)}function w(){var e=function(){if(void 0===_)try{(new Date).toLocaleDateString(C,{timeZone:"UTC"}),_=!0}catch(e){_=!1}return _}();if(window.Intl&&window.Intl.DateTimeFormat){var t={},n={hour:"2-digit",minute:"2-digit"};h=new Intl.DateTimeFormat(C,t),b=new Intl.DateTimeFormat(C,n),e&&(t.timeZone="UTC",n.timeZone="UTC"),g=new Intl.DateTimeFormat(C,t),v=new Intl.DateTimeFormat(C,n),y=h.format,S=b.format,D=g.format,I=v.format}else y=D=function(e){return e.toLocaleDateString(C)},S=I=function(e){return e.toLocaleTimeString(C)}}function E(e,t){if(!e)return"";y||w();var n=r.i(new Date,e);return(t?n?I:D:n?S:y)(e)}function A(e,t){return e?(y||w(),(t?D:y)(e).replace(/[:\/\\]/g,"-")):""}function L(e,t,n){return void 0===n&&(n=!1),r.j(e,n?C:f(a.a.language),t)}function k(e){void 0===e&&(e=!1);var t=new Date(2e3,11,22);return t.toLocaleDateString(e?C:f(a.a.language),{day:"numeric",month:"numeric",year:"numeric"}).replace(t.getDate().toString(),"DD").replace((t.getMonth()+1).toString(),"MM").replace(t.getFullYear().toString(),"YYYY")}}
,function(e,t,n){n.d(t,{a:function(){return s},b:function(){return o},c:function(){return d},d:function(){return l},e:function(){return c}});var a=n(81),i={word:["doc","docm","docx","docb","dot","dotm","dotx"],excel:["xls","xlsb","xlsm","xlsx","xlt","xltm","xltx"],powerpoint:["ppt","pptm","pptx","sldx","sldm","pot","potm","potx","pps","ppsm","ppsx"],onenote:["one"],visio:["vsd","vsdm","vsdx","vdw","vss","vssm","vssx","vst","vstm","vstx"],whiteboard:["whiteboard"],fluid:["fluid","loop","note"],pdf:["pdf"],document:["epub","gdoc","odt","rtf","wri","pages"],presentation:["odp","gslides","key"],spreadsheet:["ods","gsheet","numbers"],txt:["dif","diff","readme","out","plist","properties","text","txt"],archive:["7z","ace","arc","arj","dmg","gz","iso","lzh","pkg","rar","sit","tgz","tar","z","zip"],photo:["arw","bmp","cr2","crw","dcr","dds","dib","dng","erf","gif","heic","heif","ico","jfi","jfif","jif","jpe","jpeg","jpg","kdc","mrw","nef","orf","pct","pict","png","pns","psd","raw","tga","tif","tiff","wdp"],audio:["aif","aiff","aac","amr","au","awb","dct","dss","dvf","flac","gsm","m4a","m4p","mid","mmf","mp3","ogg","oga","ra","rm","wav","wma","wv"],video:["3g2","3gp","3gp2","3gpp","asf","avi","dvr-ms","flv","m1v","m4v","mkv","mod","mov","mm4p","mp2","mp2v","mp4"," mpa","mpe","mpeg","mpg","mpv","mpv2","mts","ogg","qt","swf","ts","vob","webm","wlmp","wm","wmv","wmx"],vector:["ai","dgn","gdraw","pd","emf","eps","fig","indd","indt","ps","svg","svgz","wmf","oxps","xps","xd","sketch"],model:["3ds","3mf","blend","cool","dae","df","dwfx","dwg","dxf","fbx","glb","gltf","holo","layout","max","off","ply","skp","stp","stl","t","thl","x"],csv:["csv"],xml:["xaml","xml","xsl"],html:["htm","html","mht"],code:["abap","ada","adp","ahk","as","as3","asc","ascx","asm","asp","awk","bash","bash_login","bash_logout","bash_profile","bashrc","bat","bib","bsh","build","builder","c","c++","capfile","cc","cfc","cfm","cfml","cl","clj","cls","cmake","cmd","coffee","config","cpp","cpt","cpy","cs","cshtml","cson","csproj","css","ctp","cxx","d","ddl","di","disco","dml","dtd","dtml","el","emakefile","erb","erl","f","f90","f95","fs","fsi","fsscript","fsx","gemfile","gemspec","gitconfig","go","groovy","gvy","Hcp","h","h++","haml","handlebars","hbs","hh","hpp","hrl","hs","htc","hxx","idl","iim","inc","inf","ini","inl","ipp","irbrc","jade","jav","java","js","json","jsp","jsx","l","less","lhs","lisp","log","lst","ltx","lua","m","mak","make","manifest","master","md","markdn","markdown","mdown","mkdn","ml","mli","mll","mly","mm","mud","nfo","opml","osascript","p","pas","patch","php","php2","php3","php4","php5","phtml","pl","pm","pod","pp","profile","ps1","pss","pt","py","pyw","r","rake","rb","rbx","rc","rdf","re","reg","rest","resw","resx","rhtml","rjs","rprofile","rpy","rss","rst","ruby","rxml","s","sass","scala","scm","sconscript","sconstruct","script","scss","sgml","sh","sh","shtml","sml","svn-base","sql","sql","sty","tcl","tex","textile","tld","tli","tmpl","tpl","vb","vi","vim","vmg","webpart","wsp","wsdl","xhtml","xoml","xsd","xslt","yaml","yaws","yml","zsh"],email:["eml","msg","ost","pst"],application:["application","appref-ms","apk","app","appx","exe","ipa","msi","xap"],font:["ttf","otf","woff"],sysfile:["bak","bin","cab","cache","cat","cer","class","dat","db","dbg","dl_","dll","ithmb","jar","kb","kdc","ldt","lrprev","ppa","ppam","pdb","rom","thm","thmx","vsl","xla","xlam","xll"]},r=void 0;function o(e){return e?null!==e.itemType&&void 0!==e.itemType&&e.itemType!==a.a.File?a.a[e.itemType].toLowerCase():s(e.extension):"none"}function s(e){return e?(r||(r={},Object.keys(i).map(function(e){i[e].forEach(function(t){r[t]=e})})),r[e.toLowerCase()]||"other"):"none"}function c(e){return"word"===s(e)}function d(e){return"excel"===s(e)}function l(e){return"powerpoint"===s(e)}}
,function(e,t,n){n.d(t,{a:function(){return E},b:function(){return w},c:function(){return O},d:function(){return y},e:function(){return S},f:function(){return D},g:function(){return I},h:function(){return v},i:function(){return b},j:function(){return g},k:function(){return x},l:function(){return C}});var a=n(281),i=n(32),r=n(82),o=n(39),s=n(181),c=n(80),d=n(19),l=n("react-lib"),u=n(280),f=n(20),p=n(79),m=n(21),_=n(24),h=["ownerCannotShareWithSelf","maximumRecipientsExceeded","invalidAclEmailSpecified","duplicateMembersInRequest","secureSharingInvalidRequest"];function b(e){return h.indexOf(e)>-1}function g(e){var t,n;return!("UNVALIDATED_EMAIL_ADDRESS"!==(null===(n=null===(t=null==e?void 0:e.rawPersonData)||void 0===t?void 0:t.EntityData)||void 0===n?void 0:n.PrincipalType))}function v(e){var t,n;return!(!(null==e?void 0:e.isExternal)||"GUEST_USER"!==(null===(n=null===(t=null==e?void 0:e.rawPersonData)||void 0===t?void 0:t.EntityData)||void 0===n?void 0:n.PrincipalType))}function y(e){return e&&0!==e.length?e.filter(function(e){return e.entityType===c.a.externalUser}).length:0}function S(e){return e&&0!==e.length?e.filter(function(e){return e.entityType===c.a.linkedinUser}).length:0}function D(e){var t=e.filter(function(e){return e.entityType===c.a.externalUser}),n=t.length,a=t.map(function(e){return e.name});if(n>3)return d.d(f.Hf,n);if(n>1){var i=a.join(", "),r=i.lastIndexOf(",");return"".concat(i.substring(0,r+1)," ").concat(f.I," ").concat(i.substring(r+1)," ").concat(f.qf)}return 1===n?"".concat(a[0]," ").concat(f.Qf):""}function I(e,t,n){var a=e.filter(function(e){return e.entityType===c.a.group}),i=a.length,r="";if(n){var o=a.filter(function(e){return!e.email}),s=o.length;if(s>3)r=d.d(f.Xe,o.length);else if(s>1){var l=[];o.map(function(e){return l.push(e.name)});var u=l.join(", "),p=u.lastIndexOf(","),m="".concat(u.substring(0,p+1)," ").concat(f.I," ").concat(u.substring(p+1));r=d.d(f.b,m)}else s>0&&(o[0].email||(r=d.d(f.Vf,a[0].name)))}else 1===i?r=f.jf:i>1&&(r=d.d(f.Je,i));return t>=1e3?r+=" ".concat(f.Gd):t>=25&&(r+=" ".concat(d.d(f.zd,t))),r}function x(e){var t=e.selectedItems,n=e.sharingLinkKind,d=e.canAddExternalPrincipal,h=e.sharingInformation,b=e.viewPolicyTipCallback,g=e.permissionsMap,y=e.scope;if(!m.Fb())return C({selectedItems:t,canAddExternalPrincipal:d,sharingInformation:h,viewPolicyTipCallback:b,audience:e.audience});var S=l.createElement("div",null,l.createElement("span",{role:"alert","aria-live":"assertive"},f.Ph),l.createElement(u.a,{onClick:b},f.qh)),D=h.item.hasDlpPolicy||h.sharingAbilities&&h.sharingAbilities.directSharingAbilities&&h.sharingAbilities.directSharingAbilities.canAddExternalPrincipal.disabledReason===a.a.documentIsProtectedByDlp,I=!1,x=e.audience;if(h.sharingAbilities&&e.audience&&t&&t.length)switch(x){case i.a.specificPeople:case i.a.specificPeopleFlex:h.sharingAbilities.peopleSharingLinkAbilities&&h.sharingAbilities.peopleSharingLinkAbilities.canAddNewExternalPrincipals&&(I=h.sharingAbilities.peopleSharingLinkAbilities.canAddNewExternalPrincipals.disabledReason===a.a.azureB2BIMIntegrationNotConfiguredSharingToNewExternalUserNotSupported);break;case i.a.anyone:h.sharingAbilities.anyoneLinkAbilities&&h.sharingAbilities.anyoneLinkAbilities.canAddNewExternalPrincipals&&(I=h.sharingAbilities.anyoneLinkAbilities.canAddNewExternalPrincipals.disabledReason===a.a.azureB2BIMIntegrationNotConfiguredSharingToNewExternalUserNotSupported);break;case i.a.organization:h.sharingAbilities.organizationLinkAbilities&&h.sharingAbilities.organizationLinkAbilities.canAddNewExternalPrincipals&&(I=h.sharingAbilities.organizationLinkAbilities.canAddNewExternalPrincipals.disabledReason===a.a.azureB2BIMIntegrationNotConfiguredSharingToNewExternalUserNotSupported)}for(var O=(0,_.j)(h.fileExtension),w=0,E=t;w<E.length;w++){var L=E[w];if(!L.isResolving&&!L.isResolved)return D&&!d?S:O&&I&&L.isExternal?l.createElement("span",{role:"alert","aria-live":"assertive"},f.we):L.rawData?A(L.rawData,h.customizedExternalSharingServiceUrl):l.createElement("span",{role:"alert","aria-live":"assertive"},f.of);if(O&&I&&L.isExternal)return l.createElement("span",{role:"alert","aria-live":"assertive"},f.we);if(L.isExternal&&D&&!d)return S;if(L.isExternal&&!d&&!v(L))return l.createElement("span",{role:"alert","aria-live":"assertive"},f.Fg);if(L.isExternal&&L.principalType===p.a.distributionList&&L.entityType===c.a.group)return l.createElement("span",{role:"alert","aria-live":"assertive"},f.Ug);var k=y===r.a.organization;if(L.isExternal&&k)return l.createElement("span",{role:"alert","aria-live":"assertive"},f.Tg)}if(g&&n===o.a.direct){var M=0;for(var P in g)g[P]===s.a.none&&M++;var T="";1===M?T=f.Zd:M>1&&(T=f.Xd);var U=e.onShareHintClick?l.createElement("a",{className:"od-Share-PeoplePicker-error-changeTypeLink",onClick:function(){return e.onShareHintClick()},href:"javascript:void(0)"},f.Ub):void 0;if(T)return l.createElement("div",null,l.createElement("span",{role:"alert","aria-live":"assertive"},T),U)}return h.peoplePickerError?l.createElement("span",{role:"alert","aria-live":"assertive"},h.peoplePickerError):null}function C(e){var t,n,i,r,o,s,d,h,b,g,y,S,D,I,x,C,O,w,E=e.selectedItems,L=e.canAddExternalPrincipal,k=e.sharingInformation,M=e.viewPolicyTipCallback,P=l.createElement("div",null,l.createElement("span",{role:"alert","aria-live":"assertive"},f.Ph," "),l.createElement(u.a,{onClick:M},f.qh)),T=k.item.hasDlpPolicy||k.sharingAbilities&&k.sharingAbilities.directSharingAbilities&&k.sharingAbilities.directSharingAbilities.canAddExternalPrincipal.disabledReason===a.a.documentIsProtectedByDlp;if(m.Fb())for(var U=(0,_.j)(k.fileExtension),F=0,H=E;F<H.length;F++){if(!(V=H[F]).isResolving&&!V.isResolved)return T&&!L?P:!V.isExternal||L||v(V)?V.rawData?A(V.rawData,k.customizedExternalSharingServiceUrl):l.createElement("span",{role:"alert","aria-live":"assertive"},f.of):U?l.createElement("span",{role:"alert","aria-live":"assertive"},f.we):l.createElement("span",{role:"alert","aria-live":"assertive"},f.Fg);if(V.isExternal&&T&&!L)return P;if(V.isExternal&&!L&&!v(V))return U?l.createElement("span",{role:"alert","aria-live":"assertive"},f.we):l.createElement("span",{role:"alert","aria-live":"assertive"},f.Fg);if(V.isExternal&&V.principalType===p.a.distributionList&&V.entityType===c.a.group)return l.createElement("span",{role:"alert","aria-live":"assertive"},f.Ug)}else for(var R=(null===(i=null===(n=null===(t=null==k?void 0:k.sharingAbilities)||void 0===t?void 0:t.directSharingAbilities)||void 0===n?void 0:n.canAddNewExternalPrincipal)||void 0===i?void 0:i.enabled)||(null===(s=null===(o=null===(r=null==k?void 0:k.sharingAbilities)||void 0===r?void 0:r.anyoneLinkAbilities)||void 0===o?void 0:o.canAddNewExternalPrincipals)||void 0===s?void 0:s.enabled)||(null===(b=null===(h=null===(d=null==k?void 0:k.sharingAbilities)||void 0===d?void 0:d.peopleSharingLinkAbilities)||void 0===h?void 0:h.canAddNewExternalPrincipals)||void 0===b?void 0:b.enabled),N=(null===(S=null===(y=null===(g=null==k?void 0:k.sharingAbilities)||void 0===g?void 0:g.directSharingAbilities)||void 0===y?void 0:y.canAddExternalPrincipal)||void 0===S?void 0:S.enabled)||(null===(x=null===(I=null===(D=null==k?void 0:k.sharingAbilities)||void 0===D?void 0:D.anyoneLinkAbilities)||void 0===I?void 0:I.canHaveExternalUsers)||void 0===x?void 0:x.enabled)||(null===(w=null===(O=null===(C=null==k?void 0:k.sharingAbilities)||void 0===C?void 0:C.peopleSharingLinkAbilities)||void 0===O?void 0:O.canHaveExternalUsers)||void 0===w?void 0:w.enabled),B=0,j=E;B<j.length;B++){var V=j[B],z=N&&v(V),G=(U=(0,_.j)(k.fileExtension),R||z);if(V.isResolving||V.isResolved){if(V.isExternal){if(!G)return!m.Xb()&&T?P:U?l.createElement("span",{role:"alert","aria-live":"assertive"},f.we):l.createElement("span",{role:"alert","aria-live":"assertive"},f.Fg);if(V.principalType===p.a.distributionList&&V.entityType===c.a.group)return l.createElement("span",{role:"alert","aria-live":"assertive"},f.Ug)}}else{if(G)return V.rawData?A(V.rawData,k.customizedExternalSharingServiceUrl):l.createElement("span",{role:"alert","aria-live":"assertive"},f.of);if(!m.Xb()&&T)return P;if(V.isExternal)return U?l.createElement("span",{role:"alert","aria-live":"assertive"},f.we):l.createElement("span",{role:"alert","aria-live":"assertive"},f.Fg)}}return k.peoplePickerError?l.createElement("span",{role:"alert","aria-live":"assertive"},k.peoplePickerError):null}function O(e){var t,n,i,r,o,s,c,d,u,p,h,b,g=e.sharingInformation,y=e.selectedItems;if(m.Fb())for(var S=null===(i=null===(n=null===(t=null==g?void 0:g.sharingAbilities)||void 0===t?void 0:t.directSharingAbilities)||void 0===n?void 0:n.canAddExternalPrincipal)||void 0===i?void 0:i.enabled,D=(null===(s=null===(o=null===(r=null==g?void 0:g.sharingAbilities)||void 0===r?void 0:r.directSharingAbilities)||void 0===o?void 0:o.canAddExternalPrincipal)||void 0===s?void 0:s.disabledReason)===a.a.azureB2BIMIntegrationNotConfiguredSharingToNewExternalUserNotSupported,I=(0,_.j)(g.fileExtension),x=0,C=y;x<C.length;x++){if((L=C[x]).isExternal&&I&&D)return l.createElement("span",{role:"alert","aria-live":"assertive"},f.we);if(L.isExternal&&!S&&!v(L))return l.createElement("span",{role:"alert","aria-live":"assertive"},f.Fg)}else{I=(0,_.j)(g.fileExtension);for(var O=null===(u=null===(d=null===(c=null==g?void 0:g.sharingAbilities)||void 0===c?void 0:c.directSharingAbilities)||void 0===d?void 0:d.canAddNewExternalPrincipal)||void 0===u?void 0:u.enabled,w=null===(b=null===(h=null===(p=null==g?void 0:g.sharingAbilities)||void 0===p?void 0:p.directSharingAbilities)||void 0===h?void 0:h.canAddExternalPrincipal)||void 0===b?void 0:b.enabled,E=0,A=y;E<A.length;E++){var L=A[E],k=w&&v(L);if(L.isExternal&&!O&&!k)return I?l.createElement("span",{role:"alert","aria-live":"assertive"},f.we):l.createElement("span",{role:"alert","aria-live":"assertive"},f.Fg)}}return null}function w(e){var t,n,i,o,s,c,d,u,p,h,b,g,y=e.scope,S=e.selectedItems,D=e.sharingInformation,I=e.simplifiedV2;if(m.Fb()){var x=void 0,C=void 0;if(D.sharingAbilities&&void 0!==y&&S&&S.length)switch(y){case r.a.specificPeople:D.sharingAbilities.peopleSharingLinkAbilities&&D.sharingAbilities.peopleSharingLinkAbilities.canAddNewExternalPrincipals&&(x=D.sharingAbilities.peopleSharingLinkAbilities.canAddNewExternalPrincipals.disabledReason===a.a.azureB2BIMIntegrationNotConfiguredSharingToNewExternalUserNotSupported,C=D.sharingAbilities.peopleSharingLinkAbilities.canAddNewExternalPrincipals.disabledReason===a.a.blockedByWhoCanShareSettings);break;case r.a.anyone:D.sharingAbilities.anyoneLinkAbilities&&D.sharingAbilities.anyoneLinkAbilities.canAddNewExternalPrincipals&&(x=D.sharingAbilities.anyoneLinkAbilities.canAddNewExternalPrincipals.disabledReason===a.a.azureB2BIMIntegrationNotConfiguredSharingToNewExternalUserNotSupported,C=D.sharingAbilities.anyoneLinkAbilities.canAddNewExternalPrincipals.disabledReason===a.a.blockedByWhoCanShareSettings)}for(var O=(0,_.j)(D.fileExtension),w=y===r.a.organization,E=y===r.a.uninitialized,A=0,L=S;A<L.length;A++)if((U=L[A]).isExternal){if(x&&O)return l.createElement("span",{role:"alert","aria-live":"assertive"},f.we);if(x||C)return l.createElement("span",{role:"alert","aria-live":"assertive"},f.Fg);if(w||E)return I?l.createElement("span",{role:"alert","aria-live":"assertive"},l.createElement("div",{style:{fontWeight:600}},f.Sd),l.createElement("div",null,f.Dd)):l.createElement("span",{role:"alert","aria-live":"assertive"},f.Tg)}}else{O=(0,_.j)(D.fileExtension),w=y===r.a.organization,E=y===r.a.uninitialized;var k=void 0,M=void 0;if(D.sharingAbilities&&void 0!==y&&S&&S.length)switch(y){case r.a.anyone:k=null===(i=null===(n=null===(t=D.sharingAbilities)||void 0===t?void 0:t.anyoneLinkAbilities)||void 0===n?void 0:n.canAddNewExternalPrincipals)||void 0===i?void 0:i.enabled,M=null===(c=null===(s=null===(o=D.sharingAbilities)||void 0===o?void 0:o.anyoneLinkAbilities)||void 0===s?void 0:s.canHaveExternalUsers)||void 0===c?void 0:c.enabled;break;case r.a.specificPeople:k=null===(p=null===(u=null===(d=D.sharingAbilities)||void 0===d?void 0:d.peopleSharingLinkAbilities)||void 0===u?void 0:u.canAddNewExternalPrincipals)||void 0===p?void 0:p.enabled,M=null===(g=null===(b=null===(h=D.sharingAbilities)||void 0===h?void 0:h.peopleSharingLinkAbilities)||void 0===b?void 0:b.canHaveExternalUsers)||void 0===g?void 0:g.enabled}for(var P=0,T=S;P<T.length;P++){var U=T[P],F=M&&v(U);if(U.isExternal){if(!k&&!F)return O?l.createElement("span",{role:"alert","aria-live":"assertive"},f.we):l.createElement("span",{role:"alert","aria-live":"assertive"},f.Fg);if(w||E)return I?l.createElement("span",{role:"alert","aria-live":"assertive"},l.createElement("div",{style:{fontWeight:600}},f.Sd),l.createElement("div",null,f.Dd)):l.createElement("span",{role:"alert","aria-live":"assertive"},f.Tg)}}}return null}function E(e,t){if(e.audience!==i.a.existing)return null;var n=0;for(var a in t)t[a]===s.a.none&&n++;var r="";return 1===n?r=f.Zd:n>1&&(r=f.Xd),r?l.createElement("div",null,l.createElement("span",{role:"alert","aria-live":"assertive"},r)):void 0}function A(e,t){var n=e.EntityData&&e.EntityData.BlockingSharingPolicy||0;return 0===n||607===n?l.createElement("span",{role:"alert","aria-live":"assertive"},e.Description):n>=401&&n<=404?t?l.createElement("div",{role:"alert","aria-live":"assertive"},d.c(f.hd,l.createElement("a",{href:t,target:"_blank",rel:"noreferrer"},f.sf))):l.createElement("span",{role:"alert","aria-live":"assertive"},f.bd):n>=200&&n<=209||n>=301&&n<=305?t?l.createElement("div",{role:"alert","aria-live":"assertive"},d.c(f.vd,l.createElement("a",{href:t,target:"_blank",rel:"noreferrer"},f.sf))):l.createElement("span",{role:"alert","aria-live":"assertive"},m.ec()?f.Tj:f.yd):n>=600&&n<=603?t?l.createElement("div",{role:"alert","aria-live":"assertive"},d.c(f.cj,l.createElement("a",{href:t,target:"_blank",rel:"noreferrer"},f.sf))):l.createElement("span",{role:"alert","aria-live":"assertive"},f.dj):802===n?l.createElement("span",{role:"alert","aria-live":"assertive"},f.Pk):void 0}}
,,,,,,,,,function(e,t,n){n.d(t,{a:function(){return o},b:function(){return r}});var a=n(0),i=n(254);function r(e,t){return function(n){var a=(0,i.b)(n,t||i.a.Small);return 0===a.indexOf("https://")||0===a.indexOf("http://")?a:a&&e?e+a:void 0}}function o(e){!e||window._spPageContextInfo&&window._spPageContextInfo.userPhotoCdnBaseUrl||(window._spPageContextInfo=(0,a.a)((0,a.a)({},window._spPageContextInfo),{userPhotoCdnBaseUrl:e}))}}
,,,function(e,t,n){n.d(t,{a:function(){return _},b:function(){return m}});var a=n(0),i=n(90),r=n(12),o=n(35),s=n(36),c=n(116),d=n(1),l=n(10),u=!d.a.isActivated("F68B6171-BBD4-440F-9527-F56CE8D3EA2C","01/06/2024","collect flight and experiment"),f=!d.a.isActivated("49bcbbce-f172-4626-8eef-1fd842a3af00","06/18/2024","Include isNucleusEnabled for customer promises"),p=!d.a.isActivated("753720d0-bf33-4abf-a6c3-19530c76f7c6","17/09/2024","bekaise - asha alerter"),m="Missing Perf Goal",_=function(e){function t(t){var n=e.call(this,function(e){return f&&e&&(e.isNucleusEnabled=!!window.__isListDataSyncEnabled),e}(t))||this;return t&&t.perfGoalInMs&&n.setTimeout(null==t?void 0:t.perfGoalInMs,{resultType:o.a.Failure,errorCode:m,extraData:(0,a.a)({},t)}),n}return(0,a.d)(t,e),t.prototype.end=function(t){var i=this;if(t&&t.extraData&&this.data.extraData&&(t=(0,a.a)((0,a.a)({},t),{extraData:(0,a.a)((0,a.a)({},this.data.extraData),t.extraData)})),t&&t.errorCode!==m&&(t=this._assessPerf(t)),p&&t&&t.veto&&"None"!==t.veto&&l.a.isFeatureEnabled({ODB:62109})&&(console.info("ASHA failure trace"),console.trace(),console.info("ASHA failure start and end data"),console.info(this.data,t),n.e(36).then(n.bind(n,561)).then(function(e){(0,e.ashaAlert)(i.data,t)}).catch(function(){})),!u)try{var r=this._collectExperiments();r&&t&&(t.extraData=(0,a.a)((0,a.a)({},t.extraData),{experiments:r}));var o=window._spPageContextInfo;if(t&&!o&&(o=t.spPageContext),this.data&&!o&&(o=this.data.spPageContext),o){var s=this._collectSPClientFlights(o);s&&t&&(t.extraData=(0,a.a)((0,a.a)({},t.extraData),{flights:s}))}}catch(e){}return e.prototype.end.call(this,t)},t.prototype._assessPerf=function(e){if(!this.endTime){var t=e.perfGoalInMs||this.data.perfGoalInMs;t&&e.resultType!==o.a.Failure&&t<s.a.getTime()-this.startTime&&(e=(0,a.a)((0,a.a)({},e),{resultType:o.a.Failure,errorCode:m,extraData:e.errorCode?(0,a.a)((0,a.a)({},e.extraData),{innerErrorCode:e.errorCode}):void 0}))}return e},t.prototype._collectExperiments=function(){var e=window.ODSP_EXPERIMENTS||{},t=void 0;for(var n in e)if(e.hasOwnProperty(n)){t=t||{};var a=e[n];a&&a._serverTime&&Date.now()-new Date(a._serverTime).getTime()<1296e6&&(t[n]=e[n])}return t},t.prototype._collectSPClientFlights=function(e){var t=e.ExpFeatures,n=void 0;if(t){n="";for(var a=0,i=t;a<i.length;a++){var r=i[a];n+=this._numberToBinString(r).split("").reverse().join("")}}return n},t.prototype._numberToBinString=function(e){var t=(e>>>0).toString(2);return"".concat(Array(32-t.length+1).join("0")).concat(t)},t}((0,i.a)({eventName:"CustomerPromise,",shortEventName:"CustomerPromise"},{scenario:{isKey:!0,isPrefixingDisabled:!0,type:r.a.String},errorCode:{isPrefixingDisabled:!0,type:r.a.String},resultType:{typeRef:o.a,isPrefixingDisabled:!0,type:r.a.Enum},resultCategory:{isPrefixingDisabled:!0,type:r.a.String},extraData:r.a.Object,httpStatus:{isPrefixingDisabled:!0,type:r.a.Number},perfGoalInMs:{isPrefixingDisabled:!0,type:r.a.Number},duration:{isPrefixingDisabled:!0,type:r.a.Number},pillar:{isPrefixingDisabled:!0,type:r.a.String},veto:{isPrefixingDisabled:!0,type:r.a.String},isStaging:{isPrefixingDisabled:!0,type:r.a.Boolean},product:{isPrefixingDisabled:!0,type:r.a.String},conversationId:{isPrefixingDisabled:!0,type:r.a.String},ashaFeature:{isPrefixingDisabled:!0,type:r.a.String},isNucleusEnabled:{isPrefixingDisabled:!0,type:r.a.Boolean}})).withManager((0,c.a)())}
,,,function(e,t,n){n.d(t,{a:function(){return _}});var a=n(0),i=n(36),r=n(49),o=n(29),s=n(348),c=n(1);function d(e,t){void 0===t&&(t=new o.a);var n=(0,s.a)(t),i=(0,a.a)((0,a.a)({AccountType:void 0!==e.accountType?r.a[e.accountType]:void 0,CloudType:e.cloudType,Environment:e.environment,FarmLabel:e.farmLabel,FarmName:e.farmName,IsAuthenticated:void 0===e.isAuthenticated?void 0:e.isAuthenticated?1:0,IsNucleus:void 0===e.isNucleus?void 0:e.isNucleus?1:0,Market:e.market,Manifest:e.manifest,OneDriveDeviceId:e.oneDriveDeviceId,Session:e.session,SiteSubscriptionId:e.siteSubscriptionId,UserId:e.userId,Version:e.version,Workload:e.workload,SiteId:e.siteId,WebId:e.webId,WebTemplateId:e.webTemplateId,pageCorrelationId:e.pageCorrelationId,originalSession:e.originalSession,listId:e.listId,Product:e.product,HomeTenantId:e.homeTenantId,ResourceTenantId:e.resourceTenantId,SessionId:e.session,TenantId:e.siteSubscriptionId,UserAgent:n.BrowserUserAgent,ServerGU:e.sideBySideToken},n||{}),e.context||{});if(c.b.isActivated("77CA8BC5-1900-4DEF-82E1-A00FB0F3B0E4")||(void 0===window.__debugLoggerContext&&(window.__debugLoggerContext=[]),window.__debugLoggerContext.push({session:i.SessionId||"",workload:i.Workload||"",product:i.Product||"None"})),!c.b.isActivated("9C23C058-67EA-4F23-A2BF-98B0225ECE29")&&!window.__wroteSessionId)try{console.log("Session ID:",i.SessionId),console.log("Time in UTC: ",(new Date).toUTCString()),window.__wroteSessionId=!0}catch(e){}return i}function l(){return n.e("odsp.1ds.lib").then(n.bind(n,"1ds-lib"))}function u(e){var t;try{return null===(t=null===window||void 0===window?void 0:window.sessionStorage)||void 0===t?void 0:t.getItem(e)}catch(e){return null}}var f=n(10),p={ODB:-990,ODC:"ForceEnableAria"},m=function(e){var t;return"true"===(null===(t=u(e))||void 0===t?void 0:t.toLowerCase())&&"undefined"!=typeof console&&!!console},_=function(){function e(e){var t=this;this._getOneDS=l,this._handlerDisposers=[],this.logEvent=function(e){Promise.all((0,a.g)([t._logger],t._updateContextPromises,!0)).then(function(n){var a=n[0],i=t._params,r=i.onLogEvent,o=i.shouldLogEvent;r&&(e=r(e)),o&&!o(e)||(a.logEvent(e),t._updateContextPromises=[])})},this._params=e;var n,i,r,o,s,_,h,b,g,v,y,S,D=d(e.context);this._loggerConfig=(0,a.a)({endpointUrl:e.context.oneDsCollectorUrl,isDebug:"true"===u("enableTelemetryDebug")||"true"===u("EnableConsoleTelemetryDebug"),disableTelemetry:(r=e.context,h=!!(null===(o=null===window||void 0===window?void 0:window._spModuleLink)||void 0===o?void 0:o.usingRedirectCookie),b="onebox"===(null==r?void 0:r.env2),g=m("_isRunningTABTest"),v=/[?&]debug=true/.test((null===(s=null===window||void 0===window?void 0:window.location)||void 0===s?void 0:s.href)||""),y=!!u("spfx-debug"),S=/[?&]alTest=/.test((null===(_=null===window||void 0===window?void 0:window.location)||void 0===_?void 0:_.href)||""),!(!(h||g||v||y||b||S)||m("enableTelemetryUpload")||m("enableAriaUpload")||f.a.isFeatureEnabled(p))),enableStorageChannel:!!e.offlineDetection,propertyConfiguration:{scrubIpOnly:!0},enablePrivacyGuard:(n=e.tenantToken,i=c.a.isActivated("FAE1CF3A-D031-498D-9CDE-EA1151B19F0F"),("3d697adc11914fa4991f1c3870255788-1afd84c4-bb01-494a-bfb0-0216ab2771c6-6977"===n||"f74c101dfd474d06a7b40fed2051df7e-edb10b9a-779e-4b75-b0cc-ee0cee0f831b-7189"===n||"3620e5572cf04917bf4993285ebe4e15-d5c60963-35a1-45e2-9430-928e0656b9cd-6718"===n)&&!i)},e.loggerConfig),this._logger=this._getOneDS().then(function(n){return new n._OneDSLogger(e.tenantToken,D,t._loggerConfig)}),this._initOfflineDetection(),this._updateContextPromises=[]}return e.prototype.updateContext=function(e){var t=d(e);this._updateContextPromises.push(this._logger.then(function(e){e.updateContext(t)}))},e.prototype.flush=function(){return this._logger.then(function(e){e.flush()})},e.prototype.attach=function(e){if(i.b){var t=e.addEventHandler({sourceName:"OneDS-".concat(this._params.sourceName),handleMissedEvents:!0,handler:this.logEvent});return this._handlerDisposers.push(t),t}var n=this.logEvent;return e.addLogHandler(n).forEach(n),t=function(){e.removeLogHandler(n)},this._handlerDisposers.push(t),t},e.prototype.dispose=function(){this._handlerDisposers.forEach(function(e){return e()}),this._handlerDisposers=[]},e.prototype._initOfflineDetection=function(){var e=this._params.offlineDetection;e&&this._logger.then(function(t){t.setOffline(e.offline),e.onChange(function(e){t.setOffline(e)})})},e}()}
,function(e,t,n){n.d(t,{a:function(){return C}});var a=n(0),i=n(7),r=n(405),o=n(207),s=n(57),c=n(31),d=n(247),l=n(404),u=n(38),f=n(91),p=n(124),m=n(592),_=n(10),h=n(1),b=n(126),g="Authorization";function v(e){var t=new p.a(e);return"".concat(t.authority,"/{ length: ").concat(t.path.length,", segments: ").concat(t.segments.length," }")}var y=n(221),S=!h.a.isActivated("814227A9-5B1C-411D-8434-601C47E5BA61"),D=window&&window.performance,I={activityLimitReached:!0,malwareDetected:!0,nameAlreadyExists:!0,resourceModified:!0,resyncRequired:!0,quotaLimitReached:!0,accessRestricted:!0,childItemCountExceeded:!0,entityTagDoesNotMatch:!0,fragmentOutOfOrder:!0,fragmentOverlap:!0,hipCheckRequired:!0,insufficientVaultQuota:!0,lockMismatch:!0,lockNotFoundOrAlreadyExpired:!0,lockOwnerMismatch:!0,maxDocumentCountExceeded:!0,maxFileSizeExceeded:!0,maxFolderCountExceeded:!0,maxItemCountExceeded:!0,nameContainsInvalidCharacters:!0,pathIsTooLong:!0,pathTooDeep:!0,pathIsTooDeep:!0,propertyNotUpdateable:!0,resyncApplyDifferences:!0,resyncUploadDifferences:!0,serviceReadOnly:!0,throttledRequest:!0,unlockRequired:!0,versionNumberDoesNotMatch:!0,virusSuspicious:!0,authFailure:!1},x="Bearer",C=function(){function e(e,t){this._sendSyncClientHeadersKs=h.b.isActivated("00babe87-7679-4e02-94f0-4c05915282ca","3/29/2023");var n=e.alwaysSendContentType,a=void 0!==n&&n,i=t.sessionManagementProvider,r=t.urlDataSource,s=t.apiEvent,c=void 0===s?o.a:s,d=t.cookieOrigin,l=t.isOffline,u=t.dataSyncClient;this._sessionManagementProvider=i,this._alwaysSendContentType=a,this._apiEvent=c,this._apiName=r&&"function"==typeof r.getApiName?r.getApiName():"Vroom",this._urlDataSource=r,this._cookieOrigin=d,this._isOffline=l,this._dataSyncClient=u,this._encodingFixEnabled=!h.b.isActivated("179f8622-1596-43df-a186-a4b42e1d7917","08/04/2020","Decode unicode characters in graph errors")&&!_.a.isFeatureEnabled({ODC:"GraphEncodingFixKillswitch"}),this._driveIdUrlCheckEnabled=!h.b.isActivated("16BE6F20-C2C6-46AF-8EA5-6D43B30F7112","06/09/2022","Validate driveUrl against driveId")}return e.prototype.send=function(e){var t=this,n=function(n){var _,C,w=e.headers,E=void 0===w?{}:w,A=e.driveUrl,L=e.driveId,k=e.apiName,M=e.disableLogging,P=void 0!==M&&M,T=e.timeout,U=e.onProgress,F=e.onUploadProgress,H=e.qosExtraData,R=e.apiVersion,N=void 0===R?"v2.0":R,B=e.needsAuthorization,j=void 0===B||B,V=e.postProcessQos,z=e.breakCache,G=e.allowCookies,K=e.hasContentType,W=void 0===K||K,q=e.useMultiPart,Q=void 0!==q&&q,Y=e.getErrorAsMessage,J=void 0!==Y&&Y,X=e.expectedErrors,Z=e.endpoint,$=n.path,ee=n.accessToken,te=n.forceContentType,ne=void 0!==te&&te,ae=n.useExactAuthToken,ie=void 0!==ae&&ae,re=n.headers;if(!Z){var oe="v2.1"===N?N:void 0;Z=t._urlDataSource?"function"==typeof t._urlDataSource.getApiBaseUrl?t._urlDataSource.getApiBaseUrl({apiVersion:oe,driveId:L}):null===(C=(_=t._urlDataSource).getVroomApiBaseUrl)||void 0===C?void 0:C.call(_):void 0}if(t._driveIdUrlCheckEnabled&&A&&L&&("me"!==L?"".concat(Z,"/drives/").concat(L):A)!==A)throw new s.a({code:"DriveIdAndDriveUrlMismatch"});var se=(0,a.a)((0,a.a)({},I),e.expectedErrorCodes||{}),ce=e.requestType,de=void 0===ce?"GET":ce,le=t._cookieOrigin,ue=new p.a($).authority?$:"".concat(Z).concat($),fe=function(n){var s,p,_,I="",x={};Q?(I=u.a.generate(),x={"Content-Type":"multipart/form-data;boundary=".concat(I)}):x=(0,a.a)((0,a.a)((0,a.a)((0,a.a)((0,a.a)((0,a.a)({Accept:"application/json"},(e.postData||t._alwaysSendContentType)&&W||ne?{"Content-Type":"application/json"}:{}),n.useCookies&&n.digestValue?{"x-requestdigest":n.digestValue}:{}),J?{prefer:"rich-error-as-message"}:{}),h.a.isActivated("99EE4BC8-A7CF-47FA-9104-3CBB7479E126","01/10/2024","Killswitch to enable locale for accept language")?{}:{"Accept-Language":b.a.language}),E),t._sendSyncClientHeadersKs?{}:re),n.sessionToken&&n.sessionToken.tokenUrl&&0===$.indexOf("/drive/")?_=new c.a("".concat(n.sessionToken.tokenUrl,"/").concat($.substring(7))):(_=new c.a($),Z&&!_.getScheme()&&(_=new c.a(Z+$))),Q&&(_.setQueryParameter("ump","1"),"POST"!==de&&(E["X-HTTP-Method-Override"]=de),de="POST");var C,O,w=y.a?function(e){var t=e.sessionToken,n=e.useExactAuthToken;if(t){var a=t.accessToken,i=t.proofToken,r=t.wlidToken,o=t.isBadger;if(r)return{name:g,value:"wlid1.1 ".concat(r)};if(a)return{name:g,value:n?a:"".concat(o?"badger":"bearer"," ").concat(a)};if(i)return{name:"X-PROOF_TOKEN",value:i}}}({sessionToken:n.sessionToken,useExactAuthToken:ie}):void 0;if(!Q)if(y.a)w&&(x=(0,a.a)((0,a.a)({},x),((s={})[w.name]=w.value,s)));else if(n.sessionToken){var A=n.sessionToken,L=A.accessToken,M=A.proofToken,R=A.wlidToken,N=A.isBadger;if(R)x=(0,a.a)((0,a.a)({},x),{Authorization:"wlid1.1 ".concat(R)});else{if(L){var B=N?"badger":"bearer",j=ie?L:"".concat(B," ").concat(L);x=(0,a.a)((0,a.a)({},x),{Authorization:j})}M&&(x=(0,a.a)((0,a.a)({},x),{"X-PROOF_TOKEN":M}))}}if(Q){if(C="",C+="--".concat(I,"\r\n"),C+="Content-Disposition: form-data;name=data\r\n",E)for(var G=0,K=Object.keys(E);G<K.length;G++){var q=K[G];C+="".concat(q,": ").concat(E[q],"\r\n")}if(C+="Content-Type: application/json\r\n",y.a)w&&(C+="".concat(w.name,": ").concat(w.value,"\r\n"));else{var Y=n.sessionToken||{};L=Y.accessToken,N=Y.isBadger,L&&(C+="Authorization: ".concat(B=N?"badger":"bearer"," ").concat(L,"\r\n"))}J&&(C+="prefer: rich-error-as-message\r\n"),C+="\r\n",C+="".concat(void 0!==e.postData?e.postData:"","\r\n"),C+="--".concat(I,"--")}z&&_.setQueryParameter("r",Math.random().toFixed(8)),(null===(p=n.sessionToken)||void 0===p?void 0:p.authKey)&&_.setQueryParameter("authKey",n.sessionToken.authKey);var ee="".concat(t._apiName,"DataRequest.").concat(k);if(!P){var te={url:v(_.toString()),name:ee,extraData:H};O=new t._apiEvent(te)}var ae=_.toString(),oe=D&&D.now();return r.a.start({url:ae,headers:x,method:de,json:C||e.postData||"",requestTimeoutInMS:T,withCredentials:n.useCookies,onProgress:U,onUploadProgress:F,responseType:e.responseType||void 0}).then(function(t){var n,i,r=(0,d.a)(ae,oe);if(O){var s=null!==(i=null===(n=t.getAllResponseHeaders())||void 0===n?void 0:n.toLowerCase())&&void 0!==i?i:"",c={resultType:o.b.Success,extraData:(0,a.a)((0,a.a)({},H||{}),{rawRequestDuration:r.duration,performanceEntry:JSON.stringify(r),requestId:s.indexOf("sprequestguid:")>=0?t.getResponseHeader("sprequestguid"):s.indexOf("request-id:")>=0?t.getResponseHeader("request-id"):null,MSCorrelationVector:s.indexOf("ms-cv:")>=0?t.getResponseHeader("MS-CV"):null})};O.end(c)}return e.parseResponse?e.parseResponse(t):0===t.responseText.length?null:JSON.parse(t.responseText)},function(e){var r,s,c=function(e,t){return V&&(e=V(e,t)),O&&O.end(e),i.c.reject(t)},u=(0,d.a)(ae,oe);if(e instanceof Error){var p=i.c.isCanceled(e),h=p?o.b.ExpectedFailure:o.b.Failure,b={error:e.message,resultCode:p?"Canceled":"",resultType:h,extraData:{rawRequestDuration:u.duration,performanceEntry:JSON.stringify(u)}};return c(b,e)}if(("text"===e.responseType||""===e.responseType)&&e.responseText)try{s=JSON.parse(e.responseText)}catch(e){}if(J)try{var g=null===(r=null==s?void 0:s.error)||void 0===r?void 0:r.message;if("string"==typeof g){var v=t._encodingFixEnabled?JSON.parse((0,m.a)(g)):JSON.parse(atob(g));s={error:v}}}catch(e){}var y=e.status,D=e.statusText,I=(s||{}).error,x=void 0===I?{}:I,C=x.message,w=void 0===C?"":C,E=x.innerError,A=void 0===E?{}:E,L=A.stackTrace,k=void 0===L?"":L,M=A.debugMessage,P=void 0===M?"":M;return(y||!t._isOffline?i.c.resolve(!1):t._isOffline()).then(function(t){var i,r,d=null!==(r=null===(i=e.getAllResponseHeaders())||void 0===i?void 0:i.toLowerCase())&&void 0!==r?r:"",p=d.indexOf("sprequestguid")>=0&&e.getResponseHeader("sprequestguid")||d.indexOf("request-id")>=0&&e.getResponseHeader("request-id")||void 0,m=t||!!(0,l.b)(s,y,function(e){return se[e]||!!(S&&X&&(0,f.isExpectedError)({code:"".concat(e),message:w},X))||void 0}),h=function(e){var t=e.error,n=e.isOffline,a=(null==t?void 0:t.message)||"",i=a;return("string"!=typeof i&&i.value?i.value:a)||(n?"Offline":"")}({error:null==s?void 0:s.error,isOffline:t}),b=new l.a(new Error(h),{response:s,status:y,request:e,correlationId:p,isExpected:m,extraData:{apiEventName:ee}});!S&&X&&(0,f.isExpectedError)({code:b.code,message:w},X)&&(m=!0);var g={resultType:m?o.b.ExpectedFailure:o.b.Failure,error:w,resultCode:b.code,extraData:(0,a.a)((0,a.a)((0,a.a)({},H||{}),(0,l.c)(b)),{stack:k,httpStatus:y,httpStatusText:D,requestId:p,correlationId:p,MSCorrelationVector:d.indexOf("ms-cv:")>=0?e.getResponseHeader("MS-CV"):null,debugMessage:P,accessTokenLength:n.sessionToken&&n.sessionToken.accessToken?n.sessionToken.accessToken.length:-1,urlLength:_.toString().length,useCookies:!!n.useCookies,isOffline:t,rawRequestDuration:u.duration,performanceEntry:JSON.stringify(u)})};return c(g,b)})})},pe=t._sessionManagementProvider;if(j){if(ee)return fe({sessionToken:ee});var me=new p.a(ue).authority;if(G&&me&&le&&me===le){if("GET"===de)return fe({useCookies:!0});if(pe&&pe.getFormDigest)return pe.getFormDigest(ue).then(function(e){return fe({digestValue:e,useCookies:!0})})}if(pe&&pe.getSessionToken){var _e={apiVersion:N,endpoint:Z,driveUrl:A,path:ue};return i.c.resolve(pe.getSessionToken(_e)).then(function(e){return fe({sessionToken:e}).catch(function(t){return pe.getSessionToken&&e&&function(e){if(e instanceof l.a){var t=e.request,n=t&&t.getResponseHeader("WWW-Authenticate");if(n&&n.slice(0,x.length)===x&&n.indexOf('error="insufficient_claims"')>-1)return!0}return!1}(t)?pe.getSessionToken((0,a.a)((0,a.a)({},_e),{claimsChallenge:{sessionToken:e,claims:O(t),error:t}})).then(function(n){return n.accessToken!==e.accessToken?fe({sessionToken:n}):i.c.reject(t)}):i.c.reject(t)})})}if(pe&&pe.getToken)return pe.getToken(N,ue).then(function(e){return fe({sessionToken:e})})}return fe({})},_=(0,a.a)({},e);return!h.a.isActivated("83F9234E-0E49-4110-943D-2F0394E9F9FF","5/24/2022","Route graph calls to Nucleus")&&this._dataSyncClient?function(e){var t=e.dataSyncClient,n=e.options,r=e.getData,o=function(){return r(n)};return i.c.resolve(t).then(function(t){return t?function(t){return t.getData({url:n.path,method:n.requestType},function(t){var n=t.endpoint,i=t.headers,o=t.onComplete,s=(0,a.a)((0,a.a)({},e.options),{path:n.url,accessToken:{accessToken:n.authToken},forceContentType:!0,useExactAuthToken:!0,headers:i,onComplete:o});return r(s)},o)}(t):o()})}({dataSyncClient:this._dataSyncClient,options:_,getData:n}):n(_)},e}();function O(e){var t=e.request&&e.request.getResponseHeader("WWW-Authenticate"),n='claims="';if(t){var a=t.indexOf(n);if(a>-1){var i=t.indexOf('"',a+n.length);if(i>-1){var r=t.slice(a+n.length,i);return h.a.isActivated("93E9F77D-7B3B-4760-B58F-1154E9E530ED","06/02/2022","Decode claims from base64")?r:atob(r)}}}}}
,,function(e,t,n){n.d(t,{a:function(){return o},b:function(){return r}});var a=n(0),i=n(159),r=function(){function e(e){var t=e.webAbsoluteUrl,n=e.encodeWebAbsoluteUrl,a=void 0===n||n;this._webAbsoluteUrl=t,this._encodeWebAbsoluteUrl=a,this._segments=[],this._parameters=[],this._rawParameters=[],this._lastParameterId=0}return e.prototype.toString=function(){var e,t=[];this._parameters.length&&t.push(this._parameters.map(function(e){var t=e.name,n=e.serializedValue;return"".concat(t,"=").concat(n)}).join("&")),t.push.apply(t,this._rawParameters),e=t.length?"?".concat(t.join("&")):"";var n=this._webUrl||this._webAbsoluteUrl||"",i=n.indexOf("?"),r=i>-1?n.slice(0,i):n,o=(0,a.g)([this._encodeWebAbsoluteUrl?encodeURI(r):r,"_api"],this._segments,!0);return"".concat(o.join("/")).concat(e)},e.prototype.segment=function(e){return this._extend({segments:[e]})},e.prototype.segments=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._extend({segments:e})},e.prototype.methodWithAliases=function(e,t){for(var n=this,a=[],i=0,r=Object.keys(t);i<r.length;i++){var o=r[i],s=t[o],c=n._autoParameter(s);n=c.apiUrl,a.push("".concat(o,"=").concat(c.name))}return n.segment("".concat(e,"(").concat(a.join(","),")"))},e.prototype.method=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var a=this,i=[],r=0,o=t;r<o.length;r++){var s=o[r],c=a._autoParameter(s);a=c.apiUrl,i.push(c.name)}return a.segment("".concat(e,"(").concat(i.join(","),")"))},e.prototype.parameter=function(e,t){return this._parameter(e,t)},e.prototype.parameters=function(e){for(var t=this,n=0,a=Object.keys(e);n<a.length;n++){var i=a[n],r=e[i];t=t.parameter(i,r)}return t},e.prototype.oDataParameter=function(e,t){return this.parameter(e,{raw:t})},e.prototype.rawParameter=function(e){return this._extend({rawParameters:[e]})},e.prototype.clone=function(){return new e({webAbsoluteUrl:this._webAbsoluteUrl,encodeWebAbsoluteUrl:this._encodeWebAbsoluteUrl})},e.prototype._extend=function(e){var t,n,a,i,r,o;void 0===e&&(e={});var s=this.clone();return s._webUrl=this._webUrl,s._lastParameterId=this._lastParameterId,(t=s._parameters).push.apply(t,this._parameters),(n=s._segments).push.apply(n,this._segments),(a=s._rawParameters).push.apply(a,this._rawParameters),"webUrl"in e&&(s._webUrl=e.webUrl),"lastParameterId"in e&&void 0!==e.lastParameterId&&(s._lastParameterId=e.lastParameterId),"parameters"in e&&void 0!==e.parameters&&(i=s._parameters).push.apply(i,e.parameters),"rawParameters"in e&&void 0!==e.rawParameters&&(r=s._rawParameters).push.apply(r,e.rawParameters),"segments"in e&&void 0!==e.segments&&(o=s._segments).push.apply(o,e.segments),s},e.prototype._autoParameter=function(e){var t=this._lastParameterId+1,n="@a".concat(t);return{name:n,apiUrl:this._extend({lastParameterId:t})._parameter(n,e)}},e.prototype._parameter=function(e,t){var n;return n=function(e){return!!e&&"object"==typeof e&&"json"in e}(t)?i.a(JSON.stringify(t.json)):function(e){return!!e&&"object"==typeof e&&"guid"in e}(t)?"guid'".concat(t.guid,"'"):function(e){return!!e&&"object"==typeof e&&"raw"in e}(t)?t.raw:"number"==typeof t||"boolean"==typeof t?"".concat(t):"'".concat(i.a(t),"'"),this._extend({parameters:[{name:e,serializedValue:n}]})},e}(),o=function(){function e(e){this._apiUrlType=function(t){function n(){return t.call(this,{webAbsoluteUrl:e.webAbsoluteUrl,encodeWebAbsoluteUrl:e.encodeWebAbsoluteUrl})||this}return(0,a.d)(n,t),n}(r)}return e.prototype.build=function(){return new this._apiUrlType},e.prototype.contextInfoUrl=function(e){var t,n=e.indexOf("/_layouts/");if(n>-1)t=e.substring(0,n);else{var a=e.lastIndexOf("/"),i=e.lastIndexOf(".");t=i>a?"".concat(e.substring(0,i),"_").concat(e.substring(i+1)):e}return"".concat(t,"/_api/contextinfo")},e}()}
,,function(e,t,n){n.d(t,{a:function(){return a}});var a={none:0,lazy:1,local:2,optional:4,bypass:8,async:16,suspensible:32,notAsync:-18,handleViral:16,loaderViral:8}}
,function(e,t,n){n.d(t,{a:function(){return i}});var a=n(239),i=function(){function e(e){this._type=e,this.dependencies={}}return e.prototype.create=function(){var e=new this._type;return{instance:e,disposable:(0,a.b)(e)?e:void 0}},e}()}
,function(e,t,n){n.d(t,{a:function(){return i}});var a=n(0);function i(e,t){return(0,a.a)(e,t)}}
,function(e,t,n){function a(e,t,n,a){var i="",r=0;if(!e)return"";var o=e.length;for(r=0;r<o;r++){var s=e.charCodeAt(r),c=e.charAt(r);if(t&&("#"===c||"?"===c)){i+=e.substr(r);break}n&&"&"===c?i+=c:s<=127?a||s>=97&&s<=122||s>=65&&s<=90||s>=48&&s<=57||t&&s>=32&&s<=95&&" \"%<>'&".indexOf(c)<0?i+=c:s<=15?i+="%0"+s.toString(16).toUpperCase():s<=127&&(i+="%"+s.toString(16).toUpperCase()):s<=2047?(i+="%"+(192|s>>6).toString(16).toUpperCase(),i+="%"+(128|63&s).toString(16).toUpperCase()):55296!=(64512&s)?(i+="%"+(224|s>>12).toString(16).toUpperCase(),i+="%"+(128|(4032&s)>>6).toString(16).toUpperCase(),i+="%"+(128|63&s).toString(16).toUpperCase()):r<e.length-1&&(s=(1023&s)<<10,r++,s|=1023&e.charCodeAt(r),i+="%"+(240|(s+=65536)>>18).toString(16).toUpperCase(),i+="%"+(128|(258048&s)>>12).toString(16).toUpperCase(),i+="%"+(128|(4032&s)>>6).toString(16).toUpperCase(),i+="%"+(128|63&s).toString(16).toUpperCase())}return i}function i(e){return e&&(e=a(e=(e=e.replace(/'/g,"''")).replace(/%27/g,"%27%27"))),e}n.d(t,{a:function(){return i},b:function(){return a}})}
,function(e,t,n){n.d(t,{a:function(){return a}});var a=function(){var e,t;this.promise=new Promise(function(n,a){e=n,t=a}),this.resolve=e,this.reject=t}}
,function(e,t,n){n.d(t,{a:function(){return a}});var a=function(){function e(e){this._value=e,this.dependencies={}}return e.prototype.create=function(){return{instance:this._value}},e}()}
,function(e,t,n){n.d(t,{a:function(){return i},b:function(){return m},c:function(){return d},d:function(){return a}});var a,i,r=n(37),o=n(1),s=n(19),c=n(243);!function(e){e[e.sameSite=0]="sameSite",e[e.crossSite=1]="crossSite",e[e.unknown=2]="unknown"}(a||(a={})),function(e){e[e.sameGeo=0]="sameGeo",e[e.crossGeo=1]="crossGeo",e[e.unknown=2]="unknown"}(i||(i={}));var d=function(){function e(e){var t=e.defaultFullWebUrl,n=e.webAbsoluteUrlLegacy,a=e.defaultListUrl,i=e.multiGeoInfo,r=e.options,s=void 0===r?{}:r,c=s.path,d=void 0===c?void 0:c,l=s.listUrl,f=void 0===l?void 0:l,p=s.webUrl,m=void 0===p?void 0:p,_=s.mayInferListUrl,h=void 0!==_&&_;this._rawPath=d||void 0,this._rawListUrl=f||void 0,this._rawWebUrl=m||void 0,this.defaultFullWebUrl=u(t||void 0);var b=!o.a.isActivated("EBF720CC-3C94-4AD7-9B65-1893741C8188");this.webAbsoluteUrlLegacy=b?u(n||void 0):void 0,this.defaultListUrl=u(a||void 0),this.multiGeoInfo=i,this.mayInferListUrl=h}return Object.defineProperty(e.prototype,"serverRelativeItemUrl",{get:function(){return l(this._getServerRelativeItemUrl())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"serverRelativeListUrl",{get:function(){return l(this._getServerRelativeListUrl())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fullListUrl",{get:function(){return this._getFullListUrl()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"normalizedListUrl",{get:function(){return l(this._getNormalizedListUrl())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fullItemUrl",{get:function(){return this._getFullItemUrl()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"normalizedItemUrl",{get:function(){return l(this._getNormalizedItemUrl())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"listRelativeItemUrl",{get:function(){return this._getListRelativeItemUrl()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"webRelativeItemUrl",{get:function(){return this._getWebRelativeItemUrl()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fullWebUrl",{get:function(){return this._getFullWebUrl()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"normalizedWebUrl",{get:function(){return l(this._getNormalizedWebUrl())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"serverRelativeWebUrl",{get:function(){return l(this._getServerRelativeWebUrl())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"inferredFullListUrl",{get:function(){return l(this._getInferredFullListUrl())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isCrossDomain",{get:function(){return this._getIsCrossDomain()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isCrossList",{get:function(){return this._getIsCrossList()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"siteRelation",{get:function(){return this._getSiteRelation()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"geoRelation",{get:function(){return this._getGeoRelation()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._getPath()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"listUrl",{get:function(){return this._getListUrl()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"webUrl",{get:function(){return this._getWebUrl()},enumerable:!1,configurable:!0}),e.prototype._getPath=function(){var e,t=this._rawPath;if(t)if("/"===t[0]||t.indexOf("://")>-1)e=u(t);else{var n=this._getListUrl()||this.defaultListUrl;n&&(e="".concat(n,"/").concat(t))}return this._getPath=function(){return e},e},e.prototype._getListUrl=function(){var e,t=this._rawListUrl;if(t)if("/"===t[0]||t.indexOf("://")>-1)e=u(t);else{var n=this._getWebUrl()||this.defaultFullWebUrl;n&&(e="".concat(n,"/").concat(t))}return this._getListUrl=function(){return e},e},e.prototype._getWebUrl=function(){var e,t=this._rawWebUrl;return t&&(e="/"===t[0]||t.indexOf("://")>-1?u(t):"".concat(this.defaultFullWebUrl,"/").concat(t)),this._getWebUrl=function(){return e},e},e.prototype._getCurrentAuthority=function(){var e=new r.a(this.defaultFullWebUrl).authority;return this._getCurrentAuthority=function(){return e},e},e.prototype._getNormalizedWebUrl=function(){var e,t=this._getFullWebUrl(),n=this.defaultFullWebUrl;if(void 0!==t&&!(0,s.b)(t,n)){var a=new r.a(t);e=(0,s.b)(a.authority,this._getCurrentAuthority())?a.path:t}return this._getNormalizedItemUrl=function(){return e},e},e.prototype._getNormalizedItemUrl=function(){var e,t=this._getFullItemUrl();if(void 0!==t){var n=new r.a(t);e=(0,s.b)(n.authority,this._getCurrentAuthority())?n.path:t}return this._getNormalizedItemUrl=function(){return e},e},e.prototype._getNormalizedListUrl=function(){var e,t=this._getFullListUrl(),n=this._getDefaultListUrl();return void 0===t||(0,s.b)(t,n)||(e=(0,s.b)(new r.a(t).authority,this._getCurrentAuthority())?this._getServerRelativeListUrl():t),this._getNormalizedListUrl=function(){return e},e},e.prototype._getInferredFullListUrl=function(){var e,t=this._getFullListUrl();if(t)e=t;else{var n=this._getFullItemUrl(),a=this._getFullWebUrl();if(n&&a&&(0,c.a)(n,a)){var i=new r.a(n),o=new r.a(a);i.segments.length>o.segments.length&&(e="".concat(i.authority).concat(i.segments.slice(0,o.segments.length+1).join("/")))}}return this._getInferredFullListUrl=function(){return e},e},e.prototype._getServerUrl=function(){var e=this.path&&new r.a(this.path).authority||this.listUrl&&new r.a(this.listUrl).authority||this.webUrl&&new r.a(this.webUrl).authority||this.defaultListUrl&&new r.a(this.defaultListUrl).authority||new r.a(this.defaultFullWebUrl).authority;return this._getServerUrl=function(){return e},e},e.prototype._getServerRelativeListUrl=function(){var e;if(void 0!==this.listUrl)e=new r.a(this.listUrl).path;else{var t=this._getDefaultListUrl(),n=this.mayInferListUrl;if(void 0!==t||n){var a=this._getServerRelativePath(),i=new r.a(t).path;if(void 0===a&&(void 0===this.webUrl||i&&(0,c.a)(p(i),p(this._getServerRelativeWebUrl())))||i&&(0,c.a)(p(a),p(i)))e=i;else if(void 0!==a&&(""===this.defaultListUrl||n)){var o=this._getServerRelativeWebUrl();if((0,c.a)(p(a),p(o))){var s=new r.a(a).segments[new r.a(o).segments.length];e="".concat(p(o)).concat(s)}}}}return this._getServerRelativeListUrl=function(){return e},e},e.prototype._getFullListUrl=function(){var e,t=this._getServerUrl(),n=this._getServerRelativeListUrl();return void 0!==n&&(e="".concat(t).concat(n)),e},e.prototype._getFullItemUrl=function(){var e,t=this._getServerUrl(),n=this._getServerRelativeItemUrl();return void 0!==n&&(e="".concat(t).concat(n)),this._getFullItemUrl=function(){return e},e},e.prototype._getServerRelativeWebUrl=function(){var e,t;if(void 0!==this.webUrl)e=new r.a(this.webUrl).path;else if(!this.defaultListUrl&&!this.listUrl||this.mayInferListUrl||void 0===(t=this._getServerRelativeListUrl()))this.defaultFullWebUrl&&(e=new r.a(this.defaultFullWebUrl).path);else{var n=new r.a(t);e="".concat(n.segments.slice(0,-1).join("/"))}return this._getServerRelativeWebUrl=function(){return e},e},e.prototype._getServerRelativePath=function(){var e;return void 0!==this.path&&(e=new r.a(this.path).path),this._getServerRelativePath=function(){return e},e},e.prototype._getServerRelativeItemUrl=function(){var e;return this.path||this._rawPath?e=this._getServerRelativePath():this.listUrl?e=this._getServerRelativeListUrl():this.webUrl?e=this._getServerRelativeWebUrl():this.defaultListUrl?e=this._getServerRelativeListUrl():this.defaultFullWebUrl&&(e=this._getServerRelativeWebUrl()),this._getServerRelativeItemUrl=function(){return e},e},e.prototype._getListRelativeItemUrl=function(){var e,t,n=this._getServerRelativePath(),a=this._getServerRelativeListUrl();return void 0!==this.path&&void 0!==a&&(0,c.a)(p(n),t=p(a))&&(e=n&&n.substring(t.length)),this._getListRelativeItemUrl=function(){return e},e},e.prototype._getWebRelativeItemUrl=function(){var e,t,n=this._getServerRelativePath(),a=this._getServerRelativeWebUrl();return void 0!==this.path&&void 0!==a&&(0,c.a)(p(n),t=p(a))&&(e=n&&n.substring(t.length)),this._getWebRelativeItemUrl=function(){return e},e},e.prototype._getDefaultListUrl=function(){var e;return void 0!==this.defaultListUrl&&(e=new r.a(this.defaultListUrl).authority?this.defaultListUrl:"".concat(this._getCurrentAuthority()).concat(this.defaultListUrl)),this._getDefaultListUrl=function(){return e},e},e.prototype._getIsCrossDomain=function(){var e=this._getCurrentAuthority(),t=!(0,s.b)(new r.a(this._getServerUrl()).authority,e);return this._getIsCrossDomain=function(){return t},t},e.prototype._getIsCrossList=function(){var e=this._getFullListUrl(),t=this._getDefaultListUrl(),n=!(0,s.b)(e,t);return this._getIsCrossList=function(){return n},n},e.prototype._getSiteRelation=function(){var e=a.unknown;if(this._getIsCrossDomain())e=a.crossSite;else if(void 0!==this.webUrl)e=(0,s.b)(f(this.defaultFullWebUrl),f(this._getFullWebUrl()))?a.sameSite:a.crossSite;else{var t=new r.a(this.defaultFullWebUrl).path,n=this._getServerRelativeListUrl()||this._getServerRelativePath();if(void 0!==n)if((0,c.a)(p(n),p(t))){var i=new r.a(f(n)),o=new r.a(f(t));e=i.segments.length-1===o.segments.length||i.segments.length-2===o.segments.length&&"Lists"===i.segments[i.segments.length-2]?a.sameSite:a.unknown}else e=a.crossSite}return this._getSiteRelation=function(){return e},e},e.prototype._getFullWebUrl=function(){var e,t=this._getServerUrl(),n=this._getServerRelativeWebUrl();return void 0!==n&&(e="".concat(t).concat(n)),this._getFullWebUrl=function(){return e},e},e.prototype._getGeoRelation=function(){if(!this._getIsCrossDomain())return i.sameGeo;var e=new r.a(this._getServerUrl()).authority;if(!e)return i.unknown;var t=this._getCurrentGeo();if(!t)return i.unknown;var n=this._getGeoByAuthority()[e.toUpperCase()];return n?(0,s.b)(n,t)?i.sameGeo:i.crossGeo:i.unknown},e.prototype._getGeoByAuthority=function(){var e={},t={};function n(n,a,i){var o=new r.a(n).authority.toUpperCase();!i&&t[o]||(e[o]=a),i&&(t[o]=!0)}if(this.multiGeoInfo)for(var a=0,i=this.multiGeoInfo;a<i.length;a++){var o=i[a],s=o.InstanceId,c=o.IsDefaultDataLocation;if(n(o.MySiteHostUrl,s,c),n(o.PortalUrl,s,c),n(o.RootSiteUrl,s,c),n(o.TenantAdminUrl,s,c),o.AdditionalUrls)for(var d=0,l=o.AdditionalUrls;d<l.length;d++)n(l[d],s,c);if(this.defaultFullWebUrl&&this.webAbsoluteUrlLegacy){var u="".concat(new r.a(this.webAbsoluteUrlLegacy).authority,"/");o.MySiteHostUrl===u&&n("".concat(new r.a(this.defaultFullWebUrl).authority,"/"),s,c)}}return this._getGeoByAuthority=function(){return e},e},e.prototype._getCurrentGeo=function(){var e=this._getCurrentAuthority();if(e){var t=this._getGeoByAuthority()[e.toUpperCase()];return this._getCurrentGeo=function(){return t},t}},e}();function l(e){return""===e?"/":e}function u(e){return"/"===e?"/":e}function f(e){return void 0===e&&(e=""),"/"===e[e.length-1]?e.substring(0,e.length-1):e}function p(e){return void 0===e&&(e=""),"/"===e[e.length-1]?e:"".concat(e,"/")}var m=function(){function e(e){var t=e.context,n=e.itemUrlPartsType,a=void 0===n?d:n;this.itemUrlPartsType=a,this.itemUrlContext=t}return e.prototype.getUrlParts=function(e){var t=this.itemUrlContext,n=t.webAbsoluteUrl,a=t.webAbsoluteUrlLegacy,i=t.listUrl,r=t.multiGeoInfo;return new this.itemUrlPartsType({defaultFullWebUrl:n,webAbsoluteUrlLegacy:a,defaultListUrl:i,multiGeoInfo:r,options:e})},e}()}
,function(e,t,n){function a(e){return e?"gallatin"===e:location.origin.indexOf(".cn")===location.origin.length-3}function i(e){return"pathfinder"===e||"trailblazer"===e}function r(e){return"ag08"===e||"ag09"===e}function o(e,t){return i(e)||r(e)||"gcc"===t}n.d(t,{a:function(){return r},b:function(){return o},c:function(){return a},d:function(){return i}})}
,function(e,t,n){var a=n(0),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.d)(t,e),t.prototype.attached=function(e){var t=this,n=function(){for(var n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];return t.attach(e.apply(this,n)||this)};return n.prototype=e.prototype,n},t}(n(121).a);t.a=i}
,function(e,t,n){n.d(t,{a:function(){return s}});var a=n(0),i=n(162),r=n(65),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.d)(t,e),t}(i.c),s=function(e){function t(t,n){var a=n.itemUrlPartsType,i=void 0===a?o:a;return e.call(this,{context:n.pageContext,itemUrlPartsType:i})||this}return(0,a.d)(t,e),t.prototype.getUrlParts=function(t){return e.prototype.getUrlParts.call(this,t)},t.prototype.getItemUrlParts=function(e){var t=(0,r.a)(e);return this.getUrlParts({path:t.id,listUrl:t.listurl})},t}(i.b)}
,function(e,t,n){n.d(t,{a:function(){return s}});var a=n(0),i=n(162),r=n(154),o=function(e){function t(t,n){var a=e.call(this,{webAbsoluteUrl:n.pageContext.webAbsoluteUrl,encodeWebAbsoluteUrl:n.encodeWebAbsoluteUrl})||this;return a._pageContext=n.pageContext,a._shouldEncodeWebAbsoluteUrl=n.encodeWebAbsoluteUrl,a._itemUrlHelper=n.itemUrlHelper,a}return(0,a.d)(t,e),t.prototype.webByUrl=function(e){return this.webByItemUrl(this._itemUrlHelper.getUrlParts(e))},t.prototype.webByItemUrl=function(e){var t=e.siteRelation,n=e.isCrossDomain,a=e.fullItemUrl,r=this;return(n||t===i.d.crossSite)&&(r=r.method("SP.RemoteWeb",a)),r.segment("web")},t.prototype.listById=function(e,t){return this.webByItemUrl(e).segment("lists").method("GetById",t)},t.prototype.clone=function(){return new t({webAbsoluteUrl:this._pageContext.webAbsoluteUrl},{pageContext:this._pageContext,itemUrlHelper:this._itemUrlHelper,encodeWebAbsoluteUrl:this._shouldEncodeWebAbsoluteUrl})},t}(r.b),s=function(e){function t(t,n){var i=e.call(this,{webAbsoluteUrl:n&&n.pageContext?n.pageContext.webAbsoluteUrl:"",encodeWebAbsoluteUrl:n.encodeWebAbsoluteUrl})||this,r=n.itemUrlHelper,s=n.pageContext,c=n.encodeWebAbsoluteUrl,d=n.apiUrlType,l=void 0===d?function(e){function t(){return e.call(this,{},{itemUrlHelper:r,pageContext:s,encodeWebAbsoluteUrl:c})||this}return(0,a.d)(t,e),t}(o):d;return i._apiUrlType=l,i}return(0,a.d)(t,e),t.prototype.build=function(){return new this._apiUrlType},t}(r.a)}
,function(e,t,n){n.d(t,{a:function(){return l},b:function(){return f}});var a=n(7),i=n(4),r=n(152),o=n(59),s=n(51),c=n(10),d="DisableSubstrateSearch",l="https://outlook.office.com/search",u={ODB:1286},f=function(){function e(e,t){this._dataRequestor=new r.a({},{}),this._pageContext=t.pageContext,this._oAuthTokenProvider=t.oAuthTokenProvider,this._sharingContextInformation=t.sharingContextInformation,this._sharingContextInformation&&this._sharingContextInformation.additionalTokens&&(this._substrateToken=this._sharingContextInformation.additionalTokens.substrateToken),this.initializeDataStore()}return e.prototype.canUseSubstrate=function(){if(this._substrateToken)return!0;var e=!1;return this._pageContext&&!this._pageContext.isSPO||this._pageContext&&this._pageContext.authToken||(this._pageContext&&this._oAuthTokenProvider&&c.a.isFeatureEnabled(u,this._pageContext.ExpFeatures)&&(e=!0),this._dataStore&&(e=e&&!this._dataStore.getValue(d,s.a.session))),e},e.prototype.disableSubstrateCallsForPicker=function(){this.initializeDataStore(),this._dataStore.setValue(d,!0,s.a.session)},e.prototype.getSubstrateToken=function(){var e=this;if(this._substrateToken)return a.c.resolve(this._substrateToken);if(this._oAuthTokenProvider){var t=new i.a({name:"PeoplePicker.GetSubstrateToken"});return this._oAuthTokenProvider.getToken(l).then(function(e){return t.end({resultType:i.b.Success}),e},function(n){return a.c.isCanceled(n)?(t.end({resultType:i.b.ExpectedFailure,resultCode:"Canceled"}),a.c.reject(n)):(t.end({resultCode:"PeoplePicker.GetSubstrateTokenError",resultType:i.b.Failure,extraData:{serverErrorCode:n._serverErrorCode,message:n.message}}),e.disableSubstrateCallsForPicker(),null)})}return null},e.prototype.warmUpInit=function(e){var t=this;this.canUseSubstrate()&&this.getSubstrateToken().then(function(n){t.init(n,e)})},e.prototype.init=function(e,t){var n,a;void 0===t&&(t="documentshare");var i="".concat(l,"/api/v1/init?scenario=").concat(t);this._dataRequestor.send({apiName:"Substrate.PeopleSearch.Init",path:i,headers:{Authorization:"Bearer "+e,"X-AnchorMailbox":"OID:".concat(null===(n=this._pageContext)||void 0===n?void 0:n.aadUserId,"@").concat(null===(a=this._pageContext)||void 0===a?void 0:a.aadTenantId)},needsAuthorization:!1})},e.prototype.initializeDataStore=function(){this._dataStore||(this._dataStore=new o.a("PeoplePicker",s.a.session))},e}()}
,function(e,t,n){n.d(t,{a:function(){return r}});var a=n(0),i=n(118),r=function(){function e(e,t){var n=this._pageContext=t.pageContext,r=t.tokenProvider,o=t.noRedirect,s=t.normalizeErrors,c=t.dataRequestorType,d=void 0===c?function(e){function t(t){return e.call(this,t,{pageContext:n,tokenProvider:r,noRedirect:o})||this}return(0,a.d)(t,e),t}(i.b):c,l=e.dataSourceName,u=void 0===l?"DataSource":l;this.dataRequestor=new d({qosName:u,normalizeErrors:s})}return e.prototype.getDataSourceName=function(){return this.dataSourceName},e.prototype.needsRequestDigest=function(e){return!0},e.prototype.getData=function(e,t,n,a,i,r,o,s,c,d,l,u,f,p,m,_,h){void 0===i&&(i="POST");var b=e(),g=a&&a(),v=this.needsRequestDigest(b);return this.dataRequestor.getData({url:b,parseResponse:t,qosName:n,additionalPostData:g,method:i,additionalHeaders:r,contentType:o,maxRetries:s,noRedirect:c,crossSiteCollectionCall:d,telemetryHandler:l,qosExtraData:u,needsRequestDigest:v,authToken:f,webAbsoluteUrl:p,useExactAuthToken:m,skipSyncClient:_,customerPromise:h})},e}();t.b=r}
,function(e,t,n){n.d(t,{a:function(){return a},b:function(){return p},c:function(){return f},d:function(){return h},e:function(){return m},f:function(){return _}});var a,i=n(0),r=n(208),o=n(4),s=n(20),c=n(98),d=n(21),l=n(422),u=n(268);function f(e){if(!d.g()){var t;switch(e){case 2:case 9:t="files";break;case 3:t="doclib";break;case 4:t="sync";break;case 12:case 41:case 42:t="list";break;case 18:case 37:t="odc-files";break;case 4:t="odc-sync";break;default:t=void 0}return t}}function p(e,t,n,r){var o=e?(0,i.a)({},e):null,d=n;switch(t){case a.generic:case a.render:o.error=d.message,o.errorCategory=c.a.generic,o.errorMessage=s.Lk,o.rawError=n,o.debugErrorMessage=r?r.toString():(d.stack?d.stack:d.toString()).substring(0,1024);break;case a.api:if(!e){var l=c.b.generic,u=null==n?void 0:n.code,f=null==n?void 0:n.status,p=s.Rd,m=JSON.stringify(n||{});u?u.indexOf("-2147024809")>-1&&m&&m.indexOf("Item does not exist")>-1&&(l=c.b.invalidItem):f&&parseInt(f,10)>=500&&(l=c.b.serverFailure),o={error:l,errorCategory:c.a.getSharingInformation,errorMessage:p,debugErrorMessage:m,rawError:n,anonymousLinkExpirationRestrictionDays:void 0,canAddExternalPrincipal:void 0,canAddInternalPrincipal:void 0,canRequestAccessForGrantAccess:void 0,canManagePermissions:void 0,defaultSharingLink:void 0,defaultShareLinkScope:void 0,defaultShareLinkToExistingAccess:void 0,hasInheritedLinks:void 0,isShared:void 0,item:void 0,fileExtension:void 0,sharingLinks:void 0,sharingPrincipals:void 0,peoplePickerSettings:void 0,userDisplayName:void 0,blockPeoplePickerAndSharing:void 0,defaultShareLinkPermission:void 0,sharingAbilities:void 0,defaultLinkKind:void 0,directLink:void 0,hasPermissionsInformation:void 0,isGraphAvailable:!1,sharingLinkTemplates:void 0,webTemplateId:void 0,itemUniqueId:void 0,customizedExternalSharingServiceUrl:void 0,outlookEndpointHostUrl:void 0,webUrl:void 0}}}return o}function m(e){var t=e.customerPromise,n=e.rawErrorMessage,s=e.engagementExtraData,c=e.errorType,l=e.sharingStore;if(t){var f=n,p=(0,r.d)(f),m=function(e){return e&&"string"==typeof e?e.split(",").join("_"):JSON.stringify(e)}(p.resultCode),_=window._sharingContextInfo,h={sharingContext:{clientId:_.clientId,scenarioId:_.scenarioId,listUrl:_.listUrl,serverRelativeItemUrl:_.serverRelativeItemUrl,resourceId:_.resourceId,webAbsoluteUrl:_.webAbsoluteUrl,listId:_.listId,listItemId:_.listItemId,uniqueId:_.uniqueId,correlationId:_.correlationId,hostSessionId:_.hostSessionId,userId:_.userId},url:location.href},b=p.resultType;if(function(e){var t,n;if((null===(t=null==e?void 0:e.code)||void 0===t?void 0:t.indexOf("Microsoft.SharePoint.SPSharingResourceOverBudgetException"))>=0)return!0;if(503===(null==e?void 0:e.status)&&(null==e?void 0:e.retryAfter))return!0;if(-1===(null==e?void 0:e.status)&&(null===(n=null==e?void 0:e.code)||void 0===n?void 0:n.indexOf("NoConnection"))>=0)return!0;var a=null==e?void 0:e.message;if(a){if("string"!=typeof a&&(a=JSON.stringify(a)),a.indexOf("The invited user already exists in the directory")>=0)return!0;if(a.indexOf("This invitation is blocked by cross-tenant access settings.")>=0)return!0;if(a.indexOf("Creating multi-file sharing bundle is not supported.")>=0)return!0}return!1}(f)&&(b=o.b.ExpectedFailure),t.end({resultType:b,errorCode:m,extraData:(0,i.a)((0,i.a)((0,i.a)((0,i.a)({},null==l?void 0:l.getEngagementHelper().getEngagementExtraData()),s),p.extraData),{error:p.error,rawErrorMessage:n,errorType:c||a.generic,debuggingInfo:h})}),!d.zb()){var g=(0,u.a)();null==g||g.sendShareLoadResult({resultType:b,errorType:c,errorCode:m,errorMessage:f.toString()})}}}function _(e){var t=e.customerPromise,n=e.engagementExtraData,a=e.sharingStore;if(t&&(t.end({resultType:o.b.Success,extraData:(0,i.a)((0,i.a)({},null==a?void 0:a.getEngagementHelper().getEngagementExtraData()),n)}),!d.zb())){var r=(0,u.a)();null==r||r.sendShareLoadResult({resultType:o.b.Success})}}function h(e){var t;return((t={})[l.a.SharingToBlockedUserOnODB]=s.Ni,t[l.a.SharingToBlockedBySiteRAC]=s.Bi,t[l.a.ObjectNotSupported]=s.uj,t)[e]||""}!function(e){e[e.render=0]="render",e[e.api=1]="api",e[e.generic=2]="generic"}(a||(a={}))}
,,,,,,,,function(e,t,n){var a;n.d(t,{a:function(){return p},b:function(){return f}});var i="ms-word",r="onenote|UsePlain",o="ms-powerpoint",s="ms-excel",c="ms-visio",d="ms-publisher",l="ms-access",u="ms-project",f=i,p={accdb:l,csv:s,doc:i,docm:i,docx:i,dot:i,dotm:i,dotx:i,odp:o,ods:s,odt:i,one:r,onepkg:r,onetoc2:r,mpp:u,notebook:r,pot:o,potm:o,potx:o,ppa:o,ppam:o,pps:o,ppsm:o,ppsx:o,ppt:o,pptm:o,pptx:o,pub:d,vdw:c,vsd:c,vsdm:c,vsdx:c,vsl:c,vss:c,vssm:c,vssx:c,vst:c,vstm:c,vstx:c,xla:s,xlam:s,xll:s,xls:s,xlsb:s,xlsm:s,xlsx:s,xlt:s,xltm:s,xltx:s};(a={})[l]="Access",a[i]="Word",a[r]="OneNote",a[o]="PowerPoint",a[s]="Excel",a[c]="Visio",a[d]="Publisher",a[u]="Project"}
,function(e,t,n){n.d(t,{a:function(){return r}});var a=n(0),i=n(438),r=(0,a.a)((0,a.a)({},i.a),{vivaConnectionsSoftBackground:"var(--vivaConnectionsSoftBackground)",semanticPrimaryButtonText:"var(--semanticPrimaryButtonText)",semanticPrimaryButtonTextHovered:"var(--semanticPrimaryButtonTextHovered)",semanticPrimaryButtonBackgroundHovered:"var(--semanticPrimaryButtonBackgroundHovered)",semanticButtonBackgroundDisabled:"var(--semanticButtonBackgroundDisabled)",semanticPrimaryButtonBackgroundDisabled:"var(--semanticPrimaryButtonBackgroundDisabled)",semanticButtonTextDisabled:"var(--semanticButtonTextDisabled)",semanticDisabledBackground:"var(--semanticDisabledBackground)",semanticButtonTextHovered:"var(--semanticButtonTextHovered)",semanticButtonBackgroundHovered:"var(--semanticButtonBackgroundHovered)",semanticPrimaryButtonBackgroundPressed:"var(--semanticPrimaryButtonBackgroundPressed)",semanticPrimaryButtonTextPressed:"var(--semanticPrimaryButtonTextPressed)",semanticDisabledText:"var(--semanticDisabledText)",semanticActionLink:"var(--semanticActionLink)",semanticBodyText:"var(--semanticBodyText)",semanticDisabledBodyText:"var(--semanticDisabledBodyText)",semanticDisabledBodySubtext:"var(--semanticDisabledBodySubtext)",semanticInputBackground:"var(--semanticInputBackground)",semanticInputText:"var(--semanticInputText)",semanticPrimaryButtonTextDisabled:"var(--semanticPrimaryButtonTextDisabled)",semanticPrimaryButtonBackground:"var(--semanticPrimaryButtonBackground)",semanticButtonBackground:"var(--semanticButtonBackground)",semanticButtonBorder:"var(--semanticButtonBorder)",semanticButtonBackgroundPressed:"var(--semanticButtonBackgroundPressed)",semanticErrorBackground:"var(--semanticErrorBackground)",semanticWarningBackground:"var(--semanticWarningBackground)",semanticSuccessBackground:"var(--semanticSuccessBackground)",semanticSevereWarningBackground:"var(--semanticSevereWarningBackground)",semanticInfoBackground:"var(--semanticInfoBackground)",semanticErrorIcon:"var(--semanticErrorIcon)",semanticWarningIcon:"var(--semanticWarningIcon)",semanticSuccessIcon:"var(--semanticSuccessIcon)",semanticSevereWarningIcon:"var(--semanticSevereWarningIcon)",semanticInfoIcon:"var(--semanticInfoIcon)"})}
,,,function(e,t,n){n.d(t,{a:function(){return a}});var a={none:1,pending:2,hasAccess:3}}
,,,,,,,,,,,function(e,t,n){n.d(t,{a:function(){return a}});var a=function(){function e(e){this._cachedRect={width:0,height:0,top:0,left:0,bottom:0,right:0},this._resizeCallback=e,this._callbackDelayMilliseconds=20}return e.prototype.checkSizeChangeForRef=function(e){e&&e.current&&this.checkSizeChange(e.current)},e.prototype.checkSizeChange=function(e){var t=this;if(e&&this._resizeCallback){var n=e.getBoundingClientRect();this._cachedRect.width===n.width&&this._cachedRect.height===n.height&&this._cachedRect.top===n.top&&this._cachedRect.right===n.right&&this._cachedRect.left===n.left&&this._cachedRect.bottom===n.bottom||(this._callbackDelayMilliseconds?setTimeout(function(){t._resizeCallback()},this._callbackDelayMilliseconds):this._resizeCallback()),this._cachedRect=n}},e}()}
,function(e,t,n){n.d(t,{a:function(){return g},b:function(){return i},c:function(){return r},d:function(){return a}});var a,i,r,o=n(0),s=n(136),c=n(52),d=n(40),l=n(41),u=n(107),f=n(32),p=n(39),m=n(205),_=n(89),h=n(279),b="ShareV3";!function(e){e.Opening="Opening",e.Opened="Opened",e.Completed="Completed"}(a||(a={})),function(e){e.MainLinkSettingsHint="MainLinkSettingsHint",e.PeoplePickerErrorLinkSettingsHint="PeoplePickerErrorLinkSettingsHint",e.CopyLinkSettingsHint="CopyLinkSettingsHint",e.RoleSelector="RoleSelector",e.Other="Unknown"}(i||(i={})),function(e){e.People="People",e.Groups="Groups",e.Links="Links",e.Other="Unknown"}(r||(r={}));var g=function(){function e(e,t){this._manager=e,this._extraData=t,this._engagmentCounts={}}return e.prototype.setEngagementExtraData=function(e){this._extraData=(0,o.a)((0,o.a)({},this._extraData),e)},e.prototype.getEngagementExtraData=function(){return this._extraData},e.prototype.linkSettingsOpened=function(e,t){this.log("LinkSettings.Opened",(0,o.a)((0,o.a)({},e),{linkSettingsOpenSource:t||i.Other}))},e.prototype.linkSettingsApplyClicked=function(e){this.log("LinkSettings.ApplyClicked",e)},e.prototype.linkSettingsCancelClicked=function(e){this.log("LinkSettings.CancelClicked",e)},e.prototype.linkSettingsLearnMoreClicked=function(e){this.log("LinkSettings.LearnMoreClicked",e)},e.prototype.linkSettingsOnAllowEditingClicked=function(e){this.log("LinkSettings.AllowEditingClicked",e)},e.prototype.linkTrackLinkClicked=function(e){this.log("LinkSettings.TrackLinkClicked",e)},e.prototype.linkSettingsLinkTypeChanged=function(e){this.log("LinkSettings.LinkTypeChanged",e)},e.prototype.manageAccessNumberOfSharingPrincipals=function(e){this.log("ManageAccess.NumberOfSharingPrincipals",e)},e.prototype.manageAccessOpened=function(e){this.log("ManageAccess.Opened",e)},e.prototype.manageAccessAddressBarLinkTypeClicked=function(e){this.log("ManageAccess.AddressBarLinkTypeClicked",e)},e.prototype.manageAccessFacePileClicked=function(e){this.log("ManageAccess.FacePileClicked",e)},e.prototype.manageAccessRemoveDirectAccess=function(e){this.log("ManageAccess.RemoveDirectAccess",e)},e.prototype.manageAccessLinkCopyButtonClicked=function(e){this.log("ManageAccess.LinkCopyClicked",e)},e.prototype.manageAccessLinkDetailsClicked=function(e){this.log("ManageAccess.LinkDetailsClicked",e)},e.prototype.manageAccessLinkInviteesToggled=function(e,t){this.log("ManageAccess.LinkInviteesToggled",(0,o.a)((0,o.a)({},t),{isExpanded:e}))},e.prototype.manageAccessAdvancedLinkClicked=function(e){this.log("ManageAccess.AdvancedLinkClicked",e)},e.prototype.manageAccessLinkSectionShareClicked=function(e){this.log("ManageAccess.LinkSectionShareClicked",e)},e.prototype.manageAccessGrantAccessClicked=function(e){this.log("ManageAccess.DiretAccessSectionGrantAccessClicked",e)},e.prototype.manageAccessV3Opened=function(e){this.log("ManageAccessV3.Opened",e)},e.prototype.manageAccessV3NumberOfSharingPrincipals=function(e){this.log("ManageAccessV3.NumberOfSharingPrincipals",e)},e.prototype.manageAccessV3NumberOfLinks=function(e){this.log("ManageAccessV3.NumberOfLinks",e)},e.prototype.manageAccessV3AdvancedSettingsClicked=function(e){this.log("ManageAccessV3.AdvancedSettingsClicked",e)},e.prototype.manageAccessV3UserDidSearch=function(e){this.log("ManageAccessV3.UserDidSearch",e)},e.prototype.manageAccessV3GrantAccessClicked=function(e){this.log("ManageAccessV3.GrantAccessClicked",e)},e.prototype.manageAccessV3StopSharingClicked=function(e){this.log("ManageAccessV3.StopSharingClicked",e)},e.prototype.manageAccessV3QuickfindHotkeyUsed=function(e){this.log("ManageAccessV3.QuickfindHotkeyUsed",e)},e.prototype.compactRoleSelectorClicked=function(e){this.log("RoleSelectorCompact.Clicked",e)},e.prototype.linkSettingsInCompactRoleSelectorClicked=function(e){this.log("RoleSelectorCompact.LinkSettingsClicked",e)},e.prototype.SharingRoleChangedFromCompactRoleSelector=function(e){this.log("SharingRoleChangedFromCompactRoleSelector",e)},e.prototype.SharingRoleChangedFromLargeRoleSelector=function(e){this.log("SharingRoleChangedFromLargeRoleSelector",e)},e.prototype.manageAccessV3NavClicked=function(e,t,n){this.log("ManageAccessV3.NavigationClicked",(0,o.a)((0,o.a)({},n),{sectionName:e||r.Other,sectionItemCount:t}))},e.prototype.manageAccessV3ShareClicked=function(e,t){this.log("ManageAccessV3.ShareClicked",(0,o.a)((0,o.a)({},t),{shareLocation:e}))},e.prototype.manageAccessV3PrincipalDetailsClicked=function(e,t){this.log("ManageAccessV3.PrincipalDetailsClicked",(0,o.a)((0,o.a)({},t),{principalType:e}))},e.prototype.manageAccessV3PrincipalRemoveDirectAccess=function(e,t){this.log("ManageAccessV3.PrincipalRemoveDirectAccess",(0,o.a)((0,o.a)({},t),{principalType:e}))},e.prototype.manageAccessV3CancelPermissionUpdate=function(e){this.log("ManageAccessV3.CancelPermissionUpdate",e)},e.prototype.renderSharingInfoBar=function(e){this.log("SharingInfoBar.Rendered",e)},e.prototype.simplifiedV2TeachingBubbleShown=function(e){this.log("SimplifiedV2TeachingBubble.Shown",e)},e.prototype.simplifiedV2TeachingBubbleDismissed=function(e){this.log("SimplifiedV2TeachingBubble.Dismissed",e)},e.prototype.simplifiedV2TeachingBubbleCompleted=function(e){this.log("SimplifiedV2TeachingBubble.Completed",e)},e.prototype.simplifiedV2TeachingBubbleAbandoned=function(e){this.log("SimplifiedV2TeachingBubble.Abandoned",e)},e.prototype.shareToTeamsTeachingBubbleShown=function(e){this.log("ShareToTeamsTeachingBubble.Shown",e)},e.prototype.linkSettingsInfoMessageClick=function(e){this.log("LinkSettingsInfoMessage.Click",e)},e.prototype.shareCompleted=function(e){e=(0,o.a)((0,o.a)({},e),{compactRoleSelectorClicked:this._engagmentCounts["RoleSelectorCompact.Clicked"]>0,linkSettingsOpened:this._engagmentCounts["LinkSettings.Opened"]>0,sharingRoleChangedFromCompactRoleSelector:this._engagmentCounts.SharingRoleChangedFromCompactRoleSelector>0}),this.log("Completed",e)},e.prototype.sendACopyClicked=function(e){this.log("SendACopy.Clicked",e)},e.prototype.sendACopyOfficeClicked=function(e){this.log("SendACopy.OfficeClicked",e)},e.prototype.sendACopyPdfClicked=function(e){this.log("SendACopy.PdfClicked",e)},e.prototype.whoElseHasAccessClicked=function(e){this.log("WhoElseHasAccess.Clicked",e)},e.prototype.externalSharingCslError=function(e){this.log("externalSharingCslError",e)},e.prototype.copyLinkInterruptOpened=function(e){this.log("copyLinkInterruptOpened",e)},e.prototype.copyLinkInterruptEditLinkChosen=function(e){this.log("copyLinkInterruptEditLinkChosen",e)},e.prototype.copyLinkInterruptExistingLinkChosen=function(e){this.log("copyLinkInterruptExistingLinkChosen",e)},e.prototype.copyLinkInterruptCancelled=function(e){this.log("copyLinkInterruptCancelled",e)},e.prototype.copyLinkNotificationAutoCopyFailed=function(e){this.log("copyLinkNotificationAutoCopyFailed",e)},e.prototype.copyButtonClickedAfterAutoCopyFailed=function(e){this.log("copyButtonClickedAfterAutoCopyFailed",e)},e.prototype.shareErrorFileIsUploading=function(e){this.log("shareError.FileUploading",e)},e.prototype.webShareToTeamsTargetClicked=function(e){this.log("ShareToTeams.TeamsTargetClicked",e)},e.prototype.onLinkParticipantOpenDelete=function(e){this.log("ShareLinkParticipants.OpenParticipantDeletionDialog",e)},e.prototype.onLinkParticipantDelete=function(e){this.log("ShareLinkParticipants.ParticipantDeleted",e)},e.prototype.peoplePickerLinkedinSuggestions=function(e,t){this.log("PeoplePicker.Suggestions",(0,o.a)((0,o.a)({},e),{linkedinSuggestionsCount:s.e(t)}))},e.prototype.onShareLinkDelete=function(e){this.log("ShareLink.Delete",e)},e.prototype.logShareLinkGeneration=function(e,t){this.log("ShareV3.odspShareLink",(0,o.a)((0,o.a)({},t),{allowsAnonymousAccess:e.allowsAnonymousAccess,audience:e.audience,blockDownload:e.blockDownload,createdViaCopyLinkCommand:e.createdViaCopyLinkCommand,hasDescription:!!e.description,hasExpiration:!!e.expiration,hasPassword:e.hasPassword,numOfInvitees:e.invitees?e.invitees.length:0,isActive:e.isActive,isAddressBarLink:e.isAddressBarLink,isCreateOnlyLink:e.isCreateOnlyLink,isEdit:e.isEdit,isManageList:e.isManageList,isReview:e.isReview,isUnhealthy:e.isUnhealthy,shareId:e.shareId,sharingLinkStatus:e.status,trackLinkUsers:e.trackLinkUsers}))},e.prototype.logNumberOfUnhealthyLinks=function(e){this.log("numberOfUnhealthyLinks",{numUnhealthyLinks:e})},e.prototype.logShareObject=function(e,t){this.log("ShareObjectV2",{sharingRole:c.a[t],numOfInvitees:e.length})},e.prototype.showSensitivityLabel=function(e){this.log("showSensitivityLabel",e)},e.prototype.hoverOverSensitivityLabel=function(e){this.log("hoverOverSensitivityLabel",e)},e.prototype.modifiedSummary=function(e){this.log("modifiedSummary",e)},e.prototype.deletedSummary=function(e){this.log("deletedSummary",e)},e.prototype.summarizationCopilotEnabled=function(e,t){this.log("summarizationCopilotEnabled",(0,o.a)((0,o.a)({},e),{copilotFeatureEnabled:t}))},e.prototype.summarizationEnabled=function(e,t){this.log("summarizationEnabled",(0,o.a)((0,o.a)({},e),{summaryEnabled:t}))},e.prototype.summarizationClick=function(e,t){this.log("summarizationClick",(0,o.a)((0,o.a)({},e),{summaryClick:t}))},e.prototype.summarizationStatus=function(e,t){this.log("summarizationStatus",(0,o.a)((0,o.a)({},e),{summaryStatus:t}))},e.prototype.summarizationSent=function(e,t){this.log("summarizationSent",(0,o.a)((0,o.a)({},e),{summarySent:t}))},e.prototype.summarizationFeedback=function(e,t){this.log("summarizationFeedback",(0,o.a)((0,o.a)({},e),{feedbackIsPositive:t}))},e.prototype.summarizationDisabledReasonsMask=function(e,t){this.log("summarizationDisabledReasonsMask",(0,o.a)((0,o.a)({},e),{summaryDisabledReasonMask:t}))},e.prototype.discoverableByOrganizationToggle=function(e){this.log("DiscoverableByOrganization",{enabled:e})},e.prototype.discoverableMessageBarClicked=function(){this.log("DiscoverableByOrganization.MessageBarClicked")},e.prototype.discoverableByOrganizationDoNotShowAgainChecked=function(e){this.log("DiscoverableByOragnization.DoNotShowAgain",{checked:e})},e.prototype.logEvent=function(e,t){this.log(a[e],t)},e.prototype.log=function(e,t){void 0===this._engagmentCounts[e]?this._engagmentCounts[e]=1:this._engagmentCounts[e]++;var n=(0,o.a)((0,o.a)({},this._extraData),t),a=location.href.toLowerCase().indexOf("sharedialog.aspx")>=0,i=location.href.toLowerCase().indexOf("www.odwebp.svc.ms")>=0,r=(0,m.a)(location.search.substring(1)),s="12"===r.p,c=!!r.migratedhosting&&"true"===r.migratedhosting.toLowerCase(),g=(0,o.a)((0,o.a)((0,o.a)({},n),{clientId:d.a[n.clientId],scenarioId:n.scenarioId,mode:l.a[n.mode],shareType:u.a[n.shareType],audience:f.a[n.audience],shareTargets:this._getFriendlyShareTargets(n.shareTargets),sharingLinkKind:p.a[n.sharingLinkKind],isShareDialogASPXHosted:a,isP12:s,isMigratedhosting:c,isMicroServiceHosted:i}),void 0===n.shareViewState?{}:{shareViewState:h.a[n.shareViewState]}),v={name:0===e.indexOf(b)?e:"".concat(b,".").concat(e),webTemplateId:n.webTemplateId?n.webTemplateId.toString():void 0,docId:n.itemUniqueId,extraData:g};(this._manager?_.a.withManager(this._manager):_.a).logData(v)},e.prototype._getFriendlyShareTargets=function(e){var t=[];if(e)for(var n=0,a=e;n<a.length;n++){var i=a[n];t.push(u.a[i])}return t},e}()}
,,,,function(e,t,n){n.d(t,{a:function(){return c}});var a=n(0),i=n("react-lib"),r=n(129),o=n(77),s=n(92);function c(e,t,n){void 0===n&&(n=["styles","theme"]);var c=(0,i.useContext)(r.a),d=o.a.getSettings(n,e,c.customizations),l={};if(d.styles&&"function"==typeof d.styles&&(d.styles=d.styles((0,a.a)((0,a.a)({},d),t))),d.styles){if(l.default!==d.styles||l.component!==(null==t?void 0:t.styles)){var u=(0,s.a)(d.styles,null==t?void 0:t.styles);l.default=d.styles,l.component=null==t?void 0:t.styles,l.merged=u}return(0,a.a)((0,a.a)((0,a.a)({},d),t),{styles:l.merged})}return(0,a.a)((0,a.a)({},d),t)}}
,,,function(e,t,n){n.d(t,{a:function(){return i}});var a=n("react-lib");function i(e){var t=a.useRef(e);t.current=e;var n=a.useRef();return n.current||(n.current=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var a=t.current;return a.apply(null,e)})}}
,function(e,t,n){n.d(t,{a:function(){return o}});var a=n("react-lib");(0,n(8).b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.IconButton{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.IconButton:hover{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";outline:1px solid "},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}"}]);var i=n(61),r=n(56);function o(e){var t=e.iconProps,n=e.onClick,o=e.ariaLabel,s=e.tooltipContent,c=e.menuProps,d=e.menuIconProps,l=e.className,u=e.directionalHint,f=e.disabled,p=e.automationId,m=e.styles,_=e.tooltipStyles,h=a.useState(!1),b=h[0],g=h[1],v={gapSpace:0,calloutMaxWidth:180,hidden:b,styles:{root:{borderRadius:"4px"},beakCurtain:{borderRadius:"4px"}}};return a.createElement(i.a,{content:s,id:s,styles:_,calloutProps:v,directionalHint:u},a.createElement(r.d,{className:l||"IconButton",iconProps:t,onClick:n,onMenuClick:function(){g(!0)},onAfterMenuDismiss:function(){g(!1)},ariaLabel:o,menuProps:c,menuIconProps:d,disabled:f,"data-automationid":p,id:p,styles:m}))}}
,,,,function(e,t,n){n.d(t,{a:function(){return a.a},b:function(){return i.a}});var a=n(65),i=n(230)}
,,function(e,t,n){n.d(t,{a:function(){return s},b:function(){return o.a}});var a=n(90),i=n(12),r=n(4),o=n(35),s=(0,a.a)({eventName:"Api,Qos,",shortEventName:"Api"},{url:i.a.String,privacyClassification:{isPrefixingDisabled:!0,type:i.a.String}},r.a).withData({privacyClassification:i.b.requiredService})}
,function(e,t,n){n.d(t,{a:function(){return a.a},b:function(){return i.a},c:function(){return i.b},d:function(){return r.a}}),n(91);var a=n(49),i=(n(89),n(4)),r=(n(35),n(12),n(36),n(90),n(28),n(115))}
,,,function(e,t,n){n.d(t,{a:function(){return a}});var a={none:0,link:1,linkV2:2,linkInheritance:3,linkBundle:4,direct:5,participant:6,linkSettings:7,back:8,shareDialogPasswordOnly:9,shareDialogExpirationOnly:10,shareDialogPasswordAndExpiration:11,copyInterruptUpdate:12,copyInterruptRemove:13,addressBarLinkOff:14,shareDialogExternalSharing:15}}
,,,,,,,function(e,t,n){n.d(t,{a:function(){return r}});var a=n(28),i=n(12),r=(0,a.a)({eventName:"Trace,",shortEventName:"Trace"},{message:i.a.String,privacyClassification:{isPrefixingDisabled:!0,type:i.a.String}}).withData({privacyClassification:i.b.requiredService,privacyDataTypes:["browsingHistory"]})}
,,,function(e,t,n){n.d(t,{a:function(){return a}});var a=!n(1).a.isActivated("5E0E2EF8-347F-441A-8C3B-709E288CACF7")}
,function(e,t,n){n.d(t,{a:function(){return c}});var a=n(241),i=n(50),r=n(35),o="GetSchemaException";function s(e,t,n){var a={resultType:e};return t&&(a.resultCode=t),n&&(a.error=n),a}function c(e,t,n,c,d){var l,u=new e(t);try{l=n()}catch(e){throw u.end(s(r.a.Failure,"PromiseCreationFailed",(0,i.e)(e.toString()))),e}return l.then(function(e){var t;if(c)try{t=c(e)}catch(e){t=s(r.a.Failure,o,(0,i.e)(e.toString()))}else t=s(r.a.Success);u.end(t)},function(e){var t;if(d)try{t=d(e)}catch(e){t=s(r.a.Failure,o,(0,i.e)(e.toString()))}else t=e?s(e instanceof Error&&"Canceled"===e.name?r.a.ExpectedFailure:r.a.Failure,void 0,(0,i.e)((0,a.a)(e),"unsafe")):s(r.a.Failure);u.end(t)}),l}}
,,,function(e,t,n){var a=n(28),i=n(12),r=(0,a.a)({eventName:"UnhandledError,",shortEventName:"UnhandledError",critical:!0},{message:i.a.String,stack:i.a.String,builtStack:i.a.String,line:i.a.Number,col:i.a.Number,url:i.a.String,privacyClassification:{isPrefixingDisabled:!0,type:i.a.String}}).withData({privacyClassification:i.b.requiredService,privacyDataTypes:["productAndServicePerformance"]}),o=0;function s(e){var t,n,a;if(e){var i=e&&e.toString?e.toString():"InvalidMethod()",r=8===i.indexOf(" ")?9:0,o=i.indexOf(")")+1;if(0===(t=i.substring(r,o)).indexOf("function")||t.indexOf("(")<3){var s=o+50;a=s,(n=i=i.replace(/\s\s*/g," "))&&n.length>a&&(n=n.substr(0,a-3)+"..."),t=n+(s<i.length?"}":"")}}return t}function c(){var e,t=[];try{for(e=arguments.callee;e===l||e===c;)e=e?e.caller:e}catch(t){e=null}var n=0;try{for(;e&&n<10;)t.push(s(e)),e=e.caller,n++}catch(e){}return t}var d=[function(e){return"string"==typeof e&&0===e.indexOf("ResizeObserver loop limit exceeded")},function(e){return"string"==typeof e&&0===e.indexOf("ResizeObserver loop completed with undelivered notifications")}];function l(e,t,n,a,i){try{window.parent&&window.parent.opener&&"LogOnError"in window.parent.opener&&(d.some(function(t){return t(e,i)})||Function.prototype.apply.call(window.parent.opener.LogOnError,window.parent.opener,[e,t,n,a,i]))}catch(e){}var s=i&&i.stack,l=c().join("\n");s=s?s.replace(/[ \t]{2,}/g," "):"",l=l.replace(/[ \t]{2,}/g," ");var u={message:e,url:t,line:n,col:a,stack:s,builtStack:l};o<100?r.logData(u):100===o&&r.logData({message:"Hit max error limit of ".concat(100),url:"NA",line:0,col:0,stack:"",builtStack:""}),o++}window.onerror=l}
,function(e,t,n){var a=n(59),i=n(51),r=n(28),o=n(12),s=(0,r.a)({eventName:"RequireJSError,",shortEventName:"RequireJSError",critical:!0},{message:o.a.String,requireModules:o.a.Array,requireType:o.a.String,stack:o.a.String}),c=n(78),d=new a.a("RequireJS",i.a.session),l="error";(function(){function e(){}return e.log=function(e){s.logData(e);var t=d.getValue(l)||[];t.push(e.message),d.setValue(l,t),e&&("define"===e.requireType||"require"===e.requireType)&&e.stack&&e.requireModules&&c.a.log(e)},e.registerRequireOnError=function(){if(window.requirejs&&"function"==typeof window.requirejs){var t=window.requirejs.onError;window.requirejs.onError=function(n){e.log(n),t&&!n.isTest&&t(n)}}},e})().registerRequireOnError()}
,function(e,t,n){var a=n(78),i=n(95),r=n(7),o=n(58),s=n(241),c=n(28),d=n(12),l=(0,c.a)({eventName:"UnhandledPromise,",shortEventName:"UnhandledPromise"},{message:d.a.String,extraData:d.a.String}).withData({privacyClassification:d.b.requiredService,privacyDataTypes:["productAndServicePerformance"]}),u=new(function(){function e(){this._outstandingPromiseErrors={},this._async=new i.a}return e.prototype.log=function(e){var t=this,n=e.id;e.parent?e.handler&&delete this._outstandingPromiseErrors[n]:(this._outstandingPromiseErrors[n]=e,1===Object.keys(this._outstandingPromiseErrors).length&&this._async.setTimeout(function(){var e=t._outstandingPromiseErrors;t._outstandingPromiseErrors={},Object.keys(e).forEach(function(t){var n=e[t],i=n.exception?n.exception:n.error;if(i instanceof Error||i&&i.stack?r.c.isCanceled(n)||a.a.log(i):l.logData({message:"Promise with no error callback",extraData:(0,s.a)(i)}),window.console&&console.log){var o="Promise with no error callback:"+n.id;console.warn?console.warn(o):console.log(o),console.log(n),i&&i.stack&&console.log(i.stack)}})},0))},e}());new o.a(u).on(r.c,"error",u.log)}
,,,function(e,t,n){n.d(t,{a:function(){return r}});var a=n(0),i=n(159);function r(e,t,n){var r="",o=!0;for(var s in t&&(e=(0,a.a)((0,a.a)({},t),e)),e){var c,d=e[s];if(!n||"object"!=typeof d&&d||"object"==typeof d&&d&&d.uriValue||"number"==typeof d||"boolean"==typeof d)o?o=!1:r+="&",c="object"==typeof d&&d&&d.uriValue?d.uriValue:(0,i.b)("".concat(d)),r+="".concat(s,"=").concat(c)}return r}}
,function(e,t,n){n.r(t),n.d(t,{default:function(){return D}});var a,i=n(96),r=n(53),o=n(118),s=n(7),c=n(265),d=[.537,.349,.216,.184,.145,.082,.043,.027],l=[.537,.45,.349,.216,.184,.145,.082,.043],u=[.88,.77,.66,.55,.44,.33,.22,.11],f=[.11,.22,.33,.44,.55,.66,.77,.88],p=[.96,.84,.7,.4,.12],m=[.1,.24,.44];function _(e,t){return{h:e.h,s:e.s,v:e.v-e.v*t}}function h(e,t){return{h:e.h,s:e.s-e.s*t,v:e.v+(100-e.v)*t}}function b(e,t,n){if(!e||t===a.Unshaded||!function(e){return"number"==typeof e&&e>=a.Unshaded&&e<=a.Shade8}(t))return e;var i=h,r=_;n&&(i=_,r=h);var o,s,b,g,v,y,S,D=(s=NaN,b=(o=e).R,g=o.G,v=o.B,0==(S=(y=Math.max(b,g,v))-Math.min(b,g,v))?s=0:b===y?s=(g-v)/S%6:g===y?s=(v-b)/S+2:v===y&&(s=(b-g)/S+4),(s=Math.round(60*s))<0&&(s+=360),{h:s,s:Math.round(100*(0===y?0:S/y)),v:Math.round(y/255*100)}),I=function(e){var t=e.h,n=e.s,a=e.v,i=(2-(n/=100))*(a/=100),r=n*a;return{h:t,s:100*(r=(r/=i<=1?i:2-i)||0),l:100*(i/=2)}}(D),x=t-1;return D=function(e){return 255===e.R&&255===e.G&&255===e.B}(e)?_(D,d[x]):function(e){return 0===e.R&&0===e.G&&0===e.B}(e)?h(D,l[x]):I.l/100>.8?r(D,f[x]):I.l/100<.2?i(D,u[x]):x<p.length?i(D,p[x]):r(D,m[x-p.length]),function(e){var t=e.h,n=e.s,a=e.v,i=[],r=(a/=100)*(n/=100),o=t/60,s=r*(1-Math.abs(o%2-1)),d=a-r;switch(Math.floor(o)){case 0:i=[r,s,0];break;case 1:i=[s,r,0];break;case 2:i=[0,r,s];break;case 3:i=[0,s,r];break;case 4:i=[s,0,r];break;case 5:i=[r,0,s]}return c.a.fromRgba(Math.round(255*(i[0]+d)),Math.round(255*(i[1]+d)),Math.round(255*(i[2]+d)))}(D)}!function(e){e[e.Unshaded=0]="Unshaded",e[e.Shade1=1]="Shade1",e[e.Shade2=2]="Shade2",e[e.Shade3=3]="Shade3",e[e.Shade4=4]="Shade4",e[e.Shade5=5]="Shade5",e[e.Shade6=6]="Shade6",e[e.Shade7=7]="Shade7",e[e.Shade8=8]="Shade8"}(a||(a={}));var g=function(){function e(){}return e.generateFabricColors=function(t,n){void 0===n&&(n=!1);var i={themeDarker:a.Shade8,themeDark:a.Shade7,themeDarkAlt:a.Shade6,themeLight:a.Shade3,themeLighter:a.Shade2,themeLighterAlt:a.Shade1,themePrimary:a.Unshaded,themeAccent:a.Unshaded,themeSecondary:a.Shade5,themeTertiary:a.Shade4},r=e._getDefaultThemeTokenMap(),o=c.a.fromRgba(t.R,t.G,t.B);for(var s in i){var d=i[s];r[s]=b(o,d,n)}var l=r.themeAccent;if(r.themeAccentTranslucent10=l?c.a.fromRgba(l.R,l.G,l.B,.1*c.a.maxComponent):null,n){var u="#4f4f4f",f="#484848",p={black:"#fff",blackTranslucent40:"#66ffffff",neutralDark:"#f4f4f4",neutralPrimary:"#fff",neutralPrimaryTranslucent50:"#7fffffff",neutralPrimaryAlt:"#dadada",neutralSecondary:"#d0d0d0",neutralTertiary:"#c8c8c8",neutralTertiaryAlt:"#6d6d6d",neutralQuaternary:u,neutralQuaternaryAlt:f,cmdbarSelected:u,cmdbarSelectedHover:f,neutralLight:"#3f3f3f",neutralLighter:"#313131",neutralLighterAlt:"#282828",white:"#1f1f1f",whiteTranslucent40:"#661f1f1f",error:"#f00",errorBackground:"#7e3333"};for(var m in p)p.hasOwnProperty(m)&&(r[m]=c.a.fromHtmlColor(p[m]))}return r},e._getDefaultThemeTokenMap=function(){return{backgroundOverlay:null,themeDarker:null,themeDark:null,themeDarkAlt:null,themePrimary:null,themeSecondary:null,themeTertiary:null,themeLight:null,themeLighter:null,themeLighterAlt:null,black:null,cmdbarSelected:null,cmdbarSelectedHover:null,neutralDark:null,neutralPrimary:null,neutralPrimaryAlt:null,neutralPrimaryTranslucent50:null,neutralSecondary:null,neutralSecondaryAlt:null,neutralTertiary:null,neutralTertiaryAlt:null,neutralQuaternary:null,neutralQuaternaryAlt:null,neutralLight:null,neutralLighter:null,neutralLighterAlt:null,white:null,blackTranslucent40:null,whiteTranslucent40:null,yellow:null,yellowLight:null,orange:null,orangeLight:null,redDark:null,red:null,magentaDark:null,magenta:null,magentaLight:null,purpleDark:null,purple:null,purpleLight:null,blueDark:null,blueMid:null,blue:null,blueLight:null,tealDark:null,teal:null,tealLight:null,greenDark:null,green:null,greenLight:null,error:null,errorBackground:null,success:null,successBackground:null,alert:null,alertBackground:null,infoBackground:null,info:null,orangeLighter:null}},e}(),v=n(99),y=function(){function e(){}return e.makeWebThemeRestUrl=function(e,t,n){var a=e;a&&"/"===a[a.length-1]&&(a=a.substring(0,a.length-1)),a=v.a.escapeUrlForCallback(a);var i=v.a.escapeUrlForCallback(a)+"/_api/SP.Web.GetContextWebThemeData?noImages=true&lcid="+v.a.encodeURIComponent(t);return n&&(i+="&ThemeOverride="+v.a.encodeURIComponent(n)),i},e.processWebThemeRestResponse=function(t){var n,a=JSON.parse(t);return a&&a.d&&a.d.GetContextWebThemeData&&(n=JSON.parse(a.d.GetContextWebThemeData)),e.processRawThemeData(n)},e.processRawThemeData=function(t){if(t){var n,a=e.coerceToColor,i=e.SetColorIfMissing,r=t.Palette?t.Palette.Colors:{};n=e.convertColorsToRgba(r);var o=g.generateFabricColors(n.ContentAccent1,t.IsInverted),s=a(n.PageBackground)||a(t.IsInverted?"#1b1a19":"#ffffff"),d=a(n.BackgroundOverlay)||null,l=Math.round(.4*c.a.maxComponent);for(var u in o)i(n,u,o[u]);i(n,"white",s),i(n,"primaryBackground",c.a.clone(s)),i(n,"primaryText",o.primaryText||a("#333")),i(n,"whiteTranslucent40",s&&c.a.fromRgba(s.R,s.G,s.B,l)),i(n,"backgroundOverlay",d),i(n,"suiteBarBackground",a(n.SuiteBarBackground)||null),i(n,"suiteBarText",a(n.SuiteBarText)||null),i(n,"suiteBarDisabledText",a(n.SuiteBarDisabledText)||null),i(n,"topBarBackground",a(n.TopBarBackground)||null),i(n,"topBarText",a(n.TopBarText)||null),i(n,"topBarHoverText",a(n.TopBarHoverText)||null),i(n,"dialogBorder",a(n.DialogBorder)||null);var f=void 0;if(t.FontPackage){var p=t.FontPackage.FontFaces&&t.FontPackage.FontFaces.map(function(e){return{fontFamily:e.FontFamily,path:e.Path,remappedPaths:e.RemappedPaths}}),m={};if(t.FontPackage.FontSlots)for(var _=0,h=Object.keys(t.FontPackage.FontSlots);_<h.length;_++){var b=h[_],v=t.FontPackage.FontSlots[b];v&&(m[b]={fontFamily:v.FontFamily,fontVariationSettings:v.FontVariationSettings})}f={fontFaces:p,fontSlots:m,fontPackageSource:t.FontPackage.Source}}return{backgroundImageUri:t.BackgroundImageUri,cacheToken:t.ThemeCacheToken,cacheMaxAge:t.ThemeCacheMaxAge,isDefault:t.IsDefault,isInverted:t.IsInverted,palette:n,version:t.Version,fontPackage:f}}return{backgroundImageUri:"",cacheToken:"",cacheMaxAge:void 0,isDefault:!0,isInverted:!1,palette:{},version:""}},e.convertColorsToRgba=function(t){var n={};for(var a in t)if(t.hasOwnProperty(a)){var i=e.coerceToColor(t[a]);i&&(n[a]=i)}return n},e.coerceToColor=function(t){var n;return t?"string"==typeof t||t instanceof String?n=c.a.fromHtmlColor(String(t)):"DefaultColor"in t?n=e.coerceToColor(t.DefaultColor):"R"in t&&"G"in t&&"B"in t&&(n=c.a.fromRgba(t.R,t.G,t.B,t.A)):n=null,n},e.SetColorIfMissing=function(e,t,n){e[t]||(e[t]=n)},e}(),S=n(128).c?"#0078d4":"#03787c",D=function(){function e(e){this._pageContext=e,this._dataRequestor=new o.a({qosName:"WebThemeDataSource"},{pageContext:e})}return e.prototype.getCacheToken=function(){var e="",t=this._pageContext;if(t){var n=Number(t.webTemplate),a=n!==r.b.mySite&&n!==r.b.mySiteHost?t.groupColor:S;e=t.themedCssFolderUrl||a}return e},e.prototype.loadTheme=function(e){return!e&&this._dataPromise?this._dataPromise:this.getCacheToken()?(this._dataPromise=this._pageContext.themedCssFolderUrl?this.loadServerTheme():this.loadGeneratedTheme(),this._dataPromise):this._dataPromise=s.c.resolve()},e.prototype.needsRequestDigest=function(e){return!1},e.prototype.loadGeneratedTheme=function(){var e=this._pageContext.groupColor||S,t=c.a.fromHtmlColor(e);if(t){var n={backgroundImageUri:null,cacheToken:e,cacheMaxAge:void 0,isDefault:!1,isInverted:!1,palette:g.generateFabricColors(t),version:"1"};return s.c.resolve(n)}return s.c.resolve()},e.prototype.loadServerTheme=function(){var e=this,t=(0,i.a)(this._pageContext),n=this._pageContext.currentUICultureName,a=this._pageContext.themedCssFolderUrl,r=this.getCacheToken()===a&&a||void 0,o=y.makeWebThemeRestUrl(t,n,r),s=this._dataRequestor.getData({url:o,parseResponse:function(t){return e._data=y.processWebThemeRestResponse(t),e._data},qosName:"WebThemeDataSource.LoadData",method:"GET"});return s.done(null,function(){e._dataPromise=null}),s},e}()}
,,,,,,,function(e,t,n){n.d(t,{a:function(){return i},b:function(){return o}});var a=n(156),i=function(){function e(e,t){this.key=e,this.flags=t}return e.prototype.toString=function(){var e=this.flags;return"".concat(this.key).concat(e&a.a.async?".async":e&a.a.suspensible?".suspensible":e&a.a.lazy?".lazy":"").concat(e&a.a.local?".local":"").concat(e&a.a.optional?".optional":"").concat(e&a.a.bypass?".bypass":"")},e}();function r(e){return{get:function(){return new i(this.key,this.flags|e)}}}var o={async:r(a.a.async|a.a.lazy),suspensible:r(a.a.suspensible),lazy:r(a.a.lazy),local:r(a.a.local),optional:r(a.a.optional),bypass:r(a.a.bypass)};Object.defineProperties(i.prototype,o)}
,function(e,t,n){n.d(t,{a:function(){return r},b:function(){return i}});var a=function(){function e(e){this._callbacks=[],this._owner=e}return e.prototype.addCallback=function(e){this._callbacks.push(e)},e.prototype.dispose=function(){for(var e;e=this._callbacks.pop();)e.call(this._owner)},e}();function i(e){return"function"==typeof e.dispose}function r(e,t){var n=e,i=n.dispose,r="function"==typeof i&&i.disposalChain||function(e){var t=new a(e),n=e.dispose,i=function(){t.dispose(),n&&(e.dispose=n,e.dispose())};return e.dispose=i,i.disposalChain=t,t}(n);return r.addCallback(t),n}}
,function(e,t,n){function a(e,t){var n,a,i=!!e.Fallback,r=e.ODB;if("boolean"==typeof r)i=r;else if(r>0){if(r>=6e4){var o=r-6e4+2e3+1;n=Math.floor(o/32),a=1<<o%32}else{if(!(r<=2e3))return!1;n=Math.floor(r/32),a=1<<r%32}i=n<t.length&&0!=(t[n]&a)}return i}function i(e,t){var n,a,i=!!e.Fallback,r=e.ODBECS;return"string"==typeof r&&null!==(a=null===(n=null==t?void 0:t.ClientFeatures)||void 0===n?void 0:n.has(r))&&void 0!==a&&a&&(i=!0),i}n.d(t,{a:function(){return i},b:function(){return a}})}
,function(e,t,n){function a(e){var t;try{var n=[];t=JSON.stringify(e,function(e,t){return t===window?"[window]":t instanceof HTMLElement?"[HTMLElement]":"function"==typeof t?"[function]":"object"==typeof t?null===t?t:-1===n.indexOf(t)?(n.push(t),t):"[circular]":t})}catch(e){t=JSON.stringify("[object]")}return t}n.d(t,{a:function(){return a}})}
,function(e,t,n){function a(e){return!!e&&"function"==typeof e.addEventListener}function i(e){return!!e&&!!e.__events__}function r(e,t){var n=e,a=n.__declaredEvents=n.__declaredEvents||{};if("string"==typeof t)a[t]=!0;else for(var i=0;i<t.length;i++)a[t[i]]=!0}function o(e,t,n,r){var o,s=e;if(a(s)){if(document.createEvent){var c=document.createEvent("HTMLEvents");c.initEvent(t,r,!0),c.args=n,o=s.dispatchEvent(c)}}else for(;s&&!1!==o;)if(i(s)){var d=s.__events__[t];for(var l in d)if(Object.prototype.hasOwnProperty.call(d,l))for(var u=d[l],f=0;!1!==o&&f<u.length;f++){var p=u[f];p.objectCallback&&(o=p.objectCallback.call(p.parent,n))}s=r?s.parent:null}else s=null;return o}n.d(t,{a:function(){return r},b:function(){return a},c:function(){return o}})}
,function(e,t,n){function a(e,t){var n=e.toUpperCase(),a=t&&t.toUpperCase();return n.substring(0,a&&a.length||0)===a}n.d(t,{a:function(){return a}})}
,function(e,t,n){var a=n(7),i=function(){function e(e){var t=this;this.resolve=function(e){t._promise._completed(e)},this.reject=function(e){t._promise._error(e)},this._promise=new a.b(e)}return Object.defineProperty(e.prototype,"promise",{get:function(){return this._promise},enumerable:!1,configurable:!0}),e.prototype.getPromise=function(){return this._promise},e.prototype.cancel=function(){this._promise.cancel()},e.prototype.complete=function(e){this._promise._completed(e)},e.prototype.error=function(e){this._promise._error(e)},e}();t.a=i}
,function(e,t,n){function a(e,t,n){var a=[],i=[],r=n||function(e,t){return e===t};return function e(t,n){if(t===n)return!0;if(null===t||null===n)return!1;if("object"!=typeof t||"object"!=typeof n)return!1;var o=Object.keys(t).sort(),s=Object.keys(n).sort();return o.length===s.length&&!!o.every(function(o,c){if(o!==s[c])return!1;if("function"==typeof t[o]||"function"==typeof n[o])return!0;if(r(t[o],n[o]))return!0;if("object"==typeof t[o]){if(-1!==a.indexOf(t[o]))throw new Error("Cannot perform DeepCompare() because a circular reference was encountered, object: ".concat(t,", ")+"property: ".concat(o));if(a.push(t[o]),-1!==i.indexOf(n[o]))throw new Error("Cannot perform DeepCompare() because a circular reference was encountered, object: ".concat(n,", ")+"property: ".concat(o));return i.push(n[o]),!!e(t[o],n[o])&&(a.pop(),i.pop(),!0)}return!1})}(e,t)}n.d(t,{a:function(){return a}})}
,function(e,t,n){n.d(t,{a:function(){return c},b:function(){return u},c:function(){return d},d:function(){return f}});var a=n(0),i=n(57),r=n(160),o=n(50),s="Canceled",c=function(e){function t(t){void 0===t&&(t={message:(0,o.e)(s)});var n=this,r=(0,i.c)(s);return(n=e.call(this,(0,a.a)({code:(0,i.d)(t.code)?(0,i.b)(t.code,r):r,isExpected:!0},t))||this).name=s,n}return(0,a.d)(t,e),t}(i.a);function d(e){if(e instanceof c)return!0;if(e&&"object"==typeof e){if(e.code===s)return!0;if(e.name===s)return!0}return!1}var l=function(e){var t,n=e.catch(function(e){return t=e,Promise.reject(e)});this.subscribe=function(e){var t=e;return n.then(function(){t=void 0},function(e){if(t){var n=t;t=void 0,n(e)}}),function(){t=void 0}},this.isCanceled=function(){return!!t},this.throwIfCanceled=function(){if(t)throw new c(t)}},u=function(){var e=new r.a,t=e.reject,n=e.resolve,a=e.promise;this.cancel=function(e){return t(e||new c)},this.dispose=function(){return n()},this.token=new l(a)};function f(e,t){return(0,a.b)(this,void 0,void 0,function(){var n,i,o=this;return(0,a.e)(this,function(s){switch(s.label){case 0:return t?[3,2]:[4,e];case 1:case 3:return[2,s.sent()];case 2:return n=new r.a,i=t.subscribe(function(e){n.reject(e)}),(0,a.b)(o,void 0,void 0,function(){var t,r,o;return(0,a.e)(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,3,4]),r=(t=n).resolve,[4,e];case 1:return r.apply(t,[a.sent()]),[3,4];case 2:return o=a.sent(),n.reject(o),[3,4];case 3:return i(),[7];case 4:return[2]}})}),[4,n.promise]}})})}}
,function(e,t,n){n.d(t,{a:function(){return i}});var a=n(37);function i(e,t,n){var i,r,o=n||window;if(!(o&&o.performance&&e&&t))return{duration:-1};try{var s=performance.getEntriesByType("resource");new a.a(e).authority||(e=(o.location&&new a.a(o.location.href).authority)+e);for(var c=void 0,d=s.length-1;d>=0;d--){var l=s[d];if(l.startTime<t)break;decodeURIComponent(l.name)===decodeURIComponent(e)&&(c=l)}return c?{connectEnd:(i=c).connectEnd,connectStart:i.connectStart,decodedBodySize:i.decodedBodySize,domainLookupend:i.domainLookupend,domainLookupStart:i.domainLookupStart,duration:void 0===(r=i.duration)?-1:r,encodedBodySize:i.encodedBodySize,fetchStart:i.fetchStart,nextHopProtocol:i.nextHopProtocol,redirectEnd:i.redirectEnd,redirectStart:i.redirectStart,requestStart:i.requestStart,responseEnd:i.responseEnd,responseStart:i.responseStart,secureConnectionStart:i.secureConnectionStart,startTime:i.startTime,transferSize:i.transferSize,workerStart:i.workerStart}:{duration:-1}}catch(e){return{duration:-1}}}}
,function(e,t,n){function a(e){return e?function(e){if(!e)return{};try{var t=atob(e.replace(/-/g,"+").replace(/_/g,"/"));return JSON.parse(t)}catch(e){return{}}}(decodeURIComponent(e).split(".")[1]):{}}function i(e){if(e){var t=e.azp||e.appid;if(t)return t;var n=e.nameid;return n&&"true"!==e.isuser&&n.split("@")[0]||void 0}}function r(e,t){void 0===t&&(t=Date.now());var n=t/1e3;if(!e)return!1;var a=e.exp,i=e.nbf;return("number"!=typeof i||n>=i)&&("number"!=typeof a||n<a)}n.d(t,{a:function(){return i},b:function(){return r},c:function(){return a}})}
,function(e,t,n){var a=n(164),i=n(250),r=n(6),o=function(){function e(e,t){void 0===e&&(e={}),void 0===t&&(t={});var n=this.resources,r=void 0===n?t.resources?new i.a(t.resources):e.resources:n;this.resources=r,this._Component_scope=new a.a}return Object.defineProperty(e.prototype,"scope",{get:function(){return this._Component_scope},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this.scope.isDisposed},enumerable:!1,configurable:!0}),e.prototype.dispose=function(){this._Component_scope.dispose()},e.prototype.managed=function(e){return this.resources&&(e=this.resources.injected(e)),this.scope.attached(e)},e.prototype.child=function(e){var t;return t=e instanceof r.a?this.resources.consume(e):this.resources?this.resources.injected(e,{injectChildResourceScope:!0}):e,this.scope.attached(t)},e.dependencies={resources:i.b},e}();t.a=o}
,function(e,t,n){n.d(t,{a:function(){return T},b:function(){return F}});var a=n(0),i=n(121),r=n(239),o=n(6),s=n(156);function c(e,t){return function(n){if(Array.isArray(n)&&"function"==typeof n[0]){if("number"==typeof e&&e&s.a.optional)return;if(t)return Promise.reject(n);throw n[0](n[1],n[2])}return Promise.reject(n)}}var d=n(1),l=function(){function e(e){this.key=e.key,this.entry=e.entry,this.manager=e.manager,this._resource=void 0}return e.prototype.getInstance=function(e,t){if(this._resource)return this._resource.instance;var n=this.manager,a=this.entry.factory,i=a.create(n.resolve(a.dependencies,t));return this._resource=i,i.disposable&&n.scope.attach(i.disposable),i.instance},e.prototype.promote=function(t){var n=this.entry;return new e({key:this.key,entry:{manager:t,loader:n.loader,factory:n.factory}})},e.prototype.debug=function(){var e,t=this.entry.loader,n=void 0;return this.entry.factory&&(n={type:(null===(e=this.entry.factory.constructor)||void 0===e?void 0:e.name)||"Factory"},Object.keys(this.entry.factory.dependencies).length>0&&(n.dependencies=this.entry.factory.dependencies)),(0,a.a)((0,a.a)((0,a.a)({},t?{loader:t}:{}),n?{factory:n}:{}),this._resource?{value:this._resource}:{})},e}(),u=n(160),f=n(403),p=n(238);function m(e){return e.length<1?" Consumed directly.":(0,a.g)((0,a.g)([],e,!0),[""],!1).reverse().join("\n  Required by ")}function _(e){var t=e.flags;return t&s.a.async?new p.a(e.key,t&s.a.notAsync):e}function h(e){var t=new u.a;return e.then(function(e){return t.resolve(e)},function(e){return t.reject(e)}),t.promise}var b=new o.a({name:"asyncLoadBarrier"}),g=function(){function e(e){this._handleManager=e.manager,this._isResourceScopeKey=e.isResourceScopeKey,this._loadState={},this._root=e.manager.consume(b.optional)}return e.prototype.loadAsync=function(e,t,n,i){var r=e.key;if(this._isResourceScopeKey(r))return{bypass:v,promise:Promise.resolve(void 0)};var o=this._loadAsync(e,t,(0,a.g)([e],n,!0),i);return{promise:o.promise.catch(c(e.flags,!0)),bypass:o.bypass}},e.prototype.loadAllAsync=function(e,t,n,a){if(e){var i=Object.keys(e),r=i.length;if(r>0){for(var o=[];r--;){var s=e[i[r]];s&&o.push(this.loadAsync(s,t,n,a))}return{bypass:y(function(){for(var e=0,t=o;e<t.length;e++)t[e].bypass()}),promise:(0,f.a)(o.map(function(e){return e.promise}))}}}return{bypass:v,promise:Promise.resolve(void 0)}},e.prototype._loadAsync=function(e,t,n,i){var r=this,o=e.key,c=o.id,l=this._loadState,f=e.flags|t,p=l[c];if(p){if(i&&i.indexOf(o)>=0)throw new Error("".concat(o," has a circular dependency.").concat(m(i)," "));return f&s.a.bypass&&p.bypass(),p}if(f&s.a.async)return{bypass:v,promise:Promise.resolve(void 0)};var _=this._handleManager.getHandle(o);if(!_)return l[c]={bypass:v,promise:Promise.reject([S,e,n])};l[c]={bypass:v,promise:Promise.resolve(void 0)};var h=_.entry,b=h.factory;if(b)return l[c]=this.loadAllAsync(b.dependencies,f&s.a.loaderViral,n,i?(0,a.g)((0,a.g)([],i,!0),[o],!1):[o]);var g=h.loader;if(!g)return l[c]={bypass:v,promise:Promise.reject([S,e,n])};var D,I=this._root,x=new u.a,C=x.resolve,O=x.reject,w=x.promise;return f&s.a.bypass||!I?C():I.wait().then(C).catch(O),l[c]={bypass:y(function(){d.a.isActivated("D6B556B6-1D2A-4DC3-A9A2-AC42C0A3127C","06/29/2022","Allow bypass to force-resolve existing loaders")||(f|=s.a.bypass,C(),D&&D())}),promise:w.then(function(){return g.load()}).then(function(e){h.factory=e;var t=e.dependencies;if(t){var c=r.loadAllAsync(t,f&s.a.loaderViral,n,i?(0,a.g)((0,a.g)([],i,!0),[o],!1):[o]);return D=c.bypass,c.promise}})}},e}();function v(){}function y(e){return function(){if(e){var t=e;e=void 0,t()}}}function S(e,t){return new Error("".concat(e," is being loaded, but has no factory / loader.Check to ensure that either: ")+"\n  1) ".concat(e," is defined with a 'factory' or 'loader' specified.")+"\n  2) A higher - level component calls 'expose', 'exposeFactory', or 'exposeAsync' for ".concat(e,".").concat(function(e){return e.length<2?" Loaded directly.":(0,a.g)([""],e.slice(1),!0).join("\n  Required by ")}(t)))}var D=function(){function e(e){this._loader=e,this._cached=void 0}return e.prototype.load=function(){var e=this;return this._cached?this._cached:(this._cached=h(this._loader.load())).then(function(t){return e._loader=void 0,t},function(t){return e._cached=void 0,Promise.reject(t)})},e}(),I=d.a.isActivated("677F4316-6DBD-4FD0-A1CA-92673CFB4423"),x=function(){function e(t){var n;if(this._handles={},this._isLocked=!1,this._loader=void 0,t instanceof e){if(t.isDisposed)throw new Error("Parent ResourceScope has already been disposed!");n=t.options,this._parent=t,this._level=t._level+1,this._isResourceScopeKey=t._isResourceScopeKey,this._createResourceScope=t._createResourceScope}else n=t||{},this._parent=void 0,this._level=0,this._isResourceScopeKey=t.isResourceScopeKey,this._createResourceScope=t.createResourceScope;this.scope=new i.a,this.options=n}return Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this.scope.isDisposed},enumerable:!1,configurable:!0}),e.prototype.block=function(e){return this._expose(e)},e.prototype.isDescendantOf=function(e){return this._level>e._level},e.prototype.getHandle=function(e){for(var t=this,n=e.id;!(n in t._handles)&&t._parent;)t=t._parent;var a=t._handles;return a[n]||this.options.useFactoriesOnKeys&&(e.factory&&(a[n]=new l({key:e,entry:{factory:e.factory,manager:t}}))||e.loader&&(a[n]=new l({key:e,entry:{loader:new D(e.loader),manager:t}})))||void 0},e.prototype.expose=function(e,t,n){return this._expose(e,function(a){return new l({key:e,entry:{factory:t.factory,loader:t.loader,manager:a},manager:n&&a})})},e.prototype.dispose=function(){this.scope.dispose(),this._handles={},this._loader=void 0,this.consume=this.resolve=A,this._getLoader=L},e.prototype.bind=function(e){var t=this.getHandle(e);return t?this._expose(e,function(e){return t.promote(e)}):this},e.prototype.lock=function(){var e;"allow"!==(null!==(e=this.options.exposeAfterConsumeMode)&&void 0!==e?e:"allow")&&(this._isLocked=!0)},e.prototype.consume=function(e,t){var n=this;this.lock();var a,i=e.flags,r=e.key;if(i&s.a.async){var o,d=_(e),l=function(){return n.consume(d,t)};if(this._isResourceScopeKey(r))return function(){return o||(o=Promise.resolve(l()))};if((g=this._getValidHandle(e,s.a.none,[])).handle)return function(){return o||(o=h(n._getLoader().loadAsync(d,s.a.none,[],[]).promise).then(l,c(i)))};if(i&s.a.optional)return function(){return Promise.resolve(void 0)};throw(y=g.error)[0](y[1],y[2])}if(i&s.a.suspensible){var u,f,m=function(e){var t=e.flags;return t&s.a.suspensible?new p.a(e.key,t&~s.a.suspensible):e}(e);return{read:function(){if(n._isResourceScopeKey(r))return function(){return n.consume(m,t)};var a=n._getValidHandle(e,s.a.none,[]);if(a.handle)return a.handle.getInstance(r,t||{owner:"".concat(r," ")});var o=a.error;if(o[0]===O){var c=n._getValidHandle(new p.a(e.key,i|s.a.async),s.a.none,[]);if(!I&&f)throw f.error;if(c.handle)throw u||(u=h(n._getLoader().loadAsync(e,s.a.none,[],[]).promise)).catch(function(e){if(!I){var t=e instanceof Error?e:e[0](e[1],e[2]);throw f={error:t},t}});var d=c.error;throw d[0](d[1],d[2])}if(!(i&s.a.optional))throw o[0](o[1],o[2])}}}if(this._isResourceScopeKey(r)){var b;a=function(){return b||(b=n.scope.attach(n._createResourceScope(n,t||{owner:"".concat(r," ")}))),b}}else{var g,v=(g=this._getValidHandle(e,s.a.none,[])).handle;if(v)a=function(){return v.getInstance(r,t||{owner:"".concat(r," ")})};else if(!(i&s.a.optional)){var y;throw(y=g.error)[0](y[1],y[2])}}return i&s.a.lazy?a:a&&a()},e.prototype.isExposed=function(e){return!!this._isResourceScopeKey(e.key)||!!this._getValidHandle(e,s.a.none,[]).handle},e.prototype.resolve=function(e,t){for(var n={},a=0,i=Object.keys(e);a<i.length;a++){var r=i[a];e[r]&&(n[r]=this.consume(e[r],t))}return n},e.prototype.loadAsync=function(e,t,n,a){return this._getLoader().loadAsync(e,t,n,a)},e.prototype.loadAllAsync=function(e,t,n,a){return this._getLoader().loadAllAsync(e,t,n,a)},e.prototype.debug=function(){for(var e,t={},n=0,a=Object.entries(this._handles);n<a.length;n++){var i=a[n],r=i[0],o=i[1];t[o?"".concat(o.key.name," [").concat(o.key.id,"]"):r]=null==o?void 0:o.debug()}return{parent:null===(e=this._parent)||void 0===e?void 0:e.debug(),level:this._level,isLocked:this._isLocked,isDisposed:this.isDisposed,options:this.options,handles:t}},e.prototype._getLoader=function(){return this._loader?this._loader:(this.lock(),this._loader=new g({manager:this,isResourceScopeKey:this._isResourceScopeKey}))},e.prototype._getValidHandle=function(e,t,n){var a=e.key,i=a.id;if(n.indexOf(a)>=0)throw new Error("".concat(a," has a circular dependency.").concat(m(n)," "));var r=this._handles[i];if(r&&r.manager)return w(r);var o=this.getHandle(a);if(!o)return E([C,e,n]);var c=e.flags|t,d=o.entry,u=d.factory;if(c&s.a.async&&d.loader)return w(o);if(!u)return E([O,e,n]);for(var f=n.push(a)-1,p=o.manager,_=c&s.a.local?this:p||d.manager,h=u.dependencies||{},b=0,g=Object.keys(h);b<g.length;b++){var v=h[g[b]];if(v&&!this._isResourceScopeKey(v.key)){var y=this._getValidHandle(v,c&s.a.handleViral,n),S=y.handle;if(S){var D=S.manager||S.entry.manager;D.isDescendantOf(_)&&(_=D)}else if(!(v.flags&s.a.optional)||y.error[0]===O&&this.options.errorOnOptionalAsyncOnly)return y}}return n.splice(f),p&&p===_||(o=new l({key:a,entry:d,manager:_}),_._handles[i]=o),this._handles[i]=o,w(o)},e.prototype._expose=function(t,n){if(this.isDisposed)throw new Error("Cannot expose a resource on a ResourceScope that has been disposed.");if(this._isResourceScopeKey(t))throw new Error("It is invalid to expose `resourceScopeKey`");var a=t.id,i=this._isLocked?this.scope.attach(new e(this)):this,r=i._handles;if(r[a]&&this.options.noDoubleExpose)throw new Error("".concat(t," has already been exposed / consumed at this scope."));return r[a]=n?n(i):void 0,i},e}();function C(e,t){return new Error("".concat(e," is being consumed, but is not available in the current scope.")+"\n  1) Check to ensure that the dependency on this resource (and each step up the chain) is properly declared."+"\n  2) If availability is expected, check to see if the target resource has a dependency that is only available in a child scope.".concat(m(t)))}function O(e,t){return new Error("".concat(e," is being consumed synchronously, but was exposed asynchronously and has not been loaded. Either:")+"\n  1) Ensure that the root call that is requesting this resource is a consumeAsync(). Or"+"\n  2) Ensure that the dependency on this resource is properly declared, so that it can be picked up by an earlier consumeAsync() or load() call.".concat(m(t)))}function w(e){return{handle:e,error:void 0}}function E(e){return{handle:void 0,error:e}}function A(e){if(e instanceof p.a||e instanceof o.a)throw new Error("Cannot consume ".concat(e," from a disposed ResourceScope."));throw new Error("Cannot resolve resources from a disposed ResourceScope.")}function L(){throw new Error("Cannot load a resource from a ResourceScope that has been disposed.")}var k=n(401),M=n(161),P=n(125),T=function(){function e(t,n){var r,o,s;t instanceof e?(s=t._handleManager,o=t._owner,t._lock()):t instanceof x?s=t:n=t||n;var c=new i.a;if(s){if(s.scope.isDisposed)throw new Error("Parent ResourceScope has already been disposed.");s.lock(),"allow"===(null!==(r=s.options.exposeAfterConsumeMode)&&void 0!==r?r:"allow")&&(this._forkOnWrite=!0)}else{var d=(0,a.a)((0,a.a)({},n||{}),{isResourceScopeKey:H,createResourceScope:function(t,n){return new e(t,n)}});s=c.attach(new x(d))}this._handleManager=s,this._scope=c;var l=n?n.owner:"";this._owner=o?"".concat(o," > ").concat(l," "):l}return e.prototype.consume=function(e){if(this._lock(),e)return this._handleManager.consume(e)},e.prototype.consumeAsync=function(e){if(this._lock(),!e)return Promise.resolve(void 0);var t=this._handleManager,n=_(e);return h(t.loadAsync(n,s.a.none,[],[]).promise).then(function(){return t.consume(n)}).catch(c(n.flags))},e.prototype.load=function(e){return this._lock(),h(this._handleManager.loadAllAsync(e,s.a.none,[],[]).promise).catch(c(s.a.none))},e.prototype.exposeAsync=function(e,t){this._expose(e,{loader:new D(t)})},e.prototype.exposeFactory=function(e,t){this._expose(e,{factory:t})},e.prototype.expose=function(e,t){return this._expose(e,{factory:new M.a(t)},t),t},e.prototype.exposeFromPack=function(e){var t=this;e.specifications.forEach(function(e,n){e.factory?t.exposeFactory(n,e.factory):e.loader&&t.exposeAsync(n,e.loader)})},e.prototype.block=function(e){this._handleManager=this._prepareWrite().block(e)},e.prototype.bind=function(e){this._handleManager=this._prepareWrite().bind(e)},e.prototype.isDefined=function(e){if(this._lock(),!e)return!1;var t=this._handleManager;return!t.isDisposed&&!!t.getHandle(e)},e.prototype.isExposed=function(e){if(this._lock(),!e)return!1;var t=this._handleManager;return!t.isDisposed&&t.isExposed(e)},e.prototype.injected=function(t,n){void 0===n&&(n={});var a=n.injectChildResourceScope,i={owner:n.owner||t.name},o=a?this._scope.attach(new e(this,i)):this,s=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this.resources=o;var i=t.apply(this,e)||this;return a&&(0,r.a)(i,U),i};return s.prototype=t.prototype,s},e.prototype.resolve=function(e){return this._lock(),this._handleManager.resolve(e)},e.prototype.resolveAsync=function(e){var t=this;return this.load(e).then(function(){return t.resolve(e)})},e.prototype.resolved=function(e,t){return(0,k.a)(e,this.resolve((0,a.a)((0,a.a)({},e.dependencies||{}),t||{})))},e.prototype.resolvedAsync=function(e,t){var n=this;return this.load((0,a.a)((0,a.a)({},e.dependencies||{}),t||{})).then(function(){return n.resolved(e,t)})},e.prototype.exposeAlias=function(e,t){this.exposeFactory(e,new P.a(t))},e.prototype.dispose=function(){this._scope.dispose()},e.prototype._debug=function(){return{owner:this._owner,manager:this._handleManager.debug()}},e.prototype._expose=function(e,t,n){if(this._isLocked)throw new Error("This resource scope is locked and cannot have new keys exposed. This means a resource has already been consumed or checked for exposure from this scope");this._handleManager=this._prepareWrite().expose(e,t,n)},e.prototype._prepareWrite=function(){return this._forkOnWrite?(this._forkOnWrite=!1,this._scope.attach(new x(this._handleManager))):this._handleManager},e.prototype._lock=function(){var e;this._isLocked||"reject"!==(null!==(e=this._handleManager.options.exposeAfterConsumeMode)&&void 0!==e?e:"allow")||(this._isLocked=!0)},e}();function U(){var e;null===(e=this.resources)||void 0===e||e.dispose()}var F=new o.a({name:"resources"});function H(e){return e===F}}
,function(e,t,n){var a=n(95),i=n(78),r=n(241),o=function(){function e(t){this._async=new a.a(this);var n=t.url,i=t.requestTimeoutInMS,r=void 0===i?e.DEFAULT_TIMEOUT_MS:i,o=t.json,s=t.responseType,c=void 0===s?"":s,d=t.headers,l=void 0===d?{}:d,u=t.withCredentials,f=void 0!==u&&u,p=t.needsCors,m=void 0!==p&&p,_=t.onProgress,h=t.onUploadProgress,b=t.method,g=void 0===b?o?"POST":"GET":b;this._url=n,this._requestTimeoutInMS=r,this._postData=o,this._headers=l,this._method=g,this._withCredentials=f,this._needsCors=m,this._responseType=c,this._progressCallback=_,this._uploadProgressCallback=h}return e.prototype.abort=function(e){this._abortRequest()&&!e&&this._callFailureCallback(this._request,-3,!1)},e.prototype.start=function(e,t){var n=this;this._successCallback=e,this._failureCallback=t;var a=this._method,o=this._headers;try{this._request=this._getRequest();var s=this,c=s._progressCallback,d=s._uploadProgressCallback,l=s._request,u=s._responseType;for(var f in c&&(l.onprogress=function(e){try{c(e)}catch(e){i.a.logError(e)}}),d&&(l.upload.onprogress=function(e){try{d(e)}catch(e){i.a.logError(e)}}),this._async.setTimeout(function(){n._completed||n._timeoutCallback()},this._requestTimeoutInMS),l.onreadystatechange=function(){if(!n._completed){var e=4;try{e=l.DONE||4}catch(e){}l.readyState===e&&n._requestEndCallback()}},l.open(a,this._url,!0),"withCredentials"in l&&(l.withCredentials=this._withCredentials),l.responseType=u,o)l.setRequestHeader(f,o[f]);l.send(this._postData)}catch(e){i.a.logError(e,{origin:location?location.origin:"unknown",withCredentials:this._withCredentials,requestUrl:this._url,headers:(0,r.a)(o),method:a}),this._abortRequest(),this._callFailureCallback(this._request,-1,!1)}},e.prototype._getRequest=function(){var e=this;if(!this._needsCors||!window.XDomainRequest)return new XMLHttpRequest;var t=new XDomainRequest;return t.setRequestHeader=function(){},t.onprogress=function(){},t.ontimeout=function(){},t.onload=function(){e._requestEndCallback()},t},e.prototype._abortRequest=function(){var e=!1;if(!this._completed){this._completed=!0,this._async.dispose();try{this._request&&this._request.abort()}catch(e){}e=!0}return e},e.prototype._timeoutCallback=function(){this._completed||(this._abortRequest(),this._callFailureCallback(this._request,-2,!0))},e.prototype._callSuccessCallback=function(e,t){try{this._successCallback&&this._successCallback(e,t)}catch(e){i.a.log(e)}},e.prototype._callFailureCallback=function(e,t,n){try{this._failureCallback&&this._failureCallback(e,t,n)}catch(e){i.a.log(e)}},e.prototype._requestEndCallback=function(){if(!this._completed){this._completed=!0;var e=-1;try{this._async.dispose();try{e=this._request.status}catch(e){}}catch(t){e=-1,i.a.log(t)}e<400&&e>0?this._callSuccessCallback(this._request,e):this._callFailureCallback(this._request,e,!1)}},e.DEFAULT_TIMEOUT_MS=3e4,e}();t.a=o}
,function(e,t,n){n.d(t,{a:function(){return d},b:function(){return u}});var a=n(7),i=n(10),r=n(4),o=n(59),s=n(51),c={ODB:387},d="https://graph.microsoft.com",l="DisableGraph",u=function(){function e(e,t){this._pageContext=t.pageContext,this._sharingContextInformation=t.sharingContextInformation,this._oAuthTokenProvider=t.oAuthTokenProvider,this._sharingContextInformation&&this._sharingContextInformation.additionalTokens&&(this._graphToken=this._sharingContextInformation.additionalTokens.graphToken),this.initializeDataStore()}return e.prototype.canUseGraph=function(){if(this._graphToken)return!0;if(this._pageContext&&this._pageContext.authToken)return!1;var e=this._pageContext&&this._oAuthTokenProvider&&i.a.isFeatureEnabled(c);return this._dataStore&&(e=e&&!this._dataStore.getValue(l,s.a.session)),e},e.prototype.disableGraphCallsForPicker=function(){this.initializeDataStore(),this._dataStore.setValue(l,!0,s.a.session)},e.prototype.getGraphToken=function(){var e=this;if(this._graphToken)return a.c.resolve(this._graphToken);if(this._oAuthTokenProvider){var t=new r.a({name:"PeoplePicker.GetGraphToken"});return this._oAuthTokenProvider.getToken(d).then(function(e){return t.end({resultType:r.b.Success}),e},function(n){return a.c.isCanceled(n)?(t.end({resultType:r.b.ExpectedFailure,resultCode:"Canceled"}),a.c.reject(n)):(t.end({resultCode:"PeoplePicker.GetGraphTokenError",resultType:r.b.Failure,extraData:{serverErrorCode:n._serverErrorCode,message:n.message}}),e.disableGraphCallsForPicker(),null)})}return null},e.prototype.initializeDataStore=function(){this._dataStore||(this._dataStore=new o.a("PeoplePicker",s.a.session))},e}()}
,function(e,t,n){n.d(t,{a:function(){return w}});var a=n(0),i=n(80),r=n(96),o=n(10),s=n(38),c=n(168),d=n(79),l=n(7),u=n(167),f=n(166),p=n(165),m=n(407),_=n(152),h=(n(221),_.a),b=n(404),g=n(1),v=n(593),y=n(31),S=n(4),D=n(163),I=!g.b.isActivated("b7426b02-fdf6-4c5e-9809-e0c21db41db7","07/10/2022","remove hard code graph endpoint and read from spPageContextInfo")&&!o.a.isFeatureEnabled({ECS:1026572}),x=!g.b.isActivated("29b79ab1-ae17-42fd-b4e1-39e58a904f55","04/02/2023","enable IB discovery"),C=!g.b.isActivated("9a20d40f-32c7-4d46-b7e5-ab292ac5809f"),O=!g.b.isActivated("5e644b83-32fa-4e2f-9e2f-4369ae93cf72","05/13/2024","add endpoints for substrate in airgap")&&!o.a.isFeatureEnabled({ECS:1261410}),w=function(e){function t(t,n){var a=this,i=E(t)?t:n.pageContext,r=!!(null==n?void 0:n.noRedirect),o=null==n?void 0:n.tokenProvider;(a=e.call(this,{dataSourceName:"PeoplePickerDataSource"},{pageContext:i,noRedirect:r,tokenProvider:o})||this)._isSubstrateAPIWarm=!1;var s=E(t)?t.apiUrlHelper:n.apiUrlHelper;return a._apiUrlHelper=s||new f.a({},{itemUrlHelper:new p.a({},{pageContext:i}),pageContext:i}),a._capabilities={supportsMruCaching:!0},n&&(a._dataRequestor=n.dataRequestor,a._graphPeoplePickerHelper=n.graphPeoplePickerHelper,a._substratePeoplePickerHelper=n.substratePeoplePickerHelper,a._livePeoplePickerHelper=n.livePeoplePickerHelper,a._getAuthToken=n.getAuthToken),a._webAbsoluteUrl=i.webAbsoluteUrl,a}return(0,a.d)(t,e),t.prototype.getCapabilities=function(){return this._capabilities},t.prototype.getPersonaDetails=function(e){var t=this;return l.c.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(n){return t.dataRequestor.getData({url:t._apiUrlHelper.build().segment("sp.publishing.personmagazine.GetPersonMagazineUserProfileDataForUser").parameter("accountName",e).toString(),qosName:"GetPersonaDetails",authToken:n,parseResponse:function(e){var n=function(e){return{name:e.DisplayName,email:e.Email,userId:e.AccountName,office:e.Office,image:e.PictureUrl,job:e.Title,department:e.DepartmentName,phone:e.Phone,sip:e.Lync}},a=JSON.parse(e).d.GetPersonMagazineUserProfileDataForUser,i={personDetails:n(a.Primary),managerChain:a.ManagerChain.results.map(n),directReports:a.DirectReports.results.map(n)};return i.personDetails.profilePage=(0,r.b)(t._pageContext)+"/_layouts/15/me.aspx?p="+encodeURIComponent(i.personDetails.sip)+"&origin=ProfileODBCard",i}})})},t.prototype.getPickerEntityInformation=function(e){var t=this,n=0;e.principalType===d.a.sharePointGroup&&(n=Number(e.rawPersonData.EntityData.SPGroupID));var a=JSON.stringify({entityInformationRequest:{PrincipalType:e.principalType,EmailAddress:e.email,GroupId:n}});return g.b.isActivated("3fa8ef41-badd-45d3-bc59-39fab6f5e50a")||(a=JSON.stringify({entityInformationRequest:{PrincipalType:e.principalType,EmailAddress:e.email,GroupId:n,Key:e.userId}})),l.c.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(n){return t.dataRequestor.getData({url:t._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.GetPickerEntityInformation").toString(),additionalPostData:a,qosName:"getPickerEntityInformation",authToken:n,noRedirect:!0,parseResponse:function(t){return{totalMemberCount:JSON.parse(t).d.TotalMemberCount,person:e}}})})},t.prototype.resolve=function(e,t){var n=this;return l.c.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(a){var r=t.listId&&{querycontext:t.listId};return n.dataRequestor.getData({url:n._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.ClientPeoplePickerResolveUser").toString(),additionalPostData:n._constructPostBody(e,t),qosName:"Resolve",authToken:a,additionalHeaders:r,parseResponse:function(e){var a=JSON.parse(e),r=JSON.parse(a.d.ClientPeoplePickerResolveUser),o=[];o[0]=r,r.IsResolved||r.EntityData.IsBlockedOnODB&&"true"===r.EntityData.IsBlockedOnODB.toLowerCase()||o&&!o[0].DisplayText&&(o[0].DisplayText=r.Key);var s=(o=n._transformData(o,t.filterExternalUsers))[0];return t.filterExternalUsers&&s&&s.entityType===i.a.externalUser?(s.isResolved=!1,s.entityType=i.a.regularUser):t.blockViaPolicy&&!t.filterExternalUsers&&s&&!s.isResolved&&0===s.multipleMatches.length&&(s.isResolved=!0,s.isExternal=!0,s.entityType=i.a.externalUser),t.isGraphDistributionList&&t.useGraph&&s.isExternal&&(s.entityType=i.a.group,s.principalType=d.a.distributionList),s}})})},t.prototype.canUseGraph=function(e){var t,n=e&&e.useGraph&&(null===(t=this._graphPeoplePickerHelper)||void 0===t?void 0:t.canUseGraph());return n&&!this._dataRequestor&&(this._dataRequestor=new h({},{})),!!n},t.prototype.canUseSubstrate=function(e){var t,n=e.useSubstrate&&(null===(t=this._substratePeoplePickerHelper)||void 0===t?void 0:t.canUseSubstrate());return n&&!this._dataRequestor&&(this._dataRequestor=new h({},{})),!!n},t.prototype.getLivePersonaPickerHelper=function(){return this._livePeoplePickerHelper},t.prototype.init=function(e){var t;this.canUseSubstrate(e)&&!this._isSubstrateAPIWarm&&(null===(t=this._substratePeoplePickerHelper)||void 0===t||t.warmUpInit(e.scenarioName),this._isSubstrateAPIWarm=!0)},t.prototype.search=function(e,t){return x&&t.enforceIBSegmentFiltering?this.sharePointSearch(e,t):this.canUseSubstrate(t)||t.useNew3Ssearch?this._substrateSearch(e,t):this.canUseGraph(t)?this._graphSearch(e,t):(0===t.groupID&&(t.useSubstrateSearch=!0),this.sharePointSearch(e,t))},t.prototype.sharePointSearch=function(e,t){var n=this;return t.onToggleGetMoreResults&&t.onToggleGetMoreResults(!1),l.c.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(a){var r=t.listId&&{querycontext:t.listId};return n.dataRequestor.getData({url:n._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.ClientPeoplePickerSearchUser").toString(),additionalPostData:n._constructPostBody(e,t),qosName:"ClientPeoplePickerSearchUser",additionalHeaders:r,authToken:a,parseResponse:function(a){var r=t.allowSharePointGroups,o=void 0===r||r,s=t.filterExternalUsers,c=JSON.parse(a),l=JSON.parse(c.d.ClientPeoplePickerSearchUser),u=n._transformData(l,s);return s&&(u=u.filter(function(e){return e.entityType!==i.a.externalUser})),u=u.filter(function(e){return e.principalType===d.a.sharePointGroup?o:e.principalType===d.a.securityGroup?o||n._isValidEmail(e.email,!0):n._isValidEmail(e.email,!1)}),n._handleZeroSearchResult(u,e,t,i.b.sharepointSearch)}})})},t.prototype.subscribePresence=function(e,t){var n=this;try{if(this._ensureSkypePresence(),!O365Shell_Shim.SkypeIntegration.isAvailable())return null;var a=function(e){try{switch(e){default:t(0);break;case 1:t(1);break;case 2:t(2);break;case 3:t(3);break;case 4:t(4);break;case 5:t(5);break;case 6:t(6);break;case 8:t(7)}}catch(e){}};return this._skypeIntegration.TrackPresence(e,a),{dispose:function(){try{n._skypeIntegration.UntrackPresence(e,a)}catch(e){}}}}catch(e){}return null},t.prototype._constructPostBody=function(e,t){var n={queryParams:{QueryString:e,MaximumEntitySuggestions:t.maximumEntitySuggestions,AllowEmailAddresses:t.allowEmailAddresses,AllowOnlyEmailAddresses:t.allowOnlyEmailAddresses,PrincipalType:t.principalType,PrincipalSource:t.principalSource,UseSubstrateSearch:t.useSubstrateSearch,SharePointGroupID:t.groupID,QuerySettings:t.querySettings}};return JSON.stringify(n)},t.prototype._ensureSkypePresence=function(){var e=this;try{if(!this._skypeIntegration){var t=new O365Shell_Shim.SkypeIntegration;t.OnApiReady(function(){e._skypeIntegration=t})}}catch(e){}},t.prototype._graphSearch=function(e,n){var a=this;return this._graphPeoplePickerHelper.getGraphToken().then(function(r){var o;if(!r)return a.sharePointSearch(e,n);var s=I&&a._pageContext&&a._pageContext.msGraphEndpointUrl?null===(o=a._pageContext)||void 0===o?void 0:o.msGraphEndpointUrl:"https://graph.microsoft.com",c=new y.a("".concat(s,"/v1.0/me/people"));if(e){c.setQueryFromObject({$search:'"'.concat(e,'"'),$top:"30",$select:"displayName,scoredEmailAddresses,personType,department,jobTitle,userPrincipalName"});var l=t._getPersonTypeFilter(n);l&&c.setQueryParameter("$filter",l)}var u=new S.a({name:"PeoplePickerGraphSearch"});return a._dataRequestor.send({apiName:"Graph.PeopleSearch",path:c.toString(),headers:{Authorization:"Bearer "+r,"X-PeopleQuery-QuerySources":"Mailbox,Directory"},needsAuthorization:!1}).then(function(t){if(n.onToggleGetMoreResults&&n.onToggleGetMoreResults(!0),t&&t.value&&0!==t.value.length)u.end({resultType:S.b.Success});else if(u.end({resultType:S.b.ExpectedFailure,extraData:{error:"graph search return empty results"}}),e)return a.sharePointSearch(e,n);var r=t.value,o=[];return r.forEach(function(e){if(!e.personType.subclass||!a._isIgnorablePeopleSubType(e.personType.subclass)){var t,r=e.scoredEmailAddresses[0]?e.scoredEmailAddresses[0].address:"",s=e.userPrincipalName&&a._isValidEmail(e.userPrincipalName,!1)?e.userPrincipalName:r;t=L()?A()?{Key:s,IsResolved:!1}:{Key:s,IsResolved:!1,EntityData:{ObjectId:e.id}}:{Key:s,IsResolved:!1,EntityData:{ObjectId:e.id},PeopleType:e.personType.class,PeopleSubtype:e.personType.subclass};var c,l="ImplicitContact"===e.personType.subclass,u="OrganizationUser"===e.personType.subclass,f="Group"===e.personType.class&&"UnifiedGroup"===e.personType.subclass,p="PublicDistributionList"===e.personType.subclass,_=(0,m.a)(a._webAbsoluteUrl,r);p&&(c=i.c.PublicDistributionList),f&&(c=i.c.unified);var h={department:e.department,email:r,image:l?void 0:_,job:!1===n.fallbackToEmailIfNoJob?e.jobTitle:e.jobTitle||r,name:e.displayName,providerName:u?"Provider":void 0,userId:s,rawData:t,rawPersonData:t,isExternal:!u,aadObjectId:e.id,fromDataSource:i.b.graph,detailedGroupInfo:c};u?(h.entityType=i.a.regularUser,h.principalType=d.a.user,h.isResolved=!0):f?(h.entityType=i.a.group,h.principalType=d.a.securityGroup,h.isResolved=!1,h.userId=e.id):(h.principalType=p?d.a.distributionList:d.a.none,h.entityType="Group"===e.personType.class?i.a.group:i.a.externalUser,h.isResolved=!1,h.providerName=void 0),h.userId&&o.push(h)}}),a._handleZeroSearchResult(o,e,n,i.b.graph)},function(t){var i=(0,b.e)(t)&&429===t.status||"Canceled"===t.name;if(u.end({resultType:i?S.b.ExpectedFailure:S.b.Failure,extraData:{error:t}}),(0,b.e)(t))switch(t.status){case 400:case 401:case 403:case 404:return a._graphPeoplePickerHelper.disableGraphCallsForPicker(),a.sharePointSearch(e,n);default:return a.sharePointSearch(e,n)}else"Canceled"!==t.name&&a._graphPeoplePickerHelper.disableGraphCallsForPicker();return"Canceled"===t.name?null:a.sharePointSearch(e,n)})})},t.prototype._substrateSearch=function(e,t){var n=this;return this._substratePeoplePickerHelper.getSubstrateToken().then(function(r){if(!r)return n.sharePointSearch(e,t);var o=null;t.siteIBSegmentIDs&&t.siteIBSegmentIDs.length>0&&(o=t.siteIBSegmentIDs);var c,l=t.useNew3Ssearch?["Mailbox","Directory","SecurityGroups"]:["Mailbox","Directory"],f={Authorization:"Bearer "+r},p=t.useNew3Ssearch?["OrganizationUser","Guest","UnifiedGroup","MailUniversalSecurityGroup"]:["OrganizationUser","Guest","PublicDistributionList","UnifiedGroup"];C&&t.subTypesToBeFiltered&&t.subTypesToBeFiltered.length>0&&(p=t.subTypesToBeFiltered),t.allowSharePointGroups&&p.push("UniversalSecurityGroup");var _=s.a.isValidGuid(e),h={Or:p.map(function(e){return{Term:{PeopleSubtype:e}}})},v=o?{Or:o.map(function(e){return{Term:{InformationBarrierSegment:e}}})}:null,y=_?{Or:{Term:{ExternalDirectoryObjectId:e}}}:null,I=o||_?_?o?{And:[h,v,y]}:{And:[h,y]}:{And:[h,v]}:h;c=JSON.stringify({EntityRequests:[{EntityType:"People",ProvenanceMergeMode:"Default",Provenances:l,Query:{QueryString:_?null:e},From:0,Size:25,Fields:["DisplayName","EmailAddresses","CompanyName","JobTitle","OfficeLocation","Department","UserPrincipalName","PeopleType","PeopleSubtype","Phones"],InformationBarrierMode:t.siteIBMode,Filter:I}],TimeZone:"UTC",Cvid:t.conversationId||s.a.generate(),Scenario:{Name:t.scenarioName||"documentshare"}});var x=t.scenarioName?"?scenario=".concat(t.scenarioName):"",w=new S.a({name:"PeoplePickerSubstrateSearch"}),E=new S.a({name:"PeoplePickerAirGapEndpointAvailable"}),M=u.a;if(O&&(0,D.a)(n._pageContext.env2)){var P=n._pageContext.farmSettings;P&&P.ExternalService_exchangesearchurl?(M=P.ExternalService_exchangesearchurl,E.end({resultType:S.b.Success})):E.end({resultType:S.b.Failure,extraData:{error:"airgap endpoint not available, falling back to default substrate endpoint which doesn not work when user input less than 3 letters"}})}return n._dataRequestor.send((0,a.a)({apiName:"Substrate.PeopleSearch",path:M+"/api/v1/suggestions".concat(x),headers:f,needsAuthorization:!1,requestType:"POST",postData:c},k()?{}:{timeout:t.substrateTimeout})).then(function(r){t.onToggleGetMoreResults&&t.onToggleGetMoreResults(!0);var o=r.Groups[0]?r.Groups[0].Suggestions:[];if(0===o.length){if(w.end({resultType:S.b.Failure,extraData:{error:"substrate search return empty results"}}),e)return n.sharePointSearch(e,t)}else w.end({resultType:S.b.Success});var s=[];return o.forEach(function(e){var r,o;if(!e.PeopleSubtype||!n._isIgnorablePeopleSubType(e.PeopleSubtype)){var c,l,u=(g.b.isActivated("5e38f89b-f0eb-4276-baf8-c03d42a95c45")?e.EmailAddresses[0]:n._firstValidEmail(e.EmailAddresses))||e.QueryText||"",f=e.UserPrincipalName&&n._isValidEmail(e.UserPrincipalName,!1)?e.UserPrincipalName:u;e.Id&&e.Id.indexOf("@")&&(c=e.Id.substring(0,e.Id.indexOf("@"))),t.useNew3Ssearch&&!f&&e.Id&&e.Id.indexOf("@")&&(f=e.Id.substring(0,e.Id.indexOf("@"))),l=L()?A()?{Key:f,IsResolved:!1}:{Key:f,IsResolved:!1,EntityData:{ObjectId:c}}:{Key:f,IsResolved:!1,EntityData:{ObjectId:c},PeopleType:e.PeopleType,PeopleSubtype:e.PeopleSubtype};var p,_="ImplicitContact"===e.PeopleSubtype,h="OrganizationUser"===e.PeopleSubtype,b="LinkedIn"===e.PeopleSubtype,v="Group"===e.PeopleType&&"UnifiedGroup"===e.PeopleSubtype,y="PublicDistributionList"===e.PeopleSubtype,S=(0,m.a)(n._webAbsoluteUrl,u);y&&(p=i.c.PublicDistributionList),v&&(p=i.c.unified);var D=(0,a.a)({department:e.Department,office:e.OfficeLocation,email:u,image:_?void 0:S,job:!1===t.fallbackToEmailIfNoJob?e.JobTitle:e.JobTitle||u,name:e.DisplayName,providerName:"Provider",userId:f,rawData:l,rawPersonData:l,isExternal:!h,detailedGroupInfo:p},C?{phones:null!==(o=null===(r=e.Phones)||void 0===r?void 0:r.map(function(e){return{type:e.Type,number:e.Number}}))&&void 0!==o?o:void 0}:{});h?(D.entityType=i.a.regularUser,D.principalType=d.a.user,D.isResolved=!0):v?(D.entityType=i.a.group,D.principalType=d.a.securityGroup,D.isResolved=!1,D.providerName=void 0):b?D.entityType=i.a.linkedinUser:(D.principalType=y?d.a.distributionList:d.a.none,D.entityType="Group"===e.PeopleType?i.a.group:i.a.externalUser,D.isResolved=!1,D.providerName=void 0),D.userId&&s.push(D)}}),n._handleZeroSearchResult(s,e,t,i.b.substrate)},function(i){var o=void 0;try{o=JSON.parse(atob(r.split(".")[1])).exp<Date.now()/1e3}catch(e){}var s=void 0;if(i&&(0,b.e)(i)&&i.status&&(s=i.status),w.end({resultType:S.b.Failure,resultCode:s?s.toString():"unknown",extraData:(0,a.a)({error:i},k()?{tokenExpired:o}:{jsonExtraData:JSON.stringify({tokenExpired:o})})}),(0,b.e)(i))switch(i.status){case 400:case 401:case 403:case 404:return n._substratePeoplePickerHelper.disableSubstrateCallsForPicker(),n.sharePointSearch(e,t);default:return n.sharePointSearch(e,t)}else"Canceled"!==i.name&&(n._substratePeoplePickerHelper.disableSubstrateCallsForPicker(),n.sharePointSearch(e,t));return null})})},t.prototype._handleZeroSearchResult=function(e,t,n,a){if(!t)return e;if(!1!==n.resolveEmailIfNoResults&&0===e.length&&this._isValidEmail(t,!1)){var r={Key:t,IsResolved:!1};e.push({email:t,entityType:i.a.externalUser,isResolved:!1,job:!1===n.fallbackToEmailIfNoJob?void 0:t,name:t,userId:t,rawData:r,rawPersonData:r,isExternal:!0,fromDataSource:a})}return e},t.prototype._isValidEmail=function(e,t){return e?!(e.indexOf(" ")>-1||e.indexOf(";")>-1)&&v.a.isValidEmailSyntax(e,!1):!t},t.prototype._firstValidEmail=function(e){var t=this;if(Array.isArray(e))return e.find(function(e){return"string"==typeof e&&e&&t._isValidEmail(e,!1)})},t._getPersonTypeFilter=function(e){var t="";return e.principalType&d.a.user&&(t+="personType/subclass eq 'OrganizationUser' or personType/subclass eq 'Guest'"),e.principalType&d.a.securityGroup&&(t&&(t+=" or "),t+="personType/subclass eq 'UnifiedGroup'"),e.principalType&d.a.distributionList&&null!==e.filterPublicDistributionList&&e.filterPublicDistributionList!==!g.b.isActivated("18c99317-6e4f-4859-85bf-b127709b6eff","01/28/2022","Include public distribuition list in filter by default")&&(t&&(t+=" or "),t+="personType/subclass eq 'PublicDistributionList'"),t},t.prototype._isIgnorablePeopleSubType=function(e){return!!e&&["PersonalDistributionList","ImplicitGroup","Unknown"].some(function(t){return t===e})},t.prototype._transformData=function(e,t){var n=this;return e.map(function(e){var a=e.EntityData,r={name:e.DisplayText,email:a.Email,userId:e.Key,job:a.Title,department:a.Department,phone:a.MobilePhone,providerName:e.ProviderDisplayName,entityType:e.EntityType,isResolved:e.IsResolved,multipleMatches:e.MultipleMatches,rawPersonData:e,rawData:e};g.b.isActivated("2d29e305-4283-48bb-b578-47520e9bc783","08/23/2024","Add object id when using sharepoint search")||("User"!==e.EntityType?r.aadObjectId=e.Key.split("|")[2]:r.aadObjectId=e.EntityData.ObjectId),r.multipleMatches.length>0&&(r.multipleMatches=n._transformData(r.multipleMatches,t),t&&(r.multipleMatches=r.multipleMatches.filter(function(e){return e.entityType!==i.a.externalUser})));var o=r.email;r.isResolved&&(r.image=o?(0,m.a)(n._webAbsoluteUrl,o):null);var s=a.PrincipalType||e.EntityType;switch(s){case"UNVALIDATED_EMAIL_ADDRESS":case"GUEST_USER":r.entityType=i.a.externalUser,r.principalType=d.a.user,r.isExternal=!0;break;case"SecGroup":case"SharePointGroup":case"FormsRole":case"SecurityGroup":if(!g.b.isActivated("5bcee89c-f8f5-4973-82d2-ab06c37b03e0","1/25/2025","Fix bug: SharePointSearch result principleType of SecurityGroup was treated as user type")||"SecurityGroup"!==s){r.entityType=i.a.group,r.principalType="SharePointGroup"===s?d.a.sharePointGroup:d.a.securityGroup,r.detailedGroupInfo="SharePointGroup"===s?i.c.SPGroup:i.c.securityGroup;break}default:r.entityType=i.a.regularUser,r.principalType=d.a.user}return r})},t}(c.b);function E(e){return!!e.webAbsoluteUrl}function A(){return g.b.isActivated("3ca1ecbf-ea9f-45eb-bd26-5dfb3924d136","12/4/23","add objectId to rawData")||o.a.isFeatureEnabled({ECS:1173676})}function L(){return g.b.isActivated("E5965CCD-495A-4747-A28A-75901A57468A")}function k(){return g.b.isActivated("7D10C18B-9CCF-4085-8CBF-1D94BCFCB91E")}}
,function(e,t,n){n.d(t,{a:function(){return r},b:function(){return u}});var a=n(31),i=n(4),r={Small:1,Medium:2,Large:3},o="_oat_",s={},c={},d="TryGetAlternativeUrlFailure";function l(e){if(-1===e.indexOf(o))return!0;var t=c[e];if(t)return Date.now()/1e3<t;var n=new a.a(e),r=n.getQueryParameter(o);if(r){var s=r.split("_");if(2===s.length&&(t=Number(s[0])),!t)return new i.a({name:d}).end({resultType:i.b.Failure,resultCode:"OatParamUnexpectedFormat",extraData:{eatParam:r}}),c[e]=Date.now()/1e3+86400,!0;if(t-=30,c[e]=t,Date.now()/1e3>t)return!1}var l=n.getQueryParameter("P1");if(!l)return!0;var u=Number(l);return u-=30,c[e]=Math.min(u,c[e]),!(Date.now()/1e3>u)}function u(e,t,n){var o;switch(n=n||function(e){var t,n;function a(e){return l(window[e].userPhotoCdnBaseUrl)?window[e].userPhotoCdnBaseUrl:(delete window[e].userPhotoCdnBaseUrl,"")}try{var r=s&&s[e];if(r||((null===(t=window._spPageContextInfo)||void 0===t?void 0:t.userPhotoCdnBaseUrl)?r=a("_spPageContextInfo"):(null===(n=window._spHomePageContext)||void 0===n?void 0:n.userPhotoCdnBaseUrl)&&(r=a("_spHomePageContext"))),!r)return;return l(r)?r:void delete s[e]}catch(e){new i.a({name:d}).end({resultType:i.b.Failure,resultCode:"Unexpected",extraData:{error:e}})}}("UserPhotoAspx")||"/_layouts/15/userphoto.aspx",t){case r.Medium:o="M";break;case r.Large:o="L";break;default:o="S"}var c=new a.a(n);return c.setQueryParameter("size",o),c.setQueryParameter("accountname",e||""),c.toString()}}
,function(e,t,n){var a=n(408),i=n(10),r=n(81),o=n(37),s=n(1),c=function(){function e(e){this._itemUrlHelper=e.itemUrlHelper,this._sharingContextInformation=e.sharingContextInformation}return e.prototype.getApiRoot=function(e,t,n,c){var d,l,u,f,p,m,_,h,b,g;if(void 0===c&&(c=!1),this._sharingContextInformation){var v=this._sharingContextInformation,y=v.isFolder,S=v.isListSharing,D=v.itemUrl,I=v.listId,x=v.listItemId,C=v.listUrl,O=v.resourceId,w=v.serverRelativeItemUrl,E=v.uniqueId,A=v.webAbsoluteUrl,L=(c&&null!==(l=null===(d=null==t?void 0:t.properties)||void 0===d?void 0:d.listId)&&void 0!==l?l:I)||"",k=(c&&null!==(f=null===(u=null==t?void 0:t.properties)||void 0===u?void 0:u.ID)&&void 0!==f?f:x)||"",M=(c&&null!==(m=null===(p=null==t?void 0:t.properties)||void 0===p?void 0:p.uniqueId)&&void 0!==m?m:E)||"";if(S)return e.build().webByUrl({webUrl:A}).method("Lists",I);if(E){if(I)return e.build().webByUrl({webUrl:A}).segment("lists").method("getbyid",L).method("GetItemByUniqueId",M);var P=c&&(null==t?void 0:t.type)===r.a.Folder||y?"GetFolderById":"GetFileById",T={guid:c&&null!==(h=null===(_=null==t?void 0:t.properties)||void 0===_?void 0:_.uniqueId)&&void 0!==h?h:E};return e.build().webByUrl({webUrl:A}).method(P,T).segment("ListItemAllFields")}return C?e.build().webByUrl({listUrl:C}).method("GetListItem",w):D?i.a.isFeatureEnabled({ODB:1236})?e.build().webByUrl({webUrl:A}).methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:new o.a(D).path}).segment("ListItemAllFields"):e.build().webByUrl({webUrl:A}).method("GetFileByUrl",a.b(D)).segment("ListItemAllFields"):I&&x?e.build().webByUrl({webUrl:A}).method("Lists",L).method("GetItemById",k):e.build().webByUrl({webUrl:A}).method("GetListItemByResourceId",O)}if(g=t.properties.path?this._itemUrlHelper.getUrlParts({path:t.properties.path}):this._itemUrlHelper.getItemUrlParts(t.key),!s.b.isActivated("c75d69bb-a1f0-46fc-a252-78d6cdeac52b","05/08/2024","call GSI using itemType and uniqueId")&&!n&&(null===(b=null==t?void 0:t.properties)||void 0===b?void 0:b.uniqueId)&&(null==t?void 0:t.type))return P=t.type===r.a.Folder?"GetFolderById":"GetFileById",T={guid:t.properties.uniqueId},e.build().webByItemUrl(g).method(P,T).segment("ListItemAllFields");var U=e.build().webByItemUrl(g).method("Lists",n);return t.isRootFolder||(U=t.properties.ID?U.method("GetItemById",t.properties.ID):U.method("GetItemByUniqueId",t.properties.uniqueId)),U},e.prototype.getFileUrl=function(e){return this._itemUrlHelper.getItemUrlParts(e.key).fullItemUrl},e.prototype.canUseSecurable=function(e){var t=e.properties;return!(!t||!(e.isRootFolder?e.list&&e.list.id:t.ID||t.uniqueId))},e.getUniqueSharingPrincipals=function(e){if(e){var t=new Set;return e.filter(function(e){return!t.has(e.loginName)&&(t.add(e.loginName),!0)})}},e}();t.a=c}
,function(e,t,n){function a(e,t){return void 0===t&&(t=!0),e=encodeURI(e),t&&e&&(e=e.replace(/#/g,"%23")),e}n.d(t,{a:function(){return a}})}
,function(e,t,n){n.d(t,{a:function(){return a}});var a={Owner:0,View:1,Edit:2,Submitter:3,CoOwner:4,None:5,Review:6,Custom:7}}
,function(e,t,n){n.d(t,{a:function(){return a}});var a={unknown:0,prefetch:1,hostapp:2,api:3}}
,function(e,t,n){n.d(t,{a:function(){return a}});var a={Network:1,Embed:3,App:4,View:5,Edit:6,Form:7,Direct:8,Organization:9,AppAccess:10,RequestAccess:11,None:100}}
,function(e,t,n){n.d(t,{a:function(){return i}});var a=n(19);function i(e,t){void 0===t&&(t=!1);var n=new Date(e),i=n.getTimezoneOffset()<0,r=n.getFullYear()+"",o=(0,a.f)(n.getMonth()+1+"",2),s=(0,a.f)(n.getDate()+"",2),c=(0,a.f)(n.getHours()+"",2),d=(0,a.f)(n.getMinutes()+"",2),l=(0,a.f)(n.getSeconds()+"",2),u=(i?"+":"-")+(0,a.f)(i?(Math.ceil(n.getTimezoneOffset()/60)+"").replace("-",""):Math.floor(n.getTimezoneOffset()/60)+"",2)+(0,a.f)((n.getTimezoneOffset()%60).toString().replace("-",""),2);return t?r+"-"+o+"-"+s+"T"+c+":"+d+":"+l+u:r+o+s+"T"+c+d+l+u}}
,function(e,t,n){n.d(t,{a:function(){return s},b:function(){return o}});var a=n(7),i=n(53),r=function(){function e(e){if(this._features=new Map,!e)throw new Error("Cannot create SPFeatureInfo object, incoming data is undefined.");for(var t in e)if(void 0!==t){var n=e[t];this._features.set(t,{version:n.Version,enabled:n.Enabled})}}return e.prototype._serialize=function(){var e={};return this._features.forEach(function(t,n){e[n]={Version:t.version,Enabled:t.enabled}}),e},e.prototype.get=function(e){if(!e||e&&0===e.length)throw new Error("Cannot get feature, featureName input is empty or undefined");return this._features.get(e)},e}();function o(e,t,n){var i=0;return new a.c(function(a,r){var o=setInterval(function(){if(!(i*t<=n))throw clearInterval(o),"Timed out waiting for checker "+e;i++,e()&&(clearInterval(o),a())},t)})}function s(e){if(e.featureInfo){var t=new r(e.featureInfo);if(t){var n=t.get("SitePagePublishing");return!!n&&n.enabled}return!1}return Number(e.webTemplate)===i.b.sitePagePublishing}}
,function(e,t,n){n.d(t,{a:function(){return c},b:function(){return r},c:function(){return o},d:function(){return s}});var a,i=n(594);function r(e){return Number(e)===a.DocumentLibrary}function o(e){return e===i.a.genericList||e===i.a.announcements||e===i.a.issueTracking||e===i.a.contacts||e===i.a.customGrid}function s(e){return Number(e)===i.a.promotedLinks}!function(e){e[e.invalidType=-1]="invalidType",e[e.GenericList=0]="GenericList",e[e.DocumentLibrary=1]="DocumentLibrary"}(a||(a={})),i.a.mySiteDocumentLibrary,i.a.documentLibrary,i.a.pictureLibrary,i.a.xmlFormLibrary,i.a.webPageLibrary,i.a.publishingPageLibrary,i.a.publishingAsset,i.a.documentLibrary,i.a.contentCenterPrimeLibrary;var c=i.a}
,function(e,t,n){n.d(t,{a:function(){return a}});var a={CUSTOM_SETTINGS_1:"WorkloadSettingsSubLinks1",CUSTOM_SETTINGS_2:"WorkloadSettingsSubLinks2",CUSTOM_SETTINGS_3:"WorkloadSettingsSubLinks3",FEEDBACK:"ShellFeedback",DIAGNOSTICS:"Diagnostics",O365_SETTINGS:"ShellO365Settings",ADD_APP:"SuiteMenu_zz5_MenuItemCreate",SITE_CONTENTS:"SuiteMenu_zz6_MenuItem_ViewAllSiteContents",SITE_SETTINGS:"SuiteMenu_zz7_MenuItem_Settings",SITE_INFORMATION:"SuiteMenu_MenuItem_SiteInformation",SITE_PERMISSIONS:"SuiteMenu_MenuItem_SitePermissions",SITE_DESIGNS:"SuiteMenu_MenuItem_SiteDesigns",SITE_TEMPLATES:"SuiteMenu_MenuItem_SiteTemplates",HUB_SETTINGS:"SuiteMenu_MenuItem_HubSettings",USER_ACTIVITY:"UserActivity",LIBRARY_SETTINGS:"SuiteMenu_LibrarySettings",LIST_SETTINGS:"SuiteMenu_ListSettings",LANGUAGE:"SuiteMenu_Language",BRAND_CENTER:"Brand_Center",CHANGE_THE_LOOK:"Change_The_Look",VIVA_CONNECTIONS:"Viva_Connections_Settings",GET_ONEDRIVE_APPS:"GetOneDriveApps",MANAGE_OR_CANCEL_SUBSCRIPTION:"ManageOrCancelSubscription",CLOUD_IMPORT_SETTING:"Cloud_Import_Setting",ABOUT_ME:"ShellAboutMe",SETTINGS:"ShellSettings",MY_SETTINGS:"SuiteMenu_zz2_ID_PersonalInformation",SIGN_OUT:"ShellSignout",HELP:"HelpLink",COMMUNITY:"ShellCommunity",PRIVACY:"ShellPrivacy",LEGAL:"ShellLegal",USERVOICE:"UserVoice",FIRSTRUN:"FirstRun",DEVELOPERS:"Developers",ABUSE:"ReportAbuse",IMPRESSUM:"Impressum",MAIL:"ShellMail",CALENDAR:"ShellCalendar",PEOPLE:"ShellPeople",ONEDRIVE:"ShellDocuments",WORD:"ShellWordOnline",EXCEL:"ShellExcelOnline",POWERPOINT:"ShellPowerPointOnline",ONENOTE:"ShellOneNoteOnline",SITES:"ShellSites",YAMMER:"ShellYammer",TASKS:"ShellTasks",POWER_BI:"ShellPowerBI",DELVE:"ShellOfficeGraph",VIDEO:"ShellVideo",ALCHEMY:"ShellAlchemy",SMILE:"ShellSendASmile",STREAM:"ShellStream",LISTS:"Lists",VIVASUITEHOME:"VivaSuiteHome",SHAREPOINT:"Sharepoint",CLIPCHAMP:"Clipchamp"}}
,function(e,t,n){n.d(t,{a:function(){return y}});var a=n(7),i=n(265),r=n(59),o=n(51),s=n(1),c="1.7",d="Data",l="CacheToken",u="CacheVersion",f="CacheExpires",p="E0574800-0160-4366-A004-D16781CF11BA",m=function(){function e(){}return e.clearThemeCache=function(){var t=e.getThemeDataStore();t.remove(d),t.remove(l),t.remove(u),s.a.isActivated(p)||t.remove(f)},e.getCachedTheme=function(t){var n,a=e.getThemeDataStore();try{if(s.a.isActivated(p))t===a.getValue(l)&&c===a.getValue(u)&&(n=a.getValue(d));else{var i=a.getValue(f);t===a.getValue(l)&&c===a.getValue(u)&&(!i||Date.now()<i)&&(n=a.getValue(d))}}catch(e){}return n},e.updateThemeCache=function(t,n){var a=e.getThemeDataStore();if(a.setValue(d,t),a.setValue(l,n||t.cacheToken),a.setValue(u,c),!s.a.isActivated(p))if(null==t?void 0:t.cacheMaxAge){var i=1e3*t.cacheMaxAge;a.setValue(f,Date.now()+i)}else a.remove(f)},e.getThemeDataStore=function(){return new r.a("odTheme",o.a.local)},e}(),_=n(4),h=n(222),b=function(){function e(e){this._loadData=e}return e.getBackgroundUrl=function(t){return t?e._makeCssUrl(t.backgroundImageUri):"none"},e._makeCssUrl=function(t){var n="none";return t&&(n='url("'+e._escapeQuotesAndParentheses(t)+'")'),n},e._escapeQuotesAndParentheses=function(e){var t={"'":"%27",'"':"%22","(":"%28",")":"%29"},n=null;return null!=e&&(n=e.replace(/(['"\(\)])/gm,function(e,n){return t[n]})),n},e.prototype.loadThemeTokenMap=function(t,n){return this.loadThemeData(t,n).then(function(t){var n;if(t&&t.palette){n={};var a=t.palette;for(var r in a){var o=a[r];n[r]=o?i.a.toHtmlString(o):null}n.backgroundImageUri=e._makeCssUrl(t.backgroundImageUri)}return n},function(e){return null})},e.prototype.loadThemeData=function(e,t){if(!t&&this._dataPromise)return this._dataPromise;var n=this,i=null,r=_.b.Failure;return this._dataPromise=(0,h.a)(_.a,{name:"ThemeProvider.LoadData"},function(){return new a.c(function(o,s){var c=null;t||(c=m.getCachedTheme(e)),c?o(c):n._loadData(t).done(function(t){t?(t.cacheToken&&m.updateThemeCache(t,e),o(t)):(i="NoData",s&&s("No model returned"))},function(e){a.c.isCanceled(e)?(i="Canceled",r=_.b.ExpectedFailure):i="ServerLoadFailure",s&&s(e)})})},null,function(e){a.c.isCanceled(e)&&(r=_.b.ExpectedFailure,i="Canceled");var t=e;if(e){var n={name:e.name||void 0,message:e.message&&e.message.value||e.message||void 0,correlationId:e.correlationId||void 0};t=JSON.stringify(n)}return{resultType:r,resultCode:i||"Other",error:t}}),this._dataPromise},e}(),g=n(53),v=n(266),y=function(){function e(e){this._isEnquoteKillswitchActivated=s.b.isActivated("b39f1385-ab28-4f24-b610-ec20f5dfac7b"),this._pageContext=e.pageContext?e.pageContext:window._spPageContextInfo,this._getThemeDataSource=e.getThemeDataSource,this._themeProvider=new b(this._loadTheme.bind(this))}return e.prototype.loadThemeSlotsMap=function(e){var t=this._getThemeCacheToken();return t?this._themeProvider.loadThemeTokenMap(t,e):a.c.resolve()},e.prototype.loadFullFormattedThemeData=function(e){var t=this;return this.loadFullThemeData(e).then(function(e){if(e){var n={},a=e.palette;for(var r in a){var o=a[r];o&&(n[r]=i.a.toHtmlString(o))}e.backgroundImageUri&&(n.backgroundImageUri=b.getBackgroundUrl(e));var c=void 0,d=void 0,l=void 0;if((0,v.b)(t._pageContext)&&e.fontPackage&&e.fontPackage.fontFaces&&e.fontPackage.fontSlots){c=e.fontPackage.fontFaces,d={},l=e.fontPackage.fontPackageSource;for(var u=function(e){var n;if(n=t._isEnquoteKillswitchActivated?{fontFamily:e.fontFamily&&'"'+e.fontFamily.replace(/"/g,'\\"')+'"'}:{fontFamily:e.fontFamily&&t._enquoteIfNeeded(e.fontFamily)},e.fontVariationSettings){for(var a="",i=0,r=Object.keys(e.fontVariationSettings);i<r.length;i++){var o=r[i],s=e.fontVariationSettings[o];switch(o){case"wght":n.fontWeight=s;break;case"wdth":n.fontStretch=s;break;case"slnt":n.fontStyle="oblique ".concat(s,"deg");break;case"ital":n.fontStyle=s?"italic":"normal";break;case"opsz":n.fontOpticalSizing=s;break;default:a+=a?", ":"",t._isEnquoteKillswitchActivated?a+='"'.concat(o,'" ').concat(s):a+="".concat(t._enquoteIfNeeded(o)," ").concat(s)}}a&&(n.fontVariationSettings=a)}return n},f=0,p=Object.entries(e.fontPackage.fontSlots);f<p.length;f++){var m=p[f],_=m[0],h=m[1];s.b.isActivated("661c8da2-e6df-4c44-95fb-d32ccf03998f","12/12/2023")?d[_]={fontFamily:null==h?void 0:h.fontFamily}:d[_]=u(h)}}var g={palette:n,isInverted:e.isInverted,fontPackageSource:l,fontFaces:c,fontSlots:d};return(0,v.a)(g,t._pageContext)}})},e.prototype.loadFullThemeData=function(e){var t=this._getThemeCacheToken();return t?this._themeProvider.loadThemeData(t,e):a.c.resolve(void 0)},e.prototype._getThemeCacheToken=function(){var e,t=this._pageContext;if(t){var n=Number(t.webTemplate),a=n===g.a.teamSite||n===g.a.group?t.groupColor:void 0,i=a?a+";web#"+t.webTemplate:null;e=t.themedCssFolderUrl||i||void 0}return e},e.prototype._loadTheme=function(e){return this._getThemeCacheToken()?(this._themeDataSource||(this._themeDataSource=this._getThemeDataSource()),this._themeDataSource.then(function(t){return t?t.loadTheme(e):a.c.resolve()})):a.c.resolve()},e.prototype._enquoteIfNeeded=function(e){return e.startsWith('"')&&e.endsWith('"')?e:'"'.concat(e.replace(/"/g,'\\"'),'"')},e}()}
,function(e,t){var n=function(){function e(){this.R=0,this.G=0,this.B=0,this.A=e.maxComponent}return e.clone=function(t){return e.fromRgba(t.R,t.G,t.B,t.A)},e.equals=function(e,t){var n=!e,a=!t;return n||a?n&&a:e.R===t.R&&e.G===t.G&&e.B===t.B&&e.A===t.A},e.fromRgba=function(t,n,a,i){var r=new e;return r.R=Math.round(t),r.G=Math.round(n),r.B=Math.round(a),r.A=null!=i?Math.round(i):e.maxComponent,r},e.fromRgbaString=function(t){var n=new e;if(/^rgb.+/.test(t)){var a=t.match(/[\d.]+/g);n=e.fromRgba(Number(a[0]),Number(a[1]),Number(a[2]),4===a.length?Number(a[3])*e.maxComponent:null)}return n},e.fromHtmlColor=function(t){function n(e,t,n){return parseInt(e.charAt(t)+e.charAt(n),16)}var a=new e;if("string"==typeof t&&"#"===t.charAt(0))switch(t.length){case 9:a.A=n(t,1,2),a.R=n(t,3,4),a.G=n(t,5,6),a.B=n(t,7,8);break;case 7:a.R=n(t,1,2),a.G=n(t,3,4),a.B=n(t,5,6);break;case 4:a.R=n(t,1,1),a.G=n(t,2,2),a.B=n(t,3,3)}else/^rgb.+/.test(t)&&(a=e.fromRgbaString(t));return a},e.toHtmlString=function(t,n){function a(t){var n=Number(t);if(!(n>=0&&n<=e.maxComponent))throw new Error("Argument must be a Number in [0, 255]");var a=n.toString(16);return n<16&&(a="0"+a),a}return t.A<e.maxComponent&&!n?"rgba("+t.R.toString(10)+", "+t.G.toString(10)+", "+t.B.toString(10)+", "+(t.A/e.maxComponent).toFixed(2)+")":"#"+(n?a(t.A):"")+a(t.R)+a(t.G)+a(t.B)},e.maxComponent=255,e}();t.a=n}
,function(e,t,n){n.d(t,{a:function(){return g},b:function(){return D},c:function(){return b}});var a,i=n(0),r=n(10),o=n(30),s=n(2),c=n(77),d=n(128),l={neutralDark:"#201f1e",neutralPrimary:"#323130",neutralPrimaryAlt:"#3b3a39",neutralSecondary:"#605e5c",neutralSecondaryAlt:"#8a8886",neutralTertiary:"#a19f9d",neutralTertiaryAlt:"#c8c6c4",neutralQuaternary:"#d2d0ce",neutralQuaternaryAlt:"#e1dfdd",neutralLight:"#edebe9",neutralLighter:"#f3f2f1",neutralLighterAlt:"#faf9f8"},u=n(1),f="#3d3e66",p="#e9eaf6",m="#616161",_="#ebebeb",h={black:"#242424",neutralDark:"#424242",neutralPrimary:m,neutralPrimaryAlt:m,neutralSecondary:"#8a8a8a",neutralTertiary:"#bdbdbd",neutralTertiaryAlt:"#d1d1d1",neutralQuaternary:_,neutralQuaternaryAlt:_,neutralLight:"#f0f0f0",neutralLighter:"#f5f5f5",neutralLighterAlt:"#fafafa",white:"#fff",themeDarker:"#323348",themeDark:f,themeDarkAlt:f,themePrimary:"#5b5fc7",themeSecondary:"#9092c1",themeTertiary:"#a5a7cf",themeLight:"#385dc2",themeLighter:p,themeLighterAlt:p,accent:"#137ad1"};function b(e,t,n,a){var i;return c.a.applyBatchedUpdates(function(){i=(0,s.G)(g(e,t,a))}),i}function g(e,t,n){if(u.b.isActivated("0d6cef16-2b13-4ef6-94c6-60e57e73d2a3"))return function(e,t){t&&o.a.initSPExpFeatures(t.ExpFeatures),r.a.evaluateCanOverride(),d.c||(e=S({palette:{themePrimary:"#03787c",themeLighterAlt:"#f0f9fa",themeLighter:"#c5e9ea",themeLight:"#98d6d8",themeTertiary:"#49aeb1",themeSecondary:"#13898d",themeDarkAlt:"#026d70",themeDark:"#025c5f",themeDarker:"#014446"}},e));var n=e.palette;return n&&(n.black||n.neutralPrimary||n.white||n.neutralQuaternary)&&!(n.black&&n.white&&n.neutralPrimary&&n.neutralQuaternary&&0===n.black.indexOf("#000")&&0===n.white.toLowerCase().indexOf("#fff")&&0===n.neutralPrimary.indexOf("#333")&&0===n.neutralQuaternary.toLowerCase().indexOf("#d0d0d0"))||(e.palette=(0,i.a)((0,i.a)({},e.palette),l)),e}(e,t);t&&o.a.initSPExpFeatures(t.ExpFeatures),r.a.evaluateCanOverride();var s=function(e,t){return d.c?a.noDefault:t&&(null==e?void 0:e.themedCssFolderUrl)||!function(e){var t;if(!u.b.isActivated("a7baa93c-d9fa-4e23-aa22-5f51ad9fab63")&&e){var n=null===(t=e.featureInfo)||void 0===t?void 0:t.VivaBackendFeature;return n?n.Enabled:e.isCurrentSiteAVivaBackendSite}return!1}(e)?a.spDefault:a.vivaHomeDefault}(t,n);return function(e,t){switch(e){case a.noDefault:return v(t);case a.vivaHomeDefault:return function(e){return y({palette:h},e)}(t);case a.spDefault:default:return function(e){return y({palette:{themePrimary:"#03787c",themeLighterAlt:"#f0f9fa",themeLighter:"#c5e9ea",themeLight:"#98d6d8",themeTertiary:"#49aeb1",themeSecondary:"#13898d",themeDarkAlt:"#026d70",themeDark:"#025c5f",themeDarker:"#014446"}},e)}(t)}}(s,e)}function v(e){var t;return function(e){var t=e.palette,n=!t.black&&!t.neutralPrimary&&!t.white&&!t.neutralQuaternary||t.black&&t.white&&t.neutralPrimary&&t.neutralQuaternary&&0===t.black.indexOf("#000")&&0===t.white.toLowerCase().indexOf("#fff")&&0===t.neutralPrimary.indexOf("#333")&&0===t.neutralQuaternary.toLowerCase().indexOf("#d0d0d0");return!(t&&!n)}(e)&&(e.palette=(t=e.palette,(0,i.a)((0,i.a)({},t),l))),e}function y(e,t){return v(t=S(e,t))}function S(e,t){return(0,i.a)((0,i.a)((0,i.a)({},e),t),{effects:(0,i.a)((0,i.a)({},e.effects),t.effects),fonts:(0,i.a)((0,i.a)({},e.fonts),t.fonts),palette:(0,i.a)((0,i.a)({},e.palette),t.palette)})}function D(e){var t=u.b.isActivated("17d606aa-a12a-4d3e-b988-db14e6dc370f")?window._spPageContextInfo:null!=e?e:window._spPageContextInfo;return t&&o.a.initSPExpFeatures(t.ExpFeatures),o.a.isFeatureEnabled({ODB:61259})}!function(e){e[e.noDefault=0]="noDefault",e[e.vivaHomeDefault=1]="vivaHomeDefault",e[e.spDefault=2]="spDefault"}(a||(a={}))}
,function(e,t,n){var a,i;function r(e,t){return a&&i===e||(a=function(e,t){var n,a=t||window._spPageContextInfo;return a&&(n=e.webThemeProvider(a)),n}(e,t),i=e),a}n.d(t,{a:function(){return r}})}
,function(e,t,n){var a;function i(){return a}function r(e){a=e}n.d(t,{a:function(){return i},b:function(){return r}})}
,function(e,t,n){n.d(t,{a:function(){return a}});var a=n("react-lib").createContext(!1)}
,,,,,,,,function(e,t,n){n.d(t,{a:function(){return s},b:function(){return r},c:function(){return a},d:function(){return l},e:function(){return d},f:function(){return c},g:function(){return o},h:function(){return i},i:function(){return u},j:function(){return f}});var a=6e4,i=2*a,r=60*a,o=2*r,s=24*r,c=2*s,d=7*s,l=32*s;function u(e,t){return e.getDate()===t.getDate()&&Math.abs(t.getTime()-e.getTime())<s}function f(e,t,n){if(e)try{return e.toLocaleDateString(t,n)}catch(t){return e.toLocaleDateString([],n)}}}
,function(e,t,n){function a(e){return e}n.d(t,{a:function(){return a}})}
,function(e,t,n){var a;n.d(t,{a:function(){return a}}),function(e){e[e.default=0]="default",e[e.shareShimmer=1]="shareShimmer",e[e.modifyPermissions=2]="modifyPermissions",e[e.permissionsList=3]="permissionsList",e[e.linkSuccess=4]="linkSuccess",e[e.grantPermissions=5]="grantPermissions",e[e.policyDetails=6]="policyDetails",e[e.error=7]="error",e[e.linkSettings=8]="linkSettings",e[e.notify=9]="notify",e[e.addPeople=10]="addPeople",e[e.linksFromTemplateList=12]="linksFromTemplateList",e[e.atMention=13]="atMention",e[e.spinner=14]="spinner",e[e.copyLinkShortcut=15]="copyLinkShortcut",e[e.permissionsPivot=16]="permissionsPivot",e[e.shareToTeams=17]="shareToTeams"}(a||(a={}))}
,function(e,t,n){n.d(t,{a:function(){return I}});var a,i,r=n(437),o=n(0),s=n("react-lib"),c=n(439),d=n(43),l=n(3),u=n(2),f=n(5),p=n(178),m=n(44),_=(0,d.a)({root:(a={fontSize:"inherit",fontWeight:"inherit"},a[u.h]={color:"LinkText"},a)}),h=(0,d.a)({root:(i={fontSize:"inherit",fontWeight:"inherit"},i[u.h]={MsHighContrastAdjust:"auto",forcedColorAdjust:"auto"},i.outlineColor="transparent",i)}),b=(0,d.a)({disabled:{color:p.a.semanticDisabledText,":hover":{color:p.a.semanticDisabledText},":active":{color:p.a.semanticDisabledText}}}),g=new Set(["as","componentRef","disabled","styles","theme","type","underline"]),v=(0,f.a)({useStaticStyles:!0}),y=function(e){var t=function(e){var t=e.as,n=e.componentRef,a=e.disabled,i=e.ref,r=e.type,s=e.underline,c=e.href,d=_(),f=h(),p=c?f:d,y=b(),S=v(e.styles,{theme:e.theme||(0,u.D)()}),D=t||(c?"a":"button");return(0,o.a)((0,o.a)({},(0,m.b)(e,g)),{appearance:"default",as:D,type:r,disabled:a,ref:n||i,inline:s,className:(0,l.a)("ms-Link","ms-LinkShim",p.root,e.disabled&&y.disabled,S.root,e.className)})}(e);return s.createElement(c.a,(0,o.a)({},t))};y.displayName="LinkShim";var S=n(42),D=n(34),I=function(e){return(0,S.a)(r.a,y,e,D.a.FluentUIV9ShimLink)}}
,function(e,t){t.a={unavailable:-1,none:0,disabled:1,notShareableByLink:2,parentListIsPrivate:3,parentListIsCatalogDocLib:4,notSupportedByWopi:5,irmIsEnabled:6,documentIsProtectedByDlp:7,forceCheckoutEditLink:8,anonymousEditLinkNotAllowedByTenant:9,nonClaimsWebapp:10,accessDeniedToAnonGuest:11,blockedByWhoCanShareSettings:12,blockedByExternalShareSettings:13,accessDeniedNotEnoughPermissions:14,sharingBlockedByVirusCheckStatus:40,loopFilesExternalSharingNotSupported:43,azureB2BIMIntegrationNotConfiguredSharingToNewExternalUserNotSupported:49}}
,,,,,,,,,,,,,,,,,,,,,function(e,t,n){n.d(t,{a:function(){return u},b:function(){return v},c:function(){return d},d:function(){return g},e:function(){return y},f:function(){return l},g:function(){return r},h:function(){return o},i:function(){return i},j:function(){return m},k:function(){return f},l:function(){return s},m:function(){return c},n:function(){return p},o:function(){return h},p:function(){return _},q:function(){return b}});var a=n("react-lib"),i=a.lazy(function(){return n.e(24).then(n.bind(n,564))}),r=a.lazy(function(){return n.e(14).then(n.bind(n,565))}),o=a.lazy(function(){return n.e(22).then(n.bind(n,566))}),s=a.lazy(function(){return n.e(29).then(n.bind(n,557))}),c=a.lazy(function(){return n.e(31).then(n.bind(n,567))}),d=a.lazy(function(){return n.e(25).then(n.bind(n,546))}),l=a.lazy(function(){return n.e(19).then(n.bind(n,388))}),u=a.lazy(function(){return n.e(15).then(n.bind(n,568))}),f=a.lazy(function(){return n.e(23).then(n.bind(n,569))}),p=a.lazy(function(){return n.e(27).then(n.bind(n,570))}),m=a.lazy(function(){return n.e(26).then(n.bind(n,571))}),_=a.lazy(function(){return n.e(30).then(n.bind(n,572))}),h=a.lazy(function(){return n.e(32).then(n.bind(n,573))}),b=a.lazy(function(){return n.e(21).then(n.bind(n,574))}),g=a.lazy(function(){return n.e(28).then(n.bind(n,575))}),v=a.lazy(function(){return Promise.all([n.e("ondemand.resx"),n.e(17)]).then(n.bind(n,576))}),y=a.lazy(function(){return Promise.all([n.e("ondemand.resx"),n.e(18)]).then(n.bind(n,577))})}
,function(e,t,n){n.d(t,{a:function(){return f}});var a=n(0),i=n(122),r=n(591);function o(e){return e?e.endTime-e.startTime:0}function s(e){return!(!e||!e.startTime&&0!==e.startTime||!e.endTime&&0!==e.endTime||!(e.endTime>e.startTime))}var c=function(e){var t=e.controlId,n=e.startTime,a=e.endTime,i=e.ignoreForEUPL,r=e.needFlatten,c=e.renderTimeCalculator,d=void 0===c?o:c,l=e.renderTimeRequiredDataChecker,u=void 0===l?s:l;this.controlId=t,this.startTime=n,this.endTime=a,this.renderTimeCalculator=d,this.renderTimeRequiredDataChecker=u,this.ignoreForEUPL=void 0===i||i,this.needFlatten=void 0!==r&&r},d=n(123),l=n(117),u="ShareControl",f=function(){function e(e){void 0===e&&(e="sharedialog");var t=this;this.resetRumOneApiMeasurement=function(){t._rumone.undoAPIInstrument()},this.computeRenderTime=function(e){return e&&e.startTime&&e.endTime?e.endTime-e.startTime:0},this.checkRenderTimeRequiredDataAvailable=function(e){return!!e&&!!e.startTime&&!!e.endTime},this._rumone=i.a.getRUMOneLogger({name:e})}return e.prototype.logSharingPerformance=function(e,t){var n=this;if(this._rumone&&this._rumone.isRunning()){var i=this.breakdownData;this._rumone.writeScenarioId("ShareDialog.".concat(e.modeName)),this._rumone.addExpectedControl(u),this._rumone.writePageTransitionType(t||r.a.fullPageLoad),this._rumone.collectW3CPerfTimings(),this._rumone.collectW3cResourceTimings();var o=location.href.toLowerCase().indexOf("sharedialog.aspx")>=0;o&&(this._rumone.collectSPClientFlights(window._spPageContextInfo),this._evaluateExperiments(window._spPageContextInfo)),this._rumone.setSettings({TTISettings:{enabled:!0},getStartTime:function(){return n._regulateTime(e.startTime)}});var s=new c({controlId:u,startTime:e.startTime,endTime:e.endTime,renderTimeCalculator:this.computeRenderTime,renderTimeRequiredDataChecker:this.checkRenderTimeRequiredDataAvailable});this._rumone.writeControlPerformanceData(s);var d=e.breakDownData,l=this._getResponseEnd();d=(0,a.a)((0,a.a)({},d),{waitForDomReady:Math.round(this._rumone.getMarkerTime("EUPL.AfterWaitForDomReady")-this._rumone.getMarkerTime("EUPL.BeforeWaitForDomReady")),isShareDialogASPXHosted:i(o),w3cResponseEnd:i(l-performance.timing.navigationStart),appStart:i(this._regulateTime(this._rumone.getMarkerTime("EUPL.AppStart"))-this._regulateTime(l)),render:i(this._regulateTime(e.endTime)-this._regulateTime(this._rumone.getMarkerTime("EUPL.AppStart")))}),this._rumone.writeEUPLBreakdown(JSON.stringify(d))}},e.prototype.resetRumOne=function(){return!this._rumone.isRunning()&&(this._rumone.resetLogger(),!0)},e.prototype.breakdownData=function(e){return{data:e,needFlatten:!0}},e.prototype._isDateTime=function(e){var t=new Date;return e>new Date(t.setDate(t.getDate()-1)).getTime()},e.prototype._regulateTime=function(e){return this._isDateTime(e)&&d.a?e-performance.timing.navigationStart:e},e.prototype._getResponseEnd=function(){return performance&&performance.timing?window.g_responseEnd&&(performance.timing.responseEnd&&Number(window.g_responseEnd)<performance.timing.responseEnd||!performance.timing.responseEnd)?Number(window.g_responseEnd):performance.timing.responseEnd:NaN},e.prototype._evaluateExperiments=function(e){e&&(0,l.c)(90089,e)},e}()}
,function(e,t,n){function a(e){return{clientId:e.clientId,scenarioId:e.scenarioId,correlationId:e.correlationId,hostOptions:e.hostOptions}}n.d(t,{a:function(){return a}})}
,function(e,t,n){var a,i;n.d(t,{a:function(){return a},b:function(){return i}}),function(e){e[e.CompletedSuccessfully=0]="CompletedSuccessfully",e[e.AccessRequestsQueued=1]="AccessRequestsQueued",e[e.Error=2]="Error"}(a||(a={})),function(e){e[e.UnshareLink=0]="UnshareLink",e[e.ShareLink=1]="ShareLink",e[e.FetchSharingInformation=2]="FetchSharingInformation",e[e.GrantAccess=3]="GrantAccess"}(i||(i={}))}
,function(e,t,n){n.d(t,{a:function(){return M},b:function(){return L},c:function(){return k},d:function(){return g},e:function(){return v},f:function(){return U},g:function(){return F},h:function(){return y},i:function(){return R},j:function(){return H},k:function(){return P},l:function(){return D},m:function(){return I},n:function(){return A},o:function(){return T}});var a=n(32),i=n(281),r=n(41),o=n(30),s=n(177),c=n(52),d=n(132),l=n(21),u=n(72),f=n(24),p=n(456),m=n(135),_=n(455),h={ODB:772},b={ODB:1935};function g(e){return"anyoneLinkAbilities"===e||"anonymousLinkAbilities"===e?a.a.anyone:"organizationLinkAbilities"===e?a.a.organization:"peopleSharingLinkAbilities"===e?a.a.specificPeopleFlex:void 0}function v(e,t){return e===a.a.anyone?t.anyoneLinkAbilities?t.anyoneLinkAbilities:t.anonymousLinkAbilities:e===a.a.organization?t.organizationLinkAbilities:e===a.a.specificPeopleFlex||e===a.a.specificPeople||e===a.a.customLabeledSpecificPeople?t.peopleSharingLinkAbilities:t.directSharingAbilities}function y(e,t){var n=v(e,t);return(null==n?void 0:n.canManageEditLink)?n.canManageEditLink.enabled:!!(null==n?void 0:n.canAddInternalPrincipal)&&n.canAddInternalPrincipal.enabled}function S(e,t,n){var r,o,s=v(a.a.direct,n.sharingAbilities),c=(null===(r=s.canAddInternalPrincipal)||void 0===r?void 0:r.enabled)||(null===(o=s.canAddExternalPrincipal)||void 0===o?void 0:o.enabled);return!(0,f.tb)(e,t)||!F(a.a.specificPeople,n.sharingAbilities,i.a.forceCheckoutEditLink)&&c}function D(e,t,n,a,i){return a?t.canRequestAccessForGrantAccess:i!==_.a.ShareSitePageDraft&&i!==_.a.ShareSitePageDraftFromLibrary&&i!==_.a.SharePrivateDraft}function I(e,t,n){var a,i=v(e,t);return!(!l._c()&&n===_.a.ShareSitePageDraft||n===_.a.ShareSitePageDraftFromLibrary||n===_.a.SharePrivateDraft)&&!!(null==i?void 0:i.canManageReadLink)&&(null===(a=null==i?void 0:i.canManageReadLink)||void 0===a?void 0:a.enabled)}function x(e){var t=e.sharingRole;return t===c.a.manageList||t===c.a.owner}function C(e,t){return!(s.b!==s.a[e]||!(0,f.k)(t,c.a.review))}function O(e,t,n,a,i){return!(!i||!T(e,t)||!(0,p.b)(n,p.a.AllowMediaTA)&&a!==d.a.folder)}function w(e,t,n,a){return a&&(0,f.k)(n,c.a.restrictedview)&&((0,p.b)(t,p.a.AllowMediaTA)||e===d.a.folder)}function E(e,t){var n=e.sharedObjectType===d.a.list;return t&&n&&e.userRole===c.a.owner}function A(e,t,n){if(o.a.isFeatureEnabled(h)&&!s.a[n]){var a=v(e,t);return(null==a?void 0:a.canManageReviewLink)?a.canManageReviewLink.enabled:!!(null==a?void 0:a.supportsReviewPermission)&&a.supportsReviewPermission.enabled}return!1}function L(e){var t={fullControl:{enabled:!1,shouldDisplay:!1},manageList:{enabled:!1,shouldDisplay:!1},review:{enabled:!1,shouldDisplay:!1},edit:{enabled:!1,shouldDisplay:!1},view:{enabled:!1,shouldDisplay:!1},blockDownload:{enabled:!1,shouldDisplay:!1}};switch(e.role){case c.a.view:t.view.enabled=t.view.shouldDisplay=!0;break;case c.a.restrictedview:t.blockDownload.enabled=t.blockDownload.shouldDisplay=!0;break;case c.a.review:t.review.enabled=t.review.shouldDisplay=!0}return t}function k(e){var t=e.clientId,n=e.sharingStore,i=e.sharingInformation,o=e.audience,s=e.mode,u=e.isPreventDownloadAllowed,p=!1,_=!1,h=!1,b=!1,g=!0,S=!1;if(!(0,f.V)(i)){p=i.sharedObjectType===d.a.list,_=function(e){var t=e.audience,n=e.sharingRole,i=v(t,e.sharingAbilities);return(null==i?void 0:i.canManageManageListLink)?i.canManageManageListLink.enabled:t===a.a.existing&&(n===c.a.manageList||n===c.a.owner)}({audience:o,sharingAbilities:i.sharingAbilities,sharingRole:i.userRole}),b=A(o,i.sharingAbilities,i.fileExtension)||P(o,i.sharingAbilities,i.fileExtension),h=y(o,i.sharingAbilities);var D=!l._c()&&(null==n?void 0:n.getScenarioId)&&n.getScenarioId();g=I(o,i.sharingAbilities,D);var x="video"===(0,m.a)(i.fileExtension)&&O(o,i.sharingAbilities,i.fileExtension,i.sharedObjectType,u),C=(0,f.tb)(t,n)&&O(o,i.sharingAbilities,i.fileExtension,i.sharedObjectType,u);S=x||C}var w=s===r.a.addPeople||s===r.a.manageAccess||h,E=g;return(o==a.a.specificPeople&&R(o,i.sharingAbilities)||i.requiresAccessApproval)&&(w=E=!0),{fullControl:{enabled:!1,shouldDisplay:!1},manageList:{enabled:_,shouldDisplay:p},review:{enabled:b,shouldDisplay:b},edit:{enabled:w,shouldDisplay:!0},view:{enabled:E,shouldDisplay:E},blockDownload:{enabled:S,shouldDisplay:S}}}function M(e){e.audience;var t,n,a,i,o,s,c=e.clientId,u=e.sharingInformation,p=e.scenarioId,_=e.isPreventDownloadAllowed,h=e.shareMode,b=e.sharingStore,g=!1,v=!1,y=!1,I=!1,O=!1,A=!1,L=!1;if(l.E()){if(!(0,f.V)(u)){g=u.sharedObjectType===d.a.list,v=x({sharingRole:u.userRole}),y=E(u,h===r.a.addPeople||h===r.a.manageAccess),I=!!(0,f.tb)(c,b)&&C(u.fileExtension,u.userRole);var k="video"===(0,m.a)(u.fileExtension)&&w(u.sharedObjectType,u.fileExtension,u.userRole,_),M=(0,f.tb)(c,b)&&w(u.sharedObjectType,u.fileExtension,u.userRole,_);O=k||M,A=S(c,b,u)}L=D(0,u,u.sharingAbilities,u.requiresAccessApproval,p)}else if(!(0,f.V)(u)){var P=null===(t=u.sharingAbilities)||void 0===t?void 0:t.directSharingAbilities;y=E(u,h===r.a.addPeople||h===r.a.manageAccess),g=u.sharedObjectType===d.a.list,v=x({sharingRole:u.userRole})&&(null===(n=P.supportsManageListPermission)||void 0===n?void 0:n.enabled),A=S(c,b,u)&&(null===(a=P.supportsEditPermission)||void 0===a?void 0:a.enabled),I=C(u.fileExtension,u.userRole)&&(null===(i=P.supportsReviewPermission)||void 0===i?void 0:i.enabled),L=D(0,u,u.sharingAbilities,u.requiresAccessApproval,p)&&(null===(o=P.supportsReadPermission)||void 0===o?void 0:o.enabled),k="video"===(0,m.a)(u.fileExtension)&&w(u.sharedObjectType,u.fileExtension,u.userRole,_),M=(0,f.tb)(c,b)&&w(u.sharedObjectType,u.fileExtension,u.userRole,_),O=(k||M)&&(null===(s=P.supportsRestrictedViewPermission)||void 0===s?void 0:s.enabled)}return{fullControl:{enabled:y,shouldDisplay:y},manageList:{enabled:v,shouldDisplay:g},review:{enabled:I,shouldDisplay:I},edit:{enabled:A,shouldDisplay:A},view:{enabled:L,shouldDisplay:L},blockDownload:{enabled:O,shouldDisplay:O}}}function P(e,t,n){if(s.b===s.a[n]){var a=v(e,t);return(null==a?void 0:a.canManageReviewLink)?a.canManageReviewLink.enabled:!!(null==a?void 0:a.supportsReviewPermission)&&a.supportsReviewPermission.enabled}return!1}function T(e,t){var n=v(e,t);return!!(null==n?void 0:n.supportsRestrictedView)&&n.supportsRestrictedView.enabled}function U(e,t){if(u.c())return[];var n=[];if(o.a.isFeatureEnabled(b))for(var a=0,i=t;a<i.length;a++){var r=i[a];if(r.linkDetails&&r.linkDetails.shareId){var s=v(r.linkDetails.audience,e);s.canManageEditLink&&s.canManageEditLink.enabled||s.canManageReviewLink&&s.canManageReviewLink.enabled||s.canManageReadLink&&s.canManageReadLink.enabled||r.linkDetails.expiration&&r.linkDetails.expiration<new Date(Date.now())||n.push(r.linkDetails)}}return n}function F(e,t,n){var a;if(void 0===e||!t)return!1;var i=v(e,t);for(var r in i)if((null===(a=i[r])||void 0===a?void 0:a.disabledReason)==n)return!0;return!1}function H(e,t){return F(e,t,i.a.sharingBlockedByVirusCheckStatus)}function R(e,t){return F(e,t,i.a.irmIsEnabled)}}
,,,,,,,,,,,,,,function(e,t,n){var a,i=n(20),r=n(55),o=n(71);!function(e){e.getAttachAsCopyOptions=function(e,t,n,a,s,c){var d=[],l=function(e,t,n,a,s){var c=n.name.split("."),d="";if(c.length>1&&(d=c[1].toLowerCase()),(0,o.l)()||s){var l=function(){!function(e,t){e.getEngagementHelper().sendACopyOfficeClicked(t),(0,o.u)()}(e,a)};return r.o(t)||function(e){return["doc","docx","dot","docm","odt","rtf","txt"].indexOf(e)>-1}(d)?{key:"word",name:i.Yk,iconProps:{iconName:"WordDocument",className:"Share-wordIcon"},onClick:l}:r.l(t)||function(e){return["ppt","pptx","pptm","ppsx","pps","ppsm","odp"].indexOf(e)>-1}(d)?{key:"powerpoint",name:i.Ih,iconProps:{iconName:"PowerPointDocument",className:"Share-powerpointIcon"},onClick:l}:r.e(t)||function(e){return["xlsx","xlsm","xlsb","xls","ods","csv","xlt","xltm","xltx"].indexOf(e)>-1}(d)?{key:"excel",name:i.nd,iconProps:{iconName:"ExcelDocument",className:"Share-excelIcon"},onClick:l}:r.n(t)||function(e){return["vsd","vsdx"].indexOf(e)>-1}(d)?{key:"visio",name:i.qk,iconProps:{iconName:"VisioLogo"},onClick:l}:{key:"document",name:i.Wc,iconProps:{iconName:"Document"},onClick:l}}}(n,e,t,a,s);l&&d.push(l);var u=function(e,t,n){if((0,o.m)()||n)return{key:"pdf",name:i.Sg,iconProps:{iconName:"PDF",className:"Share-pdfIcon"},onClick:function(){!function(e,t){e.getEngagementHelper().sendACopyPdfClicked(t),(0,o.w)()}(e,t)}}}(n,a,c);return u&&d.push(u),d}}(a||(a={})),t.a=a}
,function(e,t,n){n.d(t,{a:function(){return d}});var a=n("react-lib"),i=n("prop-types-lib");(0,n(8).b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.Header-width{width:100%}@media screen and (max-width:352px){.Header-width{max-width:294px}}.Header-flex-row{display:flex;flex-direction:row;align-items:center;column-gap:.25rem}.Header-flex-row i{font-size:.875rem}@supports (font:-apple-system-body){.Header-flex-row i{font:-apple-system-body}}.Header-flex-row button:hover{outline:0;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";border-radius:4px}.Header-flex-grow{flex-grow:1}.Header-main-text{white-space:nowrap;overflow:hidden;display:flex;flex-direction:column;align-self:center}.Header-filename{margin:0;font-size:1.25rem;font-weight:600;overflow:hidden;text-overflow:ellipsis}@media screen and (max-width:511px){.Header-filename{font-size:1rem}@supports (font:-apple-system-body){.Header-filename{font:-apple-system-body}}}.Header-filename.ie{font-size:1.25rem}@supports (font:-apple-system-title2){.Header-filename{font:-apple-system-title2}}.Header-subheader{font-size:.875rem}@supports (font:-apple-system-body){.Header-subheader{font:-apple-system-body}}.Header-subheader.ie{max-width:320px;overflow:hidden;text-overflow:ellipsis}.Header-odc h1{font-size:1.25rem}.Header-contextual{font-weight:600;font-size:.75rem}.Header-actions{padding-left:5px;gap:5px;flex-shrink:1;row-gap:.5rem}.Header-actions button{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.Header-backButton button{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";margin-right:5px}[dir=rtl] .Header-backButton button{transform:scale(-1,1)}"}]);var r=n(14),o=n(20),s=n(112),c=n(201);function d(e,t){var n=e.actions,i=e.mainHeaderText,d=e.subHeaderText,l=e.className,u=e.fullHeaderText,f=e.isFilenameTruncated,p=e.isSubHeaderTextTruncated,m=e.itemTypePrefix,_=e.renderBackButton,h=e.onBackButtonClicked,b=e.isContextualHeader,g=t.platformDetection,v=g.isIE?"ie":"",y="Header-filename ".concat(g.isMobile?"mobile ":""," ").concat(v),S=m?m+" "+i:i,D=function(){return b?a.createElement("div",{className:y+" Header-contextual","aria-label":f?void 0:S},i):a.createElement("h1",{className:y,"aria-label":f?void 0:S},i)},I=function(){return a.createElement("span",{className:"Header-subheader ".concat(v)},d)};return a.createElement("div",{className:"Header-flex-row Header-width ".concat(v," ").concat(l)},_&&a.createElement("div",{className:"Header-flex-row Header-backButton"},a.createElement(c.a,{iconProps:{iconName:"Back"},ariaLabel:o.db,onClick:h,tooltipContent:o.db,automationId:"Header-backButton"})),a.createElement("div",{className:"Header-main-text Header-flex-grow"},f?(0,s.b)(D(),u,{position:r.a.bottomLeftEdge}):D(),p?(0,s.b)(I(),d,{styles:{root:{overflow:"hidden",textOverflow:"ellipsis",maxWidth:"320px"}},position:r.a.bottomLeftEdge}):I(),_&&s.a(i,"assertive","alert")),a.createElement("div",{className:"Header-flex-row Header-actions"},n))}d.contextTypes={platformDetection:i.object.isRequired}}
,function(e,t,n){n.d(t,{a:function(){return ke}});var a=n(0),i=n("react-lib"),r=n(8);(0,r.b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-Share-PeoplePickerContainer{display:flex;flex-direction:row;flex-wrap:nowrap}.od-Share-PeoplePickerContainer.space-between{justify-content:space-between}.od-Share-PeoplePickerContainer.normal{justify-content:normal}.od-Share-PeoplePickerContainer .od-Share-PeoplePicker-ErrorWarnings-wrapper,.od-Share-PeoplePickerContainer .od-Share-PeoplePicker-wrapper{max-width:calc(100% - (1.75rem + 34px));width:100%;flex-grow:1}.od-Share-PeoplePicker-flexGrow{flex-grow:1;height:100%}.od-Share-PeoplePicker-PeoplePickerIcon{font-size:1.5rem;padding-top:10px;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}[dir=ltr] .od-Share-PeoplePicker-PeoplePickerIcon{padding-left:12px}[dir=rtl] .od-Share-PeoplePicker-PeoplePickerIcon{padding-right:12px}#od-Share-PeoplePicker-wrapper-id .ms-BasePicker-text::after{content:none}.od-Share-PeoplePicker-RoleSelector{align-self:flex-end;grid-row:1;grid-column:2;-ms-grid-row:1;-ms-grid-column:2;-ms-grid-row-align:end}[dir=ltr] .od-Share-PeoplePicker.withIcon{padding-left:12px}[dir=rtl] .od-Share-PeoplePicker.withIcon{padding-right:12px}.od-Share-PeoplePicker .ms-Callout{width:100%}.od-Share-PeoplePicker .ms-Callout .ms-Suggestions{width:100%;min-width:100%}.od-Share-PeoplePicker .ms-BasePicker-text{min-height:26px;border:none;padding:0;border-bottom:1px solid "},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";display:block}.od-Share-PeoplePicker .ms-BasePicker-input{font-size:.75rem;background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";width:100%}[dir=ltr] .od-Share-PeoplePicker .ms-BasePicker-input{padding-left:0}[dir=rtl] .od-Share-PeoplePicker .ms-BasePicker-input{padding-right:0}.od-Share-PeoplePicker .ms-BasePicker-input::-ms-clear{display:none;width:0;height:0}.od-Share-PeoplePicker.ms-Share-PeoplePicker--error .ms-BasePicker-text{border-color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-Share-PeoplePicker .ms-BasePicker-input::before{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-Share-PeoplePicker input.ms-BasePicker-input:-ms-input-placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:.75rem}.od-Share-PeoplePicker input.ms-BasePicker-input::placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:.75rem}@supports (font:-apple-system-body){.od-Share-PeoplePicker input.ms-BasePicker-input:-ms-input-placeholder{font:-apple-system-body}.od-Share-PeoplePicker input.ms-BasePicker-input::placeholder{font:-apple-system-body}}.od-Share-PeoplePicker .ms-TextField.ms-TextField--multiline .ms-TextField-field{font-size:.75rem}.od-Share-PeoplePicker .ms-TextField-field{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea::-webkit-input-placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:.75rem;font:-apple-system-caption1}.od-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea::-moz-placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:.75rem}.od-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea:-ms-input-placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:.75rem}.od-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea:-moz-placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:.75rem}.od-Share-PeoplePicker .ms-PickerPersona-container{border-radius:16px;margin-bottom:8px;max-width:208px}[dir=ltr] .od-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona{padding-left:1px}[dir=rtl] .od-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona{padding-right:1px}.od-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona-details div.ms-Persona-primaryText{font:-apple-system-body;white-space:nowrap}.od-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona-details div.ms-Persona-secondaryText{font:-apple-system-caption1}.od-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona-details div.ms-Persona-tertiaryText{font:-apple-system-caption1}.od-Share-PeoplePicker .ms-PickerPersona-container.is-excluded{background-color:transparent;border:1px solid "},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}[dir=ltr] .od-Share-PeoplePicker .ms-PickerPersona-container.is-excluded .ms-Persona-details{padding-left:12px}[dir=rtl] .od-Share-PeoplePicker .ms-PickerPersona-container.is-excluded .ms-Persona-details{padding-right:12px}.od-Share-PeoplePicker .ms-PickerPersona-container.is-excluded .ms-Button-icon{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-Share-PeoplePicker .ms-PickerItem-content{max-width:250px;border-radius:16px;font-size:1rem}@supports (font:-apple-system-body){.od-Share-PeoplePicker .ms-PickerItem-content{font:-apple-system-body;height:auto}}.od-Share-PeoplePicker .ms-PickerItem-content.ms-Button--icon{width:2rem;height:auto}.od-Share-PeoplePicker .ms-PickerItem-content .ms-Button-flexContainer i.ms-Button-icon{font-size:1rem;height:1rem;line-height:1rem}.od-Simplified-Share-PeoplePicker{height:100%;padding:12px 6px 12px 0}.od-Simplified-Share-PeoplePicker.smaller-padding{padding:10px 5px 10px 3px}.od-Simplified-Share-PeoplePicker .ms-Callout{width:100%}.od-Simplified-Share-PeoplePicker .ms-Callout .ms-Suggestions{width:100%;min-width:100%}.od-Simplified-Share-PeoplePicker.inline .ms-Callout-container{position:static}.od-Simplified-Share-PeoplePicker .ms-BasePicker-text{min-height:unset;border:none;padding:0;display:block;height:100%}.od-Simplified-Share-PeoplePicker.isIE.initial-padding{padding-bottom:4px}.od-Simplified-Share-PeoplePicker.isIE .ms-BasePicker-text{min-height:unset;border:none;padding:0;display:block;height:100%;max-width:320px}.od-Simplified-Share-PeoplePicker .ms-BasePicker-input{font-size:.875rem;background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";width:100%;height:100%;padding:0}[dir=ltr] .od-Simplified-Share-PeoplePicker .ms-BasePicker-input{padding-left:0}[dir=rtl] .od-Simplified-Share-PeoplePicker .ms-BasePicker-input{padding-right:0}@supports (font:-apple-system-body){.od-Simplified-Share-PeoplePicker .ms-BasePicker-input{font:-apple-system-body}}.od-Simplified-Share-PeoplePicker .ms-BasePicker-input::-ms-clear{display:none;width:0;height:0}.od-Simplified-Share-PeoplePicker.ms-Share-PeoplePicker--error .ms-BasePicker-text{border-color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-Simplified-Share-PeoplePicker .ms-BasePicker-input::before{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-Simplified-Share-PeoplePicker input.ms-BasePicker-input:-ms-input-placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:.875rem}.od-Simplified-Share-PeoplePicker input.ms-BasePicker-input::placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:.875rem}@supports (font:-apple-system-body){.od-Simplified-Share-PeoplePicker input.ms-BasePicker-input:-ms-input-placeholder{font:-apple-system-body;white-space:break-spaces}.od-Simplified-Share-PeoplePicker input.ms-BasePicker-input::placeholder{font:-apple-system-body;white-space:break-spaces}}@keyframes fadein{0%{opacity:0}100%{opacity:1}}@keyframes fadeout{0%{opacity:1}100%{opacity:0}}.od-Simplified-Share-PeoplePicker .ms-TextField.ms-TextField--multiline .ms-TextField-field{font-size:.875rem}.od-Simplified-Share-PeoplePicker .ms-TextField-field{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-Simplified-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea::-webkit-input-placeholder{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";font-size:.75rem;font:-apple-system-caption1}.od-Simplified-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea::-moz-placeholder{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";font-size:.75rem}.od-Simplified-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea:-ms-input-placeholder{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";font-size:.75rem}.od-Simplified-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea:-moz-placeholder{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";font-size:.75rem}.od-Simplified-Share-PeoplePicker .ms-PickerPersona-container{border-radius:16px;margin-bottom:8px;max-width:208px;height:0;overflow:hidden;opacity:0;align-items:center}[dir=ltr] .od-Simplified-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona{padding-left:1px}[dir=rtl] .od-Simplified-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona{padding-right:1px}.od-Simplified-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona-details div.ms-Persona-primaryText{white-space:nowrap;font:-apple-system-body}.od-Simplified-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona-details div.ms-Persona-secondaryText{font:-apple-system-caption1}.od-Simplified-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona-details div.ms-Persona-tertiaryText{font:-apple-system-caption1}.od-Simplified-Share-PeoplePicker .ms-PickerPersona-container.is-excluded{background-color:transparent;border:1px solid "},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}[dir=ltr] .od-Simplified-Share-PeoplePicker .ms-PickerPersona-container.is-excluded .ms-Persona-details{padding-left:12px}[dir=rtl] .od-Simplified-Share-PeoplePicker .ms-PickerPersona-container.is-excluded .ms-Persona-details{padding-right:12px}.od-Simplified-Share-PeoplePicker .ms-PickerPersona-container.is-excluded .ms-Button-icon{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-Simplified-Share-PeoplePicker .ms-PickerItem-content:focus::after{border-radius:16px;box-shadow:0 0 0 1px "},{theme:"black",defaultValue:"#000"},{rawString:";outline-color:transparent;outline:0!important}@media screen and (-ms-high-contrast:active){.od-Simplified-Share-PeoplePicker .ms-PickerItem-content:focus::after{border-radius:16px;box-shadow:0 0 0 1px "},{theme:"black",defaultValue:"#000"},{rawString:";outline-color:transparent;outline:0!important}}.od-Simplified-Share-PeoplePicker .ms-PickerItem-content{max-width:250px;border-radius:16px;font-size:1rem}@supports (font:-apple-system-body){.od-Simplified-Share-PeoplePicker .ms-PickerItem-content{font:-apple-system-body;height:auto}}.od-Simplified-Share-PeoplePicker .ms-PickerItem-content.ms-Button--icon{width:2rem;height:100%}.od-Simplified-Share-PeoplePicker .ms-PickerItem-content .ms-Button-flexContainer i.ms-Button-icon{font-size:1rem;height:1rem;line-height:1rem}.od-Simplified-Share-PeoplePicker .ms-SelectionZone{height:100%}@media screen and (min-width:400px){.ms-Suggestions,.ms-Suggestions-none{width:370px!important}}.od-Share-PeoplePicker-Suggestions-Simplified-Share.isIE{width:448px!important}@media screen and (min-width:400px){.od-Share-PeoplePicker-Suggestions-Simplified-Share.isIE .ms-Suggestions,.od-Share-PeoplePicker-Suggestions-Simplified-Share.isIE .ms-Suggestions-none{width:448px!important}.od-Share-PeoplePicker-Suggestions-Simplified-Share.isIE .ms-Suggestions-container{max-height:135px!important}}.od-Share-PeoplePicker-Suggestions-Simplified-Share.isNotIE{width:432px!important}@media screen and (min-width:400px){.od-Share-PeoplePicker-Suggestions-Simplified-Share.isNotIE .ms-Suggestions,.od-Share-PeoplePicker-Suggestions-Simplified-Share.isNotIE .ms-Suggestions-none{width:432px!important}.od-Share-PeoplePicker-Suggestions-Simplified-Share.isNotIE .ms-Suggestions-container{max-height:135px!important}}.od-Share-PeoplePicker-Suggestions-Simplified-Share.inline .ms-Suggestions-spinner{position:static}.od-Share-PeoplePicker-Suggestions-Simplified-Share button.ms-SearchMore-button.is-selected{border:1px solid "},{theme:"black",defaultValue:"#000"},{rawString:"}@supports (font:-apple-system-body){.od-Share-PeoplePicker-Suggestions-Simplified-Share .ms-Persona-primaryText,.od-Share-PeoplePicker-Suggestions-Simplified-Share .ms-Persona-secondaryText{font:-apple-system-body}}.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container{max-height:200px;width:100%}@supports (font:-apple-system-body){.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container .ms-Suggestions-item,.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container button.ms-Suggestions-itemButton{font:-apple-system-body;height:auto}}.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container .ms-PeoplePicker-pickerPersona,.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container div.ms-PeoplePicker-personaContent{font:-apple-system-headline;height:auto}.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container .ms-Persona-details div.ms-Persona-primaryText{font:-apple-system-body}.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container .ms-Persona-details div.ms-Persona-secondaryText{font:-apple-system-caption1}.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container .ms-Persona-details div.ms-Persona-tertiaryText{font:-apple-system-caption1}.od-Share-PeoplePicker-Suggestions.od-Share-PeoplePicker-Suggestions-condensed .ms-Suggestions-container{max-height:150px}.od-Share-PeoplePicker-Suggestions button.ms-SearchMore-button{font-size:.75rem;height:2.5rem;font:-apple-system-caption1}.od-Share-PeoplePicker-Suggestions button.ms-SearchMore-button i.ms-Button-icon{font-size:1rem;width:1.5625rem;font:-apple-system-caption1}.od-Share-PeoplePicker-Suggestions button.ms-SearchMore-button span.ms-Button-label{font:-apple-system-caption1}.od-Share-PeoplePicker-Suggestions div.ms-Suggestions-none{font-size:.75rem;line-height:1.875rem}@supports (font:-apple-system-caption1){.od-Share-PeoplePicker-Suggestions div.ms-Suggestions-none{font:-apple-system-caption1;height:auto}}.od-Share-PeoplePicker-Suggestions div.ms-Suggestions-spinner{line-height:1.875rem}.od-Share-PeoplePicker-Suggestions div.ms-Suggestions-spinner div.ms-Spinner-circle{width:1.25rem;height:1.25rem}.od-Share-PeoplePicker-Suggestions div.ms-Suggestions-spinner div.ms-Spinner-label{font-size:.75rem}@supports (font:-apple-system-caption1){.od-Share-PeoplePicker-Suggestions div.ms-Suggestions-spinner div.ms-Spinner-label{font:-apple-system-caption1;height:auto}}.od-Share-PeoplePicker-error{font-size:.75rem;color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:";display:block;margin-bottom:4px;font:-apple-system-caption2}[dir=ltr] .od-Share-PeoplePicker-error .od-Share-PeoplePicker-error-changeTypeLink{margin-left:5px}[dir=rtl] .od-Share-PeoplePicker-error .od-Share-PeoplePicker-error-changeTypeLink{margin-right:5px}.od-Share-PeoplePicker-warning{word-break:break-word;font:-apple-system-caption2}.od-Share-PeoplePicker-warning .ms-MessageBar{display:block;padding:6px;box-sizing:border-box}.od-Share-PeoplePicker-warning .ms-MessageBar .ms-MessageBar-text{margin:0}.od-Share-PeoplePicker-warning .ms-MessageBar .ms-MessageBar-icon{margin:0 5px 0 0}[dir=rtl] .od-Share-PeoplePicker-warning .ms-MessageBar .ms-MessageBar-icon{margin:0 0 0 5px}.od-Share-PeoplePicker-selectedItem--error .ms-PickerPersona-container{border-style:solid;border-width:1px;color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:";border-color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:";background-color:RGBA("},{theme:"redDark",defaultValue:"#a4262c"},{rawString:", .06);font:-apple-system-caption2}.od-Share-PeoplePicker-selectedItem--warning .ms-PickerPersona-container{border-style:solid;border-width:1px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";border-color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";background-color:RGBA("},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:", .06);font:-apple-system-caption2}.od-Share-PeoplePicker-resolve-spinner{padding:3px}@media screen and (-ms-high-contrast:active){.od-Share-PeoplePicker-Suggestions .ms-Button.is-suggested .od-Share-PeoplePicker-Suggestions .ms-Persona .od-Share-PeoplePicker-Suggestions .ms-Persona-details .od-Share-PeoplePicker-Suggestions .ms-Persona-primaryText{color:HighlightText}}@media screen and (-ms-high-contrast:active){.od-Share-PeoplePicker-Suggestions .ms-Button:hover .od-Share-PeoplePicker-Suggestions .ms-Persona .od-Share-PeoplePicker-Suggestions .ms-Persona-details .od-Share-PeoplePicker-Suggestions .ms-Persona-primaryText{color:HighlightText}}@media screen and (-ms-high-contrast:active){.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-icon:hover,.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-secondaryText:hover,.od-Share-PeoplePicker-Suggestions .ms-PeoplePicker-personaContent:hover,.od-Share-PeoplePicker-Suggestions .ms-PeoplePicker-pickerPersona:hover,.od-Share-PeoplePicker-Suggestions .ms-Suggestions-item:hover{text-overflow:ellipsis;white-space:nowrap;font-weight:400;font-size:.75rem;color:highlighttext;forced-color-adjust:none}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-icon,.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-secondaryText,.od-Share-PeoplePicker-Suggestions .ms-PeoplePicker-personaContent,.od-Share-PeoplePicker-Suggestions .ms-PeoplePicker-pickerPersona,.od-Share-PeoplePicker-Suggestions .ms-Persona-secondaryText{color:inherit}}@media (forced-colors:active) and (prefers-color-scheme:dark){:-ms-input-placeholder{text-overflow:ellipsis;white-space:nowrap;font-weight:400;font-size:.75rem;color:#fff!important;forced-color-adjust:none}::placeholder{text-overflow:ellipsis;white-space:nowrap;font-weight:400;font-size:.75rem;color:#fff!important;forced-color-adjust:none}}@media (forced-colors:active) and (prefers-color-scheme:light){:-ms-input-placeholder{text-overflow:ellipsis;white-space:nowrap;font-weight:400;font-size:.75rem;color:#000!important;forced-color-adjust:none}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-icon,.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-secondaryText,::placeholder{text-overflow:ellipsis;white-space:nowrap;font-weight:400;font-size:.75rem;color:#000!important;forced-color-adjust:none}}.od-RoleSelectorCompact-permissionButton:focus{outline:1px solid}.od-Share-PeoplePicker-selectedItem--error{display:flex}.od-Share-PeoplePicker-height{height:auto}"}]);var o=n(74),s=n(80),c=n(485),d=n(75),l=n(323),u=n(61),f=n(14),p=n(56),m=n(13),_=n(47),h=n(19);(0,r.b)([{rawString:"@media screen and (-ms-high-contrast:active){.ms-Suggestions-itemButton.is-suggested .ms-PeoplePicker-personaContent .ms-Persona-primaryText,.ms-Suggestions-itemButton.is-suggested .ms-PeoplePicker-personaContent .ms-Persona-secondaryText,.ms-Suggestions-itemButton:hover .ms-PeoplePicker-personaContent .ms-Persona-primaryText,.ms-Suggestions-itemButton:hover .ms-PeoplePicker-personaContent .ms-Persona-secondaryText{color:HighlightText}}.ms-PickerPersona-container{position:relative;display:inline-flex;vertical-align:top;background:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:';margin:1px;vertical-align:top;white-space:nowrap;cursor:default;-webkit-user-select:none;-ms-user-select:none;user-select:none}.ms-PickerPersona-container::-moz-focus-inner{border:0}.ms-PickerPersona-container{outline:transparent}.ms-PickerPersona-container{position:relative}.ms-Fabric--isFocusVisible .ms-PickerPersona-container:focus:after{content:"";position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid '},{theme:"focusBorder",defaultValue:"#605e5c"},{rawString:"}.ms-PickerPersona-container:hover{background:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.ms-PickerPersona-container.is-selected{background:"},{theme:"neutralQuaternary",defaultValue:"#d2d0ce"},{rawString:"}.ms-PickerPersona-container.is-selected:hover{background:"},{theme:"neutralQuaternaryAlt",defaultValue:"#e1dfdd"},{rawString:"}.ms-PickerPersona-container.is-listbelow{width:100%}.ms-PickerItem-sideContent{display:inline-block}.ms-PickerPersona-content{flex:1;vertical-align:middle;min-width:100px}.ms-PeoplePicker-personaContent{min-width:100px;padding:7px 12px;display:flex;align-items:center}.od-PeoplePicker-linkedInLogo{color:#0077b5}.itemContent_d5c49a3e{flex:0 1 auto;min-width:0;max-width:100%;overflow:hidden}.itemContent_d5c49a3e>.fui-Persona{vertical-align:bottom}.peoplePickerPill_d5c49a3e{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";height:24px;border-radius:12px;display:inline-flex;align-items:center;margin:4px}.peoplePickerClose_d5c49a3e{border-radius:12px;height:24px;width:24px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}html[dir=ltr] .peoplePickerClose_d5c49a3e{padding-left:4px}html[dir=rtl] .peoplePickerClose_d5c49a3e{padding-right:4px}.peoplePickerClose_d5c49a3e:hover{background:"},{theme:"neutralQuaternaryAlt",defaultValue:"#e1dfdd"},{rawString:";border-radius:12px}.placeholderUser_d5c49a3e{background-color:unset;outline:1px dashed;outline-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.personDisplayName_d5c49a3e{white-space:nowrap}html[dir=ltr] .personDisplayName_d5c49a3e{padding-left:8px}html[dir=rtl] .personDisplayName_d5c49a3e{padding-right:8px}"}]);const b="itemContent_d5c49a3e",g="placeholderUser_d5c49a3e";var v,y,S=n(477),D=n(30),I=n(382),x=n(1),C=n(2);function O(e){var t,n;return!(!e.invitationId&&!(null===(n=null===(t=e.rawData||e.rawPersonData)||void 0===t?void 0:t.EntityData)||void 0===n?void 0:n.invitation))}(y=v||(v={}))[y.standalone=0]="standalone",y[y.pill=1]="pill";var w=n(31),E=D.a.isFeatureEnabled({ODC:"ToolTipEmailKillSwitch"})||x.a.isActivated("2f7a87f9150a4ef3b35a1ad82e402730","08/28/2021","ToolTipEmailKillSwitchActivated");function A(e,t,n){var a="3rem";if(t)switch(t){case d.c.size24:a="1.5rem";break;case d.c.size32:a="2rem";break;case d.c.size40:a="2.5rem";break;case d.c.extraSmall:a="1.75rem";break;default:a="3rem"}var r={text:e.name?e.name:"",imageUrl:e.image?e.image:"",tertiaryText:e.email?e.email:"",secondaryText:e.job?e.job:"",imageInitials:"",imageAlt:e.imageAlt,coinProps:{styles:{coin:{width:a,height:a,maxWidth:"75px",maxHeight:"75px",flexShrink:0},image:{width:a+"!important",height:a+"!important",maxWidth:"75px",maxHeight:"75px"},imageArea:{width:a,height:a,maxWidth:"75px",maxHeight:"75px"},initials:{width:a,height:a,fontSize:"0.625rem",lineHeight:a}}},styles:{root:{height:"auto"},primaryText:{height:"auto",whiteSpace:"normal",fontSize:"0.875rem"},secondaryText:{height:"auto",whiteSpace:"normal",fontSize:"0.75rem"}}};return O(e)&&void 0!==n?(0,I.default)(r,function(e,t){void 0===t&&(t={});var n=(0,C.D)(),a=t.fontSize;return{coinProps:{styles:{initials:e===v.standalone?{border:"1px dashed ".concat(n.palette.themePrimary),boxSizing:"border-box",fontSize:null!=a?a:"16px",fontWeight:"normal",color:n.palette.themePrimary}:{border:"none",boxSizing:"border-box",fontSize:null!=a?a:"12px",color:n.palette.themePrimary,paddingLeft:"4px",paddingRight:"4px"}}},initialsColor:d.a.transparent,onRenderInitials:function(){return i.createElement(m.a,{iconName:"Contact",style:{fontWeight:"normal"}})}}}(n)):r}var L=function(e){return i.createElement("div",{className:"ms-PeoplePicker-personaContent"},i.createElement(l.a,(0,a.a)({},e.personaProps,{presence:d.b.none,size:d.c.size40,className:"ms-PeoplePicker-pickerPersona"})),e.person.entityType===s.a.linkedinUser&&i.createElement(m.a,{className:"od-PeoplePicker-linkedInLogo",iconName:"LinkedInLogo"}))},k=function(e){var t,n=e.item,r=e.onRemoveItem,o=e.index,s=e.selected,c=e.removeButtonAriaLabel,m=A(n,d.c.extraSmall,v.pill);return E||(m.onRenderPrimaryText=function(){return i.createElement(u.a,{content:n.email||m.text,directionalHint:f.a.topLeftEdge},m.text)}),i.createElement("div",{className:(0,_.a)("ms-PickerPersona-container",(t={"is-selected":!!s},t[g]=O(n),t)),"data-is-focusable":!0,"data-selection-index":o,key:o,role:"listitem"},i.createElement("div",{className:(0,_.a)("ms-PickerItem-content",b)},i.createElement(l.a,(0,a.a)({},m,{presence:d.b.none,size:d.c.extraSmall}))),i.createElement(p.d,{styles:{root:{flexShrink:0}},onClick:r,iconProps:{iconName:"Cancel"},className:"ms-PickerItem-content","data-is-focusable":!0,"aria-label":null!=c?c:h.d(S.b,n.name),disabled:e.disabled}))},M=function(e){var t=e.item,n=e.onRemoveItem,r=e.index,o=e.selected,s=A(t,d.c.size40),c="PickerPersonaId"+Math.floor(1e4*Math.random()),u=h.d(S.b,t.name);return i.createElement("div",{className:(0,_.a)("ms-PickerPersona-container is-listbelow",{"is-selected":!!o}),"data-is-focusable":!0,"data-selection-index":r,key:r,"aria-labelledby":c,role:"listitem"},i.createElement("div",{className:"ms-PickerPersona-content"},i.createElement(l.a,(0,a.a)({id:c},s,{presence:d.b.none,size:d.c.size40}))),i.createElement("div",{className:"ms-PickerItem-content"},i.createElement(p.d,{onClick:n,iconProps:{iconName:"Cancel"},className:"ms-PickerItem-content","data-is-focusable":!0,"aria-label":u})))},P=function(e){var t,n=e.item,r=e.onRemoveItem,o=e.index,s=e.selected,c=e.removeButtonAriaLabel,m=A(n,d.c.extraSmall,v.pill),y=i.useRef(null),D=i.useRef(null);i.useEffect(function(){y.current&&D.current&&(y.current.style.animation="fadein 200ms",y.current.style.transition="height 200ms cubic-bezier(0.33,0.00,0.10,1.00)",y.current.style.height="".concat(D.current.scrollHeight,"px"),y.current.style.opacity="1")},[]);var I=n.email&&n.email!==m.text;return E||(m.onRenderPrimaryText=function(){return i.createElement(u.a,{content:i.createElement("div",null,i.createElement("div",null,m.text&&m.text),I&&i.createElement("div",null,n.email)),directionalHint:f.a.topLeftEdge},m.text)}),i.createElement("div",{className:(0,_.a)("ms-PickerPersona-container",(t={"is-selected":!!s},t[g]=O(n),t)),"data-is-focusable":!0,key:o,role:"listitem",ref:y},i.createElement("div",{ref:D,className:(0,_.a)("ms-PickerItem-content",b)},i.createElement(l.a,(0,a.a)({},m,{presence:d.b.none,size:d.c.extraSmall}))),i.createElement(p.d,{styles:{root:{flexShrink:0}},onClick:r,iconProps:{iconName:"Cancel"},className:"ms-PickerItem-content","data-is-focusable":!0,"aria-label":null!=c?c:h.d(S.b,n.name),disabled:e.disabled}))},T=n(480),U=n(484),F=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClick=function(e){t.props.inputProps&&t.props.inputProps.onClick&&t.props.inputProps.onClick(e),0!==e.button||e&&e.target&&e.target.value||t.onEmptyInputFocus()},t.onInputFocus=function(e){var n,a;x.b.isActivated("543f1508-f671-478a-9d8e-f38cf68393fd","04/19/2023","Respect the onEmptyResolveSuggestions prop passed to PeoplePicker")||t.props.showDefaultSuggestionOnlyByClick||e&&e.target&&e.target.value||!t.props.onEmptyResolveSuggestions||t.onEmptyInputFocus(),H()||null===(a=null===(n=t.props.inputProps)||void 0===n?void 0:n.onFocus)||void 0===a||a.call(n,e)},t}return(0,a.d)(t,e),t}(T.b);function H(){return x.b.isActivated("f7dc3d8b-8019-4187-9e11-6dcb2597352b")}var R,N=n(7),B=n(253),j=n(59),V=n(51),z=n(329),G=function(e){function t(){var n=e.call(this,t._Key,t._DataStoreCachingType)||this;if(n._MaxItems=200,n._Version=5,n._buffer=n.getValue(t._StorageKey),n._buffer&&n._buffer.version===n._Version&&n._buffer.lastCachePrune||n.initializeBuffer(),n._data={},Date.now()<n._buffer.lastCachePrune+6048e5)for(var a=0;a<n._buffer.dataArray.length;a++){var i=n._buffer.dataArray[a],r=n._getItemKey(i);n._data[r]=i}else n.initializeBuffer(),n.setValue(t._StorageKey,n._buffer);return n}return(0,a.d)(t,e),t.clear=function(){new j.a(t._Key,t._DataStoreCachingType).remove(t._StorageKey)},t.isCacheEntryFresh=function(e,t){return e.name===t.name&&e.email===t.email&&e.job===t.job&&e.office===t.office&&e.department===t.department&&e.phone===t.phone},t.prototype.setItem=function(e){var n=this._getItemKey(e),a=this._data[n];if(a){if(t.isCacheEntryFresh(a,e))return;var i=this._buffer.dataArray.map(function(e){return e.userId}).indexOf(e.userId);this._buffer.dataArray[i]=e}else if(this._buffer.dataArray.length===this._MaxItems){this._buffer.index++,this._buffer.index>=this._MaxItems&&(this._buffer.index=0);var r=this._buffer.dataArray[this._buffer.index],o=this._getItemKey(r);delete this._data[o],this._buffer.dataArray[this._buffer.index]=e}else this._buffer.dataArray.push(e),this._buffer.index++;this._data[n]=e,this.setValue(t._StorageKey,this._buffer)},t.prototype.getItems=function(e,t){for(var n=[],a=0;a<this._buffer.dataArray.length;a++){var i=(this._buffer.index-a+this._MaxItems)%this._MaxItems,r=this._buffer.dataArray[i];!(r.email&&r.email.toLowerCase().indexOf(e.toLowerCase())>=0||r.name&&r.name.toLowerCase().indexOf(e.toLowerCase())>=0)||t&&r.entityType===s.a.externalUser||n.push(r)}return n},t.prototype.containsItem=function(e){var t=this._getItemKey(e);return Boolean(this._data[t])},t.prototype.initializeBuffer=function(){this._buffer={},this._buffer.dataArray=[],this._buffer.index=-1,this._buffer.version=this._Version,this._buffer.lastCachePrune=Date.now()},t.prototype._getItemKey=function(e){return e.email||e.userId||(0,z.a)(JSON.stringify(e)).toString()},t._Key="ClientPeoplePicker",t._StorageKey="MRU",t._DataStoreCachingType=V.a.local,t}(j.a),K=function(){function e(e){this._dataSource=e.peoplePickerDataSource?e.peoplePickerDataSource:new B.a({imageAbsoluteWebUrl:e.imageAbsoluteWebUrl},{pageContext:e.pageContext,apiUrlHelper:e.apiUrlHelper,graphPeoplePickerHelper:e.graphPeoplePickerHelper}),this._ppCapabilities=this._dataSource.getCapabilities(),this._ppCapabilities.supportsMruCaching?(this._mruCache=new G,this.MaxCacheSuggestions=5):this.MaxCacheSuggestions=0}return e.prototype.search=function(e,t){var n,a,i=this,r={cached:null,promise:null};return this._mruCache&&!t.groupID&&(a=this.searchMruCache(e,t&&t.filterExternalUsers)).length>0&&(r.cached=a),r.promise=new N.c(function(r,o){n=i._dataSource.search(e,t).then(function(e){if(e)if(a){a.length>0&&(a=i._removeStaleCacheResults(a,e));var t=a.map(function(e){return e.userId});r(e.filter(function(e){return t.indexOf(e.userId)<0}))}else r(e)},function(e){o(e)})},function(){n&&n.cancel()}),r},e.prototype.resolve=function(e,t){var n=this;return this._dataSource.resolve(e,t).then(function(e){return n._mruCache&&e.isResolved&&n.addToMruCache(e),e})},e.prototype.getPersonaDetails=function(e){return this._dataSource.getPersonaDetails(e).then(function(e){return e})},e.prototype.subscribePresence=function(e,t){return this._dataSource.subscribePresence(e,t)},e.prototype.addToMruCache=function(e){var t=this._mruCache;t&&e.rawPersonData&&e.rawPersonData.EntityData&&"UNVALIDATED_EMAIL_ADDRESS"!==e.rawPersonData.EntityData.PrincipalType&&t.setItem(e)},e.prototype.getPickerEntityInformation=function(e){return this._dataSource.getPickerEntityInformation(e)},e.prototype.sharePointSearch=function(e,t){return this._dataSource.sharePointSearch(e,t).then(function(e){return e})},e.prototype.canUseGraph=function(e){return this._dataSource.canUseGraph(e)},e.prototype.canUseSubstrate=function(e){return this._dataSource.canUseSubstrate(e)},e.prototype.getLivePersonaPickerHelper=function(){return this._dataSource.getLivePersonaPickerHelper()},e.prototype.searchMruCache=function(e,t){var n=[],a=this._mruCache;if(a){n=a.getItems(e,t);var i=this.MaxCacheSuggestions;n.length>i&&(n=n.splice(0,i))}return n},e.prototype._removeStaleCacheResults=function(e,t){var n=e.map(function(e){return e.userId}),a=[];return t.forEach(function(t){var i=n.indexOf(t.userId);if(i>-1){var r=e[i];G.isCacheEntryFresh(r,t)&&a.push(r)}}),a},e}(),W=n(79);!function(e){e[e.normal=0]="normal",e[e.listBelow=1]="listBelow"}(R||(R={})),(0,r.b)([{rawString:":global(.ms-Suggestions){width:260px}"}]);var q,Q,Y=n(10),J=x.b.isActivated("41868B4D-8044-4ACF-8E89-CFD71EF69C3D","10/31/2021","fix people picker suggestion dup"),X=x.b.isActivated("381668a6-f583-4f93-98b1-28e1f592624a","06/14/2024","merge styles with base styles KS")||Y.a.isECSFeatureEnabled({ECS:1273844}),Z=F,$=T.a,ee=function(e){function t(t){var n=e.call(this,t)||this;if(n._onResolveSuggestions=function(e){if(n._peoplePickerSearchPromise&&(n._peoplePickerSearchPromise.cancel(),n._peoplePickerSearchPromise=void 0),!(e=e.trim())&&!n._canCallGraph)return n.props.onResolvedSuggestions?n.props.onResolvedSuggestions([],e):[];var t=n._getPeoplePickerQueryParams(),a=null==t?void 0:t.conversationId;t&&t.conversationId&&delete t.conversationId;var i="peoplePickerSearch_".concat(e.trim(),"_").concat(JSON.stringify(t));t&&a&&(t.conversationId=a);var r=function(){var a=n._dataProvider.search(e.trim(),t);if(!a)return n.props.onResolvedSuggestions?n.props.onResolvedSuggestions([],e):[];var i=a.cached?a.cached:[];return n._peoplePickerSearchPromise=a.promise,n._peoplePickerSearchPromise.then(function(e){return n._peoplePickerSearchPromise=void 0,e?i.concat(e):[]}).then(function(t){var a=J?t:n._dedupeSuggestions(t);return n.props.onResolvedSuggestions?n.props.onResolvedSuggestions(a,e):a})};if(!n.props.peoplePickerImprovementsExperiment||!n.props.persistCachePeopleSearch)return r().then(function(e){return n._callRumOneLoggerFromProps(),e});try{return n.props.persistCachePeopleSearch({getData:r,key:i}).then(function(e){var t=!isNaN(e.cacheStats.lastModified);return n._callRumOneLoggerFromProps(t),e.data})}catch(e){return r().then(function(e){return n._callRumOneLoggerFromProps(),e})}},n._callRumOneLoggerFromProps=function(e){void 0===e&&(e=!1),n.props.writeUserInputDataToRumoneLogger&&n.props.writeUserInputDataToRumoneLogger(e)},n._onGetMoreResults=function(e){var t;return n._onGetMoreResultsClicked&&n._onGetMoreResultsClicked(),n.props.peoplePickerQueryParams&&((t=(0,a.a)({},n.props.peoplePickerQueryParams)).useGraph=!1,t.useSubstrate=!1),n._dataProvider&&n._dataProvider.sharePointSearch&&t?n._dataProvider.sharePointSearch(e,t).then(function(t){if(n.props.onResolvedSuggestions){var a=n.props.onResolvedSuggestions(t,e);if(a instanceof Array)return a}return t}):[]},n._mergeStylesWithBasePicker=function(e){var t=(0,U.a)(e);return(0,C.u)(t,n.props.pickerOverrideStyles)},t.dataProvider)n._dataProvider=t.dataProvider;else{if(!t.context)throw new Error("No pageContext available for PeoplePickerProvider.");n._dataProvider=new K({pageContext:t.context,peoplePickerDataSource:t.dataSource})}return n._canCallGraph=!!(n._dataProvider.canUseGraph&&n.props.peoplePickerQueryParams&&n._dataProvider.canUseGraph(n.props.peoplePickerQueryParams)),n._handleGetMoreResultsInBaseClass=n._canCallGraph&&!n.props.onGetMoreResults,n.state={hasUnresolvedText:!1,searchForMoreText:n._getSearchForMoreText(n._handleGetMoreResultsInBaseClass)},n}return(0,a.d)(t,e),Object.defineProperty(t.prototype,"selectedPeople",{get:function(){return this._peoplePicker&&this._peoplePicker.items||[]},enumerable:!1,configurable:!0}),t.prototype.render=function(){var e=this,t=this.props,n=t.className,r=t.onRenderItem,o=t.onRenderSuggestionsItem,s=t.defaultSelectedItems,c=t.onSelectedPersonasChange,l=t.suggestionsHeaderText,u=t.suggestionsClassName,f=t.suggestionsItemClassName,p=t.noResultsFoundText,m=t.loadingText,_=t.inputProps,h=t.onSuggestionSelected,b=t.suggestionsAvailableAlertText,g=t.enableSelectedSuggestionAlert,y=t.selectedItems,D=t.itemLimit,I=t.onInputChange,x=t.onGetMoreResults,O=t.searchForMoreIcon,E=t.searchForMoreText,P=t.ariaLabel,T=void 0===P?"":P,U=t.pickerCalloutProps,F=t.mergeStyles,H=t.pickerOverrideStyles,N=t.theme,B=t.disabled,j=t.onGetMoreResultsClicked,V=t.removeButtonAriaLabel,z=t.onEmptyResolveSuggestions,G=t.customizeSuggestionPersonaProps,K=t.showDefaultSuggestionOnlyByClick;this._onGetMoreResultsClicked=j;var W={className:n,onRenderSuggestionsItem:o||function(e){return function(e,t){var n,a=A(e,d.c.size40,v.standalone);if(n=a,t&&(n=t(a)),n&&n.imageUrl){var r=new w.a(n.imageUrl);r.setQueryParameter("fromPeoplePicker","true"),n.imageUrl=r.toString()}return i.createElement(L,{person:e,personaProps:n})}(e,G)},onResolveSuggestions:this._onResolveSuggestions,defaultSelectedItems:s,selectedItems:y,onChange:c,inputProps:_,enableSelectedSuggestionAlert:g,theme:N||(!X&&F?(0,C.D)():void 0),pickerSuggestionsProps:{suggestionsHeaderText:l,loadingText:m,noResultsFoundText:p,className:u,suggestionsItemClassName:f,suggestionsAvailableAlertText:b,searchForMoreIcon:O,searchForMoreText:E||(this._handleGetMoreResultsInBaseClass?this.state.searchForMoreText:void 0),suggestionsContainerAriaLabel:S.a},onItemSelected:h,itemLimit:D,onInputChange:I,onGetMoreResults:x||(this._handleGetMoreResultsInBaseClass?this._onGetMoreResults:void 0),pickerCalloutProps:U,styles:!X&&F?this._mergeStylesWithBasePicker:H,"aria-label":T,disabled:B,removeButtonAriaLabel:V,onEmptyResolveSuggestions:K&&this._canCallGraph?function(){return e.props.initRumone&&e.props.initRumone("",!0),e._onResolveSuggestions("")}:z,showDefaultSuggestionOnlyByClick:K};return this.props.peoplePickerType===R.listBelow?(W.onRenderItem=r||M,i.createElement($,(0,a.a)({},W,{componentRef:this._resolveRef("_peoplePicker")}))):(W.onRenderItem=r||k,i.createElement(Z,(0,a.a)({},W,{componentRef:this._resolveRef("_peoplePicker")})))},t.prototype.focusInput=function(){this._peoplePicker&&this._peoplePicker.focusInput()},t.prototype._getPeoplePickerQueryParams=function(){return this.props.peoplePickerQueryParams?(!this.props.peoplePickerQueryParams.onToggleGetMoreResults&&this._handleGetMoreResultsInBaseClass&&(this.props.peoplePickerQueryParams.onToggleGetMoreResults=this._onToggleGetMoreResults),this.props.peoplePickerQueryParams):{allowEmailAddresses:!1,groupID:0,maximumEntitySuggestions:30,principalSource:15,blockExternalUsers:!0,principalType:W.a.user|W.a.securityGroup|W.a.sharePointGroup}},t.prototype._dedupeSuggestions=function(e){var t=this,n=[],i=this._peoplePicker&&this._peoplePicker.items||[];i=(0,a.g)([],i,!0);for(var r=function(e){var a=o._getItemKey(e);i.some(function(e){var n=t._getItemKey(e);return a===n})||(n.push(e),i.push(e))},o=this,s=0,c=e;s<c.length;s++)r(c[s]);return n},t.prototype._getItemKey=function(e){return e.email||e.userId||(0,z.a)(JSON.stringify(e)).toString()},t.prototype._onToggleGetMoreResults=function(e){this.state&&(e&&!this.state.searchForMoreText||!e&&this.state.searchForMoreText)&&this.setState({searchForMoreText:this._getSearchForMoreText(e)})},t.prototype._getSearchForMoreText=function(e){return e?S.c:void 0},t}(o.a),te=n(41),ne=n(39),ae=n(181),ie=n("prop-types-lib"),re=n(20),oe=n(55),se=n(71),ce=n(100),de=n(38),le=n(136),ue=n(192),fe=n(21),pe=n(112),me=n(330),_e=n(24),he=n(303),be=n(122),ge=n(72),ve=n(478),ye=n(277),Se=n(327),De=n(127);!function(e){e[e.None=0]="None",e[e.Family=1]="Family",e[e.FamilyMember=2]="FamilyMember"}(q||(q={})),(Q=document.createElement("style")).innerHTML="\n  @media screen and (-ms-high-contrast: active) {\n    .ms-Button-flexContainer:hover {\n      font-size: inherit !important;\n      color: inherit !important;\n      forced-color-adjust: none;\n    }\n  }\n  ",document.head.insertAdjacentElement("beforeend",Q);var Ie="peoplepicker",xe=function(e){function t(t,n){var r=e.call(this,t)||this;return r._inputs=[],r._onItemsChange=function(e){var t=r.state.selectedItems.concat(e);r.setState({selectedItems:t},function(){r.props.onChange(t)}),e.forEach(function(e){r._onAutoResolve(e)})},r._initRumone=function(e,t){void 0===t&&(t=!1),(!r._inputStartTime&&!t&&e.length>1||!r._inputStartTime&&t&&0===e.length)&&(r._inputStartTime=Date.now(),r._rumoneLogger||(r._rumoneLogger=new he.a(Ie)),r._rumoneLogger.resetRumOneApiMeasurement(),r._rumoneLogger.resetRumOne(),be.a.getRUMOneLogger({name:Ie}).startAPIMeasurement({ignore:function(e){return e.indexOf("/Collector/3.0/")>=0},getAPIName:function(e){var t=e.toLowerCase();return-1!==t.indexOf("graph.microsoft.com/v1.0/me/people")&&-1!==t.indexOf("search")?"GraphSearch":-1!==t.indexOf("/sp.ui.applicationpages.clientpeoplepickerwebserviceinterface.clientpeoplepickersearchuser")?"SPClientPeoplePickerSearchUser":-1!==t.indexOf("https://outlook.office.com/search/api/v1/suggestions")?"SubstrateSearch":void 0}}))},r._onInputChange=function(e){if(r._inputs.push(e),r._initRumone(e),r._hasTakenErrorFocus=!1,e&&e.indexOf(";")>-1){var t=e.split(";").map(function(e){var t=/<[^\]]*>/g.exec(e);if(t&&t[0]&&(e=t[0].substring(1,t[0].length-1)),e=e.trim())return r._createGenericPerson(e)}).filter(function(e){return e});return r._onItemsChange(t),r.props.onInputChange&&r.props.onInputChange(""),""}var n=/['"].*['"]/g.exec(e);return n&&n[0]?n[0].substring(1,n[0].length-1):(r.props.onInputChange&&r.props.onInputChange(e),e)},r._onGetMoreResults=function(e){var t=r.props.pickerSettings,n={principalSource:t.PrincipalSource,principalType:r._convertPrincipalType(t.PrincipalAccountType),querySettings:t.QuerySettings,allowEmailAddresses:!!fe.yb()||t.AllowEmailAddresses,filterExternalUsers:!1,maximumEntitySuggestions:30,useSubstrateSearch:!1,allowSharePointGroups:!fe._()&&!!r.props.allowSPGroups||r._showSimplifiedDialogV2,forceResolve:!0,useSubstrate:!!r.props.sharingInformation.enforceIBSegmentFiltering,siteIBSegmentIDs:r.props.sharingInformation.siteIBSegmentIDs};return fe.K()?r._peoplePickerProvider.sharePointSearch(e,n):r._peoplePickerProvider.sharePointSearch(e,n).then(function(e){return e.filter(function(e){return 0===r.state.selectedItems.filter(function(t){return t.email===e.email}).length})})},r._onSuggestionSelected=function(e){var t=r.props.pickerSettings,n={principalSource:t.PrincipalSource,principalType:r._convertPrincipalType(t.PrincipalAccountType),querySettings:t.QuerySettings,allowEmailAddresses:t.AllowEmailAddresses,filterExternalUsers:!1,maximumEntitySuggestions:30,allowSharePointGroups:r._showSimplifiedDialogV2,forceResolve:!0};if(r._store.getEngagementHelper().log("PeoplePicker.SuggestionSelected",{clientId:r.props.clientId,mode:te.a.share,detailedGroupInfo:e.detailedGroupInfo,principalType:void 0===e.principalType?"unknown":W.a[e.principalType],entityType:void 0===e.entityType?"unknown":s.a[e.entityType],isDefaultSuggestion:!/\S/.test(r._inputs.join(""))}),fe.P()&&oe.s(r.props.clientId)){var a=r._store.getFamily(),i=r._store.getFamilyMembers();a&&i&&(e.userId===a.userId?r._store.getEngagementHelper().log("PeoplePicker.FamilyGroupSelected",{clientId:r.props.clientId,scenarioId:"",familySuggestionType:q[r.state.familyType],mode:te.a.share}):i.some(function(t){return t.userId===e.userId})&&r._store.getEngagementHelper().log("PeoplePicker.FamilyMemberSelected",{clientId:r.props.clientId,scenarioId:"",familySuggestionType:q[r.state.familyType],mode:te.a.share}))}if(!1===e.isExternal||e.isExternal&&e.providerName)return e;e.principalType===W.a.distributionList&&(n.isGraphDistributionList=!0,n.useGraph=!0);var o=(0,le.j)(e),c=(0,le.h)(e);return!e.isResolved||o?r._peoplePickerProvider.resolve(e.userId,n).then(function(t){return!t.email&&t.rawData&&t.rawData.EntityData&&(t.email=t.rawData.EntityData.OtherMails),!t.name&&t.rawData&&t.rawData.EntityData&&(t.name=t.rawData.EntityData.OtherMails),e.entityType===s.a.linkedinUser&&(t.entityType=e.entityType),void 0===t.isExternal&&(o||c)&&(t.isExternal=!0),t}):e},r._onRenderItem=function(e){var t=r.props.permissionsMap,n=r._computeAllowExternalUsers(r.props.sharingLinkKind,r.props.sharingInformation.canAddExternalPrincipal,e.item),o=!r._showSimplifiedDialogV2||r.props.shareTargetClicked===_e.f.copy,s=!r._showSimplifiedDialog&&r.props.sharingLinkKind===ne.a.direct&&t&&(void 0!==t[e.item.email]&&t[e.item.email]===ae.a.none||void 0!==t[e.item.userId]&&t[e.item.userId]===ae.a.none),c=o&&e.item.isExternal&&!n,d=!r._showSimplifiedDialogV2&&c||o&&s||!e.item.isResolved&&!e.item.isResolving,l=e.item.isExternal,u=e.item.name;if(e.removeButtonAriaLabel=h.d(re.ii,u),e.item.imageAlt=h.d(re.Gk,u),d||l){var f=d?"--error":l?"--warning":"";return i.createElement("div",{className:"od-Share-PeoplePicker-selectedItem".concat(f)},r._showSimplifiedDialog?i.createElement(P,(0,a.a)({},e)):i.createElement(k,(0,a.a)({},e)))}return e.item.isResolving?i.createElement(ce.a,{className:"od-Share-PeoplePicker-resolve-spinner"}):r._showSimplifiedDialog?i.createElement(P,(0,a.a)({},e)):i.createElement(k,(0,a.a)({},e))},r._onToggleGetMoreResults=function(e){fe.K()?r.state&&(e&&!r.state.searchForMoreText||!e&&r.state.searchForMoreText)&&r.setState({searchForMoreText:r._getSearchForMoreText(e)}):r.setState({searchForMoreText:r._getSearchForMoreText(r.props.sharingInformation.isGraphAvailable||e)})},r._writeUserInputDataToRumoneLogger=function(e){if(void 0===e&&(e=!1),r._rumoneLogger){var t=r._rumoneLogger.breakdownData,n={modeName:"peoplePicker",startTime:r._inputStartTime,endTime:Date.now(),breakDownData:{customerInputs:t(r._inputs.length),isSearchFromCache:e}};r._rumoneLogger.logSharingPerformance(n)}r._inputs=[],r._inputStartTime=null},r._peoplePickerProvider=n.peoplePickerProvider,r._resize=n.resize,r._platformDetection=n.platformDetection,r._hasTakenErrorFocus=!1,r._store=n.sharingStore,r._clientId=n.clientId,r._rumoneLogger=null,r._sharingClientMessenger=n.sharingClientMessenger,r._persistentRequestCache=new ve.a({id:"PeoplePickerSearch"},{pageContext:n}),r._showSimplifiedDialogV1=(0,_e.nb)(r._clientId,r._store)&&r.props.mode===te.a.share,r._showSimplifiedDialogV2=(0,_e.tb)(r._clientId,r._store)&&r.props.mode===te.a.share,r._showSimplifiedDialog=r._showSimplifiedDialogV1||r._showSimplifiedDialogV2,r.state={selectedItems:t.defaultSelectedItems,searchForMoreText:r._getSearchForMoreText(t.sharingInformation.isGraphAvailable),addedUsers:[],removedUsers:[],familyType:q.None,familyResolveEventFired:!1,previousUsers:[]},r._resizeTracker=new ue.a(n.resize),r._peoplePickerControl=i.createRef(),r}return(0,a.d)(t,e),t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=e.defaultSelectedItems,n=this.props.defaultSelectedItems,a=[];n.forEach(function(e){var n=t.filter(function(t){return t.name===e.name});n.length>0&&a.push({name:n[0].name,userId:n[0].userId})}),this.setState({selectedItems:t,addedUsers:a})},t.prototype.componentDidUpdate=function(e,t){var n,a,i,r,o,s,c=this;this._peoplePicker.scrollTop=this._peoplePicker.scrollHeight;var d=t.addedUsers,l=this.state.addedUsers,u=this.state.removedUsers;(null===(n=e.defaultSelectedItems)||void 0===n?void 0:n.length)!==(null===(a=this.props.defaultSelectedItems)||void 0===a?void 0:a.length)&&this.setState({previousUsers:e.defaultSelectedItems}),this._showSimplifiedDialog&&(null===(i=this._peoplePicker)||void 0===i?void 0:i.scrollHeight)&&this._peoplePicker.scrollHeight!==this.props.height&&this.props.setHeight&&((null===(r=this.state.previousUsers)||void 0===r?void 0:r.length)>this.props.defaultSelectedItems.length?this.props.setHeight(null===(o=this._peoplePicker)||void 0===o?void 0:o.scrollHeight):this.props.setHeight("auto"));var f=this._showSimplifiedDialog?200:0;this._resizeTracker?setTimeout(function(){c._resizeTracker.checkSizeChange(c._peoplePicker)},f):(this._showSimplifiedDialog||null!==this.props.error&&null===e.error)&&setTimeout(function(){c._resize()},f);var p=!1;d.length>l.length?(u=d.filter(function(e){return-1===l.indexOf(e)}),this.setState({removedUsers:u}),p=!0):d.length!==l.length&&u.length>0&&(this.setState({removedUsers:[]}),p=!0);var m=this._platformDetection&&this._platformDetection.isIE;(this._peoplePickerControl&&(!m||this._showSimplifiedDialog)&&this.props.error&&!this._hasTakenErrorFocus||p||this.props.focusPeoplePicker)&&(null===(s=this._peoplePickerControl.current)||void 0===s||s.focusInput(),this.props.error&&(this._hasTakenErrorFocus=!0))},t.prototype.componentDidMount=function(){var e,t=this._platformDetection&&this._platformDetection.isIE;!this._peoplePickerControl||t&&!this._showSimplifiedDialog||null===(e=this._peoplePickerControl.current)||void 0===e||e.focusInput()},t.prototype.render=function(){var e,t,n=this,r={placeholder:this._computePlaceholderText(),autoFocus:!0,onFocus:function(e){n._onFocus()},onBlur:function(e){n._onBlur()},"aria-label":this._computePlaceholderText()},o=this.props.pickerSettings,s=!!this.props.sharingInformation.enforceIBSegmentFiltering,c={principalSource:o.PrincipalSource,principalType:this._convertPrincipalType(o.PrincipalAccountType),querySettings:o.QuerySettings,allowEmailAddresses:!!fe.yb()||o.AllowEmailAddresses,filterExternalUsers:!1,maximumEntitySuggestions:30,useSubstrateSearch:o.UseSubstrateSearch,allowSharePointGroups:!!this.props.allowSPGroups,forceResolve:!0,useGraph:!this.props.disableGraph,useSubstrate:s,onToggleGetMoreResults:this._onToggleGetMoreResults,conversationId:de.a.generate(),siteIBSegmentIDs:this.props.sharingInformation.siteIBSegmentIDs,siteIBMode:this.props.sharingInformation.siteIBMode,useNew3Ssearch:o.useNew3Ssearch,enforceIBSegmentFiltering:s},d=this.state.selectedItems.length>0&&"smaller-padding",l=(null===(e=this._platformDetection)||void 0===e?void 0:e.isIE)&&"isIE ".concat(0===this.state.selectedItems.length&&"initial-padding"),u=this.props.renderIcon?"withIcon":"",f=this.props.error&&!this._showSimplifiedDialog?"od-Share-PeoplePicker ms-Share-PeoplePicker--error "+u:this._showSimplifiedDialog?"od-Simplified-Share-PeoplePicker ".concat(l," ").concat(d)+u:"od-Share-PeoplePicker "+u;f+=" inline";var p=oe.g(this.props.clientId)||this._platformDetection&&this._platformDetection.isMobile,_={preventDismissOnScroll:p,preventDismissOnResize:!0};this._showSimplifiedDialog&&(_.target=this.props.peoplePickerRef,_.doNotLayer=!0,_.styles={root:(0,a.a)({left:"0 !important"},{top:"".concat(Math.min((null===(t=this._peoplePicker)||void 0===t?void 0:t.scrollHeight)+2,126),"px !important")})});var h,b=p?re.xd:re.Cd,g=this.props.roleSelectorProps&&this.props.roleSelectorProps.roleSelectorAs,v=document.body,y=v?parseInt(getComputedStyle(v).fontSize,10):null;!(y&&y>16)||this._platformDetection&&this._platformDetection.isIE||(h={flexWrap:"wrap"}),this._showSimplifiedDialog&&(h=(0,a.a)((0,a.a)({},h),{width:"100%",height:this.props.height&&this.props.height,transition:"height 200ms cubic-bezier(.33, 0, .1, 1)"}));var S="od-Share-PeoplePicker-Suggestions".concat(this._peoplePickerProvider&&this._peoplePickerProvider.sharePointSearch?" od-Share-PeoplePicker-Suggestions-condensed":"");return this._showSimplifiedDialog&&(S="od-Share-PeoplePicker-Suggestions-Simplified-Share ".concat(this._platformDetection.isIE?"isIE":"isNotIE"," od-Share-PeoplePicker-Suggestions-condensed")),S+=" inline",i.createElement("div",{style:h,ref:this.props.peoplePickerRef},i.createElement("div",{id:"od-Share-PeoplePicker-wrapper-id",role:"presentation",className:this._showSimplifiedDialog?"od-Share-PeoplePicker-height":void 0},pe.a(this._computePeopleAddOrRemoveMessage(),"assertive","alert",!0),i.createElement("div",{className:this._showSimplifiedDialog?"od-Share-PeoplePicker-flexGrow ".concat(this.props.renderIcon?"normal":"space-between"):"od-Share-PeoplePickerContainer ".concat(this.props.renderIcon?"normal":"space-between")},this.props.renderIcon&&i.createElement(m.a,{className:"od-Share-PeoplePicker-PeoplePickerIcon",iconName:"CirclePlus"}),i.createElement("div",{className:"od-Share-PeoplePicker-wrapper",ref:function(e){n._peoplePicker=e}},i.createElement(ee,{"aria-describedby":"inputErrorMessage",componentRef:function(e){n._peoplePickerControl.current=e},className:f,dataProvider:this._peoplePickerProvider,selectedItems:this.state.selectedItems,inputProps:r,loadingText:re.Ce,noResultsFoundText:re.ff,onSelectedPersonasChange:this.props.onChange,peoplePickerQueryParams:c,suggestionsClassName:S,onRenderItem:this._onRenderItem,onSuggestionSelected:this._onSuggestionSelected,onResolvedSuggestions:this._onResolvedSuggestions.bind(this),itemLimit:this.props.selectionLimit,onInputChange:this._onInputChange,onRenderSuggestionsItem:this._store&&this._store.showEmailsInSuggestions()?this._onRenderSuggestionsItem:null,customizeSuggestionPersonaProps:this._customizeSuggestionsItem,onGetMoreResults:this._peoplePickerProvider&&this._peoplePickerProvider.sharePointSearch?this._onGetMoreResults:null,searchForMoreText:this._peoplePickerProvider&&this._peoplePickerProvider.sharePointSearch?this.state.searchForMoreText:null,suggestionsAvailableAlertText:b,enableSelectedSuggestionAlert:this._platformDetection&&this._platformDetection.isIE,role:"presentation",pickerCalloutProps:_,peoplePickerImprovementsExperiment:!!ge.d(),persistCachePeopleSearch:function(e){var t=n._persistentRequestCache.getRequestKey(e.key,"POST");return n._persistentRequestCache.getDataUtilizingCache({cachingStrategy:Se.a.useCacheIfNotExpired,cacheTimeoutTime:ye.a,cacheRequestKey:t,getData:e.getData,returnStatistics:!0})},writeUserInputDataToRumoneLogger:this._writeUserInputDataToRumoneLogger,initRumone:this._initRumone,showDefaultSuggestionOnlyByClick:!0})),this.props.renderRoleSelector&&i.createElement("div",{className:"od-Share-PeoplePicker-RoleSelector"},i.createElement(g,(0,a.a)({},this.props.roleSelectorProps)))),!this._showSimplifiedDialog&&i.createElement("div",{className:"od-Share-PeoplePickerContainer"},i.createElement("div",{id:"inputErrorMessage",className:"od-Share-PeoplePicker-ErrorWarnings-wrapper"},this._renderError(),this._renderWarnings()))))},t.prototype._onResolvedSuggestions=function(e,t){var n=this;if((fe.P()||(0,De.d)()&&fe.O())&&oe.s(this.props.clientId)){var a=this._store.getFamily(),i=this._store.getFamilyMembers();if(a&&t.length>1){var r=0===re.wd.toLocaleLowerCase().indexOf(t.toLocaleLowerCase()),o=!1,s=q.None;r?(s=q.Family,o=!0,e=[a].concat(i,e)):(e.forEach(function(t,n){i.forEach(function(i){(!o&&t.userId===i.userId||t.email===i.email)&&(e.splice(n+1,0,a),o=!0)})}),o&&(s=q.FamilyMember)),this.setState({familyType:s}),o&&!this.state.familyResolveEventFired&&(this.setState({familyResolveEventFired:!0}),this._store.getEngagementHelper().log("PeoplePicker.FamilyGroupResolved",{clientId:this.props.clientId,scenarioId:"",mode:te.a.share,familySuggestionType:q[s]}))}}var c=[],d=[this._store.getCurrentUserId()],l=[];e.forEach(function(e){(0,_e.$)(e.image,n._clientId)&&(e.image=void 0),-1===d.indexOf(e.userId)&&-1===c.indexOf(e.email)&&(n.state.addedUsers.some(function(t){return t.name===e.name&&t.userId===e.userId})||l.push(e),e.userId&&d.push(e.userId),e.email&&c.push(e.email))});try{return this.props.onResolvedSuggestions(l)}catch(e){return l}},t.prototype._createGenericPerson=function(e){return{userId:e,name:e,email:e,isResolving:!0}},t.prototype._customizeSuggestionsItem=function(e){return(0,a.a)((0,a.a)({},e),{"aria-label":"".concat(e.text," ").concat(e.secondaryText)})},t.prototype._onRenderSuggestionsItem=function(e){var t=e.email&&e.email!==e.name?e.email:"";fe.Yb()&&(t=e.email||"");var n={text:e.name||"",imageUrl:e.image||"",tertiaryText:e.email&&e.email!==e.name?e.email:"",secondaryText:t,imageInitials:"",imageAlt:e.imageAlt,coinProps:{styles:{coin:{width:"2.5rem",height:"2.5rem",maxWidth:"75px",maxHeight:"75px"},image:{width:"2.5rem !important",height:"2.5rem !important",maxWidth:"75px",maxHeight:"75px"},imageArea:{width:"2.5rem",height:"2.5rem",maxWidth:"75px",maxHeight:"75px"}}},styles:{root:{height:"2.5rem"},primaryText:{fontSize:"0.875rem"},secondaryText:{fontSize:"0.75rem"}}};return n["aria-label"]="".concat(n.text," ").concat(n.secondaryText),i.createElement("div",{className:"ms-PeoplePicker-personaContent"},i.createElement(l.a,(0,a.a)({},n,{presence:d.b.none,size:d.c.size40,className:"ms-PeoplePicker-pickerPersona"})),e.entityType===s.a.linkedinUser&&i.createElement(m.a,{className:"od-PeoplePicker-linkedInLogo",iconName:"LinkedInLogo"}))},t.prototype._onAutoResolve=function(e){var t=this,n=this.props.pickerSettings,i={principalSource:n.PrincipalSource,principalType:this._convertPrincipalType(n.PrincipalAccountType),querySettings:n.QuerySettings,allowEmailAddresses:n.AllowEmailAddresses,filterExternalUsers:!1,maximumEntitySuggestions:30,allowSharePointGroups:this._showSimplifiedDialogV2,forceResolve:!0};this._peoplePickerProvider.resolve(e.email,i).then(function(n){!n.email&&n.rawData&&n.rawData.EntityData&&(n.email=n.rawData.EntityData.OtherMails),!n.name&&n.rawData&&n.rawData.EntityData&&(n.name=n.rawData.EntityData.OtherMails);var a=[];t.state.selectedItems.forEach(function(t){t.email===e.email?a.push(n):a.push(t)}),t.setState({selectedItems:a},function(){t.props.onChange(a)})}).catch(function(){var n=(0,a.a)((0,a.a)({},e),{isResolving:!1}),i=[];t.state.selectedItems.forEach(function(t){t.email===e.email?i.push(n):i.push(t)}),t.setState({selectedItems:i},function(){t.props.onChange(i)})})},t.prototype._isResolveInProgress=function(){for(var e=0,t=this.state.selectedItems;e<t.length;e++)if(t[e].isResolving)return!0;return!1},t.prototype._computePlaceholderText=function(){return this.props.inputTextPlaceholder&&this.props.inputTextPlaceholder.length>0?this.props.inputTextPlaceholder:0===this.props.defaultSelectedItems.length?re.Gg:re.zg},t.prototype._computePeopleAddOrRemoveMessage=function(){var e=this.state.previousUsers,t=this.props.defaultSelectedItems,n=function(e,t){var n={};e.map(function(e){return n[e.email]?n:n[e.email]=e}),t.map(function(e){return n[e.email]?n:n[e.email]=e});var a={};e.map(function(e){return a[e.email]=a[e.email]?a[e.email]+1:1});var i=t.filter(function(e){return!a[e.email]||(a[e.email]=a[e.email]-1,!1)});return Object.keys(a).forEach(function(e){for(;a[e];)i.push(n[e]),a[e]=a[e]-1}),i};if((null==e?void 0:e.length)>(null==t?void 0:t.length)){var a=n(e,t);return(i=[]).push(a.map(function(e){return h.d(re.jg,e.name)})),i.length>0?i.join(", "):""}if(null==t?void 0:t.length){var i,r=n(t,e);return(i=[]).push(r.map(function(e){return h.d(re.Bg,e.name)})),i.length>0?"".concat(i.join(", "),". ").concat(re.zg):""}},t.prototype._convertPrincipalType=function(e){if(!e)return W.a.none;for(var t=W.a.none,n=0,a=e.split(",");n<a.length;n++){var i=a[n];"User"===i&&(t|=W.a.user),"DL"===i&&(t|=W.a.distributionList),"SecGroup"===i&&(t|=W.a.securityGroup),"SPGroup"===i&&(t|=W.a.sharePointGroup)}return t},t.prototype._computeAllowExternalUsers=function(e,t,n){var a=e===ne.a.organizationView,i=e===ne.a.organizationEdit,r=a||i,o=!t&&(0,le.h)(n);return!r&&(t||o)},t.prototype._renderError=function(){var e,t=this.props.error;if(t&&!this._isResolveInProgress()){this._peoplePickerControl&&!this._hasTakenErrorFocus&&(null===(e=this._peoplePickerControl.current)||void 0===e||e.focusInput(),this._hasTakenErrorFocus=!0);var n={error:t};return i.createElement(me.a,{messages:[n],backgroundColor:"#FDE7E9",className:"od-Simplified-Share-PeoplePickerErrorIcon",iconName:"Blocked2",textColorType:"error"})}},t.prototype._renderWarnings=function(){var e=this.props.oversharingExternalsWarning,t=this.props.oversharingGroupsWarning,n=[],a={icon:{fontSize:"1rem",minWidth:"1rem",minHeight:"1rem"},text:{fontSize:"0.75rem",lineHeight:"1rem"},innerText:{lineHeight:"1rem"}};if(!this.props.error)return this.state.selectedItems.length===this.props.selectionLimit&&n.push(i.createElement(c.a,{ariaLabel:re.Ng,styles:a},re.Ng)),e&&n.push(i.createElement(c.a,{ariaLabel:e,styles:a},e)),t&&n.push(i.createElement(c.a,{ariaLabel:t,styles:a},t)),n.length>0?i.createElement("div",{"aria-live":"assertive",role:"status",className:"od-Share-PeoplePicker-warning"},n):void 0},t.prototype._getSearchForMoreText=function(e){return e?re.wi:void 0},t.prototype._onFocus=function(){this._sharingClientMessenger?this._sharingClientMessenger.sendPeoplePickerFocused():se.s(),this.props.setPeoplePickerFocused&&this.props.setPeoplePickerFocused(!0)},t.prototype._onBlur=function(){this.props.setPeoplePickerFocused&&this.props.setPeoplePickerFocused(!1)},t.contextTypes={peoplePickerProvider:ie.object.isRequired,resize:ie.func.isRequired,platformDetection:ie.object.isRequired,sharingStore:ie.object.isRequired,clientId:ie.number.isRequired,sharingClientMessenger:ie.object},t}(o.a),Ce=function(e){function t(t){var n=e.call(this,t)||this;return n.state={hasError:!1},n}return(0,a.d)(t,e),t.getDerivedStateFromError=function(e){return{hasError:!0}},t.prototype.render=function(){return this.state.hasError?this.props.fallback?this.props.fallback:null:i.createElement(i.Fragment,null,this.props.children)},t.prototype.componentDidCatch=function(e,t){this.props.onError&&this.props.onError(e,t)},t}(i.PureComponent),Oe=n(78),we=n(35),Ee=n(200);function Ae(e){e.onError;var t=e.componentName,n=(0,Ee.a)(function(e,n){Oe.a.logError(e,{"react.componentStack":n.componentStack,"react.component":t},{eventName:"ReactRenderError",resultCode:"",resultType:we.a.Failure})});return i.createElement(Ce,(0,a.a)({},e,{onError:n}))}var Le=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.d)(t,e),t.prototype.render=function(){return i.createElement(Ae,{componentName:"peoplePicker.peoplePickerWrapper"},i.createElement(xe,(0,a.a)({},this.props,{selectionLimit:100})))},t}(i.Component),ke=Le}
,function(e,t,n){n.d(t,{a:function(){return P}});var a,i=n(473),r=n(0),o=n("react-lib"),s=n(43),c=n(83),d=n(3),l=n(476),u=n(179),f=n(5),p=n(75),m=n(13),_=n(70),h=n(325),b=n(44),g=n(106),v=(0,f.a)({cacheSize:100}),y=new Map([[p.b.none,"unknown"],[p.b.away,"away"],[p.b.blocked,"blocked"],[p.b.busy,"busy"],[p.b.dnd,"do-not-disturb"],[p.b.offline,"offline"],[p.b.online,"available"]]),S=new Map([[p.c.size8,16],[p.c.size24,24],[p.c.size32,32],[p.c.size40,40],[p.c.size48,48],[p.c.size56,56],[p.c.size72,72],[p.c.size100,96],[p.c.size120,120],[p.c.tiny,16],[p.c.extraExtraSmall,24],[p.c.extraSmall,28],[p.c.small,40],[p.c.regular,48],[p.c.large,72],[p.c.extraLarge,96],[p.c.size10,16],[p.c.size16,16],[p.c.size28,28]]),D=new Set(["allowPhoneInitials","className","coinProps","coinSize","componentRef","hidePersonaDetails","imageAlt","imageInitials","imageShouldFadeIn","imageShouldStartVisible","imageUrl","initialsColor","initialsTextColor","isOutOfOffice","onPhotoLoadingStateChange","onRenderCoin","onRenderInitials","onRenderOptionalText","onRenderPersonaCoin","onRenderPrimaryText","onRenderSecondaryText","onRenderTertiaryText","optionalText","presence","presenceColors","presenceTitle","primaryText","ref","secondaryText","showInitialsUntilImageLoads","showOverflowTooltip","showSecondaryText","showUnknownPersonaCoin","size","styles","tertiaryText","text","theme"]),I="--colorPersonaShimInitialsColor",x="--colorPersonaShimInitialsTextColor",C=[p.a.lightBlue,p.a.blue,p.a.darkBlue,p.a.teal,p.a.green,p.a.darkGreen,p.a.lightPink,p.a.pink,p.a.magenta,p.a.purple,p.a.orange,p.a.lightRed,p.a.darkRed,p.a.violet,p.a.gold,p.a.burgundy,p.a.warmGray,p.a.cyan,p.a.rust,p.a.coolGray],O=C.length,w=function(e){var t=e,n=t.imageInitials,a=t.allowPhoneInitials,i=t.showUnknownPersonaCoin,r=t.text,s=t.primaryText,c=t.theme;if(i)return o.createElement(m.a,{iconName:"Help"});var d=(0,_.b)(c),l=n||(0,h.a)(r||s||"",d,a);return""!==l?o.createElement("span",null,l):o.createElement(m.a,{iconName:"Contact"})},E=(0,f.a)({useStaticStyles:!0}),A=(0,s.a)({text:{textAlign:"left"},displayText:(0,r.a)((0,r.a)({width:"100%"},c.a.overflow("hidden")),{textOverflow:"ellipsis"}),initialsColor:{backgroundColor:"var(".concat(I,")")},initialsTextColor:{color:"var(".concat(x,")")},noAvatarSpacing:(a={},a["--fui-Persona__avatar--spacing"]=0,a)}),L=o.forwardRef(function(e,t){var n=e.onRenderCoin,a=e.onRenderPersonaCoin,s=e.onRenderPrimaryText,c=e.onRenderInitials,f=A(),m=(0,g.i)();if(n&&(!m||n.length>0)||!m&&a||s&&s.length>0||m&&c&&c.length>0||e.children)return o.createElement(i.a,(0,r.a)({},e,{ref:t}));var L=e.className,k=e.styles,M=function(e,t){var n=e.allowPhoneInitials,a=e.coinProps,i=e.hidePersonaDetails,o=e.imageAlt,s=e.imageInitials,c=e.imageUrl,l=e.initialsColor,f=e.initialsTextColor,m=e.onRenderPrimaryText,E=e.onRenderSecondaryText,A=e.optionalText,L=e.presence,k=e.primaryText,M=e.secondaryText,P=e.showSecondaryText,T=e.showUnknownPersonaCoin,U=e.size,F=e.tertiaryText,H=e.text,R=e.theme,N=e.onRenderInitials,B=L?{status:y.get(L)}:void 0,j=S.get(e.size||p.c.size48),V=P||j&&j>32,z=function(e){switch(e){case p.c.tiny:case p.c.size8:case p.c.size10:case p.c.size16:return"extra-small";case p.c.extraExtraSmall:case p.c.size28:case p.c.size24:return"small";case p.c.extraSmall:case p.c.size32:case p.c.small:case p.c.size40:case p.c.regular:case p.c.size48:return"medium";case p.c.large:case p.c.size56:case p.c.size72:return"extra-large";case p.c.extraLarge:case p.c.size100:case p.c.size120:return"huge";default:return"medium"}}(U),G=void 0,K={},W=(null==a?void 0:a.initialsColor)||l;K[x]=(null==a?void 0:a.initialsTextColor)||f,W&&"string"==typeof W?(K[I]=W,K[x]=K[x]||u.a.colorNeutralForegroundOnBrand):G=function(e){switch(e){case p.a.lightBlue:return"cornflower";case p.a.blue:return"blue";case p.a.darkBlue:return"royal-blue";case p.a.teal:return"teal";case p.a.lightGreen:return"seafoam";case p.a.green:return"forest";case p.a.darkGreen:return"dark-green";case p.a.lightPink:return"lilac";case p.a.pink:return"pink";case p.a.magenta:return"magenta";case p.a.purple:return"purple";case p.a.black:return"anchor";case p.a.orange:return"peach";case p.a.red:return"cranberry";case p.a.darkRed:return"dark-red";case p.a.violet:return"grape";case p.a.lightRed:return"red";case p.a.gold:return"gold";case p.a.burgundy:return"dark-red";case p.a.warmGray:return"mink";case p.a.coolGray:return"platinum";case p.a.gray:return"anchor";case p.a.cyan:return"royal-blue";case p.a.rust:return"brown"}return"colorful"}(l||function(e){var t=p.a.blue;if(!e)return t;for(var n=0,a=e.length-1;a>=0;a--){var i=e.charCodeAt(a),r=a%8;n^=(i<<r)+(i>>8-r)}return C[n%O]}(H||k));var q=v(null==a?void 0:a.styles),Q={imageInitials:s,allowPhoneInitials:n,showUnknownPersonaCoin:T,text:H,primaryText:k,theme:R},Y=m&&m()||H||k,J=E&&E()||M,X=72===Number(j)||100===Number(j)?F:void 0,Z=100===Number(j)?A:void 0,$={avatar:{className:(0,d.a)("ms-Persona-coin",q.coin,!(0,g.h)()&&i&&t.noAvatarSpacing),color:G,image:{className:(0,d.a)("ms-Persona-image",q.image),src:c,alt:o},initials:{style:K,className:(0,d.a)("ms-Persona-initials",q.initials,K[I]&&t.initialsColor,K[x]&&t.initialsTextColor),children:(0,g.i)()?s||(0,h.a)(H||k||"",(0,_.b)(R),n):N?N(Q,w):w(Q)},size:j},size:z,presence:B,primaryText:!i&&Y,secondaryText:!i&&V&&J,tertiaryText:!i&&X,quaternaryText:!i&&Z,textAlignment:"center"};return(0,r.a)((0,r.a)({},$),(0,b.b)(e,D))}(e,f),P=E(k),T=(0,g.a)()?f.displayText:(0,d.a)(f.displayText,"ms-Persona-secondaryText");return o.createElement(l.a,(0,r.a)({ref:e.componentRef||t},M,{className:(0,d.a)("ms-Persona",L,P.root,f.text),primaryText:M.primaryText?{className:(0,d.a)(f.displayText,"ms-Persona-primaryText",P.primaryText),children:M.primaryText}:void 0,secondaryText:M.secondaryText?{className:T,children:M.secondaryText}:void 0}))});L.displayName="PersonaShim";var k=n(42),M=n(34),P=function(e){return(0,k.a)(i.a,L,e,M.a.FluentUIV9ShimPersona)}}
,,,,function(e,t,n){n.d(t,{a:function(){return a}});var a={useCacheAndUpdateInTheBackground:0,useCacheIfNotExpired:1,onlyCache:2,bypassCache:3,useCacheAndNoUpdate:4}}
,,function(e,t,n){function a(e){if(!e||0===e.length)return 0;for(var t=5381,n=0;n<e.length;n++)t=(t<<5)+t+e.charCodeAt(n),t&=t;return t}n.d(t,{a:function(){return a}})}
,function(e,t,n){n.d(t,{a:function(){return d}});var a=n("react-lib"),i=n("prop-types-lib");(0,n(8).b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-Share-PeoplePickerErrorContainer{display:flex;padding:8px 32px 8px 12px}.od-Share-PeoplePickerErrorContainer .od-Share-PeoplePickerErrorDiv{padding:0 8px;font-size:.75rem;color:#323130}.od-Simplified-Share-PeoplePickerErrorContainer{display:flex;flex-direction:row;padding:4px 0 0 4px}.od-Simplified-Share-PeoplePickerErrorIcon{padding-top:3px}.od-Simplified-Share-PeoplePickerErrorIcon{padding-right:5px;font-size:.625rem}.od-Simplified-Share-PeoplePickerErrorText{font-size:.75rem}.od-Simplified-Share-primary{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-Simplified-Share-warning{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-Simplified-Share-warning i{color:"},{theme:"orange",defaultValue:"#d83b01"},{rawString:"}.od-Simplified-Share-info{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-Simplified-Share-info i{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-Simplified-Share-error{color:"},{theme:"red",defaultValue:"#e81123"},{rawString:"}.PeoplePickerError-moreDetails{display:flex;flex-direction:row;border:none!important;padding:0!important;font-weight:400!important;font-size:.75rem!important;background-color:transparent!important;height:auto!important;padding-top:2px!important}.PeoplePickerError-moreDetails:hover{background-color:transparent!important}.PeoplePickerError-moreDetailsText:hover{text-decoration:underline}.PeoplePickerError-icon{padding-left:5px}.PeoplePickerError-detailsContainer{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}"}]);var r=n(13),o=n(24),s=n(56),c=n(200);function d(e,t){var n=a.useState(!1),i=n[0],d=n[1],l=(0,o.nb)(t.clientId,t.sharingStore)||(0,o.tb)(t.clientId,t.sharingStore),u=(0,c.a)(function(){d(!i)});return l?a.createElement(a.Fragment,null,e.messages.map(function(t){if(t.errorDetails){var n=a.createElement("div",null,a.createElement(s.c,{className:"PeoplePickerError-moreDetails",onClick:u},a.createElement("div",{className:"PeoplePickerError-moreDetailsText"},"More Details"),a.createElement(r.a,{className:"PeoplePickerError-icon",iconName:"ChevronDown"}))),o=a.createElement("div",null,a.createElement(s.c,{className:"PeoplePickerError-moreDetails",onClick:u},a.createElement("div",{className:"PeoplePickerError-moreDetailsText"},"Hide Details"),a.createElement(r.a,{className:"PeoplePickerError-icon",iconName:"ChevronUp"})),a.createElement("div",{className:"PeoplePickerError-detailsContainer"},t.errorDetails));return a.createElement("div",{className:"od-Simplified-Share-PeoplePickerErrorContainer od-Simplified-Share-".concat(e.textColorType)},a.createElement(r.a,{className:"od-Simplified-Share-PeoplePickerErrorIcon ".concat(e.className),iconName:e.iconName}),a.createElement("div",{className:"od-Simplified-Share-PeoplePickerErrorText od-Simplified-Share-".concat(e.textColorType)},t.error,i?o:n))}return a.createElement("div",{className:"od-Simplified-Share-PeoplePickerErrorContainer od-Simplified-Share-".concat(e.textColorType)},a.createElement(r.a,{className:"od-Simplified-Share-PeoplePickerErrorIcon ".concat(e.className),iconName:e.iconName}),a.createElement("div",{className:"od-Simplified-Share-PeoplePickerErrorText od-Simplified-Share-".concat(e.textColorType)},t.error))})):a.createElement(a.Fragment,null,e.messages.map(function(t){return a.createElement("div",{className:"od-Share-PeoplePickerErrorContainer",style:{backgroundColor:e.backgroundColor}},a.createElement(r.a,{iconName:e.iconName,className:e.className}),a.createElement("div",{className:"od-Share-PeoplePickerErrorDiv"},t.error))}))}d.contextTypes={sharingStore:i.object.isRequired,clientId:i.number.isRequired}}
,,function(e,t,n){n.d(t,{a:function(){return h}});var a=n(0),i=n("react-lib"),r=n(52),o=n(311),s=n(14),c=n(56),d=n(19),l=n(20);(0,n(8).b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-RoleSelectorCompact-permissionButton{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";border-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}[dir=ltr] .od-RoleSelectorCompact-permissionButton{margin-left:8px}[dir=rtl] .od-RoleSelectorCompact-permissionButton{margin-right:8px}.od-RoleSelectorCompact-permissionButton svg{height:1.125rem;width:1.125rem}@supports (font:-apple-system-body){.od-RoleSelectorCompact-permissionButton{font:-apple-system-body;height:auto}}.od-RoleSelectorCompact-permissionButton.is-expanded{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.od-RoleSelectorCompact-permissionButton:hover{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";border-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-RoleSelectorCompact-permissionButton:active{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";border-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-RoleSelectorCompact-permissionButton:disabled{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";border-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}@supports (font:-apple-system-body){.od-RoleSelectorCompact-permissionButton span.ms-Button-flexContainer{font:-apple-system-body;height:auto}}.od-RoleSelectorCompact-permissionButton .od-RoleSelectorCompact-permissionButton-Chevron{font-size:.75rem;height:1rem;line-height:1rem}@supports (font:-apple-system-body){.od-RoleSelectorCompact-permissionButton .od-RoleSelectorCompact-permissionButton-Chevron{font:-apple-system-body;height:auto}}@supports (font:-apple-system-body){.od-RoleSelectorCompact-permissionButton i.ms-Button-icon{font:-apple-system-body;height:auto}}.od-RoleSelectorCompact-permissionButton.simplified-share{height:100%;align-self:center;border-radius:0 4px 4px 0}[dir=ltr] .od-RoleSelectorCompact-permissionButton.simplified-share{margin-left:0}[dir=rtl] .od-RoleSelectorCompact-permissionButton.simplified-share{margin-right:0}.od-RoleSelectorCompact-menuItem .od-RoleSelectorCompact-menuItem-textWrapper{display:flex;flex-direction:column;margin:8px}[dir=ltr] .od-RoleSelectorCompact-menuItem .od-RoleSelectorCompact-menuItem-textWrapper{text-align:left}[dir=rtl] .od-RoleSelectorCompact-menuItem .od-RoleSelectorCompact-menuItem-textWrapper{text-align:right}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-link{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";line-height:2.25rem;height:3.25rem;font-size:.875rem}@supports (font:-apple-system-body){.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-link{font:-apple-system-body;height:auto!important}}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-link:hover{background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-link:active{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-link.is-disabled{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-icon{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";background-color:transparent;font-size:1rem;width:1rem;max-height:unset}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-icon.blockdownload{height:1rem}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-icon:hover{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-icon:active{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-icon.is-disabled{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-itemText{font-size:.875rem;line-height:1.25rem;font:-apple-system-body}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-secondaryText{font-size:.75rem;line-height:1rem;font:-apple-system-caption1;max-width:160px;white-space:normal}.od-RoleSelectorCompact-menuItem.od-RoleSelectorCompact-settingsItem .ms-Icon-placeHolder{display:none}.od-RoleSelectorCompact-menuItem.selected{background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-RoleSelectorCompact-menuItem.selected .ms-ContextualMenu-link{background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-RoleSelectorCompact-menuItem-stopSharing .ms-ContextualMenu-link{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-RoleSelectorCompact-menuItem-textWrapper.ms-ContextualMenu-secondaryText:hover{color:highlighttext}.ms-ContextualMenu-linkContent.ms-ContextualMenu-icon{color:highlighttext}.od-RoleSelectorCompact-simplifiedPermissionsButton{height:100%!important;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"!important;background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";border-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";border-radius:0 4px 2px 0!important;height:100%;align-self:center;padding:2px}[dir=ltr] .od-RoleSelectorCompact-simplifiedPermissionsButton{margin-left:0}[dir=rtl] .od-RoleSelectorCompact-simplifiedPermissionsButton{margin-right:0}.od-RoleSelectorCompact-simplifiedPermissionsButton svg{height:1.125rem;width:1.125rem}@supports (font:-apple-system-body){.od-RoleSelectorCompact-simplifiedPermissionsButton{font:-apple-system-body;height:auto}}.od-RoleSelectorCompact-simplifiedPermissionsButton.is-expanded{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.od-RoleSelectorCompact-simplifiedPermissionsButton:hover{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";border-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-RoleSelectorCompact-simplifiedPermissionsButton:active{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";border-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-RoleSelectorCompact-simplifiedPermissionsButton:disabled{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";border-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-RoleSelectorCompact-simplifiedPermissionsButton:focus{outline:unset}.od-RoleSelectorCompact-simplifiedPermissionsButton span.ms-Button-flexContainer{height:100%;padding-left:10px;padding-right:10px}@supports (font:-apple-system-body){.od-RoleSelectorCompact-simplifiedPermissionsButton span.ms-Button-flexContainer{font:-apple-system-body;height:auto}}.od-RoleSelectorCompact-simplifiedPermissionsButton .od-RoleSelectorCompact-permissionButton-Chevron{font-size:.75rem;height:1rem;line-height:1rem}@supports (font:-apple-system-body){.od-RoleSelectorCompact-simplifiedPermissionsButton .od-RoleSelectorCompact-permissionButton-Chevron{font:-apple-system-body;height:auto}}@supports (font:-apple-system-body){.od-RoleSelectorCompact-simplifiedPermissionsButton i.ms-Button-icon{font:-apple-system-body;height:auto}}.od-AddPeople-Edit-Section button.od-RoleSelectorCompact-simplifiedPermissionsButton{border-radius:2px!important}.od-AddPeople-Edit-Section span.ms-Button-flexContainer{padding:0}.od-RoleSelectorCompact-checkmarkIcon{font-size:.75rem;max-height:unset}@media screen and (-ms-high-contrast:active){.od-RoleSelectorCompact-menuItem button.ms-ContextualMenu-link.is-checked,.od-RoleSelectorCompact-menuItem button.ms-ContextualMenu-link:hover{background-color:highlight;border-color:highlight;color:highlighttext;forced-color-adjust:none}.od-RoleSelectorCompact-menuItem button.ms-ContextualMenu-link.is-checked .od-RoleSelectorCompact-checkmarkIcon,.od-RoleSelectorCompact-menuItem button.ms-ContextualMenu-link.is-checked .od-RoleSelectorCompact-menuItem-textWrapper .ms-ContextualMenu-itemText,.od-RoleSelectorCompact-menuItem button.ms-ContextualMenu-link.is-checked .od-RoleSelectorCompact-menuItem-textWrapper .ms-ContextualMenu-secondaryText,.od-RoleSelectorCompact-menuItem button.ms-ContextualMenu-link.is-checked i.ms-ContextualMenu-icon,.od-RoleSelectorCompact-menuItem button.ms-ContextualMenu-link:hover .od-RoleSelectorCompact-checkmarkIcon,.od-RoleSelectorCompact-menuItem button.ms-ContextualMenu-link:hover .od-RoleSelectorCompact-menuItem-textWrapper .ms-ContextualMenu-itemText,.od-RoleSelectorCompact-menuItem button.ms-ContextualMenu-link:hover .od-RoleSelectorCompact-menuItem-textWrapper .ms-ContextualMenu-secondaryText,.od-RoleSelectorCompact-menuItem button.ms-ContextualMenu-link:hover i.ms-ContextualMenu-icon{background-color:highlight;border-color:highlight;color:highlighttext!important}button.od-RoleSelectorCompact-permissionButton.ms-Button.ms-Button--icon:hover,button.od-RoleSelectorCompact-simplifiedPermissionsButton.ms-Button.ms-Button--icon:hover{background-color:highlight;border-color:highlight;color:highlighttext;forced-color-adjust:none}button.od-RoleSelectorCompact-permissionButton.ms-Button.ms-Button--icon:hover i.ms-Icon.ms-Button-icon,button.od-RoleSelectorCompact-permissionButton.ms-Button.ms-Button--icon:hover i.ms-Icon.ms-Button-menuIcon.od-RoleSelectorCompact-permissionButton-Chevron,button.od-RoleSelectorCompact-simplifiedPermissionsButton.ms-Button.ms-Button--icon:hover i.ms-Icon.ms-Button-icon,button.od-RoleSelectorCompact-simplifiedPermissionsButton.ms-Button.ms-Button--icon:hover i.ms-Icon.ms-Button-menuIcon.od-RoleSelectorCompact-permissionButton-Chevron{color:highlighttext;font-weight:600;forced-color-adjust:none}}"}]);var u,f=n("prop-types-lib"),p=n(112),m=n(24),_=n(72);!function(e){e.edit="edit",e.view="view",e.review="comment",e.fullControl="full-control",e.manageList="manage-list",e.restrictedView="restricted-view",e.divider="divider",e.stopSharing="stop-sharing",e.linkSettings="linkSettings"}(u||(u={}));var h=function(e){function t(t,n){var a=e.call(this,t)||this;return a._linkSettingsClickedInRoleSelector=function(){a.context.sharingStore.getEngagementHelper().linkSettingsInCompactRoleSelectorClicked({clientId:a.props.clientId,scenarioId:"",mode:a.props.mode}),a.props.onLinkSettingsClicked()},a._onItemClicked=function(e,t){var n,i;switch(t.key){case u.fullControl:i=r.a.owner;break;case u.manageList:i=r.a.manageList;break;case u.edit:i=r.a.edit;break;case u.view:i=r.a.view;break;case u.review:i=r.a.review;break;case u.restrictedView:i=r.a.restrictedview;break;default:i=r.a.none}a._selectedRole!==i&&a.props.onRoleChange(i,a.props.permissionId||""),null===(n=a._roleSelectorRef.current)||void 0===n||n.focus()},a._selectedRole=a._parseRole(t.sharingRole),a._menuOpen=!1,a._showSimplifiedDialogV2=(0,m.tb)(a.props.clientId,n.sharingStore),a._showSimplifiedDialog=(0,m.nb)(a.props.clientId,n.sharingStore),a._useSimplifiedDialog=a._showSimplifiedDialog||a._showSimplifiedDialogV2,a._roleSelectorRef=i.createRef(),a}return(0,a.d)(t,e),t.prototype.render=function(){var e=this;this._selectedRole=this._parseRole(this.props.sharingRole);var t,n=this.props,a=n.menuPermissionOptions,u=n.showLinkSettings,f=n.showStopSharing,m=this._getMenuItems({menuPermissionOptions:a,showLinkSettings:u,showStopSharing:f,sharingRole:this.props.sharingRole}),h=m.filter(function(e){return e.itemType!==o.a.Divider}).length,b=a.manageList.shouldDisplay,g=void 0!==b&&b;switch(this.props.sharingRole){case r.a.owner:t=l.Hd;break;case r.a.edit:t=g?l.bb:l.yb;break;case r.a.review:t=l.Cb,this.props.showDropdownWithOfficeReview&&(t=l.Db);break;case r.a.view:t=l.kb;break;case r.a.restrictedview:t=l.lb;break;case r.a.manageList:t=l.hb;break;case r.a.none:t="";break;default:return null}var v={subComponentStyles:{callout:{root:{maxHeight:1===(0,_.e)()?"100%":"160px !important",overflowY:"auto"},main:{overflowY:"auto"}},menuItem:{root:{height:"auto !important"},label:{margin:"0",fontSize:"0.875rem",fontWeight:"600",lineHeight:"1.3"},secondaryText:{paddingLeft:"0",fontSize:"0.75rem",lineHeight:"1.3",textAlign:"left",whiteSpace:"normal"}}}},y={directionalHint:s.a.bottomAutoEdge,shouldFocusOnMount:!0,items:m,isBeakVisible:!1,onItemClick:this._onItemClicked,onMenuOpened:function(){e._logRoleSelectorClicked(e.context.sharingStore),e._menuOpen=!0},onMenuDismissed:function(){var t;e._menuOpen=!1,null===(t=e._roleSelectorRef.current)||void 0===t||t.focus()},styles:v,calloutProps:{minPagePadding:3}},S={iconName:"ChevronDown",className:"od-RoleSelectorCompact-permissionButton-Chevron"};if(this.props.shimmer)return i.createElement(c.d,{menuIconProps:S,iconProps:{iconName:"Stop"},className:"od-RoleSelectorCompact-permissionButton",menuProps:y,disabled:!0,styles:{root:{height:"2rem"},icon:{fontSize:"1rem",height:"1rem",lineHeight:"1rem"},flexContainer:{height:"2rem"}}});var D=this._menuOpen?d.d(l._e,this.props.ariaLabel||"",t,h):d.d(l.me,this.props.ariaLabel||"",t,h);return p.b(i.createElement(c.d,{componentRef:this._roleSelectorRef,menuIconProps:S,iconProps:this.getRoleIconName(this.props.sharingRole),className:this._useSimplifiedDialog&&!this.props.isGrantAccess?"od-RoleSelectorCompact-simplifiedPermissionsButton":"od-RoleSelectorCompact-permissionButton",menuProps:y,disabled:this.props.disabled,ariaLabel:D,styles:{root:{height:"2rem"},icon:{fontSize:"1rem",height:"1rem",lineHeight:"1rem"},flexContainer:{height:"2rem"}}}),t,{position:s.a.bottomRightEdge,styles:this._useSimplifiedDialog&&{root:{height:"100%",display:"flex"}}})},t.prototype._renderContent=function(e,t){return i.createElement(i.Fragment,null,t.renderCheckMarkIcon(e),t.renderItemIcon(e),i.createElement("div",{className:"od-RoleSelectorCompact-menuItem-textWrapper"},t.renderItemName(e),t.renderSecondaryText(e)),t.renderSubMenuIcon(e))},t.prototype._parseRole=function(e){return e===r.a.review&&!this.props.menuPermissionOptions.review.enabled||e===r.a.owner&&!this.props.menuPermissionOptions.fullControl.enabled?r.a.edit:e===r.a.restrictedview?this.props.menuPermissionOptions.blockDownload.enabled?r.a.restrictedview:r.a.view:e},t.prototype._addRenderContent=function(e){var t=this;return e.map(function(e){return(0,a.a)((0,a.a)({},e),{onRenderContent:t._renderContent})})},t.prototype._getMenuItems=function(e){var t=[],n=e.menuPermissionOptions,a=e.showLinkSettings,i=e.showStopSharing,s=e.sharingRole,c=n.fullControl,f=(c.enabled,c.shouldDisplay),p=void 0!==f&&f,m=n.review,h=(m.enabled,m.shouldDisplay),b=void 0!==h&&h,g=n.edit,v=g.enabled,y=void 0===v||v,S=g.shouldDisplay,D=void 0===S||S,I=n.view,x=(I.enabled,I.shouldDisplay),C=void 0===x||x,O=n.manageList,w=O.enabled,E=void 0!==w&&w,A=O.shouldDisplay,L=void 0!==A&&A,k=n.blockDownload,M=(k.enabled,k.shouldDisplay),P=void 0!==M&&M,T={key:u.edit,text:L?l.bb:l.yb,disabled:!y,secondaryText:L?l.gb:l.vb,ariaLabel:d.d(l.Di,L?l.bb:l.yb,L?l.gb:l.vb),className:"od-RoleSelectorCompact-menuItem",iconProps:{iconName:"Edit"},itemProps:{styles:{checkmarkIcon:["od-RoleSelectorCompact-checkmarkIcon"]}},role:"menuitemradio",canCheck:!0,isChecked:s===r.a.edit},U=e.menuPermissionOptions.blockDownload.enabled||this._showSimplifiedDialogV2?s===r.a.view:this._showSimplifiedDialog&&(s===r.a.view||s===r.a.restrictedview),F={key:u.view,text:l.kb,secondaryText:L?l.Ab:l.Lb,ariaLabel:d.d(l.Di,l.kb,L?l.Ab:l.Lb),className:"od-RoleSelectorCompact-menuItem",iconProps:{iconName:"View"},itemProps:{styles:{checkmarkIcon:["od-RoleSelectorCompact-checkmarkIcon"]}},role:"menuitemradio",canCheck:!0,isChecked:U},H={key:u.fullControl,text:l.Hd,secondaryText:l.Fd,ariaLabel:d.d(l.Di,l.Hd,l.Fd),className:"od-RoleSelectorCompact-menuItem",iconProps:{iconName:"Signin"},itemProps:{styles:{checkmarkIcon:["od-RoleSelectorCompact-checkmarkIcon"]}},role:"menuitemradio",canCheck:!0,isChecked:s===r.a.owner},R={key:u.manageList,text:l.hb,disabled:!E,secondaryText:l._b,ariaLabel:d.d(l.Di,l.hb,l._b),className:"od-RoleSelectorCompact-menuItem",iconProps:{iconName:"EditListPencil"},itemProps:{styles:{checkmarkIcon:["od-RoleSelectorCompact-checkmarkIcon"]}},role:"menuitemradio",canCheck:!0,isChecked:s===r.a.manageList},N={key:u.review,text:l.Cb,secondaryText:l.xb,ariaLabel:d.d(l.Di,l.Cb,l.xb),className:"od-RoleSelectorCompact-menuItem",iconProps:{iconName:"Feedback"},itemProps:{styles:{checkmarkIcon:["od-RoleSelectorCompact-checkmarkIcon"]}},role:"menuitemradio",canCheck:!0,isChecked:s===r.a.review},B={key:u.review,text:l.Db,secondaryText:l.Sb,ariaLabel:d.d(l.Di,l.Db,l.Sb),className:"od-RoleSelectorCompact-menuItem",iconProps:{iconName:"Feedback"},itemProps:{styles:{checkmarkIcon:["od-RoleSelectorCompact-checkmarkIcon"]}},role:"menuitemradio",canCheck:!0,isChecked:s===r.a.review},j={key:u.divider,itemType:o.a.Divider},V={key:u.stopSharing,text:l.tk,ariaLabel:l.tk,canCheck:!1,onClick:this.props.onStopSharing,className:"od-RoleSelectorCompact-menuItem od-RoleSelectorCompact-menuItem-stopSharing",iconProps:{iconName:"Delete"}},z={key:"linkSettings",text:l.Ne,onClick:this._linkSettingsClickedInRoleSelector,iconProps:{iconName:"Settings"},className:"od-RoleSelectorCompact-menuItem",ariaLabel:l.Ne},G={key:u.restrictedView,text:l.lb,secondaryText:l.ub,ariaLabel:d.d(l.Di,l.lb,l.ub),className:"od-RoleSelectorCompact-menuItem blockdownload ".concat(this._useSimplifiedDialog||s!==r.a.restrictedview?"":"selected"),iconProps:{iconName:"BlockDownloadIcon"},itemProps:{styles:{checkmarkIcon:this._useSimplifiedDialog&&["od-RoleSelectorCompact-checkmarkIcon"]}},role:"menuitemradio",canCheck:this._useSimplifiedDialog,isChecked:this._useSimplifiedDialog&&s===r.a.restrictedview};return p&&t.push(H),L&&t.push(R),D&&t.push(T),1===(0,_.e)()&&b&&(this.props.showDropdownWithOfficeReview?t.push(B):t.push(N)),C&&t.push(F),P&&t.push(G),0===(0,_.e)()&&b&&(this.props.showDropdownWithOfficeReview?t.push(B):t.push(N)),i&&t.push(j,V),a&&t.push(j,z),this._addRenderContent(t)},t.prototype._logRoleSelectorClicked=function(e){e.getEngagementHelper().compactRoleSelectorClicked({clientId:this.props.clientId,scenarioId:"",mode:this.props.mode})},t.prototype.getRoleIconName=function(e){var t;switch(e=this._parseRole(e)){case r.a.owner:t="Signin";break;case r.a.edit:t="Edit";break;case r.a.view:t="View";break;case r.a.review:t="Feedback";break;case r.a.manageList:t="EditListPencil";break;case r.a.restrictedview:t="BlockDownloadIcon";break;case r.a.none:t="";break;default:throw new Error("Sharing role does not exist")}return{iconName:t}},t.contextTypes={sharingStore:f.object.isRequired},t}(i.Component)}
,function(e,t,n){n.d(t,{a:function(){return A}});var a=n(494),i=n(0),r=n("react-lib"),o=n(5),s=n(13),c=n(43),d=n(83),l=n(3),u=n(496),f=n(498),p=n(499),m=n(176),_=n(45),h=n(111),b=n(64),g=n(44),v=new Set(["ariaLabel","autoAdjustHeight","autoComplete","borderless","canRevealPassword","className","componentRef","defaultValue","deferredValidationTime","description","disabled","elementRef","errorMessage","iconProps","inputClassName","invalid","label","multiline","onChange","onGetErrorMessage","onNotifyValidationResult","onRenderDescription","onRenderInput","onRenderLabel","onRenderPrefix","onRenderSuffix","prefix","readOnly","resizable","revealPasswordAriaLabel","styles","suffix","theme","underlined","validateOnFocusIn","validateOnFocusOut","validateOnLoad","value"]);function y(e,t){var n=function(e,t){return(0,i.a)((0,i.a)((0,i.a)({},(0,g.b)(e,v)),t),{autoComplete:e.autoComplete,defaultValue:e.defaultValue,disabled:e.disabled,readOnly:e.readOnly,value:e.value,"aria-label":e.ariaLabel})}(e,t);return e.multiline?(0,i.a)((0,i.a)({},n),function(e){var t,n=null===(t=e.resizable)||void 0===t||t;return(0,i.a)((0,i.a)({},(0,g.b)(e,v)),{appearance:"outline",resize:n?"both":"none"})}(e)):(0,i.a)((0,i.a)({},n),function(e){return(0,i.a)((0,i.a)({},(0,g.b)(e,v)),{appearance:e.underlined?"underline":"outline"})}(e))}var S=n(178),D=n(197),I=(0,o.a)(),x=(0,c.a)({root:{height:"32px"},icon:{pointerEvents:"none",position:"absolute",bottom:"6px",right:"8px",top:"auto",fontSize:S.a.fontSizeBase400,lineHeight:"18px"},iconDisabled:{color:S.a.colorNeutralForegroundDisabled},underline:{"&.ms-TextField-fieldGroup":(0,i.a)((0,i.a)({backgroundColor:S.a.colorTransparentBackground},d.a.borderRadius(0)),{borderTopStyle:"none",borderRightStyle:"none",borderLeftStyle:"none","::after":{left:0,right:0}})},underlineInteractive:{"&.ms-TextField-fieldGroup":{":hover":{borderTopStyle:"none",borderRightStyle:"none",borderLeftStyle:"none",borderBottomColor:S.a.colorNeutralStrokeAccessibleHover},":active,:focus-within":{borderTopStyle:"none",borderRightStyle:"none",borderLeftStyle:"none",borderBottomColor:S.a.colorNeutralStrokeAccessiblePressed},"::after":d.a.borderRadius(0)}},borderless:(0,i.a)((0,i.a)({},d.a.border(0,"none")),{":hover":(0,i.a)({},d.a.border(0,"none")),":active":(0,i.a)({},d.a.border(0,"none")),":focus-within":(0,i.a)({},d.a.border(0,"none")),"::after":d.a.border(0,"none")}),validationMessage:{display:"flex"},fieldDisplay:{display:"flex",flexDirection:"column"},requiredWithoutLabel:{"&.fui-Input::before, &.fui-Textarea::before":{content:"'*'",color:S.a.colorPaletteRedForeground3,position:"absolute",right:"-10px",top:"-5px"}},label:(0,i.a)({display:"block",lineHeight:"normal"},d.a.padding("5px","0px")),labelRequired:{"& .fui-Label__required":{paddingRight:"12px"}},inputBackground:{backgroundColor:S.a.semanticInputBackground},textAreaFieldGroup:{minHeight:"60px"}}),C=(0,c.a)({autoAdjustHeight:{overflowY:"hidden",maxHeight:"none"}}),O=r.forwardRef(function(e,t){var n=e.validateOnLoad,a=void 0===n||n,o=e.deferredValidationTime,c=void 0===o?200:o,d=(0,i.f)(e,["validateOnLoad","deferredValidationTime"]),g=(0,_.a)("field-"),v=g+"-control",S=x(),O=C(),w=r.useRef(""),E=0,A=(0,D.a)("TextField",d),L=I(A.styles,{theme:d.theme}),k=r.useRef(),M=t||k,P=(0,h.a)({defaultState:d.defaultValue,state:d.value,initialState:void 0}),T=P[0],U=P[1],F=r.useState(""),H=F[0],R=F[1],N=r.useRef($);N.current=$;var B=r.useRef(new b.a),j=r.useRef(!0),V=r.useCallback(B.current.debounce(function(e){var t;return null===(t=N.current)||void 0===t?void 0:t.call(N,e)},c),[]);r.useEffect(function(){a&&$(X())},[]),r.useEffect(function(){H&&!d.errorMessage&&R(""),j.current?j.current=!1:ee(d)&&V(X())},[T,d.value]),r.useImperativeHandle(d.componentRef,function(){var e,t,n,a;return{value:X(),focus:function(){var e;null===(e=M.current)||void 0===e||e.focus()},blur:function(){var e;null===(e=M.current)||void 0===e||e.blur()},select:function(){var e;null===(e=M.current)||void 0===e||e.select()},setSelectionStart:function(e){M.current&&(M.current.selectionStart=e)},setSelectionEnd:function(e){M.current&&(M.current.selectionEnd=e)},selectionStart:null!==(t=null===(e=M.current)||void 0===e?void 0:e.selectionStart)&&void 0!==t?t:-1,selectionEnd:null!==(a=null===(n=M.current)||void 0===n?void 0:n.selectionEnd)&&void 0!==a?a:-1,setSelectionRange:function(e,t){var n;null===(n=M.current)||void 0===n||n.setSelectionRange(e,t)}}},[]),r.useLayoutEffect(function(){!function(){if(M.current&&d.autoAdjustHeight&&d.multiline){var e=M.current;e.style.height=e.scrollHeight+"px"}}()},[T,d.value]);var z=function(){var e=J();return e?"string"==typeof e?e:{children:function(t,n){var a=(0,l.a)(n.className,S.validationMessage);return r.createElement("div",(0,i.a)({},n,{className:a}),!!n.children&&r.createElement("div",null,n.children),e)}}:null},G=function(){return d.iconProps?r.createElement(s.a,(0,i.a)({className:(0,l.a)(L.icon,S.icon,d.disabled&&S.iconDisabled)},d.iconProps)):null};function K(e){return function(){return r.createElement(r.Fragment,null,e.onRenderLabel(e,W))}}function W(e){return(null==e?void 0:e.label)?r.createElement(m.a,{required:e.required,htmlFor:v,disabled:e.disabled,id:g,className:(0,l.a)("ms-Label",S.label,e.required&&S.labelRequired)},e.label):null}function q(e){return(null==e?void 0:e.prefix)?r.createElement("span",{style:{paddingBottom:"1px"}},e.prefix):null}function Q(e){return(null==e?void 0:e.suffix)?r.createElement("span",{style:{paddingBottom:"1px"}},e.suffix):null}function Y(e){return(null==e?void 0:e.description)?r.createElement("span",null,e.description):null}function J(){return d.errorMessage?d.errorMessage:H||""}function X(){var e=d.value,t=void 0===e?T:e;return"number"==typeof t?String(t):t}function Z(e){var t,n=e.target.value,a=X()||"";void 0!==n&&n!==a&&(null===(t=d.onChange)||void 0===t||t.call(d,e,n),U(n))}function $(e){if(w.current!==e||ee(d)){w.current=e;var t=d.onGetErrorMessage&&d.onGetErrorMessage(e||"");if(void 0!==t)if("string"!=typeof t&&"then"in t){var n=++E;t.then(function(t){n===E&&R(t),te(e,t)})}else R(t),te(e,t);else te(e,"")}}function ee(e){return!(e.validateOnFocusIn||e.validateOnFocusOut)}function te(e,t){e===X()&&d.onNotifyValidationResult&&d.onNotifyValidationResult(t,e)}function ne(e){d.onFocus&&d.onFocus(e),d.validateOnFocusIn&&$(X())}function ae(e){d.onBlur&&d.onBlur(e),d.validateOnFocusOut&&$(X())}return d.multiline?function(e){var t,n="boolean"==typeof e.invalid?e.invalid:!!J(),a=y(A,{onFocus:ne,onBlur:ae,onChange:Z});a.className=l.a.apply(void 0,(0,i.g)(["ms-TextField-fieldGroup",L.fieldGroup,S.textAreaFieldGroup,!e.label&&e.required&&S.requiredWithoutLabel,e.borderless&&S.borderless],e.underlined?[S.underlineInteractive,S.underline]:[S.inputBackground],!1)),a.textarea={className:(0,l.a)("ms-TextField-field",L.field,e.inputClassName,e.autoAdjustHeight&&O.autoAdjustHeight,e.borderless&&S.borderless)};var o=z(),s={required:!e.onRenderLabel&&!!e.label&&e.required,hint:(null===(t=e.onRenderDescription)||void 0===t?void 0:t.call(e,e,Y))||e.description,validationMessage:o,validationState:n?"error":"none"};return r.createElement("div",{className:(0,l.a)("ms-TextField",L.root,e.className)},r.createElement(u.a,(0,i.a)({label:e.onRenderLabel||e.label?{children:e.onRenderLabel?K(e):e.label,className:(0,l.a)("ms-Label",S.label,s.required&&S.labelRequired)}:void 0},s,{className:(0,l.a)("ms-TextField-wrapper",L.wrapper,S.fieldDisplay)}),r.createElement(f.a,(0,i.a)({},a,{ref:M}))))}(d):function(e){var t,n,a,o="boolean"==typeof e.invalid?e.invalid:!!J(),s=y(A,{onFocus:ne,onBlur:ae,onChange:Z});s.contentBefore=(null===(t=e.onRenderPrefix)||void 0===t?void 0:t.call(e,e,q))||e.prefix,s.contentAfter=(null===(n=e.onRenderSuffix)||void 0===n?void 0:n.call(e,e,Q))||e.suffix||G(),s.className=(0,l.a)("ms-TextField-fieldGroup",S.root,L.fieldGroup,!e.label&&e.required&&S.requiredWithoutLabel,e.underlined?S.underline:S.inputBackground,e.borderless&&S.borderless),s.input={className:(0,l.a)("ms-TextField-field",L.field,e.inputClassName,e.borderless&&S.borderless)};var c=z(),d={required:!e.onRenderLabel&&!!e.label&&e.required,hint:(null===(a=e.onRenderDescription)||void 0===a?void 0:a.call(e,e,Y))||e.description,validationMessage:c,validationState:o?"error":"none"};return r.createElement("div",{className:(0,l.a)("ms-TextField",L.root,e.className)},r.createElement(u.a,(0,i.a)({label:e.onRenderLabel||e.label?{children:e.onRenderLabel?K(e):e.label,className:(0,l.a)("ms-Label",S.label,d.required&&S.labelRequired)}:void 0},d,{className:(0,l.a)("ms-TextField-wrapper",L.wrapper,S.fieldDisplay)}),r.createElement(p.a,(0,i.a)({},s,{ref:M}))))}(d)}),w=n(42),E=n(34),A=function(e){return(0,w.a)(a.a,O,e,E.a.FluentUIV9ShimTextField)}}
,,function(e,t,n){n.d(t,{a:function(){return b}});var a=n(0),i=n("react-lib");(0,n(8).b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-SharedWith{align-items:center;display:flex}.od-SharedWith .label{font-size:.875rem;font-weight:600;font:-apple-system-body;margin:0}[dir=ltr] .od-SharedWith .label{padding-right:4px}[dir=rtl] .od-SharedWith .label{padding-left:4px}.od-SharedWith-Facepile{display:flex;position:relative}.od-SharedWith-Facepile button.compact{height:auto;padding:2px;width:auto}.od-SharedWith-Facepile button.compact:hover{background-color:transparent}.od-SharedWith-Facepile li{display:flex}.od-SharedWith-List{display:flex}.od-SharedWith-List li{flex-shrink:0}.od-SharedWith-List:focus-visible{outline:1px solid}.od-SharedWith-Link--simplified{display:flex}.od-SharedWith-Link--simplified li{flex-shrink:0}.od-SharedWith-Link--simplified .ms-Button-flexContainer{align-items:flex-end}.od-SharedWith-Link--simplified,.od-SharedWith-More--simplified,.od-SharedWith-Persona--simplified{position:relative}.od-SharedWith-Link--simplified .ms-Button-flexContainer,.od-SharedWith-More--simplified .ms-Button-flexContainer,.od-SharedWith-Persona--simplified .ms-Button-flexContainer{align-items:center}.od-SharedWith-Link--simplified .fui-Avatar__image,.od-SharedWith-Link--simplified .ms-Image,.od-SharedWith-More--simplified .fui-Avatar__image,.od-SharedWith-More--simplified .ms-Image,.od-SharedWith-Persona--simplified .fui-Avatar__image,.od-SharedWith-Persona--simplified .ms-Image{border:2px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-SharedWith-Persona--simplified .ms-Persona-initials{position:relative;top:2px;right:-2px}.od-SharedWith-Persona--simplified .ms-Persona-initials.fui-Avatar__initials{position:absolute;left:2px}.od-SharedWith-More--simplified .ms-Persona-initials{border:2px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";color:"},{theme:"black",defaultValue:"#000"},{rawString:";background-color:"},{theme:"neutralLighterAlt",defaultValue:"#faf9f8"},{rawString:"}.od-SharedWith-More--simplified .fui-Avatar__initials{box-sizing:content-box}@media screen and (-ms-high-contrast:active),screen and (forced-colors:active){.od-SharedWith-More--simplified .ms-Persona-initials{box-sizing:unset;color:WindowText}}.od-SharedWith-Persona{display:flex;position:relative}.od-SharedWith-Persona-measure{left:0;position:absolute;visibility:hidden}.od-SharedWith-Persona .od-SharedWith-Persona-measure{margin-left:0}.od-SharedWith-Link .ms-Persona-initials{background-color:"},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:";color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-SharedWith-Link .ms-Persona-initials i{font-weight:400}@media screen and (-ms-high-contrast:active){.od-SharedWith-Link .ms-Persona-initials{color:WindowText}}.od-SharedWith-More .ms-Persona-initials{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}@media screen and (-ms-high-contrast:active){.od-SharedWith-More .ms-Persona-initials{color:WindowText}}.ms-Tooltip-subtext{font-size:.75rem}@supports (font:-apple-system-body){.ms-Tooltip-subtext{font:-apple-system-body}}.od-SharedWith-facepile-button{width:100%!important;height:auto}.od-SharedWith-facepile-button:hover{background-color:transparent!important}.od-SharedWith-facepile-button:active{background-color:transparent!important}.od-SharedWith-facepile-button:focus{outline:unset!important}.od-SharedWith-facepile-padding{padding:2px}"}]);var r=n(79),o=n(20),s=n(19),c=n("react-dom-lib"),d=n(56),l=n(14),u=n(75),f=n(13),p=n(323),m=n(61),_=n(24),h=n("prop-types-lib");function b(e,t){var n=e.ariaLabel,a=e.label,u=e.getPhotoUrl,f=e.onClick,p=e.isDiscoverable,h=e.isAccessRequest,b=e.isNotification,v=e.sharingPrincipals,S=e.sharingLinks,D=e.personaSizeInPixels,I=void 0===D?24:D,x=e.renderOverlap,C=(0,_.nb)(t.clientId,t.sharingStore)||(0,_.tb)(t.clientId,t.sharingStore),O=i.useRef(null),w=i.useRef(null),E=i.useRef(null),A=i.useRef(null),L=i.useState(!0),k=L[0],M=L[1],P=i.useState(0),T=P[0],U=P[1],F=i.useRef(0),H=i.useRef(0),R=i.useMemo(function(){var e=[],a={},c=0;if(S.length)for(var d=0,l=S;d<l.length;d++){var p=l[d];if(p.principals.length||p.invitees.length){for(var m=0,h=p.principals;m<h.length;m++)a[(P=h[m]).loginName||P.email]=P;var b=new Date(p.expiration);if(p.isActive&&(!p.expiration||b.getTime()>Date.now()))for(var D=0,O=p.invitees;D<O.length;D++)a[(P=O[D]).loginName||P.email]=P}c++}for(var w=0,E=v;w<E.length;w++)a[(P=E[w]).loginName||P.email]=P;if(F.current=y(a,r.a.user),H.current=y(a,r.a.securityGroup,r.a.sharePointGroup),c&&!C){var A=1===c?o.tj:(0,s.d)(o.ej,c),L=A+(n?", "+n:"");e.push(i.createElement(g,{ariaLabel:L,className:"".concat(C&&x?"od-SharedWith-Link--simplified":"od-SharedWith-Link"),iconName:"Link",key:".link",onClick:f,title:A,personaSizeInPixels:I,renderOverlap:x}))}for(var k=0,M=Object.keys(a);k<M.length;k++){var P,T=M[k],U=void 0;U=(P=a[T]).imageUrl?P.imageUrl:P.type===r.a.user&&u?u(T):void 0,(0,_.$)(U,t.clientId)&&(U=void 0);var R=P.primaryText+(n?", "+n:""),N=P.email&&P.email!==P.primaryText?"".concat(P.primaryText," <").concat(P.email,">"):P.primaryText;e.push(i.createElement(g,{ariaLabel:R,imageUrl:U,className:"".concat(C&&x?"od-SharedWith-Persona--simplified":""),key:P.primaryText,onClick:f,text:P.primaryText,title:N,personaSizeInPixels:I,renderOverlap:x}))}return e},[v,S]);i.useEffect(function(){return O.current=new IntersectionObserver(G,{root:A.current,threshold:1}),function(){return O.current.disconnect()}},[]),i.useEffect(function(){if(O.current&&w.current){for(var e=[],n=0;n<w.current.children.length;n++){var a=w.current.children[n];O.current.observe(a),e.push(a)}return function(){for(var n,a=0,i=e;a<i.length;a++){var r=i[a];O.current.unobserve(r)}null===(n=t.resize)||void 0===n||n.call(t)}}});var N=b?function(e,t,n,a){var i="",c="";if(1===t)i=o.Nj;else if(t>1)i=s.d(o.qe,t);else if(e>0&&e<=3)for(var d=0;d<n.length;d++)n[d].type===r.a.user&&(c+="".concat(n[d].primaryText)),e>=2&&(d===n.length-2?c+=s.d(o.H):d<n.length-2&&(c+=", "));else e>3?c=s.d(o.Ye,e):1===e&&(c=o.jj);return 0!==t&&(e>1?c=s.d(o.Ye,e):1===e&&(c=o.jj)),s.d(a?o.mi:o.ij,c,t>0&&e>0?o.H:"",i)}(F.current,H.current,v,h):function(e,t,n,a){var i="",r="",c="",d="";1===e?c=o.jj:e>1&&(c=s.d(o.Ye,e)),1===t?r=o.Nj:t>1&&(r=s.d(o.qe,t)),1===n?i=o.Bj:n>1&&(i=s.d(o.Qe,n)),a&&(d=o.Kc);var l=[d,c,r,i].filter(function(e){return""!==e}).join(", ");return""===l?o._f:s.d(o.aj,l)}(F.current,H.current,S.length,p),B="".concat(N," ").concat(o.Ei),j=o.nj+(n?" "+n:""),V=!k&&i.createElement(d.d,{className:"od-SharedWith-facepile-button",onClick:f,tabIndex:0,"data-is-focusable":!0,"aria-label":B},i.createElement("ul",{className:"od-SharedWith-List",ref:E,tabIndex:-1,id:"od-SharedWith-List"},R.slice(0,T<R.length-1?T:void 0),T<R.length-1?i.createElement(g,{ariaLabel:j,className:"".concat(C&&x?"od-SharedWith-More--simplified":"od-SharedWith-More"),iconName:"More",key:".more",onClick:f,title:o.nj,personaSizeInPixels:I,renderOverlap:x}):null)),z=i.createElement("div",{"aria-label":a,className:"od-SharedWith-Facepile"},V,i.createElement("ul",{"aria-hidden":!0,className:"od-SharedWith-List od-SharedWith-Persona-measure",ref:w,role:"presentation"},R));return i.useEffect(function(){if((null==E?void 0:E.current)&&(null==w?void 0:w.current))if(C&&x){for(var e=(0,_.Q)(),t=0;t<E.current.children.length;t++){var n=E.current.children[t];e?n.style.left="".concat(6*t,"px"):n.style.right="".concat(6*t,"px")}for(t=0;t<w.current.children.length;t++)n=w.current.children[t],e?n.style.left="".concat(6*t,"px"):n.style.right="".concat(6*t,"px");for(t=0;t<w.current.children.length;t++)(a=w.current.children[t].firstChild).setAttribute("data-is-focusable","false"),a.setAttribute("tabindex","-1")}else for(t=0;t<w.current.children.length;t++){var a;(a=w.current.children[t].firstChild.firstChild).setAttribute("data-is-focusable","false"),a.setAttribute("tabindex","-1")}}),C?i.createElement("div",{className:"od-SharedWith",ref:A},a&&i.createElement("h2",{className:"label"},a),i.createElement(m.a,{hostClassName:"od-SharedWith-tooltip",calloutProps:{gapSpace:0,directionalHint:e.isNotification?l.a.topCenter:l.a.topLeftEdge},content:"".concat(N," ").concat(e.isNotification?o.Ei:"")},z)):i.createElement("div",{className:"od-SharedWith",ref:A},a&&i.createElement("h2",{className:"label"},a),z);function G(e){var t=0,n=1e3;if(w.current){for(var a=0,i=e;a<i.length;a++)for(var r=i[a],o=0;o<w.current.children.length;o++)if(w.current.children[o]===r.target){r.intersectionRect.width===r.boundingClientRect.width?t=Math.max(t,o):n=Math.min(n,o);break}0===t&&1e3!==n&&(t=Math.max(0,n-1)),(0,c.unstable_batchedUpdates)(function(){U(function(e){return e!==t?t:e}),M(!1)})}}}function g(e,t){var n=e.ariaLabel,r=e.className,o=e.iconName,s=e.imageUrl,c=e.onClick,d=e.text,h=e.title,b=e.personaSizeInPixels,g=(e.renderOverlap,v(b)),y=b/16,S=(0,_.nb)(t.clientId,t.sharingStore)||(0,_.tb)(t.clientId,t.sharingStore),D={styles:{coin:{width:"".concat(y,"rem"),height:"".concat(y,"rem")},image:{width:"".concat(y,"rem!important"),height:"".concat(y,"rem !important")},imageArea:{width:"".concat(y,"rem"),height:"".concat(y,"rem")},initials:{width:"".concat(y,"rem"),height:"".concat(y,"rem"),fontSize:"0.625rem",lineHeight:"".concat(y,"rem")}}},I={className:!S&&"od-SharedWith-facepile-padding",text:d,imageUrl:s,hidePersonaDetails:!0,showInitialsUntilImageLoads:!0,size:g||u.c.size24,onRenderInitials:o?function(){return i.createElement(f.a,{iconName:o})}:void 0,coinProps:D,styles:{root:{height:"1.5rem",minWidth:"".concat(b,"px")},primaryText:{fontSize:"0.875rem"},secondaryText:{fontSize:"0.75rem"}}},x=i.createElement(p.a,(0,a.a)({},I));return x=c?i.createElement("span",{tabIndex:-1,"aria-label":n,"data-is-focusable":!1,role:"img"},x):i.createElement("span",{className:"od-SharedWith-noninteractivePersona",tabIndex:0,"aria-label":n,"data-is-focusable":!0,role:"img"},x),S?i.createElement("li",{className:r},x):i.createElement("li",{className:r},i.createElement(m.a,{hostClassName:"od-SharedWithPersona-tooltip",calloutProps:{gapSpace:0},content:h,directionalHintForRTL:l.a.topLeftEdge},x))}!function(){if("object"==typeof window)if("IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype)"isIntersecting"in window.IntersectionObserverEntry.prototype||Object.defineProperty(window.IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return this.intersectionRatio>0}});else{var e=function(e){for(var t=window.document,n=o(t);n;)n=o(t=n.ownerDocument);return t}(),t=[],n=null,a=null,i=function(e){this.time=e.time,this.target=e.target,this.rootBounds=l(e.rootBounds),this.boundingClientRect=l(e.boundingClientRect),this.intersectionRect=l(e.intersectionRect||{top:0,bottom:0,left:0,right:0,width:0,height:0}),this.isIntersecting=!!e.intersectionRect;var t=this.boundingClientRect,n=t.width*t.height,a=this.intersectionRect,i=a.width*a.height;this.intersectionRatio=n?Number((i/n).toFixed(4)):this.isIntersecting?1:0},r=function(){function r(e,t){this.THROTTLE_TIMEOUT=100,this.POLL_INTERVAL=null,this.USE_MUTATION_OBSERVER=!0;var n,a,i,r=t||{};if("function"!=typeof e)throw new Error("callback must be a function");if(r.root&&1!=r.root.nodeType&&9!=r.root.nodeType)throw new Error("root must be a Document or Element");this._checkForIntersections=(n=this._checkForIntersections.bind(this),a=this.THROTTLE_TIMEOUT,i=null,function(){i||(i=setTimeout(function(){n(),i=null},a))}),this._callback=e,this._observationTargets=[],this._queuedEntries=[],this._rootMarginValues=this._parseRootMargin(r.rootMargin),this.thresholds=this._initThresholds(r.threshold),this.root=r.root||null,this.rootMargin=this._rootMarginValues.map(function(e){return e.value+e.unit}).join(" "),this._monitoringDocuments=[],this._monitoringUnsubscribes=[]}return r.prototype._setupCrossOriginUpdater=function(){return n||(n=function(e,n){a=e&&n?u(e,n):{top:0,bottom:0,left:0,right:0,width:0,height:0},t.forEach(function(e){e._checkForIntersections()})}),n},r.prototype._resetCrossOriginUpdater=function(){n=null,a=null},r.prototype.observe=function(e){if(!this._observationTargets.some(function(t){return t.element==e})){if(!e||1!=e.nodeType)throw new Error("target must be an Element");this._registerInstance(),this._observationTargets.push({element:e,entry:null}),this._monitorIntersections(e.ownerDocument),this._checkForIntersections()}},r.prototype.unobserve=function(e){this._observationTargets=this._observationTargets.filter(function(t){return t.element!=e}),this._unmonitorIntersections(e.ownerDocument),0==this._observationTargets.length&&this._unregisterInstance()},r.prototype.disconnect=function(){this._observationTargets=[],this._unmonitorAllIntersections(),this._unregisterInstance()},r.prototype.takeRecords=function(){var e=this._queuedEntries.slice();return this._queuedEntries=[],e},r.prototype._initThresholds=function(e){var t=e||[0];return Array.isArray(t)||(t=[t]),t.sort().filter(function(e,t,n){if("number"!=typeof e||isNaN(e)||e<0||e>1)throw new Error("threshold must be a number between 0 and 1 inclusively");return e!==n[t-1]})},r.prototype._parseRootMargin=function(e){var t=(e||"0px").split(/\s+/).map(function(e){var t=/^(-?\d*\.?\d+)(px|%)$/.exec(e);if(!t)throw new Error("rootMargin must be specified in pixels or percent");return{value:parseFloat(t[1]),unit:t[2]}});return t[1]=t[1]||t[0],t[2]=t[2]||t[0],t[3]=t[3]||t[1],t},r.prototype._monitorIntersections=function(t){var n=t.defaultView;if(n&&-1==this._monitoringDocuments.indexOf(t)){var a=this._checkForIntersections,i=null,r=null;this.POLL_INTERVAL?i=n.setInterval(a,this.POLL_INTERVAL):(s(n,"resize",a,!0),s(t,"scroll",a,!0),this.USE_MUTATION_OBSERVER&&"MutationObserver"in n&&(r=new n.MutationObserver(a)).observe(t,{attributes:!0,childList:!0,characterData:!0,subtree:!0})),this._monitoringDocuments.push(t),this._monitoringUnsubscribes.push(function(){var e=t.defaultView;e&&(i&&e.clearInterval(i),c(e,"resize",a,!0)),c(t,"scroll",a,!0),r&&r.disconnect()});var d=this.root&&(this.root.ownerDocument||this.root)||e;if(t!=d){var l=o(t);l&&this._monitorIntersections(l.ownerDocument)}}},r.prototype._unmonitorIntersections=function(t){var n=this._monitoringDocuments.indexOf(t);if(-1!=n){var a=this.root&&(this.root.ownerDocument||this.root)||e,i=this._observationTargets.some(function(e){var n=e.element.ownerDocument;if(n==t)return!0;for(;n&&n!=a;){var i=o(n);if((n=i&&i.ownerDocument)==t)return!0}return!1});if(!i){var r=this._monitoringUnsubscribes[n];if(this._monitoringDocuments.splice(n,1),this._monitoringUnsubscribes.splice(n,1),r(),t!=a){var s=o(t);s&&this._unmonitorIntersections(s.ownerDocument)}}}},r.prototype._unmonitorAllIntersections=function(){var e=this._monitoringUnsubscribes.slice(0);this._monitoringDocuments.length=0,this._monitoringUnsubscribes.length=0;for(var t=0;t<e.length;t++)e[t]()},r.prototype._checkForIntersections=function(){if(this.root||!n||a){var e=this._rootIsInDom(),t=e?this._getRootRect():{top:0,bottom:0,left:0,right:0,width:0,height:0};this._observationTargets.forEach(function(a){var r=a.element,o=d(r),s=this._rootContainsTarget(r),c=a.entry,l=e&&s&&this._computeTargetAndRootIntersection(r,o,t),u=null;this._rootContainsTarget(r)?n&&!this.root||(u=t):u={top:0,bottom:0,left:0,right:0,width:0,height:0};var f=a.entry=new i({time:window.performance&&performance.now&&performance.now(),target:r,boundingClientRect:o,rootBounds:u,intersectionRect:l});c?e&&s?this._hasCrossedThreshold(c,f)&&this._queuedEntries.push(f):c&&c.isIntersecting&&this._queuedEntries.push(f):this._queuedEntries.push(f)},this),this._queuedEntries.length&&this._callback(this.takeRecords(),this)}},r.prototype._computeTargetAndRootIntersection=function(t,i,r){if("none"!=window.getComputedStyle(t).display){for(var o,s,c,l,f,m,_,h,b=i,g=p(t),v=!1;!v&&g;){var y=null,S=1==g.nodeType?window.getComputedStyle(g):{};if("none"==S.display)return null;if(g==this.root||9==g.nodeType)if(v=!0,g==this.root||g==e)n&&!this.root?!a||0==a.width&&0==a.height?(g=null,y=null,b=null):y=a:y=r;else{var D=p(g),I=D&&d(D),x=D&&this._computeTargetAndRootIntersection(D,I,r);I&&x?(g=D,y=u(I,x)):(g=null,b=null)}else{var C=g.ownerDocument;g!=C.body&&g!=C.documentElement&&"visible"!=S.overflow&&(y=d(g))}if(y&&(o=y,s=b,c=Math.max(o.top,s.top),l=Math.min(o.bottom,s.bottom),f=Math.max(o.left,s.left),h=l-c,b=(_=(m=Math.min(o.right,s.right))-f)>=0&&h>=0&&{top:c,bottom:l,left:f,right:m,width:_,height:h}||null),!b)break;g=g&&p(g)}return b}},r.prototype._getRootRect=function(){var t;if(this.root&&!m(this.root))t=d(this.root);else{var n=m(this.root)?this.root:e,a=n.documentElement,i=n.body;t={top:0,left:0,right:a.clientWidth||i.clientWidth,width:a.clientWidth||i.clientWidth,bottom:a.clientHeight||i.clientHeight,height:a.clientHeight||i.clientHeight}}return this._expandRectByRootMargin(t)},r.prototype._expandRectByRootMargin=function(e){var t=this._rootMarginValues.map(function(t,n){return"px"==t.unit?t.value:t.value*(n%2?e.width:e.height)/100}),n={top:e.top-t[0],right:e.right+t[1],bottom:e.bottom+t[2],left:e.left-t[3],height:0,width:0};return n.width=n.right-n.left,n.height=n.bottom-n.top,n},r.prototype._hasCrossedThreshold=function(e,t){var n=e&&e.isIntersecting?e.intersectionRatio||0:-1,a=t.isIntersecting?t.intersectionRatio||0:-1;if(n!==a)for(var i=0;i<this.thresholds.length;i++){var r=this.thresholds[i];if(r==n||r==a||r<n!=r<a)return!0}},r.prototype._rootIsInDom=function(){return!this.root||f(e,this.root)},r.prototype._rootContainsTarget=function(t){var n=this.root&&(this.root.ownerDocument||this.root)||e;return f(n,t)&&(!this.root||n==t.ownerDocument)},r.prototype._registerInstance=function(){t.indexOf(this)<0&&t.push(this)},r.prototype._unregisterInstance=function(){var e=t.indexOf(this);-1!=e&&t.splice(e,1)},r}();window.IntersectionObserver=r,window.IntersectionObserverEntry=i}function o(e){try{return e.defaultView&&e.defaultView.frameElement||null}catch(e){return null}}function s(e,t,n,a){"function"==typeof e.addEventListener?e.addEventListener(t,n,a||!1):"function"==typeof e.attachEvent&&e.attachEvent("on"+t,n)}function c(e,t,n,a){"function"==typeof e.removeEventListener?e.removeEventListener(t,n,a||!1):"function"==typeof e.detatchEvent&&e.detatchEvent("on"+t,n)}function d(e){var t;try{t=e.getBoundingClientRect()}catch(e){}return t?(t.width&&t.height||(t={top:t.top,right:t.right,bottom:t.bottom,left:t.left,width:t.right-t.left,height:t.bottom-t.top}),t):{top:0,bottom:0,left:0,right:0,width:0,height:0}}function l(e){return!e||"x"in e?e:{top:e.top,y:e.top,bottom:e.bottom,left:e.left,x:e.left,right:e.right,width:e.width,height:e.height}}function u(e,t){var n=t.top-e.top,a=t.left-e.left;return{top:n,left:a,height:t.height,width:t.width,bottom:n+t.height,right:a+t.width}}function f(e,t){for(var n=t;n;){if(n==e)return!0;n=p(n)}return!1}function p(t){var n=t.parentNode;return 9==t.nodeType&&t!=e?o(t):(n&&n.assignedSlot&&(n=n.assignedSlot.parentNode),n&&11==n.nodeType&&n.host?n.host:n)}function m(e){return e&&9===e.nodeType}}(),b.contextTypes={clientId:h.number.isRequired,resize:h.func.isRequired,sharingStore:h.object.isRequired},g.contextTypes={sharingStore:h.object.isRequired,clientId:h.number.isRequired};var v=function(e){switch(e){default:return u.c.size24;case 28:return u.c.size28;case 48:return u.c.size48}},y=function(e,t,n){var a=0;for(var i in e)(e[i].type===t||n&&e[i].type===n)&&a++;return a}}
,function(e,t,n){n.d(t,{a:function(){return g}});var a=n(500),i=n(0),r=n("react-lib"),o=n(501),s=n(5),c=n(43),d=n(83),l=n(3),u=n(44),f=new Set(["alignContent","styles","theme","vertical","className"]),p=(0,c.a)({noFlexGrow:{flexGrow:0},verticalPadding:(0,i.a)({},d.a.padding("0","4px")),horizontalPadding:(0,i.a)({},d.a.padding("4px","0"))}),m=(0,s.a)({useStaticStyles:!0}),_=function(e){var t=function(e){var t,n,a=p(),r=m(e.styles),o=null!==(t=e.vertical)&&void 0!==t&&t,s={alignContent:null!==(n=e.alignContent)&&void 0!==n?n:"center",vertical:o,className:(0,l.a)(a.noFlexGrow,o&&a.verticalPadding||a.horizontalPadding,e.className,r.root,"ms-SeparatorShim")};return(0,i.a)((0,i.a)({},s),(0,u.b)(e,f))}(e);return r.createElement(o.a,(0,i.a)({},t),e.children)};_.displayName="SeparatorShim";var h=n(42),b=n(34),g=function(e){return(0,h.a)(a.a,_,e,b.a.FluentUIV9ShimSeparator)}}
,function(e,t){t.a={anyone:0,workGroup:1,specificPeople:2,onlyYou:3,existing:4,chat:5,mail:6}}
,function(e,t,n){n.d(t,{a:function(){return r}});var a=n(0),i=n(44),r=function(e){var t=(0,i.a)(e);return(0,a.a)((0,a.a)({},t),(0,i.b)(e,o))},o=new Set(["ariaLabelledBy","componentRef","disableFirstFocus","disableRestoreFocus","disabled","elementToFocusOnDismiss","enableAriaHiddenSiblings","firstFocusableSelector","firstFocusableTarget","focusPreviouslyFocusedInnerElement","forceFocusInsideTrap","ignoreExternalFocusing","isClickableOutsideFocusTrap"])}
,,,,,,,,function(e,t){var n;!function(e){e[e.button=0]="button",e[e.link=1]="link",e[e.copyLink=2]="copyLink"}(n||(n={})),t.a=n}
,function(e,t,n){n.d(t,{a:function(){return s}});var a=n(0);(0,n(8).b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ActivityIndicator{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);z-index:2;text-align:center}.od-ActivityIndicator .ms-Spinner{display:inline-block;width:1.75rem}.od-ActivityIndicator span{font-size:1rem}"}]);var i=n("react-lib"),r=n(100),o=n(101),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.d)(t,e),t.prototype.render=function(){return i.createElement("div",{className:"od-ActivityIndicator","aria-hidden":this.props.ariaHidden,"aria-live":"assertive"},i.createElement("div",null,i.createElement(r.a,{type:o.b.large,styles:{circle:{width:"1.75rem",height:"1.75rem",borderWidth:"0.09375rem"},label:{fontSize:"0.75rem"}}})),i.createElement("span",{role:"alert"},this.props.message))},t}(i.Component)}
,function(e,t,n){n.d(t,{a:function(){return i}});var a=n(29);function i(e){return void 0===e&&(e=new a.a),{BrowserIsMobile:e.isMobile,BrowserIsPWA:e.isPWA,BrowserMajVer:e.browserMajor,BrowserMinVer:e.browserMinor,BrowserName:e.browserName,BrowserUserAgent:e.userAgent,OSName:e.osName,OSVersion:e.osVersion}}}
,function(e,t,n){function a(){}n.d(t,{a:function(){return a}})}
,function(e,t,n){n.d(t,{a:function(){return s}});var a,i=n(28),r=n(12),o=(0,i.a)({eventName:"PageInit,",shortEventName:"PageInit"},{screenWidth:r.a.Number,screenHeight:r.a.Number,availableScreenWidth:r.a.Number,availableScreenHeight:r.a.Number,renderWidth:r.a.Number,renderHeight:r.a.Number,browserWidth:r.a.Number,browserHeight:r.a.Number,devicePixelRatio:r.a.Number,referrer:r.a.String}),s=function(){function e(){}return e.init=function(){return a||(a=o.logData({screenWidth:window.screen.width,screenHeight:window.screen.availHeight,availableScreenWidth:window.screen.availWidth,availableScreenHeight:window.screen.availHeight,renderWidth:window.innerWidth,renderHeight:window.innerHeight,browserWidth:window.outerWidth,browserHeight:window.outerHeight,devicePixelRatio:window.devicePixelRatio?window.devicePixelRatio:0})),a},e}()}
,function(e,t,n){n.d(t,{a:function(){return P},b:function(){return F}});var a,i,r=n(0),o=n(10),s=n(49),c=n(36),d=n(90),l=n(12),u=(0,d.a)({eventName:"Beacon,",shortEventName:"Beacon"},{name:l.a.String,status:l.a.String,success:l.a.Boolean,retryCount:l.a.Number,totalRetries:l.a.Number,eventCount:l.a.Number}),f=n(78),p=n(29),m=n(251),_=function(){function e(e,t,n,a,i){this._endpointUrl=e.callbackEndpoint.authority+e.callbackEndpoint.path;var r={};if(i)for(var o=0;o<i.length;++o)r[i[o].EventType]=r[i[o].EventType]+1||1;var s={TelemetryTenantId:e.telemetryTenantToken.substring(0,32),AppVersion:e.appVersion,EventType:t,StatusCode:n,EventCount:i?i.length:0,Timestamp:a,Environment:e.environment||"",DatapointSchemaVersion:"1.0",TelemetrySource:"Aria",EventSummary:r,Workload:e.workload||"",FarmLabel:e.farmLabel||"",FarmName:e.farmName||""};this._dataCompletenessJson=JSON.stringify(s)}return Object.defineProperty(e.prototype,"endpointUrl",{get:function(){return this._endpointUrl},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dataCompletenessJson",{get:function(){return this._dataCompletenessJson},enumerable:!1,configurable:!0}),e.prototype.send=function(){new m.a({method:"POST",url:this._endpointUrl,json:this._dataCompletenessJson,requestTimeoutInMS:1e3}).start(function(e,t){},function(e,t,n){})},e}(),h=n(37),b=n(352),g=function(){function e(e){this._handlerLoader=e}return e.prototype.attach=function(e){var t,n=!1;return this._getHandler().then(function(a){n||(t=a.attach(e))}),function(){n=!0,t&&t()}},e.prototype._getHandler=function(){var e=this._handlerLoader();return this._getHandler=function(){return e},e},e}(),v=n(7),y="AriaBeacon",S={logStartEvents:!1,Init:function(e,t,n,i){var o=this;void 0===i&&(i={});try{S.logStartEvents=!0;var s,d=C(t,i.platformDetection),l=new h.a(t.completenessCallbackEndpoint),p={telemetryTenantToken:e,appVersion:t.version,environment:t.environment,workload:t.workload,farmLabel:t.farmLabel,farmName:t.farmName,callbackEndpoint:l},m={ariaLoader:function(){return v.c.resolve(n)},context:d,tenantToken:e,disableCookies:t.disableCookies,ariaLogConfiguration:{collectorUrl:t.collectorUrl},logStartEvents:S.logStartEvents,offlineDetection:i.offlineDetection,offlineCache:i.offlineCache,ariaQos:{isQosEvent:function(e){return u.isTypeOf(e)&&!!e.data&&e.data.name===y},reportQos:function(e){var t=e.result,n=e.statusCode,a=e.events;new u({name:y,retryCount:0,totalRetries:0,eventCount:a?a.length:0}).end({success:0===t,status:n+""}),""!==l.authority&&new _(p,t,n,(new Date).getTime(),a).send()}}},b=t.getAuthToken?new g(function(){return(0,r.b)(o,void 0,void 0,function(){var e;return(0,r.e)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,t.getAuthToken()];case 1:return e=n.sent(),[3,3];case 2:return n.sent(),[3,3];case 3:return[2,a=new x((0,r.a)({userAuthToken:e},m))]}})})}):a=new I(m);return s=i.customManager?b.attach(i.customManager):b.attach(c.a),function(){s(),a=void 0}}catch(e){return e instanceof n.Exception&&(e=new Error("Aria error: ".concat(e.toString()))),f.a.log(e),a=void 0,function(){}}},updateContext:function(e,t){if(void 0===t&&(t={}),a){var n=C(e,t.platformDetection);a.updateContext(n)}},isInitialized:function(e){return!!a},flushTelemetry:function(){return(0,r.b)(this,void 0,void 0,function(){return(0,r.e)(this,function(e){switch(e.label){case 0:return a?[4,a.flush()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})}},D=S,I=(i=l.b.requiredService,function(e){var t="function"==typeof i?i:function(){return i};return function(e){function n(n){var a=n.onLogEvent;return e.call(this,(0,r.a)((0,r.a)({},n),{onLogEvent:function(e){var n=a?a(e):e;if(n.data)return(0,r.a)((0,r.a)({},n),{data:(0,r.a)((0,r.a)({},n.data),{privacyClassification:t(n)})})}}))||this}return(0,r.d)(n,e),n}(e)})(b.a),x=function(e){function t(t){var n=t.context,a=void 0===n?{}:n,i=t.userAuthToken,o=t.userId,s=(t.context,(0,r.f)(t,["userAuthToken","userId","context"])),c=i&&function(e){try{var t=e.split(".")[1];if(t)return JSON.parse(atob(t.replace(/-/g,"+").replace(/_/g,"/")))}catch(e){return}}(i),d=c&&c.puid?"Business":"Unknown",l=c&&c.app_displayname||"Unknown",u=c&&c.appid||"Unknown",f=function(e,t,n){return e?"Unknown"===n?"":e:"Business"===n&&t&&t.puid||""}(o,c,d),p=f?1:0,m=c&&c.tid||"Unknown";return e.call(this,(0,r.a)({context:(0,r.a)({AccountType:d,AppName:l,AppId:u,IsAuthenticated:p,SiteSubscriptionId:m,UserId:f},a)},s))||this}return(0,r.d)(t,e),t}(I);function C(e,t){return void 0===t&&(t=new p.a),(0,r.a)({AccountType:s.a[e.accountType],BrowserIsMobile:t.isMobile,BrowserIsPWA:t.isPWA,BrowserMajVer:t.browserMajor,BrowserMinVer:t.browserMinor,BrowserName:t.browserName,BrowserUserAgent:t.userAgent,CloudType:e.cloudType,Environment:e.environment,FarmLabel:e.farmLabel,FarmName:e.farmName,IsAuthenticated:e.isAuthenticated?1:0,Market:e.market,Manifest:e.manifest,OSName:t.osName,OSVersion:t.osVersion,Session:e.session,SiteSubscriptionId:e.siteSubscriptionId||"",UserId:e.userId,Version:e.version,Workload:e.workload,SiteId:e.siteId,WebId:e.webId,WebTemplateId:e.webTemplateId,pageCorrelationId:e.pageCorrelationId,originalSession:e.originalSession,ResourceTenantId:e.resourceTenantId,listId:e.listId,product:e.product,SessionId:e.session,TenantId:e.siteSubscriptionId,UserAgent:t.userAgent,ServerGU:e.sideBySideToken},e.context||{})}var O,w,E=n(1),A=n(116);function L(){return n.e("odsp.aria.lib").then(n.bind(n,"aria-lib"))}var k={ODB:-990,ODC:"ForceEnableAria"},M={ODB:1607,ODC:"EnableAll1DSTelemetry"},P=function(){function e(){}return e.Init=function(e,t,n,a,i){void 0===n&&(n=L),e&&T(t)&&(O=n().then(function(n){D.Init(e,t,n,{offlineDetection:a,customManager:i})},function(e){}))},e.InitCustomerPromise=function(e,t,n,a){void 0===n&&(n=L),e&&T(t)&&(w=n().then(function(n){D.Init(e,t,n,{offlineDetection:a,customManager:(0,A.a)()})},function(e){}))},e.UpdateContext=function(e){O&&O.then(function(){D.updateContext(e)}).catch(function(){}),w&&w.then(function(){D.updateContext(e)}).catch(function(){})},Object.defineProperty(e,"logStartEvents",{get:function(){return D.logStartEvents},set:function(e){D.logStartEvents=e},enumerable:!1,configurable:!0}),e.flushTelemetry=function(){return(0,r.b)(this,void 0,void 0,function(){return(0,r.e)(this,function(e){switch(e.label){case 0:if(!O)return[3,4];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,D.flushTelemetry()];case 2:case 3:return e.sent(),[3,4];case 4:return[2]}})})},e.getAriaTimeZone=function(e){var t=Math.abs(e),n=t%60,a=Math.floor(t/60);return"".concat(e>0?"-":"+").concat(a>=10?a:"0".concat(a),":").concat(n>=10?n:"0".concat(n))},e}();function T(e){var t=e.version,n=e.env2,a=!1;return E.a.isActivated("5C0A45DF-2014-4FE8-9D90-180A716AC309")||(a="onebox"===n),!(!E.b.isActivated("010437DC-D681-4308-A21E-8BD4ADE3783C","11/12/2021","Use session storage TAB test running flag to bypass client-side logging.")&&U("_isRunningTABTest"))&&("dev"!==t&&!a||!!o.a.isFeatureEnabled(k)||U("enableAriaUpload")||U("enableTelemetryUpload"))}function U(e){var t=!E.b.isActivated("6DC50D29-3FD6-465C-9E8D-80A877497A9D","10/10/2022","Ensure that a boolean value is returned and not undefined.");try{if("sessionStorage"in window&&window.sessionStorage){var n=window.sessionStorage[e],a=n&&"true"===n.toLowerCase();return t?!!a&&"undefined"!=typeof console&&!!console:a&&"undefined"!=typeof console&&!!console}}catch(e){}return!1}function F(){return o.a.isFeatureEnabled(M)}}
,function(e,t,n){n.d(t,{a:function(){return f}});var a=n(0),i=n(36),r=n(49),o=n(1),s=n(19),c=n(329);function d(e,t){var n=t.Session,i=t.Version,r=t.OSName,o=t.OSVersion,d=t.Market,l=t.UserId,u=t.Manifest,f=(0,a.f)(t,["Session","Version","OSName","OSVersion","Market","UserId","Manifest"]),p=e.getSemanticContext();if(n&&e.setContext("AppInfo.Session",n),u&&e.setContext("AppInfo.Manifest",u),i&&p.setAppVersion(i),p.setUserLanguage(d||""),l){var m=function(e){return e&&e.replace(/(membership\|urn(%3a|:)spo(%3a|:)guest#)([^@]+)(@[^@]+)$/i,function(e,t,n,a,i,r){return"".concat(t).concat((0,c.a)(i)).concat(r)})}(l);p.setUserId(m)}for(var _ in r&&p.setDeviceOsName(r),o&&p.setDeviceOsVersion(o),f)if(Object.prototype.hasOwnProperty.call(f,_)){if(null==f[_])continue;var h=(0,s.a)(_);e.setContext(h,f[_])}}var l=n(91),u=n(599),f=function(){function e(e){var t=this;this.logEvent=function(e){var n=t._onLogEvent?t._onLogEvent(e):e;t._createLogHandler().then(function(e){return e(n)})},this._getAria=p(function(){return e.ariaLoader().then(function(t){return function(e,t){e.LogManager.isInitialized()||(e.LogManager.initialize(t.tenantToken,(0,a.a)((0,a.a)({disableCookies:t.disableCookies},t.offlineCache?{browserOverrides:{onGetData:t.offlineCache.getData,onSaveData:t.offlineCache.saveData}}:{}),t.ariaLogConfiguration||{})),"undefined"!=typeof window&&"function"==typeof window.addEventListener&&window.addEventListener("beforeunload",function(){e.LogManager.flush()})),e.LogManager.addCallbackListener(function(e,n,a,i){a===t.tenantToken&&t.ariaQos&&t.ariaQos.reportQos({result:e,statusCode:n,events:i})})}(t,e),t})}),this._getLogger=p(function(){return t._getAria().then(function(a){var i=function(e,t,n){void 0===n&&(n={});var a=new e.Logger(t);return d(a,n),a}(a,e.tenantToken,e.context),r=e.offlineDetection;return u.a&&r?n.e(39).then(n.bind(n,586)).then(function(n){return t._offlineEventQueue=n.makeOfflineAriaEventQueue(i,e.tenantToken,r),[i,a]}):Promise.resolve([i,a])})}),this._createLogHandler=p(function(){return t._getLogger().then(function(n){var a=n[0],i=function(e,t,n,a,i){return void 0===n&&(n=!0),void 0===a&&(a=void 0),void 0===i&&(i=void 0),function(c){try{if((c.eventType!==r.b.Start||n)&&(!a||!a.isQosEvent(c))){var d=function(e,t,n){var a,i=function(e){for(var t={CorrelationVector:e.vector.toString(),WebLog_FullName:e.eventName,WebLog_EventType:r.b[e.eventType]},n=e.eventName.split(","),a=0,i=n;a<i.length;a++){var o=i[a];o&&(t["WebLog_Type_".concat(o)]=1)}var c=e.data,d=e.context;if(d)for(var l in d)if(Object.prototype.hasOwnProperty.call(d,l)){if(null==(f=d[l]))continue;t[m=(0,s.a)(l)]=f}if(c)for(var u in c)if(Object.prototype.hasOwnProperty.call(c,u)){var f;if(null==(f=c[u]))continue;var p=e.metadata[u];if(p){var m=p.isPrefixingDisabled?(0,s.a)(u):"".concat((0,s.a)(p.definedInName),"_").concat(u),_=p.type;if(4===_){for(var h in f)if(Object.prototype.hasOwnProperty.call(f,h)){var b=f[h];if(null!=b&&""!==b){var g=void 0;if("object"==typeof b)try{g=JSON.stringify(b)}catch(e){g=b}else g=b;t["".concat(m,"_").concat(h.replace(/\./g,"_"))]=g}}}else t[m]=6===_?p.typeRef[f]:f}}return{name:e.isEventTypePrefixingDisabled?n[n.length-2]:"ev_".concat(n[n.length-2]),values:t}}(t),c=i.name,d=i.values,l=new e.EventProperties;return l.name=c,o.b.isActivated("2657d5a5-7313-42a0-ab20-287781f44d1b")||("AppChrome.PageOpenedInTeamsVivaConnections1PAppContext"===(a=d.Name)||"SPO.DashboardWebPart.Load"===a||"AdaptiveCardExtension.CardAction"===a||"TeamsNavigation.Navigation.ClickedInTeamsviva1pAppContext"===a||"TeamsSiteHeader.RefreshButtonClicked"===a||"TeamsSiteHeader.CopyLinkButtonClicked.successful"===a||"TeamsSiteHeader.GoToBrowserButtonClicked"===a)&&(l.eventType="VivaAnalytics"),function(e,t,n,a){var i;try{for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(i=r,t.setProperty(r,n[r]))}catch(t){var o=void 0,s=void 0;throw t instanceof e.Exception&&(o=t.ErrorCode(),s=new Error("Aria error: ".concat(t.toString()))),s&&(t.handled=!0,a&&a.logError(s,{errorCode:o,propertyKey:i})),t}}(e,l,d,n),l}(e,c,l);u.a&&(null==i?void 0:i.storeEventIfNecessary(d))||t.logEvent(d)}}catch(t){var f=void 0;t instanceof e.Exception&&(f=new Error("Aria error: ".concat(t.toString()))),t&&t.handled||l.log(f||t)}}}(n[1],a,e.logStartEvents,e.ariaQos,t._offlineEventQueue);return i})}),this._onLogEvent=e.onLogEvent}return e.prototype.attach=function(e){if(this._createLogHandler(),i.b)return e.addEventHandler({sourceName:"AriaTelemetryHandler",handler:this.logEvent,handleMissedEvents:!0});var t=this.logEvent;return e.addLogHandler(t).forEach(t),function(){return e.removeLogHandler(t)}},e.prototype.updateContext=function(e){this._getLogger().then(function(t){return d(t[0],e)})},e.prototype.flush=function(){return this._getAria().then(function(e){e.LogManager.flush()})},e}();function p(e){var t=void 0;return function(){return t||(t=e()),t}}}
,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){var a,i,r;n.d(t,{a:function(){return p}});var o=!(!(null===window||void 0===window?void 0:window.Flight)||"dev"!==window.Flight.version&&!window.Flight.devMode),s=-1!==(null===(a=null===window||void 0===window?void 0:window.document)||void 0===a?void 0:a.cookie.indexOf("srr")),c=window&&"https://www.onedrive-tst.com"===(null===(i=window.location)||void 0===i?void 0:i.origin)&&-1!==(null===(r=window.document)||void 0===r?void 0:r.cookie.indexOf("devhost")),d=s||o||c,l="/files/fabric-cdn-prod_20240610.001",u="".concat("https://res-1.cdn.office.net").concat(l),f=d?u:"",p=function(e){var t,n;if(!f){var a=null===(n=null===(t=window.require)||void 0===t?void 0:t.toUrl)||void 0===n?void 0:n.call(t,"");f=a?"".concat(function(e){var t=e.indexOf("//"),n=e.indexOf("/"),a=t>-1&&t<=n?t+"//".length:-1;if(a>-1){var i=e.indexOf("/",a);return i>-1?e.slice(0,i):e}return""}(a)).concat(l):u}return"".concat(f).concat("")}()}
,function(e,t,n){n.d(t,{a:function(){return a}});var a=new(n(6).a)("navigation")}
,,function(e,t,n){n.d(t,{a:function(){return o}});var a=n(28),i=n(12),r=n(218),o=(0,a.a)({eventName:"Verbose,Trace,",shortEventName:"Verbose"},{name:{isKey:!0,type:i.a.String},privacyClassification:{isPrefixingDisabled:!0,type:i.a.String}},r.a).withData({privacyClassification:i.b.requiredService})}
,function(e,t,n){n.d(t,{a:function(){return i}});var a=n(50),i=function(e){void 0===e&&(e={});var t,n,i=e.message,r=e.innerError;i&&("string"==typeof i?t=i:(t=(0,a.b)(i))&&(n=i)),!t&&r&&(t=r.message,r.loggableMessage&&(n=r.loggableMessage));var o=new Error(t);for(var s in this.message=o.message,this.innerError=r,this.loggableMessage=n||(0,a.e)(this.message,!1),this.stack=o.stack,this.name=o.name,this)Object.prototype.hasOwnProperty.call(this,s)&&(o[s]=this[s]);var c=Object.getPrototypeOf(this);if(Error.captureStackTrace&&Error.captureStackTrace(o,c),Object.setPrototypeOf)return Object.setPrototypeOf(o,c),o};Object.setPrototypeOf&&(i.prototype=Object.create(Error.prototype,{constructor:{value:Error,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf(i,Error))}
,,,,function(e,t,n){n.r(t),n.d(t,{GraftOperationType:function(){return i},backup:function(){return s},default:function(){return d},optional:function(){return o},remove:function(){return r},replace:function(){return c}});var a=n(0),i={none:0,replace:1,optional:2,remove:3,backup:4};function r(){return{graftOperationType:i.remove}}function o(e){return{graftOperationType:i.optional,value:e}}function s(e){return{graftOperationType:i.backup,value:e}}function c(e){return{graftOperationType:i.replace,value:e}}function d(e,t){if(!l(e))throw new Error("Value for 'base' passed to 'graft' is not an object.");if(!l(t))throw new Error("Value for 'extension' passed to 'graft' is not an object");if(t===e)return e;for(var n=0,r=Object.keys(t);n<r.length;n++){var o=r[n],s=t[o],c=e[o];if(s!==c){var _=s;if(p(_))if(_.graftOperationType===i.replace)c=void 0,s=h=_.value;else if(_.graftOperationType===i.backup){var h=_.value;if(void 0!==e[o])continue;s=h}else{if(_.graftOperationType!==i.optional){if(m(_)){delete e[o];continue}throw new Error("Unknown patch specified for grafting. Only use exported functions from Graft to create patches.")}if(void 0===(h=_.value))continue;s=h}var b=void 0;if(u(s))b=new Date(s.getTime());else if(f(s)){var g=c;f(g)||(g=[]),g.splice.apply(g,(0,a.g)([0,g.length],s,!1)),b=g}else if(l(s)){var v=c;l(v)||(v={}),d(v,s),b=v}else b=s;e[o]=b}}return e}function l(e){return"object"==typeof e&&!!e}function u(e){return e instanceof Date}function f(e){return Array.isArray(e)}function p(e){return l(e)&&!!e.graftOperationType}function m(e){return e.graftOperationType===i.remove}}
,,,,function(e,t,n){n.d(t,{a:function(){return w},b:function(){return S},c:function(){return C},d:function(){return O}});var a=n(0),i=(n(225),n(226),n(227),n(1)),r=n(4),o=function(e){function t(t){var n=t.chunkId,a=t.error;return e.call(this,{name:"chunkLoadError",resultType:r.b.Failure,resultCode:n,error:a})||this}return(0,a.d)(t,e),t.prototype.send=function(){e.prototype.end.call(this)},t}(r.a);i.a.isActivated("6FA6188C-D5C4-4714-93E0-90339B6F2F07")||window.addEventListener("unhandledrejection",function(e){var t;"ChunkLoadError"===(null===(t=e.reason)||void 0===t?void 0:t.name)&&new o({chunkId:e.reason.chunkId,error:e.reason.message}).send()});var s,c=n(36),d=n(350),l=n(349),u=n(151),f=n(351),p=n(116),m=n(31),_=/[a-f0-9]{8}(?:-[a-f0-9]{4}){3}-[a-f0-9]{12}/gi,h=["guestaccesstoken","access_token","prooftoken","tempauth","share","auth_token","auth_key","originalPath","querytext","querytemplate","selectproperties","hithighlightedproperties","refiners","sortlist","refinementfilters","collapsespecification","hiddenconstraints","querytemplatepropertiesurl","zerotermsuggestions","pageinfo","immediacyquerystring","immediacytitle","immediacyurl","k","q","InplaceSearchQuery","Default"],b=["/_api/search/","/_api/searchsetting/","/results.aspx","/osssearchresults.aspx","/peopleresults.aspx","/conversationresults.aspx","/videoresults.aspx","/sharepoint.aspx","/search.aspx","RenderListDataAsStream"],g=n(38),v=n(49),y=i.b.isActivated("C3E59A6A-1D1B-479E-A536-AD846D2EBE39","5/18/2023","Use accountType from options, if available, or a better default logic");function S(e){void 0===e&&(e={});var t,n=e.pageContext,a=void 0===n?window._spPageContextInfo:n,r=e.spModuleLink,o=void 0===r?window._spModuleLink:r,s=a.env||"devbox",c=a.cloudType||s,d=a.env2,l="",u="",f=!1,p=void 0,m=c;switch(m.toLowerCase()){case"devbox":case"edog":case"prodbubble":case"spdf":t="ppe";break;default:m="prod",t="prod"}return"onebox"!==d||i.b.isActivated("C7635348-9E0C-4AD6-A922-EECF98EB3CB6")||(t="ppe"),o&&(l=o.buildNumber,u=o.manifestName,o.usingRedirectCookie?l="dev":(p=o.targetBuildNumber,f=o.isBuildAsExperimentRunning)),{version:l,manifest:u,appEnvironment:m,ariaEnvironment:t,isBuildAsExperimentRunning:f,buildAsExperimentTargetVersion:p}}function D(e){return e&&e.length>36&&(e=e.replace(/[{}]/g,"")),e}(0,l.a)();var I=void 0,x=void 0;function C(e){var t,n=function(e){if(s)return s;var t,n=e.pageContext,a=void 0===n?window._spPageContextInfo:n,i=S(e),r=i.version,o=i.manifest,c=i.appEnvironment,d=a.isAnonymousGuestUser,l=a.currentUICultureName,u=a.systemUserKey,f=a.userLoginName,p=a.siteSubscriptionId,m=a.farmLabel,_=a.farmName,h=a.siteId,b=a.webTemplate,I=a.webId,x=a.ariaCollectorUrl,C=a.oneDsCollectorUrl,O=a.CorrelationId,w=a.cloudType,E=a.getAuthToken,A=a.homeTenantId,L=a.aadTenantId,k=a.listId,M=a.SideBySideToken,P=a.env2;return t=y?f?v.a.Business:v.a.BusinessAnonymous:void 0!==e.accountType?e.accountType:d?v.a.BusinessAnonymous:v.a.Business,s={isAuthenticated:!d,market:l,session:e.sessionId||g.a.generate(),version:r,manifest:o,userId:u,accountType:t,siteSubscriptionId:p,farmLabel:m,farmName:_,collectorUrl:x,oneDsCollectorUrl:C,environment:c,env2:P,workload:e.workload,disableCookies:d,siteId:D(h),webTemplateId:b,webId:D(I),context:e.context,pageCorrelationId:O,cloudType:w,getAuthToken:E,listId:D(k),sideBySideToken:M,product:e.product,homeTenantId:A||L,resourceTenantId:L}}(e);if(n){var a=function(e){var t=S(e).ariaEnvironment,n=void 0===t?"ppe":t;return n&&e.tokens[n]}(e);if(e.initOneDS||(0,f.b)()){var i="spo-core-".concat(e.sourceName);I=new u.a({sourceName:i,tenantToken:a,context:n,offlineDetection:e.offlineDetection}),e.initCustomerPromise&&(x=new u.a({sourceName:i,tenantToken:a,context:n,offlineDetection:e.offlineDetection})),I.attach(null!==(t=e.customManager)&&void 0!==t?t:c.a),e.initCustomerPromise&&x.attach((0,p.a)())}else I=void 0,f.a.Init(a,n,e.ariaLoader,e.offlineDetection,e.customManager),e.initCustomerPromise&&(x=void 0,f.a.InitCustomerPromise(a,n,e.ariaLoader,e.offlineDetection))}}function O(e,t){if(s){var n=function(e){return s?s=(0,a.a)((0,a.a)({},s),e):null}(t);n=(0,a.a)((0,a.a)({},n),{context:(0,a.a)((0,a.a)({},s.context),e)}),I?(I.updateContext(n),null==x||x.updateContext(n)):f.a.UpdateContext(n)}}function w(){if(s)return I?(null==x||x.flush(),I.flush()):f.a.flushTelemetry()}c.a.cleanString=function(e,t,n){return function(e,t){void 0===t&&(t={});var n,a=t.keyDeclaration,i=t.pathsToSanitize,r=void 0===i?[]:i,o=t.keysToSanitize,s=void 0===o?[]:o;if(a&&a.isKey&&(e=e.replace(_,"<guid>")),e.indexOf("http")<0)return e;try{n=new m.a(e)}catch(t){return e}if(""===n.getAuthority())return e;for(var c=e,d=!1,l=0;l<r.length;l++)if(n.getPath().indexOf(r[l])>=0){d=!0;break}if(d)c="".concat(n.getScheme(),"://").concat(n.getAuthority()).concat(n.getPath(),"<scrubbedquerystring>...");else{for(var u=n.getQueryAsObject(),f=0;f<s.length;f++){var p=s[f];u[p]&&(u[p]="<scrubbed>")}n.setQueryFromObject(u),c=n.getDecodedStringForDisplay()}return c}(e,{key:t,keyDeclaration:n,keysToSanitize:h,pathsToSanitize:b})},d.a.init()}
,,,,,,function(e,t,n){n.d(t,{a:function(){return S}});var a=n(0),i=n(78),r=n(95),o=function(){function e(){this._localHandlers=[]}return e.init=function(){var e=this;this._initialized||(this._initialized=!0,this._originalBeforeUnload=window.onbeforeunload,window.onbeforeunload=window.__onbeforeunload=function(t){return e._handleBeforeUnload(t)})},e.registerHandler=function(e){this._handlers.push(e)},e.unRegisterHandler=function(e){for(var t=0;t<this._handlers.length;t++)if(this._handlers[t]===e){this._handlers.splice(t,1);break}},e.registerOnContinueHandler=function(e){this._onContinueHandler=e},e.unRegisterOnContinueHandler=function(e){this._onContinueHandler=null},e.dispose=function(){this._originalBeforeUnload?window.onbeforeunload=this._originalBeforeUnload:window.onbeforeunload=null},e._handleBeforeUnload=function(e){var t=void 0;if(!this._allowNavs){for(var n=0;n<this._handlers.length;n++)try{if(t=this._handlers[n](!0))break}catch(e){i.a.log(e)}if(!t&&this._originalBeforeUnload)try{t=this._originalBeforeUnload(e)}catch(e){i.a.log(e)}}return t||void 0},e.prototype.registerHashNavDialogCallback=function(e){this._hashNavDialogCallback=e},e.prototype.registerHashNavDialogHandler=function(e){if(this._hashNavDialogHandler)throw Error("Registering HashNavDialogHandler when one is already set");this._hashNavDialogHandler=e},e.prototype.unregisterHashNavDialogHandler=function(){this._hashNavDialogHandler=void 0},e.prototype.isHashNavDialogHandlerRegistered=function(){return!!this._hashNavDialogHandler},e.prototype.allowHashNav=function(t,n){var a=void 0;if(!e._isDialogOpen&&!e._allowNavs){for(var r=0;r<e._handlers.length;r++)try{if(a=e._handlers[r](!1))break}catch(e){i.a.log(e)}a&&(e._isDialogOpen=!0,this._hashNavDialogCallback(a).then(function(){e._isDialogOpen=!1,e._allowNavs=!0,e._blockNavsAgainId||(e._blockNavsAgainId=e._async.setImmediate(function(){e._allowNavs=!1,e._blockNavsAgainId=null})),t&&t()},function(){e._isDialogOpen=!1,n&&n()}))}return!a&&!e._isDialogOpen},e.prototype.blockHashNav=function(t,n){var a=this,r=null;if(this._dialogWasJustDismissed)return this._dialogWasJustDismissed=!1,!1;for(var o=0;o<e._handlers.length;o++)try{if(r=e._handlers[o](!1))break}catch(e){i.a.log(e)}return!(!r||!this._hashNavDialogHandler||(this._hashNavDialogHandler(r,function(){e._onContinueHandler?e._onContinueHandler().then(function(){a._dialogWasJustDismissed=!0,t()}).catch(function(){}):(a._dialogWasJustDismissed=!0,t())},n),0))},e.prototype.registerHandler=function(t){this._localHandlers.push(t),e.registerHandler(t)},e.prototype.unRegisterHandler=function(t){for(var n=0;n<this._localHandlers.length;n++)if(this._localHandlers[n]===t){this._localHandlers.splice(n,1);break}e.unRegisterHandler(t)},e.prototype.registerOnContinueHandler=function(t){e.registerOnContinueHandler(t)},e.prototype.unRegisterOnContinueHandler=function(t){e.unRegisterOnContinueHandler(t)},e.prototype.hasActiveBlock=function(){return 0!==this._localHandlers.length},e.prototype.dispose=function(){for(var t=0,n=this._localHandlers;t<n.length;t++){var a=n[t];e.unRegisterHandler(a)}},e._handlers=[],e._async=new r.a,e._initialized=!1,e}(),s=o;o.init();var c=n(29),d=n(58),l=n(164),u=n(1),f=n(65),p=n(230);function m(e){return"string"==typeof e?e:(0,p.a)(e)}var _=window.history,h=window.applicationCache,b=new c.a,g=!u.a.isActivated("DE394832-0B5E-447E-B070-CFB40B970AFE"),v=u.a.isActivated("a6d295af-8283-417b-85ed-1090c39b73cf"),y=!u.a.isActivated("E2B6560C-7D5A-4493-ABF2-F2DE0CA09EEE"),S=function(){function e(e){void 0===e&&(e={}),this._viewParamsString="",this._dontBlockNextNav=!1;var t=e.disableHashConversion,n=void 0!==t&&t,a=e.disableNavigationEventListeners,i=void 0!==a&&a,r=e.shouldReloadOnNavigate,o=e.history,c=e.prettyPathMap;this._overrideHistory=o,this._shouldReloadOnNavigate=r,this._performHashConversion=!n,this._disableNavigationEventListeners=e.disableNavigationEventListeners,this._viewParams={},this._prettyPathMap=c,this.scope=new l.a,this._prevHash=window.location.hash,this._supportsHistoryApi=_&&!!_.pushState&&(!h||h.status===h.UNCACHED),this.beforeUnload=new s,this.scope.attach(this.beforeUnload),this._events=this.scope.attach(new d.a(this)),this._events.declare("change"),i||this.setNavEventListeners("on"),this._updateUrlState()}return Object.defineProperty(e.prototype,"_history",{get:function(){return this._overrideHistory?this._overrideHistory:history},enumerable:!1,configurable:!0}),e.prototype.dispose=function(){this.setNavEventListeners("off"),this.scope.dispose()},Object.defineProperty(e.prototype,"viewParams",{get:function(){return this._viewParams},enumerable:!1,configurable:!0}),e.prototype.navigateTo=function(e){var t=this;if(g||this.beforeUnload.allowHashNav(function(){return t.navigateTo(e)})){var n="string"==typeof e?{url:e}:e,a=n.url,i=e.hasOwnProperty("viewParams")?e.viewParams:void 0,r=e.hasOwnProperty("directOpen")?e.directOpen:void 0,o=void 0,s=void 0;if(i&&"#"===i[0]?(o=i.substr(1),s=a):(o="#"===a[0]?a.substr(1):void 0,s=void 0),void 0===n.frameId&&b.isPWA&&"#"!==a&&(n.frameId="_blank"),void 0!==o)n.ignoreHistory?this._replaceState(o,!1,s):this._pushState(o,s);else{var c=void 0,d=!1;if(n&&n.frameId&&"_self"!==n.frameId)try{(c=window.open(r?a:"",n.frameId))&&"_blank"===n.frameId&&(c.opener=null),c&&!r&&(this._disableNavigationEventListeners&&"#"===a?this.updateViewParams("",{ignoreHistory:n.ignoreHistory,clearOtherParams:!0}):c.location.href=a),d=!0}catch(e){}if(!c&&!d)try{n.ignoreHistory?window.location.replace(a):window.location.href=a}catch(e){}}}},e.prototype.updateViewParams=function(e,t){void 0===t&&(t={});var n="string"==typeof e?(0,f.a)(e):e,i=(0,a.a)((0,a.a)({},t.clearOtherParams?{}:this._viewParams),n);!v&&t.paramsToDelete&&t.paramsToDelete.forEach(function(e){delete i[e]}),t.ignoreHistory?this._replaceState(i,t.clearPath):this._pushState(i)},e.prototype.updateViewParamsWithoutHistoryChange=function(e){var t={type:"popstate",state:{viewParams:e,useViewParamsFromState:!0}};this._updateUrlState(t)},e.prototype.getUrlFromViewParams=function(e){var t=m(e),n=this._getStateUrl(e,t);return"".concat(window.location.origin).concat(n)},e.prototype.reload=function(){window.location.reload()},e.prototype.setNavEventListeners=function(e){var t=("on"===e?this._events.on:this._events.off).bind(this._events);t(window,"hashchange",this._updateUrlState),t(window,"popstate",this._updateUrlState)},e.prototype._updateUrlState=function(e){var t=this,n=!1;if(g?!this.beforeUnload.blockHashNav(function(){return t._updateUrlState(e)},function(){return t._resetBeforeNavBlock()}):this._dontBlockNextNav||this.beforeUnload.allowHashNav(function(){return t._updateUrlState(e)},function(){return t._resetBeforeNavBlock()})){this._dontBlockNextNav=!1;var a=function(e){var t,n,a,i=e||{},r=i.event,o=i.prettyPathMap,s=!1,c="";(null===(n=null===location||void 0===location?void 0:location.href)||void 0===n?void 0:n.indexOf("#"))>-1?(c=location.hash.substr(1),s=!0):(null===(a=null===location||void 0===location?void 0:location.search)||void 0===a?void 0:a.length)&&(c=location.search.substr(1));var d=(0,f.a)(c);o&&(d=(t=o.getEffectiveViewParamState({currentPathname:(null===location||void 0===location?void 0:location.pathname)||"",actualViewParams:d,actualViewParamsString:c})).viewParams,c=t.viewParamsString);var l=function(e){var t="";if(e&&"popstate"===e.type&&e.state){var n=e.state,a=n.useViewParamsFromState,i=n.viewParams;a&&i&&(t=m(i))}return t}(r),u=(0,f.a)(l),p=u,_=l;for(var h in d)if(u[h]!==d[h]){p=d,_=c;break}return{viewParams:p,viewParamsString:_,usingHashParams:s}}({event:e,prettyPathMap:this._prettyPathMap}),i=a.viewParams,r=a.usingHashParams,o=a.viewParamsString;o!==this._viewParamsString&&(this._viewParamsString=o||"",this._viewParams=i,n=!0),e&&this._shouldReloadOnNavigate&&this._shouldReloadOnNavigate()&&window.location.reload(),r&&this._performHashConversion&&this._supportsHistoryApi&&this._replaceState(o),n&&this._events.raise("change"),this._prevHash=y?window.location.hash:window.document.location.hash}else n=!1,e&&e.preventDefault();return n},e.prototype._resetBeforeNavBlock=function(){if(this._dontBlockNextNav=!0,this._supportsHistoryApi)try{history.forward()}catch(e){this._hashNav(this._prevHash)}else this._hashNav(this._prevHash)},e.prototype._pushState=function(e,t){var n=m(e);if(this._supportsHistoryApi)try{var a=this._getStateUrl(e,n,void 0);this._history.pushState({},"",a)}catch(e){this._hashNav(n)}else this._hashNav(n);this._updateUrlState(),t&&this._setMaskUrl(t)},e.prototype._replaceState=function(e,t,n){var a=m(e);if(this._supportsHistoryApi)try{var i=this._getStateUrl(e,a,t);this._history.replaceState({},"",i)}catch(e){this._supportsHistoryApi=!1,this._hashNav(a)}else this._hashNav(a);this._updateUrlState(),n&&this._setMaskUrl(n)},e.prototype._setMaskUrl=function(e){if(e&&this._supportsHistoryApi){var t={useViewParamsFromState:!0,viewParams:this._viewParams};this._history.replaceState(t,"",e)}},e.prototype._getStateUrl=function(e,t,n){var a=y?window.location.pathname:document.location.pathname;return this._prettyPathMap?this._prettyPathMap.getUpdatedUrl({currentPathname:a,viewParams:e,viewParamsString:t,clearPath:n}):function(e){var t=e.viewParamsString;return"".concat(e.clearPath?"/":e.pathname).concat(t.length>0?"?":"").concat(t)}({pathname:a,viewParamsString:t,clearPath:n})},e.prototype._hashNav=function(e){y?window.location.hash=e:document.location.hash=e},e}()}
,,,,,function(e,t,n){n.d(t,{a:function(){return a}});var a={ppe:"3d697adc11914fa4991f1c3870255788-1afd84c4-bb01-494a-bfb0-0216ab2771c6-6977",prod:"a23e4f242c9c4097a968f28c62633e19-62d0d830-5afd-4df3-8e40-351c8711cf5c-7157"}}
,function(e,t,n){n.d(t,{a:function(){return u}});var a=n(68),i=n(1),r=n(10),o=n(4),s=function(){function e(e){this._telemetryEndpoint="/_layouts/15/images/BLANK.gif",this._statusAndTypeCheckKS=i.b.isActivated("828f5168-1dc2-4aa0-8e72-51441433d0b6","7/24/2024"),this._transitionId=0,this._telemetryUrl=window.location.origin+this._telemetryEndpoint,this._logger=e}return e.prototype.gatherNetworkNotificationAccuracyTelemetry=function(e,t){var n,a=this,i=new o.a({name:"offlineDetection.networkNotificationAccuracy"});null===(n=this._logger)||void 0===n||n.log("ID: ".concat(this._transitionId,", Event: ").concat(e,", Current: ").concat(this._logger.offlineToString(!t),", New: ").concat(this._logger.offlineToString(t))),fetch(this._telemetryUrl,{cache:"no-store"}).then(function(n){var r;r=a._statusAndTypeCheckKS||0!==n.status||"error"!==n.type?!t:t,a._reportReliability(e,t,r,i)}).catch(function(){return a._reportReliability(e,t,t,i)})},e.prototype.sendNetworkTransitionTelemetry=function(e,t,n){new o.a({name:"offlineDetection.networkTransition"}).end({extraData:{eventName:e,transitionToOffline:t},resultType:o.b.Success}),n&&this.gatherNetworkNotificationAccuracyTelemetry(e,t)},e.prototype._reportReliability=function(e,t,n,a){var i;null===(i=this._logger)||void 0===i||i.log("ID: ".concat(this._transitionId,", Event: ").concat(e,", Reliability: ").concat(n?"success":"failure")),this._transitionId<1e3?this._transitionId++:this._transitionId=0,a.end({extraData:{eventName:e,offline:t},resultType:n?o.b.Success:o.b.Failure})},e}(),c=function(){function e(){var e;this._nucleusLogToConsoleFlag="sharepoint.datasync.nucleus.logToConsole";var t=null===(e=window.localStorage)||void 0===e?void 0:e.getItem(this._nucleusLogToConsoleFlag);t&&"TRUE"===t.toUpperCase()&&(this._logFn=function(e){var t=(new Date).toISOString(),n="[offline detector][".concat(t,"] ").concat(e);console.log(n)})}return e.prototype.log=function(e){this._logFn&&this._logFn(e)},e.prototype.offlineToString=function(e){return void 0===e?"undefined":e?"offline":"online"},e}(),d="nucleusoffline",l="nucleusonline",u=function(){function e(e){this._debounceNucleusNetworkNotificationsKS=i.b.isActivated("F3E94CD1-107F-45EC-97D3-BBF3E7E7D19F","3/20/2024"),this._networkNotificationTelemetryKS=i.b.isActivated("AA0825B1-9082-4A18-B91E-D3C9EDF2990E","5/21/2024"),this._debounceBrowserNetworkNotificationsKS=i.b.isActivated("4026a913-0c75-4e2b-8f21-ddd81dfd2be5","7/17/2024"),this._reliabilityTelemetryChangeKS=i.b.isActivated("62ec4fe5-2896-4928-8894-c87f125e82d7","8/1/2024"),this._reliabilityTelemetryLoggingKS=i.b.isActivated("113f8f8f-700a-4c7c-9de7-9da1d7941868","8/13/2024"),this._enableDiagnosticsParamKS=i.b.isActivated("9d87a3bf-4d22-4fbf-a877-d131429d0d91","8/15/2024"),this._differentDebounceDelayForBrowserKS=i.b.isActivated("987bf2d5-399e-47fd-b101-eab6ed615ab0","8/28/2024"),this._longBrowserDebounceDelayKS=i.b.isActivated("93bfb463-5396-4022-ba60-81d11fad3ecf","9/10/2024"),this._initialized=!1,this._ignoreSWOffline=!1,this._offline=void 0,this._browserOffline=!1,(this._enableDiagnosticsParamKS||e)&&(this._logger=new c,this._networkNotificationTelemetryKS||(this._telemetry=new s(this._reliabilityTelemetryLoggingKS?void 0:this._logger))),this._debounceNucleusNetworkNotificationsKS||(this._nucleusDebouncer=this._createNucleusDebouncer()),this._debounceBrowserNetworkNotificationsKS||(this._browserDebouncer=this._createBrowserDebouncer())}return e.prototype.onChange=function(e){var t=this;return this._ensureInitialized(),this._listeners.push(e),function(){var n=t._listeners.indexOf(e);-1!==n&&t._listeners.splice(n,1)}},e.prototype.dispose=function(){var e;null===(e=this._logger)||void 0===e||e.log("Offline detector disposing"),this._events&&this._events.dispose()},Object.defineProperty(e.prototype,"offline",{get:function(){return this._useNucleusNetworkNotifications()?void 0!==this._offline?this._offline:this._swOffline():this._browserOffline||this._swOffline()&&!this._ignoreSWOffline},enumerable:!1,configurable:!0}),e.prototype._createNucleusDebouncer=function(){return new f(e.NucleusDebounceDelay)},e.prototype._createBrowserDebouncer=function(){return new f(this._longBrowserDebounceDelayKS?this._differentDebounceDelayForBrowserKS?e.NucleusDebounceDelay:e.BrowserDebounceDelay:e.BrowserDebounceDelay2)},e.prototype._ensureInitialized=function(){this._initialized||(this._logger&&this._logger.log("Offline detector initializing. Initial state: ".concat(this._logger.offlineToString(this.offline))),this._initialized=!0,this._listeners=[],this._events=new a.a(window),this._debounceBrowserNetworkNotificationsKS?(this._events.on(window,"online",this._onStateChange.bind(this,!1,"online")),this._events.on(window,"offline",this._onStateChange.bind(this,!0,"offline"))):(this._events.on(window,"online",this._browserDebouncer.debounce(this._onStateChange.bind(this,!1,"online"),!1)),this._events.on(window,"offline",this._browserDebouncer.debounce(this._onStateChange.bind(this,!0,"offline"),!0))),this._events.on(window,"swonline",this._onStateChange.bind(this,!1,"swonline")),this._events.on(window,"swoffline",this._onStateChange.bind(this,!0,"swoffline")),this._useNucleusNetworkNotifications()&&(this._debounceNucleusNetworkNotificationsKS?(this._events.on(window,l,this._onStateChange.bind(this,!1,l)),this._events.on(window,d,this._onStateChange.bind(this,!0,d))):(this._events.on(window,l,this._nucleusDebouncer.debounce(this._onStateChange.bind(this,!1,l),!1)),this._events.on(window,d,this._nucleusDebouncer.debounce(this._onStateChange.bind(this,!0,d),!0)))))},e.prototype._onStateChange=function(e,t){var n,a;if(this._reliabilityTelemetryChangeKS&&(null===(n=this._telemetry)||void 0===n||n.gatherNetworkNotificationAccuracyTelemetry(t,e)),this._useNucleusNetworkNotifications()){if(this._offline===e)return void(this._logger&&this._logger.log("Event: ".concat(t,", offline state unchanged: ").concat(this._logger.offlineToString(this._offline))));this._reliabilityTelemetryLoggingKS&&this._logger&&this._logger.log("Event: ".concat(t,", Current: ").concat(this._logger.offlineToString(this._offline),", New: ").concat(this._logger.offlineToString(e))),null===(a=this._telemetry)||void 0===a||a.sendNetworkTransitionTelemetry(t,e,!this._reliabilityTelemetryChangeKS),this._offline=e}else{var i=this.offline;this._swOffline()&&"online"===t&&(this._ignoreSWOffline=!0),"online"===t?this._browserOffline=!1:"offline"===t&&(this._browserOffline=!0),this._telemetry&&i!==this.offline&&this._telemetry.sendNetworkTransitionTelemetry(t,e,!this._reliabilityTelemetryChangeKS)}var r=this.offline;this._listeners&&this._listeners.forEach(function(e){try{e(r)}catch(e){}})},e.prototype._swOffline=function(){return!(!window.__swstats||void 0===window.__swstats.offline)&&window.__swstats.offline},e.prototype._useNucleusNetworkNotifications=function(){return r.a.isFeatureEnabled({ODB:1235})},e.NucleusDebounceDelay=5e3,e.BrowserDebounceDelay=7e3,e.BrowserDebounceDelay2=15e3,e}(),f=function(){function e(e){this._millisecondDelay=e}return e.prototype.debounce=function(e,t){var n=this;return 0===this._millisecondDelay?e:function(){t!==n._lastOfflineNotification&&(clearTimeout(n._timer),n._lastOfflineNotification=t,n._timer=setTimeout(function(){n._lastOfflineNotification=void 0,e()},n._millisecondDelay))}},e}()}
,function(e,t,n){n.d(t,{a:function(){return i}});var a=n(0),i=function(){function e(e,t){this._type=e,this.dependencies=(0,a.a)((0,a.a)({},e.dependencies||{}),t||{})}return e.prototype.create=function(e){var t=new this._type({},e);return{instance:t,disposable:t}},e}()}
,function(e,t,n){n.d(t,{a:function(){return r}});var a=n(0),i=n(401),r=function(){function e(e,t){this._type=e,this.dependencies=(0,a.a)((0,a.a)({},e.dependencies||{}),t||{})}return e.prototype.create=function(e){return{instance:(0,i.a)(this._type,e)}},e}()}
,function(e,t,n){function a(e,t){var n=function(n){return e.call(this,n,t)||this};return n.prototype=e.prototype,n}n.d(t,{a:function(){return a}})}
,function(e,t,n){var a;n.d(t,{a:function(){return a}}),function(e){e[e.anonymous=1]="anonymous",e[e.msa=2]="msa",e[e.aad=3]="aad"}(a||(a={}))}
,function(e,t,n){n.d(t,{a:function(){return r}});var a=n(0),i=n(246);function r(e){return(0,a.b)(this,void 0,void 0,function(){var t,n,r,o,s,c,d;return(0,a.e)(this,function(a){switch(a.label){case 0:return[4,Promise.all(e.map(function(e){return e.then(function(e){return{result:e}},function(e){return{error:e}})}))];case 1:for(t=a.sent(),n=[],r=[],o=!0,s=0,c=t;s<c.length;s++)"error"in(d=c[s])?((0,i.c)(d.error)||(o=!1),r.push(d.error)):(n.push(d.result),o=!1);if(r.length>0)throw o?new i.a:r[0];return[2,n]}})})}}
,function(e,t,n){n.d(t,{a:function(){return i},b:function(){return c},c:function(){return r},d:function(){return s},e:function(){return o}});var a=n(0),i=function(e){function t(t,n){var i=this,r=n.response,o=(void 0===r?{}:r).error,s=(void 0===o?{}:o).innerError,d=(void 0===s?{}:s).stackTrace,l=void 0===d?"":d,u=n.response,f=n.request,p=n.status,m=n.code,_=void 0===m?c(u,p,function(e){return"".concat(e)})||"unhandled":m,h=(0,a.a)({innerError:t,code:_},n);return(i=e.call(this,h)||this).name="GraphError",i.response=u,i.status=p,i.serverStack=l,i.request=f,i.error=t,i}return(0,a.d)(t,e),t}(n(57).a);function r(e){var t={};if(t.errorMessage=e.message,o(e)){t.vroomStatus=e.status;var n=e.response;if(n&&n.error){var a=n.error;t.vroomErrorCode=a.code,t.vroomErrorMessage=a.message;var i=a.innerError||a.innererror;i&&(t.vroomErrorInnerCode=i.code,t.vroomErrorInnerMessage=i.message,t.vroomErrorInnerDebugMessage=i.debugMessage,t.vroomErrorInnerStack=i.stackTrace)}}return t}function o(e){return!!e&&e instanceof i}function s(e){return function(e,t){if(e&&o(e))return c(e.response,e.status,function(e){return function(e){return"".concat(e)}(e)})}(e)||"unhandled"}function c(e,t,n){if(e){for(var a=[],i=e.error;i;)a.push(i),i=i.innerError||i.innererror;for(;i=a.pop();)if(void 0!==i.code){var r=n(i.code);if(void 0!==r)return r}}return n(t)}}
,function(e,t,n){var a=n(251),i=n(7),r=function(){function e(){}return e.start=function(e){var t=new a.a(e);return new i.c(function(e,n){t.start(e,n)},function(){t.abort(!0)})},e.startAndPostProcess=function(e,t){var n=new a.a(e);return new i.c(function(e,a){n.start(function(n,a){e(t(n,a))},a)},function(){n.abort(!0)})},e}();t.a=r}
,function(e,t,n){var a=n(7),i=n(4),r=function(){function e(e,t){void 0===e&&(e={}),this._dataSource=t.oAuthTokenDataSource}return e.prototype.getToken=function(e,t){var n=new i.a({name:"getToken"});return this._dataSource.getToken(e,t).then(function(e){return n.end({resultType:i.b.Success}),e},function(e){return n.end({resultType:i.b.Failure}),a.c.reject(e)})},e.prototype.getInstrumentedToken=function(e,t){var n=new i.a({name:"getToken"});return this._dataSource.getInstrumentedToken(e,t).then(function(e){return n.end({resultType:i.b.Success}),e},function(e){return n.end({resultType:i.b.Failure}),a.c.reject(e)})},e}();t.a=r}
,function(e,t,n){n.d(t,{a:function(){return o}});var a,i=n(37),r=n(254);function o(e,t,n){var a=(0,r.b)(t,void 0,n);if(!e||!a||0===a.indexOf("http"))return a;try{return new i.a(e).authority+a}catch(e){return a}}!function(e){e.Small="S",e.Medium="M",e.Large="L"}(a||(a={}))}
,function(e,t,n){n.d(t,{a:function(){return d},b:function(){return c},c:function(){return o},d:function(){return s}});var a=n(256),i=n(30),r=n(1);function o(e){var t=e.lastIndexOf("/");return t>=0?e.substring(t+1):e}function s(e){return decodeURI(e)}function c(e){var t;try{t=decodeURI(e)}catch(n){t=e}return t===e?e=(0,a.a)(e,!0):(e=e.replace("#","%23"),r.b.isActivated("589c6b39-fbce-42b5-bff1-125e13e2367a","05/19/2021","encode url with %number in the name")||i.a.isFeatureEnabled({ECS:83959})||!e.indexOf("%25")||(e=(0,a.a)(e,!0))),e}function d(e){return e&&e.indexOf("?")<0&&(e=(e=encodeURI(e)).replace(/#/g,"%23")),e}}
,,function(e,t,n){n.d(t,{a:function(){return R}});var a=n(0),i=n(260),r=n(165),o=n(166),s=n(168),c=n(257),d=n(258),l=n(259),u=n(98),f=n(52),p=n(40),m=n(39),_=n(32),h=n(82),b=n(413),g=n(41),v=n(96),y=n(81),S=n(255),D=n(412),I=n(53),x=n(407),C=n(1),O=n(261),w=n(411),E=n(97),A=n(30),L=n(127),k=!C.b.isActivated("48d0bf6b-2e41-42a8-a3a3-e8d2ef405dbb","7/14/2022","better error handling"),M=C.b.isActivated("3e85cd31-2807-44c1-96bf-35f08619ec11","1/31/2023","Fix for not appending navId to SPL link"),P=C.b.isActivated("edb05947-5f5b-47a0-91ef-ddc0cef4e7a1","07/03/2024","sbarrameda: fix to use loginName if userId is undefined"),T=C.b.isActivated("46a06a91-966f-47f1-af68-09d8b3864e12","07/03/2023","Override navId with navIdSendLinkOverride")||A.a.isFeatureEnabled({ECS:1107386}),U=C.b.isActivated("62a4337e-d21e-407b-b2ef-2163777d20b8","12/19/2022","Link unfurl using displayName KS")||A.a.isFeatureEnabled({ECS:1059927}),F=C.b.isActivated("9c1ecbd5-cae0-484e-ba86-18863f653357","09/18/2023","KS for using AgeGroup returned from GSI")||A.a.isFeatureEnabled({ECS:1132016}),H=C.b.isActivated("8b8c00d5-55fe-4115-9289-1f3c0a6e37b4","02/15/2024","Use maxPrincipalsToReturn and maxLinkMembersToReturn in GSI request")||A.a.isFeatureEnabled({ECS:1231607}),R=function(e){function t(t,n){void 0===n&&(n={pageContext:t.pageContext});var a=e.call(this,{dataSourceName:"SharingDataSource"},n)||this;a._getParentListId=t.getParentListId,a._itemUrlHelper=t.itemUrlHelper||new r.a({},{pageContext:t.pageContext}),a._apiUrlHelper=t.apiUrlHelper||new o.a({},{pageContext:t.pageContext,itemUrlHelper:a._itemUrlHelper}),a._sharingContextInformation=t.sharingContextInformation||void 0,a._sharingDataSourceHelper=new S.a({itemUrlHelper:a._itemUrlHelper,sharingContextInformation:a._sharingContextInformation,isItemUrlEncoded:t.isItemUrlEncoded});var i=(0,v.a)(a._pageContext);return a._shareUrl=i+"/_api/SP.Web.ShareObject",a}return(0,a.d)(t,e),t.parsePeople=function(e){return e.map(function(e){var n={role:t.parseSharingRole(e.CurrentRole),statusCode:Number(!e.Status),errorMessage:e.Message||null};return{name:e.DisplayName,email:e.Email,userId:e.UserId,sharingInfo:n}})},t.parseSharingRole=function(e){switch(e){case 0:return c.a.None;default:return c.a.View;case 2:return c.a.Edit;case 6:return c.a.Review}},t.prototype.getSharingInformation=function(e,t,n,a,i,r){var o,s=this,c=(a=a||this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e,this._getParentListId(e))).segment("GetSharingInformation"),l="pickerSettings";return t&&(l+=",permissionsInformation"),n&&(l+=",sharingLinkTemplates"),i&&(l+=",addressBarLinkSettings"),o=c.oDataParameter("$Expand",l).toString(),this.getData(function(){return o},function(t){var n=JSON.parse(t),a=s._parseGetSharingInformationResponse(n,e);return a.getSharingInformationSources=d.a.api,a},"GetSharingInformation",function(){var e={request:{maxPrincipalsToReturn:H?30:100,maxLinkMembersToReturn:H?30:100}};return JSON.stringify(e)},"POST",this._sharingContextInformation&&this._sharingContextInformation.listId&&V(this._sharingContextInformation.listId.slice(1,-1))?{"X-SP-REQUESTRESOURCES":"WEBPROPERTIES, list=".concat(this._sharingContextInformation.listId.slice(1,-1))}:null,null,null,!0,void 0,void 0,this._getExtraData(),r)},t.prototype.getSharingInformationForRMA=function(e,t,n){var a=this,i=(t=t||this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e,this._getParentListId(e))).segment("GetSharingInformation");return this.getData(function(){return i.toString()},function(e){var t=JSON.parse(e);return a._parseGetSharingInformationResponseForRMA(t)},"GetSharingInformation",function(){return""},"POST",this._sharingContextInformation&&this._sharingContextInformation.listId&&V(this._sharingContextInformation.listId.slice(1,-1))?{"X-SP-REQUESTRESOURCES":"WEBPROPERTIES, list=".concat(this._sharingContextInformation.listId.slice(1,-1))}:null,null,null,!0,void 0,void 0,this._getExtraData(),n)},t.prototype.getShareLinkApi=function(e,t,n){return t.method("Lists",this._getParentListId(e)).method("GetItemById",n).segment("ShareLink")},t.prototype.emailWithoutPermissioning=function(e,n,a,i){var r=this,o=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,n,this._getParentListId(n)).segment("ForwardObjectLink").toString();return this.getData(function(){return o},function(e){var a=JSON.parse(e).d,i=[];a.UniquelyPermissionedUsers&&a.UniquelyPermissionedUsers.results&&(i=a.UniquelyPermissionedUsers.results);var r=[];a.InvitedUsers&&a.InvitedUsers.results&&(r=a.InvitedUsers.results);var o={};if(o.statusCode=a.StatusCode,o.errorMessage=a.ErrorMessage,o.people=t.parsePeople(i),o.invitedUsers=t.parsePeople(r),o.itemId=n&&n.id,r.length>0&&(o.invitationLink=r[0].InvitationLink),o.invalidEmails=[],a.UsersWithInvalidEmails&&a.UsersWithInvalidEmails.results)for(var s=0,c=a.UsersWithInvalidEmails.results;s<c.length;s++){var d=c[s];o.invalidEmails.push(d.User)}return o},"ForwardObjectLink",function(){for(var t=[],n=0,o=e;n<o.length;n++){var s=o[n];t.push(s.rawPersonData)}var c={peoplePickerInput:JSON.stringify(t),emailBody:a,emailSubject:i,linkParameters:{}};return r._sharingContextInformation&&r._sharingContextInformation.optInSendNavIdInShareLink&&!M&&(r._sharingContextInformation.navIdSendLinkOverride&&!T?c.linkParameters.nav=r._sharingContextInformation.navIdSendLinkOverride:r._sharingContextInformation.navId&&(c.linkParameters.nav=r._sharingContextInformation.navId)),JSON.stringify(c)})},t.prototype.checkPermissions=function(e,t){var n=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,t,this._getParentListId(t)).segment("CheckPermissions").toString();return this.getData(function(){return n},function(e){var t=JSON.parse(e);return t.d?t.d.CheckPermissions.results:null},"CheckPermissions",function(){var t={recipients:e};return JSON.stringify(t)})},t.prototype.share=function(e,n){var a=this,i=!!this._sharingContextInformation||this._sharingDataSourceHelper.canUseSecurable(n.items[0]);if(n.linkType===l.a.Organization||n.linkType===l.a.Edit||n.linkType===l.a.View)return this._shareLink(e,n);var r,o={};if(i){var s=n.items[0],d=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,s,this._getParentListId(s));r=d.segment("ShareObject").toString()}else r=this._shareUrl;this._sharingContextInformation&&this._sharingContextInformation.listId&&V(this._sharingContextInformation.listId.slice(1,-1))&&(o["X-SP-REQUESTRESOURCES"]="WEBPROPERTIES, list=".concat(this._sharingContextInformation.listId.slice(1,-1)));var f=e.length;return this.getData(function(){return r},function(e){var a=JSON.parse(e).d,i=[];(0,E.a)()&&window.sessionStorage.setItem("Share_Response",JSON.stringify(a)),a.UniquelyPermissionedUsers&&a.UniquelyPermissionedUsers.results&&(i=a.UniquelyPermissionedUsers.results);var r=[];a.InvitedUsers&&a.InvitedUsers.results&&(r=a.InvitedUsers.results);var o={};if(o.statusCode=a.StatusCode,o.errorMessage=a.ErrorMessage,o.people=t.parsePeople(i),o.invitedUsers=t.parsePeople(r),o.itemId=n.items[0]&&n.items[0].id,r.length>0&&(o.invitationLink=r[0].InvitationLink),o.invalidEmails=[],a.UsersWithInvalidEmails&&a.UsersWithInvalidEmails.results)for(var s=0,c=a.UsersWithInvalidEmails.results;s<c.length;s++){var d=c[s];o.invalidEmails.push(d.User)}return o},"Share",function(){for(var t=[],r=0;r<e.length;r++){var o=e[r];t.push(o.rawPersonData)}n.roleValue===c.a.Edit.toString()?n.roleValue=w.a:n.roleValue===c.a.View.toString()&&(n.roleValue=w.e);var s={peoplePickerInput:JSON.stringify(t),roleValue:n.roleValue,sendEmail:n.sendEmail,emailBody:n.message,emailSubject:n.subject,includeAnonymousLinkInEmail:!n.requireSignIn,propagateAcl:n.propagateSharing,useSimplifiedRoles:!0};i||(s.url=a._sharingDataSourceHelper.getFileUrl(n.items[0]));var d=JSON.stringify(s);return(0,E.a)()&&window.sessionStorage.setItem("Share_Payload",d),d},"POST",o,void 0,void 0,!0,void 0,void 0,this._getExtraData(f)).catch(function(t){var a="";try{a=JSON.stringify(t)}catch(e){}return{error:u.b.generic,debugErrorMessage:a,people:e,statusCode:t.statusCode,errorMessage:t.errorMessage,invitedUsers:[],itemId:n.items[0]&&n.items[0].id||""}})},t.prototype.updatePermissions2=function(e,t,n){var a=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,t,this._getParentListId(t),(0,L.d)()).segment("UpdateDocumentSharingInfo").toString();return this.getData(function(){return a},function(e){var t=JSON.parse(e).d;return t?{role:t.UpdateDocumentSharingInfo.results[0].CurrentRole}:null},"UpdatePermissions2",function(){var t;switch(n){case f.a.none:case f.a.view:case f.a.manageList:case f.a.restrictedview:case f.a.review:case f.a.edit:case f.a.owner:t=n;break;default:t=f.a.view}var a={userRoleAssignments:[{UserId:e.loginName,Role:t}],validateExistingPermissions:!1,additiveMode:!1,sendServerManagedNotification:!1,customMessage:null,includeAnonymousLinksInNotification:!1,propagateAcl:!0};return JSON.stringify(a)})},t.prototype.updatePermissionsMultiple=function(e,t,n,a,i){var r=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,t,this._getParentListId(t)).segment("UpdateDocumentSharingInfo").toString();return this.getData(function(){return r},function(e){var t=JSON.parse(e).d;return t?{role:t.UpdateDocumentSharingInfo.results[0].CurrentRole,success:t.UpdateDocumentSharingInfo.results.map(function(e){return e.Status}).reduce(function(e,t){return e&&t},!0)}:null},"UpdatePermissionsMultiple",function(){var t;switch(n){case f.a.none:t=0;break;case f.a.view:t=1;break;case f.a.review:t=6;break;case f.a.edit:t=2;break;case f.a.restrictedview:t=7;break;default:t=1}var r={userRoleAssignments:e.map(function(e){return{UserId:P?e.userId:e.userId||e.loginName,Role:t}}),validateExistingPermissions:!1,additiveMode:!1,sendServerManagedNotification:a,customMessage:i,includeAnonymousLinksInNotification:!1,propagateAcl:!0};return JSON.stringify(r)})},t.prototype.parseRawSharingInformation=function(e,t){return this._parseGetSharingInformationResponse(e,t)},t.prototype.parseRawSharingInformationForRMA=function(e){return this._parseGetSharingInformationResponseForRMA(e)},t.prototype.unshareLink=function(e){var t=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e.item,this._getParentListId(e.item),(0,L.d)()).segment("UnshareLink").toString();return this.getData(function(){return t},function(e){return!!JSON.parse(e).d},"UnshareLink",function(){var t={linkKind:e.kind,shareId:e.shareId};return JSON.stringify(t)})},t.prototype.shareLink=function(e){var t=this,n=e.settings,a=e.items[0],r=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e.items[0],this._getParentListId(a),(0,L.d)()).segment("ShareLink").toString(),o={};return this._sharingContextInformation&&(this._sharingContextInformation.listId&&V(this._sharingContextInformation.listId.slice(1,-1))&&(o["X-SP-REQUESTRESOURCES"]="WEBPROPERTIES, list=".concat(this._sharingContextInformation.listId.slice(1,-1))),this._sharingContextInformation&&this._sharingContextInformation.enableFallbackShareLink&&(o.Prefer="DirectUrlWithShareToken")),this.getData(function(){return r},function(e){var t=JSON.parse(e);return t.d?((0,E.a)()&&window.sessionStorage.setItem("ShareLink_Response",JSON.stringify(t.d)),function(e){if(e.d)return N(e.d.ShareLink.sharingLinkInfo)}(t)):t.error?{error:u.b.generic,errorMessage:t.error.message}:void 0},"ShareLink",function(){var a=null;n.expiration&&(a=(0,i.a)(n.expiration.toString()));var r=null;if(e.recipients&&e.recipients.length>0){r=[];for(var o=0,s=e.recipients;o<s.length;o++){var c=s[o];c.rawPersonData&&r.push(c.rawPersonData)}}var d=null;if(n.inviteesToRemove&&n.inviteesToRemove.length>0){d=[];for(var l=0,u=n.inviteesToRemove;l<u.length;l++){var f=u[l];d.push({id:f.id,loginName:f.loginName,name:f.primaryText,isExternal:f.isExternal,principalType:f.type,email:f.email})}}var p={request:{createLink:!!n.createLink,settings:{allowAnonymousAccess:n.allowAnonymousAccess,trackLinkUsers:n.trackLinkUsers,linkKind:n.sharingLinkKind,expiration:a,role:n.role,restrictShareMembership:n.restrictShareMembership,updatePassword:n.updatePassword,password:n.password,shareId:n.shareId,description:n.description,scope:n.scope,nav:""}}};if(t._sharingContextInformation&&t._sharingContextInformation.optInSendNavIdInShareLink&&!M&&(t._sharingContextInformation.navIdSendLinkOverride&&!T?p.request.settings.nav=t._sharingContextInformation.navIdSendLinkOverride:t._sharingContextInformation.navId&&(p.request.settings.nav=t._sharingContextInformation.navId)),d&&(p.request.settings.inviteesToRemove={results:d}),r&&r.length>0){p.request.peoplePickerInput=JSON.stringify(r);var m=e.emailData,_=e.emailSubject;void 0!==m&&void 0===_&&(p.request.emailData={body:e.emailData,subject:""}),void 0===m&&void 0!==_&&(p.request.emailData={body:"",subject:e.emailSubject}),void 0!==m&&void 0!==_&&(p.request.emailData={body:e.emailData,subject:e.emailSubject})}var h=e.settings.shareId;h&&(p.request.settings.shareId=h,p.request.emailData={body:""});var b=JSON.stringify(p);return(0,E.a)()&&window.sessionStorage.setItem("ShareLink_Payload",b),b},"POST",0!==Object.keys(o).length?o:null,null,null,!0,void 0,void 0,this._getExtraData()).catch(function(e){if(k)return{error:e};var t="";try{t=JSON.stringify(e)}catch(e){}return{error:u.b.generic,debugErrorMessage:t}})},t.prototype.setAddressBarLinkCapability=function(e,t){var n=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e,this._getParentListId(e)).segment("SetAddressBarLinkCapability").toString();return this.getData(function(){return n},function(e){return!!JSON.parse(e).d},"SetAddressBarLinkCapability",function(){var e={enable:t};return JSON.stringify(e)})},t.prototype.shareLinkExpress=function(e,t,n){var a=this._apiUrlHelper.build().webByUrl({webUrl:this._pageContext.webAbsoluteUrl}).method("Lists",e).method("GetItemById",t).segment("ShareLinkExpress").toString();return this.getData(function(){return a},function(e){var t,n,a,i=JSON.parse(e);return i.error||!(null===(n=null===(t=i.d)||void 0===t?void 0:t.ShareLinkExpress)||void 0===n?void 0:n.sharingLinkInfo)?{error:u.b.generic,errorMessage:(null===(a=null==i?void 0:i.error)||void 0===a?void 0:a.message)||"No sharing link info returned"}:i.d?N(i.d.ShareLinkExpress.sharingLinkInfo):void 0},"ShareLinkExpress",function(){var e={expressOption:n};return JSON.stringify(e)},"POST",null,null,null,!0,void 0,void 0,this._getExtraData()).catch(function(e){if(k)return{error:e};var t="";try{t=JSON.stringify(e)}catch(e){}return{error:u.b.generic,debugErrorMessage:t}})},t.prototype.getClientId=function(){var e=Number(this._pageContext.webTemplate);if((0,O.a)(this._pageContext))return p.a.sharePoint;switch(e){case I.b.teamSite:case I.b.group:case I.b.subgroup:case I.b.sitePagePublishing:return p.a.sharePoint;case I.b.mySite:return p.a.odb;default:return p.a.sharePoint}},t.prototype._shareLink=function(e,t){var n=this,a=t.items[0],r=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,a,this._getParentListId(a)).segment("ShareLink").toString();return this.getData(function(){return r},function(n){return{statusCode:0,errorMessage:"",people:e,itemId:t.items[0].id,invitedUsers:[]}},"ShareLink",function(){for(var a=[],r=0,o=e;r<o.length;r++){var s=o[r];a.push(s.rawPersonData)}var c=null;t.expiration&&(c=(0,i.a)(t.expiration));var d={request:{peoplePickerInput:JSON.stringify(a),emailData:{body:t.message,subject:t.subject},linkKind:n._getSharingLinkKind(t.linkType,t.roleValue),createLink:!0,expiration:c}};return JSON.stringify(d)})},t.prototype._getSharingLinkKind=function(e,t){var n=m.a.direct;return e===l.a.Edit?n=m.a.anonymousEdit:e===l.a.View?n=m.a.anonymousView:e===l.a.Organization&&(n=t===c.a.Edit.toString()?m.a.organizationEdit:m.a.organizationView),n},t.prototype._parseGetSharingInformationResponse=function(e,t){if(e.error)return{error:u.b.generic,ageGroup:void 0,anonymousLinkExpirationRestrictionDays:void 0,anyoneLinkTrackUsers:void 0,canAddExternalPrincipal:void 0,canAddInternalPrincipal:void 0,canRequestAccessForGrantAccess:void 0,canManagePermissions:void 0,defaultSharingLink:void 0,defaultShareLinkScope:void 0,defaultShareLinkToExistingAccess:void 0,hasInheritedLinks:void 0,isShared:void 0,item:void 0,fileExtension:void 0,sharedObjectType:void 0,sharingLinks:void 0,sharingPrincipals:void 0,peoplePickerSettings:void 0,userDisplayName:void 0,blockPeoplePickerAndSharing:void 0,userRole:void 0,defaultShareLinkPermission:void 0,sharingAbilities:void 0,defaultLinkKind:void 0,directLink:void 0,hasPermissionsInformation:void 0,sharingLinkTemplates:void 0,webTemplateId:void 0,itemUniqueId:void 0,itemUrl:void 0,siteId:void 0,substrateFileId:void 0,tenantId:void 0,isConsumerFiles:void 0,outlookEndpointHostUrl:void 0,webUrl:void 0,userPhotoCdnBaseUrl:void 0,permissionsInformation:void 0,sensitivityLabelInformation:void 0,displayName:void 0};var n=e.d,i=n.userPhotoCdnBaseUrl,r=n.permissionsInformation,o=!!r,s=!!n.sharingLinkTemplates,c=o,d=!!n.addressBarLinkSettings,l=o?this._parseSharingLinks(r.links.results,n.directUrl,i,(0,L.d)()):[],f=s?this._parseSharingLinkTemplates(n.sharingLinkTemplates.templates.results,i):[],p=d?n.addressBarLinkSettings:null,b=[];if(o){var g=r.siteAdmins.results,v=r.principals.results,S=this._parseSharingPrincipals(g,void 0,i);S.forEach(function(e){return e.isSiteAdmin=!0});var I=this._parseSharingPrincipals(v,void 0,i);b=S.concat(I)}var x=this._getDefaultSharingLink(n.defaultLinkKind,n.defaultShareLinkScope,l,n.sharingAbilities),C=this._sharingContextInformation?this._sharingContextInformation.itemName:void 0;U||C||!n||(C=n.displayName);var O={name:C,childCount:this._sharingContextInformation?this._sharingContextInformation.itemCount:void 0,hasDlpPolicy:this._sharingContextInformation?this._sharingContextInformation.hasDlpPolicy:void 0,extension:this._sharingContextInformation&&this._sharingContextInformation.itemExtension?this._sharingContextInformation.itemExtension:n.fileExtension,appmap:this._sharingContextInformation?this._sharingContextInformation.itemAppmap:void 0,itemType:this._sharingContextInformation?this._sharingContextInformation.itemType:void 0};if(t){var w=t.properties,A=w.ItemChildCount?parseInt(w.ItemChildCount,10):0,k=w.FolderChildCount?parseInt(w.FolderChildCount,10):0,M=t.type===y.a.OneNote?0:A+k,P=this._isPolicyTipFlagSet(t.policyTip,D.a.blockSharing),T=t.name;U||T||!n.displayName||(T=n.displayName),O={name:T,childCount:M,hasDlpPolicy:P,extension:t.extension,appmap:t.appMap,itemType:t.type}}var H=n.canRequestAccessForGrantAccess||n.canAddInternalPrincipal||l.length>1,R=0===n.anonymousLinkExpirationRestrictionDays?-1:n.anonymousLinkExpirationRestrictionDays,N=(0,a.a)({anonymousLinkExpirationRestrictionDays:R,anyoneLinkTrackUsers:n.anyoneLinkTrackUsers,allOrganizationSecurityGroupId:n.allOrganizationSecurityGroupId,canAddExternalPrincipal:n.canAddExternalPrincipal,canAddInternalPrincipal:n.canAddInternalPrincipal,defaultShareLinkToExistingAccess:n.defaultShareLinkToExistingAccess,canManagePermissions:H,defaultSharingLink:x,fileExtension:n.fileExtension,sharedObjectType:n.sharedObjectType,hasInheritedLinks:!!c&&n.permissionsInformation.hasInheritedLinks,isShared:(0,L.a)(l,b),item:O,sharingLinks:l,sharingPrincipals:b,peoplePickerSettings:n.pickerSettings,userDisplayName:this._pageContext.userDisplayName,blockPeoplePickerAndSharing:n.blockPeoplePickerAndSharing,requiresAccessApproval:!n.canAddInternalPrincipal&&n.canRequestAccessForGrantAccess,canRequestAccessForGrantAccess:n.canRequestAccessForGrantAccess,userRole:n.currentRole,defaultShareLinkPermission:n.defaultShareLinkPermission,sharingAbilities:n.sharingAbilities,defaultLinkKind:n.defaultLinkKind,defaultShareLinkScope:n.defaultShareLinkScope,directLink:{allowsAnonymousAccess:!1,audience:_.a.existing,expiration:null,description:null,isActive:!0,isEdit:!0,principals:[],invitees:[],shareId:"",sharingLinkKind:m.a.direct,sharingScope:h.a.existing,url:n.directUrl,updatePassword:!1,password:"",passwordLastModifiedBy:null},discoverableByOrganizationEnabled:n.discoverableByOrganizationEnabled,hasPermissionsInformation:!!n.permissionsInformation,sharingLinkTemplates:f,addressBarLinkSettings:p,webTemplateId:n.webTemplateId,itemUniqueId:n.itemUniqueId,itemUrl:n.itemUrl,siteId:n.siteId,substrateFileId:n.substrateFileId,tenantId:n.tenantId,isConsumerFiles:!!n.isConsumerFiles&&n.isConsumerFiles,customizedExternalSharingServiceUrl:n.customizedExternalSharingServiceUrl||"",siteIBSegmentIDs:n.siteIBSegmentIDs?n.siteIBSegmentIDs.results:null,siteIBMode:n.siteIBMode,enforceIBSegmentFiltering:!!n.enforceIBSegmentFiltering,enforceSPOSearch:!!n.enforceSPOSearch,outlookEndpointHostUrl:n.outlookEndpointHostUrl?n.outlookEndpointHostUrl:null,webUrl:n.webUrl?n.webUrl:null,isStubFile:!!n.isStubFile&&n.isStubFile,userPhotoCdnBaseUrl:n.userPhotoCdnBaseUrl,permissionsInformation:n.permissionsInformation,sensitivityLabelInformation:n.sensitivityLabelInformation,displayName:n.displayName,isPremium:n.isPremium},!F&&n.ageGroup?{ageGroup:n.ageGroup}:{});if((0,E.a)()){var B=window.sessionStorage.getItem("Get_Sharing_Information");if(B&&Object.keys(B).length>0){var j=JSON.parse(B);return(0,a.a)((0,a.a)({},N),j)}}return N},t.prototype._parseGetSharingInformationResponseForRMA=function(e){var t=e.d;return{currentRole:t.currentRole,fileExtension:t.fileExtension,fileName:t.displayName,sharedObjectType:t.sharedObjectType,sensitivityLabelInformation:t.sensitivityLabelInformation}},t.prototype._parseSharingLinks=function(e,t,n,i){var r=this;void 0===i&&(i=!1),i||(e=e.filter(function(e){return!e.isInherited}));var o=e.map(function(e){var t,o=e.linkDetails;return t=void 0!==o.Scope&&o.Scope!==h.a.uninitialized?B(o.LinkKind,o.Scope):(0,L.c)(o.LinkKind,o.AllowsAnonymousAccess,o.RestrictedShareMembership),(0,a.a)((0,a.a)({allowsAnonymousAccess:o.AllowsAnonymousAccess,hasPassword:o.RequiresPassword,blockDownload:o.BlocksDownload,description:o.Description,audience:t,expiration:o.Expiration?new Date(o.Expiration):null,isActive:o.IsActive,isEdit:j(o.LinkKind)||o.IsEditLink,isReview:o.IsReviewLink,isManageList:o.IsManageListLink,principals:r._parseSharingPrincipals(e.linkMembers.results,o.LinkKind,n),invitees:r._parseLinkInvitees(o,n),shareId:o.ShareId,sharingLinkKind:o.LinkKind,sharingScope:o.Scope,url:o.Url,updatePassword:o.UpdatePassword,password:o.Password,passwordLastModifiedBy:r._parseSharingPrincipal(o.PasswordLastModifiedBy,n),isCreateOnlyLink:o.IsCreateOnlyLink,isAddressBarLink:o.IsAddressBarLink,isUnhealthy:o.IsUnhealthy,status:o.SharingLinkStatus,created:o.Created,trackLinkUsers:o.TrackLinkUsers},i?{inheritedLinkInfo:e.inheritedFrom}:{}),e.linkStatus?{enabled:e.linkStatus.enabled}:{})});return(o=o.sort(function(e,t){return r._getLinkRanking(t)-r._getLinkRanking(e)})).push({allowsAnonymousAccess:!1,audience:_.a.specificPeople,expiration:null,description:null,isActive:!0,isEdit:!0,principals:[],invitees:[],shareId:"",sharingLinkKind:m.a.direct,sharingScope:h.a.specificPeople,url:t,updatePassword:!1,password:"",passwordLastModifiedBy:null}),o},t.prototype._getLinkRanking=function(e){var t=0;switch(e.audience){case _.a.anyone:t+=30;break;case _.a.organization:t+=20;break;case _.a.specificPeopleFlex:t+=10}return e.isEdit?t+=3:e.isReview?t+=2:e.isEdit||e.isReview||e.blockDownload||(t+=1),t},t.prototype._getSharingLinkTemplateRanking=function(e){var t=0;if(e&&e.linkDetails&&e.linkDetails.shareId){switch(e.scope){case b.a.anyone:t+=30;break;case b.a.organization:t+=20;break;case b.a.specificPeople:t+=10}switch(e.role){case f.a.edit:t+=3;break;case f.a.review:t+=2;break;case f.a.view:t+=1}}return t},t.prototype._parseSharingLinkTemplates=function(e,t){var n=this;return e.map(function(e){var a,i,r=e.linkDetails;null!==r&&(i=void 0!==r.Scope&&r.Scope!==h.a.uninitialized?B(r.LinkKind,r.Scope):(0,L.c)(r.LinkKind,r.AllowsAnonymousAccess,r.RestrictedShareMembership),a={allowsAnonymousAccess:r.AllowsAnonymousAccess,hasPassword:r.RequiresPassword,blockDownload:r.BlocksDownload,audience:i,expiration:r.Expiration?new Date(r.Expiration):null,description:r.Description,isActive:r.IsActive,isEdit:j(r.LinkKind)||r.IsEditLink,isReview:r.IsReviewLink,principals:void 0,invitees:n._parseLinkInvitees(r,t),shareId:r.ShareId,sharingLinkKind:r.LinkKind,sharingScope:r.Scope,url:r.Url,updatePassword:r.UpdatePassword,password:r.Password,passwordLastModifiedBy:n._parseSharingPrincipal(r.PasswordLastModifiedBy,t)});return{linkDetails:a,passwordProtected:e.passwordProtected,role:e.role,scope:e.scope,shareKind:e.shareKind}}).sort(function(e,t){return n._getSharingLinkTemplateRanking(t)-n._getSharingLinkTemplateRanking(e)})},t.prototype._parseLinkInvitees=function(e,t){var n=this,a=e.Invitations;if(!a)return[];for(var i=[],r=0,o=a.results;r<o.length;r++){var s=o[r];s&&s.invitee&&i.push(s.invitee)}return i.map(function(e){return{id:e.id,email:e.email,primaryText:e.name,isExternal:e.isExternal,loginName:e.loginName,role:null,secondaryText:e.jobTitle,type:e.principalType,imageUrl:(0,x.a)(n._pageContext.webAbsoluteUrl,e.email,t)}})},t.prototype._parseSharingPrincipals=function(e,t,n){var a=this,i=e.map(function(e){var i=e.principal;i||(i=e);var r={id:i.id,isExternal:i.isExternal,loginName:i.loginName,primaryText:i.name,role:e.role,secondaryText:i.jobTitle,type:i.principalType,imageUrl:(0,x.a)(a._pageContext.webAbsoluteUrl,i.email,n),email:i.email};return t&&(r.sharingLinkKind=t),r});return S.a.getUniqueSharingPrincipals(i)},t.prototype._getExtraData=function(e){var t;return this._sharingContextInformation&&(t={clientId:this._sharingContextInformation.clientId,mode:g.a[this._sharingContextInformation.mode],numRecipients:e}),t},t.prototype._parseSharingPrincipal=function(e,t){if(e){var n=e.principal;return n||(n=e),{id:n.id,isExternal:n.isExternal,loginName:n.loginName,primaryText:n.name,role:e.role,secondaryText:n.jobTitle,type:n.principalType,imageUrl:(0,x.a)(this._pageContext.webAbsoluteUrl,n.email,t),email:n.email}}return null},t.prototype._getDefaultSharingLink=function(e,t,n,a){a.peopleSharingLinkAbilities&&(a.peopleSharingLinkAbilities.canManageEditLink.enabled||a.peopleSharingLinkAbilities.canManageReadLink.enabled)&&e===m.a.direct&&(e=m.a.flexible);var i=e,r=t;a.anyoneLinkAbilities?(i!==m.a.anonymousEdit||a.anyoneLinkAbilities.canManageEditLink.enabled||(i=m.a.anonymousView),i!==m.a.anonymousView||a.anyoneLinkAbilities.canManageReadLink.enabled||(i=m.a.organizationEdit),r!==h.a.anyone||a.anyoneLinkAbilities.canManageReadLink.enabled||a.anyoneLinkAbilities.canManageReadLink.enabled||(r=h.a.organization)):(i!==m.a.anonymousEdit||a.anonymousLinkAbilities.canManageEditLink.enabled||(i=m.a.anonymousView),i!==m.a.anonymousView||a.anonymousLinkAbilities.canManageReadLink.enabled||(i=m.a.organizationEdit),r!==h.a.anyone||a.anonymousLinkAbilities.canManageReadLink.enabled||a.anonymousLinkAbilities.canManageReadLink.enabled||(r=h.a.organization)),a.organizationLinkAbilities&&(i!==m.a.organizationEdit||a.organizationLinkAbilities.canManageEditLink.enabled||(i=m.a.organizationView),i!==m.a.organizationView||a.organizationLinkAbilities.canManageReadLink.enabled||(i=m.a.direct),r!==h.a.organization||a.organizationLinkAbilities.canManageReadLink.enabled||a.organizationLinkAbilities.canManageEditLink.enabled||(r=h.a.specificPeople)),a.peopleSharingLinkAbilities&&(r!==h.a.specificPeople||a.peopleSharingLinkAbilities.canManageReadLink.enabled||a.peopleSharingLinkAbilities.canManageEditLink.enabled||(r=h.a.existing));var o=void 0;return e===m.a.anonymousEdit||e===m.a.anonymousView?o=_.a.anyone:e===m.a.organizationEdit||e===m.a.organizationView?o=_.a.organization:e===m.a.direct?o=_.a.specificPeople:e===m.a.flexible&&(o=_.a.specificPeopleFlex),{allowsAnonymousAccess:void 0,audience:o,expiration:void 0,description:void 0,isActive:!0,isEdit:void 0,principals:void 0,shareId:void 0,sharingLinkKind:i,sharingScope:r,url:void 0,invitees:void 0,updatePassword:!1,password:"",passwordLastModifiedBy:void 0}},t.prototype._isPolicyTipFlagSet=function(e,t){return e&&(e&t)===t},t}(s.b);function N(e){var t;t=void 0!==e.Scope&&e.Scope!==h.a.uninitialized?B(e.LinkKind,e.Scope):(0,L.c)(e.LinkKind,e.AllowsAnonymousAccess,e.RestrictedShareMembership);var n=e.Expiration?new Date(e.Expiration):void 0;return{link:{allowsAnonymousAccess:e.AllowsAnonymousAccess,audience:t,expiration:n,description:e.Description,isActive:e.IsActive,isEdit:j(e.LinkKind)||e.IsEditLink,principals:null,invitees:null,hasPassword:e.RequiresPassword,shareId:e.ShareId,sharingLinkKind:e.LinkKind,sharingScope:e.Scope,url:e.Url,updatePassword:e.UpdatePassword,password:e.Password,passwordLastModifiedBy:e.PasswordLastModifiedBy,shareTokenString:e.ShareTokenString,isAddressBarLink:e.IsAddressBarLink,isUnhealthy:e.IsUnhealthy,status:e.SharingLinkStatus,created:e.Created}}}function B(e,t){return e===m.a.anonymousEdit||e===m.a.anonymousView?_.a.anyone:e===m.a.organizationEdit||e===m.a.organizationView?_.a.organization:e===m.a.direct?_.a.specificPeople:e===m.a.flexible?t==h.a.anyone?_.a.anyone:t===h.a.organization?_.a.organization:_.a.specificPeopleFlex:void 0}function j(e){return e===m.a.anonymousEdit||e===m.a.organizationEdit||e!==m.a.anonymousView&&e!==m.a.organizationView&&null}function V(e){return"{"===e[0]&&(e=e.substring(1,e.length-1)),/^(\{){0,1}[0-9a-fA-F]{8}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{12}(\}){0,1}$/gi.test(e)&&"00000000-0000-0000-0000-000000000000"!=e}}
,function(e,t,n){n.d(t,{a:function(){return a},b:function(){return o},c:function(){return r},d:function(){return s},e:function(){return i}});var a="role:1073741827",i="role:1073741826",r="role:1073741829",o="role:1073741830",s="role:1073741832"}
,function(e,t,n){var a;n.d(t,{a:function(){return r}}),function(e){e[e.icon=16]="icon",e[e.iconMin=16]="iconMin",e[e.bigIcon=48]="bigIcon",e[e.bigIconMin=48]="bigIconMin",e[e.regularMin=90]="regularMin",e[e.regular=130]="regular",e[e.nameMin=220]="nameMin",e[e.nameODC=440]="nameODC",e[e.nameODB=280]="nameODB",e[e.originalLocation=300]="originalLocation",e[e.custom=900]="custom",e[e.sharedWith=150]="sharedWith",e[e.note=250]="note",e[e.dateModifiedMl=150]="dateModifiedMl",e[e.dotDotDot=32]="dotDotDot",e[e.ratingsMin=110]="ratingsMin"}(a||(a={}));var i,r={none:0,notify:1,block:2,notifyAndBlock:3,blockSharing:4};!function(e){e[e.Auto=0]="Auto",e[e.Pinned=1]="Pinned",e[e.Removed=2]="Removed"}(i||(i={}))}
,function(e,t,n){n.d(t,{a:function(){return a}});var a={anyone:0,organization:1,specificPeople:2}}
,function(e,t,n){var a;n.d(t,{a:function(){return a}}),function(e){e[e.uninitialized=0]="uninitialized",e[e.AddressBarLink=1]="AddressBarLink"}(a||(a={}))}
,,function(e,t,n){n.d(t,{a:function(){return i},b:function(){return r},c:function(){return a}});var a={none:0,allow:1,allowWithJustification:2},i={none:0,falsePositiveReported:1,overridden:2,falsePositiveReportedAndOverridden:3},r={override:0,reportFalsePositive:1}}
,function(e,t,n){n.d(t,{a:function(){return j}});var a,i=n(0),r=n(2),o=n(244),s=n(59),c=n(51),d=n(420),l=n(28),u=n(12),f=(0,l.a)({eventName:"SuiteNavError,",shortEventName:"SuiteNavError"},{message:u.a.String,stack:u.a.String,type:u.a.String}),p=n(53),m=n(263),_=n(58),h=n(10),b=n(1),g=n(267),v=n(264),y=n(231),S=n(7),D=n(128),I=n(418),x=n(29),C=function(){function e(){}return e.hasClass=function(e,t){return e.classList?e.classList.contains(t):-1!==(e.className?e.className.split(" "):[]).indexOf(t)},e.toggleClass=function(e,t,n){if(e.classList)n?e.classList.add(t):e.classList.remove(t);else{var a=e.className?e.className.split(" "):[],i=a.indexOf(t);n?-1===i&&a.push(t):i>-1&&a.splice(i,1),e.className=a.join(" ")}},e.loadStyles=function(t){e._platform.isUnlimitedStyleSheetsSupported?e.registerStyle(t):e.registerStyleIE(t)},e.registerStyle=function(e){var t=document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",n.appendChild(document.createTextNode(e)),t.appendChild(n)},e.registerStyleIE=function(t){var n=document.getElementsByTagName("head")[0],a=e._lastStyleElement?e._lastStyleElement.styleSheet.cssText:"";(!e._lastStyleElement||a.length+e._styleText.length>e.MAX_STYLE_CONTENT_SIZE)&&(e._lastStyleElement=document.createElement("style"),e._lastStyleElement.type="text/css",n.appendChild(e._lastStyleElement)),e._lastStyleElement.styleSheet.cssText+=t},e.loadStylesheet=function(e){var t=document.createElement("link");t.rel="stylesheet",t.type="text/css",t.href=e,document.head.appendChild(t)},e.setText=function(t,n){void 0===a&&(a=void 0!==e.ce("div").textContent?"textContent":"innerText"),t[a]=n},e.ce=function(e,t,n){var a=document.createElement(e);if(t)for(var i=Object.keys(t),r=0;r<i.length;r++){var o=i[r];a.setAttribute(o,t[o])}if(n)for(var s=0;s<n.length;s++)a.appendChild(n[s]);return a},e.setShadowParent=function(t,n){t[e.SHADOW_PARENT_KEY]=n},e.getParent=function(t,n){return void 0===n&&(n=!0),n&&t[e.SHADOW_PARENT_KEY]||t.parentElement},e.ct=function(e){return document.createTextNode(e)},e.createComment=function(e){return document.createComment(e)},e.clickElement=function(e){e.onclick?e.onclick(void 0):e.click&&e.click()},e.insertAfter=function(e,t){var n=t.parentNode,a=t.nextSibling;a?n.insertBefore(e,a):n.appendChild(e)},e.waitForElement=function(e,t,n,a){var i=a||document,r=i.querySelector(e);if(!r){var o=new MutationObserver(function(n,a){var r=i.querySelector(e);r&&(t(r),a.disconnect())});return o.observe(n||a||document.documentElement,{childList:!0,subtree:!0}),o}t(r)},e.getElementByTagAndPartialId=function(e,t,n){for(var a=[],i=e.getElementsByTagName(t),r=0;r<i.length;r++)i[r].id.indexOf(n)>=0&&a.push(i[r]);return a.length>0?a[0]:null},e.findAncestor=function(t,n,a){for(void 0===a&&(a=!0);t&&t!==document.body;){if(e.hasClass(t,n))return t;t=e.getParent(t,a)}return null},e.isElementOrAncestorsEqualToTarget=function(t,n){for(;t&&t!==document.body;){if(t===n)return!0;t=e.getParent(t)}return!1},e.calculateRect=function(e,t){var n=e.getBoundingClientRect(),a=0,i=0,r=0,o=0;if(t){var s=window.getComputedStyle(e);a=parseFloat(s.marginLeft),i=parseFloat(s.marginRight),r=parseFloat(s.marginTop),o=parseFloat(s.marginBottom)}return new I.a(n.left-a,n.top-r,n.width+a+i,n.height+r+o)},e.calculateSubtreeRect=function(t){for(var n=null,a=[t];a.length>0;){t=a.shift();var i=e.calculateRect(t);i.width>0&&i.height>0&&(n=n?n.union(i):i);for(var r=0,o=t.children.length;r<o;r++)a.push(t.children[r])}return n||(n=new I.a),n},e.insertAtIndex=function(e,t,n,a){if(e&&t){n=n<0?0:n;for(var i=e.firstElementChild,r=0;r<n&&i;)a&&a!==i.tagName||r++,i=i.nextElementSibling;i?e.insertBefore(t,i):e.appendChild(t)}},e.MAX_STYLE_CONTENT_SIZE=1e4,e.SHADOW_PARENT_KEY="_OneDrive_shadowParent",e._platform=new x.a,e._lastStyleElement=null,e._styleText="",e}(),O=n(89),w=n(4),E=n(222),A=n(35),L=n(261),k=function(){function e(){}return e.GetLoadPromise=function(){return window.o365ShellLoadPromise},e.GetRenderPromise=function(){return window.o365ShellRenderPromise},e.GetPostRenderPromise=function(){return window.o365ShellPostRenderPromise},e}(),M=function(){function e(){var e=this;this._PostRenderSignal=new o.a,k.GetLoadPromise()&&k.GetLoadPromise().then(function(){e._signalAction(function(){})}),k.GetRenderPromise()&&k.GetRenderPromise().then(function(){e._signalAction(function(){})}),k.GetPostRenderPromise()&&k.GetPostRenderPromise().then(function(){e._signalAction(function(){})})}return Object.defineProperty(e.prototype,"FlexPane",{get:function(){return O365Shell.FlexPane},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Header",{get:function(){return O365Shell.Header},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Navigation",{get:function(){return O365Shell.Navigation},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Settings",{get:function(){return O365Shell.Settings},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Theme",{get:function(){return O365Shell.Theme},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Search",{get:function(){return O365Shell.Search},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"NFD",{get:function(){return O365Shell.NFD},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Extensibility",{get:function(){return O365Shell.Extensibility},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"MeControl",{get:function(){return O365Shell.MeControl},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"DTT",{get:function(){return O365Shell.DTT},enumerable:!1,configurable:!0}),e.prototype.SetData=function(e){O365Shell.SetData(e)},e.prototype.Render=function(e,t){var n=this;O365Shell.Render(e,function(){return n._signalAction(t)})},e.prototype.RenderAsync=function(e,t,n){var a=this;O365Shell.RenderAsync(e,function(){return a._signalAction(t)},function(){return a._signalAction(n)})},e.prototype.GetResourceLoader=function(){return O365Shell.GetResourceLoader()},e.prototype.OnDataChanged=function(e){return O365Shell.OnDataChanged(e)},e.prototype.OnSuiteAPILoaded=function(e){return O365Shell.OnSuiteAPILoaded(e)},e.prototype.LoadShellPlus=function(){O365Shell.LoadShellPlus()},e.prototype.Exists=function(){return"undefined"!=typeof O365Shell},e.prototype.HasMember=function(e){return this.Exists()&&!!O365Shell[e]},e.prototype.OnHasMember=function(e,t){var n=this;this.HasMember(e)?t():this._PostRenderSignal.getPromise().done(function(){return n.OnHasMember(e,t)})},e.prototype._signalAction=function(e){e();var t=this._PostRenderSignal;this._PostRenderSignal=new o.a,t.complete()},e}(),P=function(){function e(t,n){this._cachePrefix="odSuiteNav",this._cacheDataKey="Data",this._cacheThemeDataKey="ThemeData",this._cacheDateKey="CacheDate",this._cacheVersionKey="CacheVersion",this._cacheSessionKey="CachedThisSession",this._cacheVersion=6,this._cacheExpire=24,this._cacheRenew=12,this._cache=new s.a(this._cachePrefix,c.a.local),this._dataSourceBasic=n.dataSource,this._pageContext=n.pageContext,this._engagementEvent=t.engagementEvent,this._qosEvents=t.qosEvents,this._capabilities=this._dataSourceBasic.getCapabilities();var a=n.require,i=void 0===a?e.require:a;this._stopCachingGuestModeNavDataKSActivated=b.a.isActivated("2b530fb4-c76f-442e-a49e-e0259135ce2f"),this._require=i}return Object.defineProperty(e.prototype,"suiteNavPlaceholder",{get:function(){return this._suiteNavPlaceholder},set:function(e){this._suiteNavPlaceholder||(this._suiteNavPlaceholder=e)},enumerable:!1,configurable:!0}),e.prototype.getCapabilities=function(){return this._capabilities},e.prototype.getO365Shell=function(){var e=this;if(!this._capabilities.supportsRealSuiteNav)return S.c.reject(new Error("getO365Shell is only supported if supportsRealSuiteNav capability is true."));if(h.a.isFeatureEnabled({ODB:!0,ODC:!1})){var t=new M;return S.c.resolve().then(k.GetLoadPromise).then(function(){return t})}var n=new o.a,a=this._qosEvents&&this._qosEvents["SuiteNavProvider.GetO365Shell"];return this._getSuiteNavShellViaBootstrapper(n),n.getPromise().then(function(){e._qosRecordSuccess(a)},function(t){e._qosRecordError(a,t)}),n.getPromise()},e.prototype.getInitialRenderNavBarData=function(){return this._dataSourceBasic.getInitialRenderNavBarData()},e.prototype.getCachedData=function(){var e;if(this._capabilities.supportsCaching&&this._isCacheValid()){var t=this._cache.getValue(this._cacheDataKey);e=t&&t.data}return e},e.prototype.getCachedThemeData=function(){var e;if(this._capabilities.supportsCaching){var t=this._cache.getValue(this._cacheThemeDataKey);t&&t.themeData&&(e=t.themeData)}return e},e.prototype.updateCachedThemeData=function(e){var t={themeData:e,cacheDate:(new Date).toISOString()};this._cache.setValue(this._cacheThemeDataKey,t)},e.prototype._requestShellCore=function(t,n,a){var i=n?t+"?odb_cb="+(new Date).toISOString():t,r=new o.a,s="SuiteNavShellCore";return this._require(i,s,function(e){a&&a();var t=new M;t.Exists()?r.complete(t):r.error(T({error:{message:"O365Shell not defined after require() succeeded"},resultCode:"O365ShellNotDefined",extraData:{shellUrl:i}}))},function(t,n){e.removeHeadScriptElement(s),r.error(T({error:n||t.message,resultCode:"LoadScriptError",extraData:{shellUrl:i}}))}),r.getPromise()},e.removeHeadScriptElement=function(e){var t=document.head.querySelector("#"+e);t&&t.parentNode.removeChild(t)},e.prototype._isGuestModeNavData=function(e){if(!e)return!1;try{var t=e.ClientData&&JSON.parse(e.ClientData);return t&&t.IsGuestMode}catch(e){return!0}},e.prototype._isCacheValid=function(){var e=this._cache.getValue(this._cacheDataKey),t=this._cache.getValue(this._cacheVersionKey),n=Date.parse(this._cache.getValue(this._cacheDateKey)),a=this._capabilities.supportsRealSuiteNav,i=this._dataSourceBasic;return e&&e.data&&(this._stopCachingGuestModeNavDataKSActivated||!this._isGuestModeNavData(e.data))&&(!a||e.jsUrl)&&t===this._cacheVersion&&e.userIdentifier===i.getUserIdentifier()&&e.cacheToken===i.getCacheToken()&&this._isSameUserLanguage(e.data.CultureName)&&this._isCacheNotExpired(n,this._cacheExpire)},e.prototype._qosRecordSuccess=function(e){e&&e.end({resultType:A.a.Success})},e.prototype._qosRecordError=function(e,t){e&&e.end(T({error:t}))},e.prototype._logEngagementData=function(e){this._engagementEvent&&this._engagementEvent.logData(e)},e.prototype._isSameUserLanguage=function(e){var t;return!(!b.a.isActivated("3e9c64de-101f-4c42-8514-06ef6dd97edb","08/09/2023","Fix language not updated in Feedback and Help section")&&e&&(null===(t=this._pageContext)||void 0===t?void 0:t.currentUICultureName))||e.toLowerCase()===this._pageContext.currentUICultureName.toLowerCase()},e.prototype._isCacheNotExpired=function(e,t){return!isNaN(e)&&Date.now()-e<60*t*60*1e3},e.prototype._getSuiteNavShellViaBootstrapper=function(e,t){var n=this,a=this._dataSourceBasic.getReactShellBootstrapperUrl();this._requestShellCore(a,t).then(function(t){e.complete(t)},function(t){t=T({error:t}),n._hasRetriedO365Shell?e.error(t):(n._hasRetriedO365Shell=!0,n._getSuiteNavShellViaBootstrapper(e,!0))})},e.require=function(t,n,a,i){var r=function(){return void 0!==window.O365Shell};if(r())a&&a(null);else{var o=document.head.querySelector("#"+n);if(o&&o.src===t)try{(0,L.b)(r,300,3e4).then(function(){a(null)})}catch(e){i(null,"Unable to load O365Shell")}else{o&&o.src!==t&&e.removeHeadScriptElement(n);var s=document.createElement("script");s.id=n,s.src=t,a&&s.addEventListener("load",function(e){a(e)}),i&&s.addEventListener("error",function(e){i(e)}),document.head.appendChild(s)}}},e}();function T(e){var t=e.error;if(t&&t.resultCode)return t;var n=A.a.Failure;return S.c.isCanceled(t)&&(n=A.a.ExpectedFailure,e.resultCode="Canceled"),{resultType:n,resultCode:e.resultCode||"Other",error:t,extraData:e.extraData}}var U=n(163),F=n(594),H=n(595),R={ODB:556,ODC:!1,Fallback:!1},N={ODB:1302,ODC:!1,Fallback:!1},B=b.b.isActivated("54d52105-eb9a-472b-98c2-17bc1192a994"),j=function(e){function t(t,n){var a=e.call(this,{engagementEvent:O.a,qosEvents:{"SuiteNavProvider.GetO365Shell":new w.a({name:"SuiteNavProvider.GetO365Shell"})}},n)||this;return a._dataSource=n.dataSource,a._cssLoaded=!1,a._isSuiteNavBootstrapperLoadingFlowEnabled=h.a.isFeatureEnabled(N),a._isMultipleFontFacesKsActivated=b.b.isActivated("7635e24c-97e6-4c2c-acd1-a141c2374dfa","1/08/2024","Use multiple font faces to load Feedback icon for in-place navigation scenario"),a}return(0,i.d)(t,e),t.prototype.clearCachedPromise=function(){this._modelPromise=void 0},t.prototype.loadData=function(e){return this._loadModel(e).then(function(e){return e.data})},t.prototype.getO365Shell=function(){if(this._isSuiteNavBootstrapperLoadingFlowEnabled)return e.prototype.getO365Shell.call(this);if(!this._capabilities.supportsRealSuiteNav)throw new Error("getO365Shell is only supported if supportsRealSuiteNav capability is true.");var t=new o.a,n=new w.a({name:"SuiteNavProvider.GetO365Shell"});return this._getSuiteNavShell(t),t.getPromise().then(function(){n.end({resultType:w.b.Success})},function(e){n.end(T({error:e}))}),t.getPromise()},t.prototype.getMailUrl=function(){return this._loadModel().then(function(e){var t=e&&e.data&&e.data.WorkloadLinks;if(t)for(var n=0,a=t;n<a.length;n++){var i=a[n];if(i&&i.Id===m.a.MAIL)return i.Url}})},t.prototype.updateWorkloadSettingsLinks=function(e){var t,n=this;return this.getO365Shell().then(function(a){return(t=a)&&t.Settings?n.loadData(e):void 0}).then(function(e){e&&e.CurrentWorkloadSettingsSubLinks&&e.CurrentWorkloadSettingsSubLinks.length>0&&t.Settings.SetWorkloadSettingsLinks(e.CurrentWorkloadSettingsSubLinks)}).catch(function(e){O.a.logData({name:"SuiteNavProvider.UpdateWorkloadSettingsLinksError"})})},t.prototype.trySetDataAfterInitialRender=function(e,t){var n=this,a=new w.a({name:"SuiteNavProvider.SetDataCalled"}),r=this._dataSource.getSuiteNavContext();if(r&&r.isConsumer)return e.NFD&&(r.helpNamespace&&e.NFD.UpdateHelpNamespace(r.helpNamespace),this._addFeedbackButton(e)),r.actionsMap&&e.Navigation.OnLinkClick(function(e){var t=r.actionsMap[e.Id];t&&(e.Cancel=!t((0,i.a)({},e)))}),S.c.wrap(!0);var o=t.actionContext,s=t.bundleLoader;return this.loadData().then(function(t){if(!t||!e)return!1;var r=n._isStreamAspx(),c=n._isVideoEditorAspx(),d=(r||c||n._isFeedbackButtonEnabled())&&!!e.NFD,l=d&&(r||c||n._shouldAddFeedbackButton(e));if(n._pageContext){var u=n._pageContext,f=u.cloudType,p=u.env2;((0,U.d)(p)||(0,U.a)(p)||"gcc"===f)&&(l=d=!1)}if(l){var m=JSON.parse(t.ClientData);n._isFeedbackButtonEnabled()&&(n._isODb()||D.d)&&(m.EnableVNextFeedback=!0,m.OcpsOauthEnabled=!0,m.OcpsOauthEndpointUrl="https://clients.config.office.net/user/v1.0/web/policies"),m.OCVFeedbackMAXEnabled||D.d?(m.OCVFeedbackMAXEnabled=!1,t.ClientData=JSON.stringify(m)):d=l=!1}try{e.SetData(t),B||(0,H.b)(t,a,n._pageContext)}catch(e){return(0,E.a)(w.a,{name:"SuiteNav.RefreshCacheAfterInvalidShellData"},function(){return n.loadData(!0)}),!1}return t.ActionsMap&&e.Navigation.OnLinkClick(function(e){var n=t.ActionsMap[e.Id];n&&(e.Cancel=!n((0,i.a)((0,i.a)({},e),o||{})))}),e.OnHasMember("OnDataChanged",function(){e.OnDataChanged(function(){return(0,E.a)(w.a,{name:"SuiteNav.RefreshCacheForShellDataChanged"},function(){return n.loadData(!0)}).done()})}),d&&l&&n._addFeedbackButton(e),s&&s.pageRenderingIsComplete(),!0},function(e){return O.a.logData({name:"SuiteNavProvider.LoadDataError"}),!1})},t.prototype._getSuiteNavShell=function(e,t){var n=this;this._loadModel().then(function(a){!n._cssLoaded&&a.cssUrl&&(C.loadStylesheet(a.cssUrl),n._dataSource.onCssLoad&&n._dataSource.onCssLoad(a),n._cssLoaded=!0),n._requestShellCore(a.jsUrl,t,V).then(function(t){e.complete(t)},function(t){n._modelPromise=void 0,(t=T({error:t}))&&"LoadScriptError"===t.resultCode&&n._isDataFromCache?(O.a.logData({name:"SuiteNavProvider.O365ShellCacheFailed"}),n._clearCache(),n._getSuiteNavShell(e)):n._hasRetriedShell?e.error(t):(n._hasRetriedShell=!0,n._cssLoaded=!1,O.a.logData({name:"SuiteNavProvider.O365ShellRetry"}),n._getSuiteNavShell(e,!0))})})},t.prototype._isODb=function(){return this._pageContext&&void 0!==this._pageContext.listBaseTemplate&&!b.b.isActivated("5488D0DA-5FA4-41EF-95EE-032C1D85ACFF")?this._pageContext.listBaseTemplate===F.a.mySiteDocumentLibrary:D.a},t.prototype._loadModel=function(e){var t=this;if(!e&&this._modelPromise)return this._modelPromise;var n,a,i,r,s=new o.a,c=this._capabilities.supportsCaching,d=this._dataSource,l=w.b.Failure,u=(0,E.a)(w.a,{name:"SuiteNavProvider.LoadData"},function(){return new S.c(function(a,i){var r;if(!e&&c&&t._isCacheValid()&&(r=t._cache.getValue(t._cacheDataKey)),r&&r.data){var o=new w.a({name:"SuiteNavProvider.GetCachedData"});d.updateDataForCurrentPage&&(r.data=d.updateDataForCurrentPage(r.data)),c&&t._isCacheOutdated()&&d.loadData().then(function(e){t._updateCache(e)}),B||(0,H.b)(r.data,o,t._pageContext),t._isDataFromCache=!0,a(r)}else t._isDataFromCache=!1,d.loadData().done(function(e){e?e.data?(c&&!function(e){var t=e&&e.data&&e.data.WorkloadLinks;return!!t&&t.some(function(e){return e&&!e.Url})}(e)&&t._updateCache(e),a(e)):(n="NoModelData",i("Model with no data returned")):(n="NoModel",i("No model returned"))},function(e){S.c.isCanceled(i)?(n="Canceled",l=w.b.ExpectedFailure):n="ServerLoadFailure",i(e)})})},null,function(e){return S.c.isCanceled(e)&&(l=w.b.ExpectedFailure,n="Canceled"),{resultType:l,resultCode:n||"Other",error:e}});return i=window._spPageContextInfo,r={webThemeProvider:function(){return new v.a({pageContext:i,getThemeDataSource:function(){return S.c.resolve(new y.default(i))}})}},(a=(0,g.a)(r,i))?this._modelPromise=S.c.all({suiteNavModel:u,theme:a.loadThemeSlotsMap()}).then(function(e){var t=e.suiteNavModel,n=e.theme,a=t&&t.data,i=t&&t.hasCobranding,r=a&&a.UseSPOBehaviors,o=h.a.isFeatureEnabled(R),s=n&&n.suiteBarBackground;return!(s&&a&&r)||i&&o||(a.ThemeColors=[s,n.primaryText,s,n.suiteBarText,n.suiteBarDisabledText,n.topBarBackground,n.topBarText,n.topBarHoverText,n.primaryBackground,n.themeLighterAlt,n.dialogBorder]),t}):this._modelPromise=u,this._modelPromise.then(function(e){return s.complete(e)},function(e){return s.error(e)}),s.getPromise()},t.prototype._isFeedbackButtonEnabled=function(){return h.a.isFeatureEnabled({ODB:this._isODb()?60887:1246,ODC:!1,Fallback:!1})},t.prototype._shouldAddFeedbackButton=function(e){var t=!1;if(this._isFeedbackButtonEnabled()){var n=this._dataSource.getWebTemplateType?this._dataSource.getWebTemplateType():p.b.invalid;t=n!==p.b.mySiteHost&&!D.b&&n!==p.b.tenantAdmin||/\/_layouts\/15\/Lists.aspx$/i.test(window.location.pathname)}return!t&&this._isStreamAspx()&&(t=h.a.isFeatureEnabled({ODB:1246,ODC:!1,Fallback:!1})),b.b.isActivated("a1dc3b5f-8668-4cdf-afdf-57bdc0194b53","06/13/2023","Always add feedback button for videoeditor.aspx")||t||!/\/_layouts\/15\/videoeditor.aspx$/i.test(window.location.pathname)||D.b||(t=!0),t},t.prototype._isStreamAspx=function(){var e,t;return b.b.isActivated("1da070f4-d176-43bf-a6db-6b00339b819b","02/07/2024","Check stream path from serverRequestPath")?/\/_layouts\/15\/stream.aspx$/i.test(window.location.pathname):/\/stream\.aspx/i.test(null!==(t=null===(e=this._pageContext)||void 0===e?void 0:e.serverRequestPath)&&void 0!==t?t:"")},t.prototype._isVideoEditorAspx=function(){return!(b.b.isActivated("a1dc3b5f-8668-4cdf-afdf-57bdc0194b53","06/13/2023","Always add feedback button for videoeditor.aspx")||!/\/_layouts\/15\/videoeditor.aspx$/i.test(window.location.pathname))},t.prototype._addFeedbackButton=function(e){var t,n=this,a="GiveFeedbackButton",i="Feedback",o=function(){var t;null===(t=e.FlexPane)||void 0===t||t.CloseFlexPaneForProvider(i),_.a.raise(document.body,"resize",void 0,!0)},s=function(){var t;e.NFD&&e.NFD.OnFeedbackMetadataRequested(function(e,t){return n._dataSource.setFeedbackMetadata(e,t)}),e.FlexPane&&(e.FlexPane.OpenFlexPaneForProvider(i),_.a.raise(document.body,"resize",void 0,!0)),null===(t=e.Extensibility)||void 0===t||t.UpdateButtonState(a,!0)},c=this._isMultipleFontFacesKsActivated?"FabricMDL2Icons":"FabricMDL2Icons, Fluent MDL2 Hybrid Icons";b.b.isActivated("4dcd117e-f86f-4bbe-bef1-3afc60df78f7","03/02/2022","Load Feedback icon before using it")?null===(t=e.Extensibility)||void 0===t||t.AddOrUpdateCustomHeaderButton({affordanceMenuItemText:d.a,ariaLabel:d.a,iconFontFamily:c,iconFontName:"",id:a,onShow:s,onHide:o}):e.Extensibility&&((0,r.z)("Feedback"),e.Extensibility.AddOrUpdateCustomHeaderButton({affordanceMenuItemText:d.a,ariaLabel:d.a,iconFontFamily:c,iconFontName:"",id:a,onShow:s,onHide:o}))},t.prototype._clearCache=function(){this._cache.remove(this._cacheDataKey),this._cache.remove(this._cacheThemeDataKey),this._cache.remove(this._cacheDateKey),this._cache.remove(this._cacheVersionKey),this._cache.remove(this._cacheSessionKey,c.a.session)},t.prototype._updateCache=function(e,t){!this._stopCachingGuestModeNavDataKSActivated&&this._isGuestModeNavData(e.data)||(this._cache.setValue(this._cacheDataKey,e),this._cache.setValue(this._cacheDateKey,new Date),this._cache.setValue(this._cacheVersionKey,this._cacheVersion),this._cache.setValue(this._cacheSessionKey,!0,c.a.session))},t.prototype._isCacheOutdated=function(){var e=this._cache.getValue(this._cacheSessionKey,c.a.session),t=Date.parse(this._cache.getValue(this._cacheDateKey));return s.a.hasStorageType(c.a.session)&&!e||Date.now()-t>=60*this._cacheRenew*60*1e3},t}(P);function V(){var e=window._o365su;if(e&&e.b)for(var t=0,n=["ThrowOnNull","ThrowOnUndefined","ThrowOnNullOrUndefined","ThrowOnNullOrEmpty","ThrowOnNullOrEmptyArray"];t<n.length;t++){var a=n[t];z(e.b,a)}}function z(e,t){var n=e[t];"function"==typeof n&&(e[t]=function(){for(var e=[],a=0;a<arguments.length;a++)e[a]=arguments[a];try{return n.apply(this,e)}catch(e){var i=e;f.logData({message:i&&i.message||"",stack:i&&i.stack||"",type:t})}})}}
,function(e,t,n){n.d(t,{a:function(){return o}});var a=n(419),i=function(e,t){this.width=0,this.height=0,this.width=e,this.height=t},r=function(){function e(t,n,i,r){if(this.x=0,this.y=0,this.width=0,this.height=0,0===arguments.length)this.x=0,this.y=0,this.width=0,this.height=0;else if(t instanceof e){var o=t;this.x=o.x,this.y=o.y,this.width=o.width,this.height=o.height}else if(t instanceof a.a){var s=t,c=n;this.x=s.x,this.y=s.y,this.width=c.width,this.height=c.height}else if("object"==typeof t&&"number"==typeof t.left&&"number"==typeof t.top&&"number"==typeof t.width&&"number"==typeof t.height){var d=t;this.x=d.left,this.y=d.top,this.width=d.width,this.height=d.height}else this.x=t,this.y=n,this.width=i,this.height=r}return e.prototype.clip=function(t){var n=new e(this);return n.x<t.x&&(n.width-=t.x-n.x,n.x=t.x),n.getRight()>t.getRight()&&(n.width-=n.getRight()-t.getRight()),n.y<t.y&&(n.height-=t.y-n.y,n.y=t.y),n.getBottom()>t.getBottom()&&(n.height-=n.getBottom()-t.getBottom()),n},e.prototype.contains=function(e){if(e instanceof a.a){var t=e;return t.x>=this.x&&t.y>=this.y&&t.x<=this.getRight()&&t.y<=this.getBottom()}var n=e,i=n.getPoint(),r=new a.a(n.getRight(),n.getBottom());return this.contains(i)&&this.contains(r)},e.prototype.getCenter=function(){return new a.a(this.x+this.width/2,this.y+this.height/2)},e.prototype.getLeft=function(){return this.x},e.prototype.getTop=function(){return this.y},e.prototype.getRight=function(){return this.x+this.width},e.prototype.getBottom=function(){return this.y+this.height},e.prototype.getPoint=function(){return new a.a(this.x,this.y)},e.prototype.getSize=function(){return new i(this.width,this.height)},e.prototype.inflate=function(t,n){var a,i;if("object"==typeof t){var r=t;a=r.width,i=r.height}else a=t,i=n;return new e(this.x-a/2,this.y-i/2,this.width+a,this.height+i)},e.prototype.nudge=function(t){var n=new e(this);return n.x<t.x?n.x=t.x:n.getRight()>t.getRight()&&(n.x=t.getRight()-n.width),n.y<t.y?n.y=t.y:n.getBottom()>t.getBottom()&&(n.y=t.getBottom()-n.height),n},e.prototype.translate=function(t,n){var i;if(t instanceof a.a){var r=t;i=this.translate(r.x,r.y)}else{var o=t,s=n;i=new e(this.x+o,this.y+s,this.width,this.height)}return i},e.prototype.union=function(t){var n=Math.min(this.x,t.x),a=Math.min(this.y,t.y);return new e(n,a,Math.max(this.x+this.width,t.x+t.width)-n,Math.max(this.y+this.height,t.y+t.height)-a)},e.prototype.fit=function(t,n){var a=t;a=this.width&&this.height&&(n?this.width>a.width||this.height>a.height:this.width>a.width&&this.height>a.height)?this._scaleTo(t,n):this;var i=(t.width-a.width)/2,r=(t.height-a.height)/2;return new e(i+this.x,r+this.y,a.width,a.height)},e.prototype._scaleTo=function(t,n){var a=t.width/t.height,i=this.width/this.height,r=0,o=0;return(n?i:a)<(n?a:i)?(o=t.height,r=i*t.height):(r=t.width,o=t.width/i),new e(this.x,this.y,r,o)},e}(),o=r}
,function(e,t,n){var a=function(){function e(t,n){if(void 0===t&&(t=0),void 0===n&&(n=0),t instanceof e){var a=t;this.x=a.x,this.y=a.y}else this.x=t,this.y=n}return e.areEqual=function(e,t,n){return void 0===n&&(n=1e-6),Math.abs(e.x-t.x)<n&&Math.abs(e.y-t.y)<n},e.getCenter=function(t){return t.reduce(function(e,t){return e.add(t)},e.ORIGIN).scale(1/t.length)},e.prototype.scale=function(t){return new e(this.x*t,this.y*t)},e.prototype.add=function(t){return new e(this.x+t.x,this.y+t.y)},e.prototype.subtract=function(t){return new e(this.x-t.x,this.y-t.y)},e.prototype.distance=function(e){var t=this.x-e.x,n=this.y-e.y;return Math.sqrt(t*t+n*n)},e.prototype.negate=function(){return new e(-this.x,-this.y)},e.prototype.abs=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},e.prototype.unit=function(){var e=this.abs();return this.scale(e&&1/e||0)},e.prototype.toString=function(){return"[Point ".concat(this.x,", ").concat(this.y,"]")},e.ORIGIN=new e,e}();t.a=a}
,,function(e,t,n){n.d(t,{a:function(){return r},b:function(){return a},c:function(){return i}});var a=function(e){var t=document.cookie.match("(^|;)\\s*"+e+"\\s*=\\s*([^;]+)");return t?t.pop():""},i=function(e,t,n,a,i){var r="",o=a||"/";if(n){var s=new Date;s.setTime(s.getTime()+24*n*60*60*1e3),r=" expires= + ".concat(s.toUTCString()," + ;")}var c="";i&&(c=" samesite=".concat(i,";"),"none"===i.toLowerCase()&&(c+=" secure;")),document.cookie="".concat(e,"=").concat(t,";").concat(r," path=").concat(o,";").concat(c)},r=function(e){document.cookie="".concat(e,"=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;")}}
,function(e,t,n){var a;n.d(t,{a:function(){return a}}),function(e){e[e.CompletedSuccessfully=0]="CompletedSuccessfully",e[e.AccessRequestsQueued=1]="AccessRequestsQueued",e[e.CapabilityDisabled=-7]="CapabilityDisabled",e[e.ObjectNotSupported=-8]="ObjectNotSupported",e[e.TooManyChildItemsWithUniqueScopes=-13]="TooManyChildItemsWithUniqueScopes",e[e.SharingToBlockedUserOnODB=-62]="SharingToBlockedUserOnODB",e[e.SharingToBlockedBySiteRAC=-84]="SharingToBlockedBySiteRAC"}(a||(a={}))}
,,,,,function(e,t,n){n.d(t,{a:function(){return a}});var a,i=n(428),r=n(1);a=r.a.isActivated("48EB9785-D133-4AF9-A10B-77DDBF104C80")?i.a:function(e,t){void 0===t&&(t={});var n=document.createElement("style");n.setAttribute("data-merge-styles","true");var a=document.createElement("style");return a.setAttribute("data-make-styles-placeholder",""),document.head.insertAdjacentElement("afterbegin",n),document.head.insertAdjacentElement("afterbegin",a),t.insertionPoint||(t.insertionPoint=a),(0,i.a)(e,t)}}
,,,function(e,t,n){n.d(t,{a:function(){return a}});var a={ShareToTeams:0,SimplifiedV2:1}}
,function(e,t,n){var a=n(58),i=n(164),r={Small:"sm",Medium:"md",Large:"lg",XLarge:"xlg",XXLarge:"xxlg",XXXLarge:"xxxlg",XXXXLarge:"xxxxlg"},o={Small:480,Medium:640,Large:1024,XLarge:1366,XXLarge:1920,XXXLarge:2560,XXXXLarge:1/0},s=function(){function e(e,t){this._scope=new i.a,this._events=new(this._scope.attached(a.a))(this),this._events.on(window,"resize, orientationchange",this._onContainerResize.bind(this));var n=t.breakpoints;this._breakpoints="function"==typeof n?n:function(){return n},this._windowWidth=0,this._windowHeight=0,this._onContainerResize()}return e.reduceBreakpoints=function(e,t){return{Small:t,Medium:e.Small,Large:e.Medium,XLarge:e.Large,XXLarge:e.XLarge,XXXLarge:e.XXLarge,XXXXLarge:1/0}},e.determineWindowSize=function(e,t){if(void 0===t&&(t=o),0===e)return"Medium";for(var n in o)if(e<t[n])return n},e.determineCssClass=function(e){return r[e]},e.getScrollbarWidth=function(){var e=document.createElement("div"),t=document.createElement("div"),n=e.style;n.visibility="hidden",n.width="100px",n.msOverflowStyle="scrollbar",n.overflow="scroll",t.style.width="100%",document.body.appendChild(e),e.appendChild(t);var a=e.offsetWidth,i=t.offsetWidth;e.parentNode.removeChild(e);var r=a-i;return this.getScrollbarWidth=function(){return r},r},Object.defineProperty(e.prototype,"windowWidth",{get:function(){return this._windowWidth},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"windowHeight",{get:function(){return this._windowHeight},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"formFactorSize",{get:function(){return this._formFactorSize},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isHamburgerVisible",{get:function(){return this._isHamburgerVisible},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"showLabels",{get:function(){return this._showLabels},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cssClass",{get:function(){return this._cssClass},enumerable:!1,configurable:!0}),e.prototype.dispose=function(){this._scope.dispose()},e.prototype.compareSize=function(e,t){var n=this._breakpoints();return n[e]-n[t]},e.prototype._afterContainerResize=function(){},e.prototype._onContainerResize=function(){var t=document.body,n=document.documentElement,a=this._windowHeight=n.clientWidth||t.clientWidth;this._windowWidth=n.clientHeight||t.clientHeight;var i=this._formFactorSize,r=this._formFactorSize=e.determineWindowSize(a,this._breakpoints());this._cssClass=e.determineCssClass(r);var s=this._isHamburgerVisible;this._isHamburgerVisible=a<o.Large;var c=this._showLabels;this._showLabels=this.compareSize(r,"Medium")>0,i&&r!==i&&this._events.raise("formFactorChange"),"boolean"==typeof s&&s!==this._isHamburgerVisible&&this._events.raise("hamburgerVisibilityChange"),"boolean"==typeof c&&c!==this._showLabels&&this._events.raise("showCommandLabelsChange"),this._afterContainerResize()},e.DEFAULT_BREAKPOINTS=o,e.MAC_SCROLL_BAR_WIDTH=8,e}();t.a=s}
,,function(e,t,n){n.d(t,{a:function(){return o}});var a=n(99),i=n(53),r=n(1).a.isActivated("77387d2b-5c80-4bec-8d0c-30b8358fc3b0","2/13/2024","Checks isListSharing to determine if listItemId should be appended"),o=function(){function e(e){this._pageContext=e.pageContext,this._listId=e.listId,this._listItemId=e.listItemId,this._webAbsoluteUrl=e.webAbsoluteUrl,this._isListSharing=e.isListSharing}return e.prototype.getAdvancedUrl=function(){var e=[this._webAbsoluteUrl];if(e.push("/_layouts/15/user.aspx"),e.push("?List="+a.a.encodeURIComponent(this._listId)),!this._isListSharing||r){if(!this._listId||!this._listItemId)return;e.push("&obj=",a.a.encodeURIComponent(this._listId),",",a.a.encodeURIComponent(this._listItemId),",LISTITEM")}return Number(this._pageContext.webTemplate)===i.b.group&&e.push("&noredirect=true"),e.join("")},e}()}
,function(e,t,n){n.d(t,{a:function(){return jt}});var a=n(0),i=n(8);(0,i.b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:active){.od-Share.not-IE{border:3px solid}}.od-Share{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:';border-radius:2px;min-height:130px}.od-Share.od-SimplifiedShare{border-radius:8px;min-height:inherit}.od-Share.animation{transition:height .2s cubic-bezier(.33, 0, .1, 1)}.od-Share.od-Share--hasActivity{position:relative}.od-Share.od-Share--hasActivity:after{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background-color:'},{theme:"white",defaultValue:"#fff"},{rawString:";opacity:.8}.od-Share.od-Share--permissionsPivot{overflow:unset!important}[dir=ltr] .od-Share .ms-Button+.ms-Button{margin-left:13px}[dir=rtl] .od-Share .ms-Button+.ms-Button{margin-right:13px}.od-Share a{color:"},{theme:"link",defaultValue:"#0078d4"},{rawString:";text-decoration:none}.od-Share a:focus,.od-Share a:hover{color:"},{theme:"linkHovered",defaultValue:"#004578"},{rawString:";text-decoration:underline}.od-Share a:focus{outline:1px solid transparent}.od-Share button:not(.ms-Button):not(.od-Share-noFocusBorder):focus{outline:1px solid;outline-color:"},{theme:"black",defaultValue:"#000"},{rawString:'}.od-Share .od-Share-noFocusBorder:focus{outline:0;border:none}.od-Share .ms-Button--default{outline:transparent;position:relative}.od-Share .ms-Button--default::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-Share .ms-Button--default:focus:after,.od-Share .ms-Button--default[data-fui-focus-visible]:focus:after{content:"";position:absolute;top:2px;right:2px;bottom:2px;left:2px;pointer-events:none;border:1px solid '},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:'}@media screen and (-ms-high-contrast:active){.od-Share .ms-Button{outline:transparent;position:relative}.od-Share .ms-Button::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-Share .ms-Button:focus:after,.od-Share .ms-Button[data-fui-focus-visible]:focus:after{content:"";position:absolute;top:2px;right:2px;bottom:2px;left:2px;pointer-events:none;border:1px solid '},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}}.od-Share ul{list-style-type:none;list-style:none;margin:0;padding:0}.od-Share .ms-Icon--ExcelLogo:before{color:#217346}.od-Share .ms-Icon--OneNoteLogo:before{color:#5c2d91}.od-Share .ms-Icon--PowerPointLogo:before{color:#d24726}.od-Share .ms-Icon--WordLogo:before{color:#2b579a}.od-Share .ms-Icon--PDF:before{color:#d24726}.od-Share.icon-Chat{color:#6264a7;background:#f6f6fa;border:1px solid #6264a7}.od-Share.icon-Mail{color:"},{theme:"teal",defaultValue:"#008272"},{rawString:";background:#f0f5f7;border:1px solid "},{theme:"teal",defaultValue:"#008272"},{rawString:"}.od-Share .icon-Globe{color:#0b6a0b;background:#f1f6f1;border:1px solid #0b6a0b;color:#0b6a0b;border-color:#0b6a0b;background-color:#f1f6f1}.od-Share .icon-Work{color:#004e8c;background:#f0f5f8;border:1px solid #004e8c;color:#004e8c;border-color:#004e8c;background-color:#f0f5f8}.od-Share .icon-AddFriend{color:#393939;background:#f2f2f2;border:1px solid #393939;color:#201f1e;border-color:#201f1e;background-color:RGBA(#201f1e,.06)}.od-Share .icon-ReminderPerson{color:#8e562e;background:#f4efeb;border:1px solid #8e562e;color:#a4262c;border-color:#a4262c;background-color:RGBA(#a4262c,.06)}.od-Share .ms-Tooltip{pointer-events:none}.od-Share .ms-Spinner{position:absolute;top:50%;left:50%}@media all and (-ms-high-contrast:none),(-ms-high-contrast:active){.od-Share .ms-Button{overflow:visible}}#od-Share-backButton-tooltip{position:relative}button.od-Share-backButton{z-index:1;background:0 0;border:none;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";cursor:pointer;font-size:16px;padding:0;position:relative;left:inherit}button.od-Share-backButton#od-ShareToTeams-backButton{top:-40px}[dir=rtl] button.od-Share-backButton{transform:scale(-1,1)}button.od-Share-backButton:focus{outline:1px solid "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}button.od-Share-backButton.absolute{position:absolute;top:8px}[dir=ltr] button.od-Share-backButton.absolute{left:8px}[dir=rtl] button.od-Share-backButton.absolute{right:8px}button.od-Share-backButton.priorView{top:14px}[dir=ltr] button.od-Share-backButton.priorView{left:16px}[dir=rtl] button.od-Share-backButton.priorView{right:16px}.od-Share-shareMainDiv{position:relative;overflow:hidden auto}.od-Share-spinnerHolder{align-items:center;display:flex;height:130px;justify-content:center}.od-Share-screenReaderOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.teams .ms-Checkbox-checkbox{border-radius:4px}.teams .ms-Button.ms-Button--default,.teams .ms-Button.ms-Button--primary{border-radius:3px;min-width:96px}.teams .ms-Button--default{border:1px solid rgba(37,36,36,.15)}.teams .ms-Button--primary.is-disabled{border:none}.SendLink-statusIconItem{display:inline-block;margin-bottom:0;font-size:.625rem;color:"},{theme:"black",defaultValue:"#000"},{rawString:"}[dir=ltr] .SendLink-statusIconItem{margin-left:4px}[dir=rtl] .SendLink-statusIconItem{margin-right:4px}[dir=ltr] .SendLink-statusIconItem{margin-right:4px}[dir=rtl] .SendLink-statusIconItem{margin-left:4px}.SendLink-statusIconItem .ms-Icon{background-color:transparent;position:relative}.SendLink-statusIconItem .ms-Icon:after{position:absolute;width:12px;height:12px;background-color:"},{theme:"green",defaultValue:"#107c10"},{rawString:"}.SendLink-statusIconTooltip{font-size:.875rem}.SendLink-statusIcon{font-size:.625rem;width:2.75px;height:2.75px}.blockDownloadSVG{width:1.125rem;height:1.125rem}"}]);var r=n(52),o=n(39),s=n(107),c=n(41),d=n(32),l=n(40),u=n(98),f=n(82),p=n(281),m=n(502),_=n(61),h=n(13),b=n(100),g=n(101),v=n("react-lib"),y=n("prop-types-lib"),S=n(136),D=n(80),I=n(55),x=n(291),C=n(347),O=n(56),w=n(24),E=n(20),A=n(306),L=n(71),k=n(58),M=n(2),P=n(112),T=n(596),U=n(54),F=n(193),H=n(21),R=n(72),N=n(192),B=n(38),j=n(248),V=n(304),z=n(305),G=n(132),K=n(278),W=n(148),q=n(303),Q=n(591),Y=n(279),J=n(302),X=function(e){function t(t,n){var a=e.call(this,t)||this;return a._initialLinkShown=!1,a._onLinkSettingsCancelClick=function(){a.setState({shouldCopyLinkToClipboard:!1},function(){a.props.onLinkPermissionsCancelClicked()})},a._onLinkSettingsApplyClicked=function(e){a.setState({shouldCopyLinkToClipboard:!0},function(){a.props.onLinkPermissionsApplyClicked(e)})},a._shareClickTime=n.shareClickTime,a._sharingClientMessenger=n.sharingClientMessenger,a.state={shouldCopyLinkToClipboard:!0},a}return(0,a.d)(t,e),t.prototype.render=function(){var e=this.props,t=e.sharingInformation,n=e.viewState,i=e.clientId,r=e.companyName,o=e.currentSettings,d=e.onShareHintClick,l=e.customLabeledAudienceConfig,u=e.displayUrl;switch(n){case Y.a.linkSuccess:var f={clientId:i,companyName:r,currentSettings:o,sharingInformation:t,onShareHintClick:d,linkRecipients:null,customLabeledAudienceConfig:l};return this._initialLinkShown||(this._sharingClientMessenger?this._sharingClientMessenger.sendShareReady():L.r(this._shareClickTime,this.props.clientId,c.a.copy,this.props.scenarioId,this.props.correlationId),this._initialLinkShown=!0),v.createElement(v.Suspense,{fallback:v.createElement(b.a,null)},v.createElement(J.l,(0,a.a)({},(0,V.a)(this.props),{shareType:s.a.copy,itemName:t.item.name,linkUrl:u,sharingHintProps:f,shouldCopyLinkToClipboard:this.state.shouldCopyLinkToClipboard,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,engagementExtraData:this.props.engagementExtraData,onRenderComplete:this.props.onShareNotificationRenderComplete,shouldWaitForSharingInfoBarInformation:this.props.shouldWaitForSharingInfoBarInformation,sharingInfoBarMessageTypeId:this.props.sharingInfoBarMessageTypeId})));case Y.a.modifyPermissions:return v.createElement(v.Suspense,{fallback:v.createElement(b.a,null)},v.createElement(J.h,(0,a.a)({},this.props,{doesCreate:!0,onCancel:this._onLinkSettingsCancelClick,onSelectedPermissionsChange:this._onLinkSettingsApplyClicked,showExistingAccessOption:!0,copyLinkShortcut:!0,onSelectedPeopleChange:function(){},renderBackButton:!0})));default:return v.createElement("div",{className:"od-Share-spinnerHolder"},v.createElement(b.a,{className:"od-Share-spinner",label:E.zb,type:g.b.large}))}},t.contextTypes={shareClickTime:y.number,sharingClientMessenger:y.object.isRequired},t}(v.Component),Z=n(169),$=n(205),ee=n(135),te=n(453),ne=n(14);(0,i.b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.ShareMain{display:flex;flex-direction:column;padding:24px}@media screen and (max-width:511px){.ShareMain{padding:16px}}.ShareMain-flex-row{width:100%;display:flex;flex-direction:row;flex-wrap:wrap;align-items:center;gap:12px}.ShareMain-flex-row.space-between{justify-content:space-between}.ShareMain-flex-grow{display:flex;flex-grow:1}.ShareMain-flex-grow.flex-start{justify-content:flex-start}.ShareMain-action-footer{display:flex;flex-direction:row}.ShareMain-action-footer.flex-end{justify-content:flex-end;flex-wrap:wrap;row-gap:1.25rem}@supports (font:-apple-system-body){.ShareMain-action-footer button{height:auto;padding:8px}}.ShareMain-sharedWithSection{width:50%}@media screen and (max-width:375px){.ShareMain-sharedWithSection{width:40%}}@media screen and (max-width:360px){.ShareMain-sharedWithSection{width:30%}}.ShareMain-notShared i{font-size:.9375rem;height:1.625rem;width:1.625rem;background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";border-radius:50%;text-align:center;color:#707070;line-height:1.625rem;cursor:pointer}.ShareMain-notShared-button:active,.ShareMain-notShared-button:hover{background-color:transparent!important}.ShareMain-notShared-button:focus{outline:unset!important}.ms-ContextualMenu-linkContent i{display:inline-flex}@supports (font:-apple-system-body){.ms-ContextualMenu-linkContent{font:-apple-system-body}}.ShareMain-button i{font-size:.875rem}.ms-Tooltip-subtext{font-size:.75rem}.ShareMain-header{padding-bottom:10px}.SimplifiedShareTargets.ie .ms-ContextualMenu-linkContent i{display:inline}.SimplifiedShareTargets.icon-width img{width:100%}.ShareMain-requiresAccessApproval{margin-bottom:12px;border-radius:4px}.ShareMain-helpMenu .ShareMain-contextualMenu-link,.ShareMain-helpMenu .ms-ContextualMenu-link{display:flex;outline:transparent;position:relative;font-size:.875rem;font-weight:400;background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";border:none;width:100%;height:36px;line-height:36px;display:block;cursor:pointer;padding:0 8px 0 4px;text-align:left}.ShareMain-helpMenu .ShareMain-contextualMenu-link span,.ShareMain-helpMenu .ms-ContextualMenu-link span{display:inherit}.ShareMain-helpMenu .ShareMain-contextualMenu-link:hover,.ShareMain-helpMenu .ms-ContextualMenu-link:hover{background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.ShareMain-helpMenu .ShareMain-contextualMenu-link .ShareMain-contextualMenu-linkContent,.ShareMain-helpMenu .ms-ContextualMenu-link .ShareMain-contextualMenu-linkContent{white-space:nowrap;height:inherit;display:flex;align-items:center;max-width:100%;padding:0 8px 0 4px}@supports (font:-apple-system-body){.ShareMain-helpMenu .ShareMain-contextualMenu-link .ShareMain-contextualMenu-linkContent,.ShareMain-helpMenu .ms-ContextualMenu-link .ShareMain-contextualMenu-linkContent{font:-apple-system-body}}.ShareMain-badge{margin-left:10px;align-self:center;color:"},{theme:"white",defaultValue:"#fff"},{rawString:";background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:';display:inline-flex;align-items:center;justify-content:center;position:relative;font-size:.625rem;height:8px;padding:3px 6px;border-radius:20px}.ShareMain-firstTimeUserMarker{background-color:#d13438;position:absolute;height:4px;width:4px;border-radius:20px;right:64px;top:32px;z-index:2}.ShareMain-copy-button-container{display:flex;flex-direction:"row";height:100%}'}]);var ae=n(19),ie=n(200),re=n(4),oe=n(321),se=n(333),ce=n(142);(0,i.b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.SendLink-flex-column{display:flex;flex-direction:column;width:100%}.SendLink-flex-row{display:flex;flex-direction:row;width:100%}.SendLink-container{display:flex;flex-direction:column}.SendLink-messageBox-container{position:relative;padding-top:12px}.SendLink-messageBox{display:flex;flex-direction:row;border:1px solid "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:"!important;border-bottom:unset!important;border-radius:4px!important}.SendLink-messageBox.error{border:1px solid "},{theme:"red",defaultValue:"#e81123"},{rawString:"!important;border-bottom:unset!important}.SendLink-messageBox-textfield{width:100%}.SendLink-messageBox-textfield .ms-TextField-field:-ms-input-placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:.875rem}.SendLink-messageBox-textfield .ms-TextField-field::placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:.875rem}@supports (font:-apple-system-body){.SendLink-messageBox-textfield .ms-TextField-field:-ms-input-placeholder{font:-apple-system-body}.SendLink-messageBox-textfield .ms-TextField-field::placeholder{font:-apple-system-body}}.SendLink-field{font-size:.875rem!important;padding:10px 8px 6px 8px!important}@supports (font:-apple-system-body){.SendLink-field{font:-apple-system-body}}.SendLink-fieldGroup{height:105px!important;overflow:hidden!important;border:none!important;border-radius:4px;background-color:transparent}.SendLink-fieldGroup:after{border:none!important}.SendLink-people-picker{max-height:126px;overflow-x:hidden;overflow-y:auto;display:flex;flex-direction:column-reverse;flex-grow:1}.SendLink-permissions-button-container{display:flex}.SendLink-permissions-button:hover{background-color:transparent}.SendLink-relative{position:relative;width:100%}.SendLink-border{border:1px solid "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:";border-radius:4px;box-sizing:border-box;position:relative;width:100%}.SendLink-border.error{border:1px solid "},{theme:"red",defaultValue:"#e81123"},{rawString:"}.SendLink-to{font-size:.875rem;font-weight:600;padding:12px 6px 12px 12px;white-space:nowrap;display:flex}[dir=rtl] .SendLink-to{padding:12px 12px 12px 6px}@supports (font:-apple-system-body){.SendLink-to{font:-apple-system-body}}.SendLink-to .SendLink-to-icon{font-size:.75rem}[dir=ltr] .SendLink-to .SendLink-to-icon{padding-right:4px}[dir=rtl] .SendLink-to .SendLink-to-icon{padding-left:4px}[dir=ltr] .SendLink-to .SendLink-to-icon{padding-left:1px}[dir=rtl] .SendLink-to .SendLink-to-icon{padding-right:1px}@supports (font:-apple-system-footnote){.SendLink-to .SendLink-to-icon{font:-apple-system-footnote}}.SendLink-label{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:.875rem;flex-grow:1}@supports (font:-apple-system-body){.SendLink-label{font:-apple-system-body}}.SendLink-label:focus-visible{outline:1px solid "},{theme:"black",defaultValue:"#000000"},{rawString:"}.SendLink-label.padding{padding-right:12px}.SendLink-animation{box-sizing:border-box;border-bottom-left-radius:200px;border-bottom-right-radius:200px;border-bottom:2px solid "},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";box-sizing:border-box;-webkit-clip-path:inset(calc(100% - 2px) 0px 0px);clip-path:inset(calc(100% - 2px) 0px 0px);animation-name:animate-underline;animation-duration:.25s;width:100%;position:absolute;height:4px;z-index:1;bottom:0}@keyframes animate-underline{from{transform:scaleX(0)}to{transform:scaleX(1);transition-property:transform;transition-duration:.2s;transition-delay:cubic-bezier(0.1, 0.9, 0.2, 1)}}.SendLink-underline{box-sizing:border-box;border-bottom:1px solid "},{theme:"neutralPrimaryAlt",defaultValue:"#3b3a39"},{rawString:";border-bottom-left-radius:200px;border-bottom-right-radius:200px;box-sizing:border-box;-webkit-clip-path:inset(calc(100% - 2px) 0px 0px);clip-path:inset(calc(100% - 2px) 0px 0px);width:100%;position:absolute;height:4px;bottom:0}.SendLink-underline.error{border-bottom:1px solid "},{theme:"red",defaultValue:"#e81123"},{rawString:"}.SendLink-underline.focused{border-bottom:2px solid "},{theme:"neutralPrimaryAlt",defaultValue:"#3b3a39"},{rawString:"}.SendLink-roleSelector-divider{display:flex;background-color:#d1d1d1;width:1px;margin-top:3px;margin-bottom:3px}.SendLink-primary{border-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.SendLink-max-height{max-height:126px}.SendLink-characterCount{margin-top:6px;font-size:.75rem;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.SendLink-characterCount.error{color:"},{theme:"red",defaultValue:"#e81123"},{rawString:"}.SendLink-label-and-count-container{display:flex;flex-direction:row;height:28px}.SendLink-label-and-count-container.v2{padding-bottom:6px}.SendLink-aiDisclaimer-and-label{display:block}.SendLink-aiDisclaimer{display:inline-flex;align-items:center;font-size:.75rem;padding-top:6px}.SendLink-aiDisclaimer.v2{height:19px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}[dir=ltr] .SendLink-aiDisclaimer.v2{margin-left:14px}[dir=rtl] .SendLink-aiDisclaimer.v2{margin-right:14px}[dir=ltr] .SendLink-aiDisclaimer.v2{padding-right:8px}[dir=rtl] .SendLink-aiDisclaimer.v2{padding-left:8px}.SendLink-aiDisclaimer.v2.longerLanguage{max-width:300px}.aiDisclaimer-successIcon{margin-top:3px}[dir=ltr] .aiDisclaimer-successIcon{padding-right:8px}[dir=rtl] .aiDisclaimer-successIcon{padding-left:8px}.SendLink-messageBox-summaryButtonArea{position:absolute;width:32px;bottom:14px}[dir=ltr] .SendLink-messageBox-summaryButtonArea{right:0}[dir=rtl] .SendLink-messageBox-summaryButtonArea{left:0}[dir=ltr] .SendLink-messageBox-summaryButtonArea{margin-right:5px}[dir=rtl] .SendLink-messageBox-summaryButtonArea{margin-left:5px}.SendLink-message-icon{font-size:.875rem;padding:13px 0 0 13px}@supports (font:-apple-system-body){.SendLink-message-icon{font:-apple-system-body}}[dir=rtl] .SendLink-message-icon{padding:13px 13px 0 0}.SendLink-characterContainer{height:19px}.SendLink-characterContainer.hidden{visibility:hidden}.SendLink-characterContainer.visible{visibility:visible;padding-bottom:3px;margin-inline-start:auto}.SendLink-permissionsLabelButton{height:100%;text-align:left;padding:6px 0}.SendLink-permissionsLabelButton:hover{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"!important}#permissionsLabelButton:hover #permissionsLabel{text-decoration:underline!important}.SendLink-permissionsLabelContainer{display:flex;flex-direction:row;align-items:center}.SendLink-permissionsLabel{font-size:.875rem}@supports (font:-apple-system-body){.SendLink-permissionsLabel{font:-apple-system-body}}.SendLink-statusIcons{display:flex;align-items:center;height:100%}.SendLink-permissionsLabelContainer{display:flex;flex-direction:row}"}]);var de,le=n(322),ue=n(332),fe=n(330),pe=n(472);!function(e){e.success="success",e.error="error",e.inProgress="inProgress",e.closed="closed"}(de||(de={}));var me=v.lazy(function(){return n.e(34).then(n.bind(n,579))}),_e=v.lazy(function(){return Promise.all([n.e("ondemand.resx"),n.e(33)]).then(n.bind(n,580))});function he(e,t){var n=e.clientId,i=e.copyMessageBarStatus,r=e.currentSettings,o=e.engagementExtraData,s=e.errorMessage,d=e.linkRecipients,l=e.messageText,u=e.summaryState,f=e.oversharingExternalsWarning,p=e.oversharingGroupsWarning,m=e.permissionsMap,b=e.permissionsLabel,g=e.shareTargetClicked,y=e.sharingInformation,S=e.sharingByCopyIsDisabled,D=e.sharingBySendIsDisabled,I=e.showExternalSharingConfirmationDialog,x=e.warningMessages,C=e.handlerForOnLinkSettingsClicked,O=e.onInputChange,A=e.onRoleChange,L=e.onSelectedPeopleChange,k=e.onSendLinkMessageChange,M=e.getStatusIcons,T=e.generateSummary,U=e.updateSummaryData,F=e.onSendLinkSummaryStateChange,N=t.sharingStore,B=t.platformDetection,j=(0,w.tb)(n,N),V=v.useState(!1),z=V[0],G=V[1],K=v.useState(!1),W=K[0],q=K[1],Q=v.useState("auto"),Y=Q[0],J=Q[1],X=v.useRef(null),Z=v.useState(""),$=Z[0],ee=Z[1],te=v.useState(""),ne=te[0],ae=te[1],re=v.useState(pe.c.CatchAll),oe=re[0],he=re[1],ke=v.useState(),Me=ke[0],Pe=ke[1],Te=v.useState(),Ue=Te[0],Fe=Te[1],He=v.useRef(null),Re=v.useState(!1),Ne=Re[0],Be=Re[1],je=v.useState(!1),Ve=je[0],ze=je[1];v.useEffect(function(){if(H.Db()&&!T){var e=N.getCopilotHelper().getCopilotSummaryDisabledReasonsMask();N.getEngagementHelper().summarizationDisabledReasonsMask(o,e)}N.getEngagementHelper().summarizationEnabled(o,T?"enabled":"disabled"),N.getEngagementHelper().summarizationCopilotEnabled(o,N.getCopilotHelper().getIsCopilotEnabled())},[]),v.useEffect(function(){u===pe.d.Succeeded?(U(ne),k(l?l+"\n"+ne:ne),H.w()&&(be=pt),(Ne||z)&&He.current&&!z&&He.current.focus()):be=ft},[u]),v.useEffect(function(){(!l||l.length<=1)&&(u===pe.d.Succeeded&&(N.getEngagementHelper().deletedSummary(o),H.Cb()&&(F(pe.d.Default),U(""))),H.Cb()||(F(pe.d.Default),U(""))),$&&l.length===$.length&&(u===pe.d.Succeeded&&(F(pe.d.Default),N.getEngagementHelper().deletedSummary(o)),ee(""))},[l]);var Ge=function(){if(H.q()){var e=N.getCopilotHelper().getAppData(),t=N.getCopilotHelper().getContextData(),n=N.getCopilotHelper().getCopilotFeedbackProps();n=(0,a.a)((0,a.a)({},n),{appData:e}),Fe(n),Pe({contextData:{cardMetaData:JSON.stringify({appData:e,contextData:t})}})}};v.useEffect(function(){s&&q(!0)},[s]);var Ke=(0,ie.a)(function(e){return xe(e,N,o)}),We=(0,ie.a)(function(e){return H.pb()?"":ye(k,e)}),qe=(0,ie.a)(function(e){ee(e.clipboardData.getData("text"))}),Qe=!s,Ye=S&&D,Je=v.useMemo(function(){return we(Ye,Qe,s)},[Ye,Qe,s]),Xe=v.useMemo(function(){return Ee(Ye,Qe,s)},[Ye,Qe,s]),Ze=v.useMemo(function(){return(0,w.s)(l)},[l]),$e=v.useMemo(function(){return I!==w.c.seeing&&!(j&&Oe(y)&&i===de.error)&&Ce(s,et,x)},[s,x,d,f,p,y,I]),et=v.useMemo(function(){return Oe(y)},[y]),tt=!z&&Ze>be;return v.createElement("div",{className:"SendLink-container"},function(){if(ne){if(z)return(0,P.a)(ne,"assertive","status");if(!Ve)return(0,P.a)(E.bk,"assertive","status")}}(),v.createElement("div",{ref:X,className:"SendLink-flex-column SendLink-relative SendLink-max-height ".concat(W&&"focused"),style:{height:B.isIE&&Y,transition:"height 200ms cubic-bezier(.33, 0, .1, 1)"}},v.createElement("div",{className:"SendLink-flex-row SendLink-border ".concat(Je," SendLink-max-height"),style:{height:B.isIE&&Y,transition:"height 200ms cubic-bezier(.33, 0, .1, 1)"}},v.createElement("div",{className:"SendLink-to"},v.createElement(_.a,{content:"".concat(E.r,".")},v.createElement(ce.a,{"aria-label":E.r,iconName:"Contact",className:"SendLink-to-icon"}))),v.createElement("div",{className:"SendLink-people-picker ".concat(B.isIE&&" IE"," SendLink-max-height"),style:{height:B.isIE&&Y,transition:"height 200ms cubic-bezier(.33, 0, .1, 1)"}},v.createElement(le.a,{allowSPGroups:j,clientId:n,defaultSelectedItems:d,disableGraph:N.shouldDisableGraphForPeopleSearch(),inputTextPlaceholder:0===d.length?E.r:E.t,oversharingExternalsWarning:f,oversharingGroupsWarning:p,peoplePickerRef:X,permissionsMap:m,pickerSettings:y.peoplePickerSettings,sharingInformation:y,sharingLinkKind:r.sharingLinkKind,onChange:L,onInputChange:O||null,onResolvedSuggestions:Ke,setPeoplePickerFocused:q,error:s,mode:c.a.share,setHeight:J,height:Y,shareTargetClicked:g,focusPeoplePicker:W})),ve(r,n,N)&&v.createElement(v.Fragment,null,v.createElement("div",{className:"SendLink-roleSelector-divider"}),v.createElement("div",{className:"SendLink-permissions-button-container",id:"SendLink-roleSelectorCompact"},v.createElement(ue.a,{menuPermissionOptions:j?Se(r,n,y,N):De(n,N,y,r,N.isPreventDownloadAllowed&&N.isPreventDownloadAllowed()),sharingRole:r.sharingRole,mode:c.a.share,clientId:n,onRoleChange:A,roleSelectorAs:ue.a,disabled:R.c()&&y.requiresAccessApproval,ariaLabel:H.Ub()?void 0:E.v})))),v.createElement(Ae,{focused:W,color:Je,error:!!s})),v.createElement("span",{role:"alert","aria-live":"assertive"},j&&y.requiresAccessApproval&&!R.c()&&v.createElement(fe.a,{className:"od-Simplified-Share-PeoplePickerErrorIcon",messages:[{error:v.createElement("span",null,E.si)}],iconName:"InfoSolid",textColorType:"info"}),$e&&v.createElement(fe.a,{className:"od-Simplified-Share-PeoplePickerErrorIcon",messages:$e,iconName:Xe,textColorType:Je})),v.createElement("div",{className:"SendLink-messageBox-container"},v.createElement("div",{className:"SendLink-messageBox ".concat(tt&&"error")},v.createElement("div",null,v.createElement(_.a,{content:"".concat(E.Te,".")},v.createElement(ce.a,{"aria-label":E.Te,iconName:"Handwriting",className:"SendLink-message-icon"}))),H.pb()?v.createElement(se.a,{className:"SendLink-messageBox-textfield",multiline:!0,resizable:!1,placeholder:E.Te,value:l,onGetErrorMessage:We,onChange:function(e,t){k(t),u===pe.d.Succeeded&&""!==t&&N.getEngagementHelper().modifiedSummary(o)},styles:ge,onFocus:function(){G(!0),ne&&!Ve&&ze(!0)},onBlur:function(){z&&ne&&!Ve&&ze(!0),G(!1)},onPaste:qe,componentRef:He}):v.createElement(se.a,{className:"SendLink-messageBox-textfield",multiline:!0,resizable:!1,placeholder:E.Te,defaultValue:l,onGetErrorMessage:We,styles:ge,onFocus:function(){G(!0)},onBlur:function(){return G(!1)}}),T&&v.createElement("div",{className:"SendLink-messageBox-summaryButtonArea"},v.createElement(v.Suspense,{fallback:null},v.createElement(me,{initiateGenerateSummary:function(){ne&&u===pe.d.Default&&N.getEngagementHelper().summarizationClick(o,"cacheAdded"),T&&(u===pe.d.Default?N.getEngagementHelper().summarizationClick(o,"initialClick"):u===pe.d.Failed&&N.getEngagementHelper().summarizationClick(o,"retry"),F(pe.d.InProgress),T().then(function(e){var t,n,i,r,s,c;try{var d=JSON.parse(e),l=d.summary,u=d.fromCache,f=d.summaryType,p=d.isParroted;H.Jb()&&p?(F(pe.d.Failed),he(pe.c.DocumentLengthTooShort),Ge(),N.getEngagementHelper().summarizationStatus((0,a.a)((0,a.a)({},o),{summarizationError:pe.c.DocumentLengthTooShort,augloopContextId:null===(t=N.getCopilotHelper().getContextData())||void 0===t?void 0:t.contextId,augloopSessionId:null===(n=N.getCopilotHelper().getAppData())||void 0===n?void 0:n.sessionId,fromCache:u}),"failure")):(ae(l||""),F(pe.d.Succeeded),Ge(),N.getEngagementHelper().summarizationStatus((0,a.a)((0,a.a)({},o),{augloopContextId:null===(i=N.getCopilotHelper().getContextData())||void 0===i?void 0:i.contextId,augloopSessionId:null===(r=N.getCopilotHelper().getAppData())||void 0===r?void 0:r.sessionId,summaryLength:l.length,fromCache:u,summaryType:f}),"success"))}catch(t){F(pe.d.Failed),Ge(),N.getEngagementHelper().summarizationStatus((0,a.a)((0,a.a)({},o),{augloopContextId:null===(s=N.getCopilotHelper().getContextData())||void 0===s?void 0:s.contextId,augloopSessionId:null===(c=N.getCopilotHelper().getAppData())||void 0===c?void 0:c.sessionId,summarizationError:"failed to parse aiResult ".concat(e)}),"failure")}}).catch(function(e){var t,n,i,r;F(pe.d.Failed);var s=null==e?void 0:e.message,c=void 0,d=void 0,l=void 0;try{var u,f=JSON.parse(s),p=void 0,m=H.Eb()||H.Ab();H.xb()&&m?(u=null===(n=JSON.parse(null===(t=null==f?void 0:f.error)||void 0===t?void 0:t.json))||void 0===n?void 0:n.summaryResultStatus,p=f.queryId):(u=f.status,p=f.contextId);var _=f.sessionId,h=f.fromCache;he(null!=u?u:pe.c.CatchAll),s=u,c=h,d=_,l=p}catch(e){he(pe.c.CatchAll)}Ge(),N.getEngagementHelper().summarizationStatus((0,a.a)((0,a.a)({},o),{summarizationError:s,augloopContextId:null!=l?l:null===(i=N.getCopilotHelper().getContextData())||void 0===i?void 0:i.contextId,augloopSessionId:null!=d?d:null===(r=N.getCopilotHelper().getAppData())||void 0===r?void 0:r.sessionId,fromCache:c}),"failure")}))},summaryState:u,errorStatus:oe,showSimplifiedDialogV2:j,retryAvailable:u===pe.d.Failed&&-1!==["Timeout","ResourceUnavailable","BlockedByQualityCheck","BlockedByPostfilter"].indexOf(oe),onFocusChange:function(e){Be(e)}})))),v.createElement(Ae,{focused:z,color:tt?"error":"primary",error:tt})),v.createElement("div",{className:"SendLink-label-and-count-container ".concat(j&&"v2")},!j&&(H.o()&&u===pe.d.Succeeded?v.createElement("div",{className:"SendLink-aiDisclaimer-and-label"},v.createElement("div",{className:"SendLink-aiDisclaimer"},v.createElement(h.a,{iconName:"Info",className:"aiDisclaimer-successIcon"}),E.gk),v.createElement("div",{className:"SendLink-label ".concat(Ze>be/2?"padding":"")},Ie(b,C,M))):v.createElement("div",{className:"SendLink-label ".concat(Ze>be/2?"padding":"")},Ie(b,C,M))),j&&H.p()&&(u===pe.d.Succeeded||u===pe.d.Failed)&&v.createElement(v.Fragment,null,v.createElement("div",{className:"SendLink-aiDisclaimer ".concat(j&&"v2 ".concat(H.sc()?"longerLanguage":"")),tabIndex:0,"aria-label":u===pe.d.Succeeded?E.gk:E.fk,role:"note"},v.createElement(h.a,{iconName:"Info",className:"aiDisclaimer-successIcon"}),u===pe.d.Succeeded?E.gk:E.fk),H.q()&&v.createElement(v.Suspense,{fallback:null},v.createElement(_e,{copilotFeedbackProps:Ue,feedbackData:Me,onClickFeedback:function(e){N.getEngagementHelper().summarizationFeedback(o,e)}}))),(j||Ze>be/2)&&v.createElement(Le,{messageLength:Ze})))}he.contextTypes={sharingStore:y.object.isRequired,platformDetection:y.object.isRequired};var be=ft,ge={fieldGroup:["SendLink-fieldGroup"],field:["SendLink-field"]},ve=function(e,t,n){return!!(0,w.tb)(t,n)||e.audience!==d.a.existing},ye=function(e,t){return e(t),""},Se=function(e,t,n,a){if(R.c()&&n.requiresAccessApproval){var i=a.getReShareLink(e.audience),r=e.sharingRole;return i&&(r=(0,w.K)(i,t,n)),(0,A.b)({role:r})}var o=a.getScenarioId&&a.getScenarioId(),s=a.isPreventDownloadAllowed&&a.isPreventDownloadAllowed();return(0,A.a)({audience:e.audience,sharingStore:a,clientId:t,sharingInformation:n,scenarioId:o,isPreventDownloadAllowed:s,shareMode:c.a.share})},De=function(e,t,n,a,i){return(0,A.c)({clientId:e,sharingStore:t,sharingInformation:n,audience:a.audience,mode:c.a.share,isPreventDownloadAllowed:i})},Ie=function(e,t,n){return v.createElement("div",{className:"SendLink-permissionsLabelContainer"},v.createElement(O.a,{id:"permissionsLabelButton",className:"SendLink-permissionsLabelButton",onClick:t},v.createElement("div",{className:"SendLink-permissionsLabelContainer"},v.createElement("div",{id:"permissionsLabel",className:"SendLink-permissionsLabel"},e))),v.createElement("div",{className:"SendLink-statusIcons"},n()))},xe=function(e,t,n){return t.getEngagementHelper().peoplePickerLinkedinSuggestions(n,e),e},Ce=function(e,t,n){if(e)return[{error:e,errorDetails:t}];var a=[];return(null==n?void 0:n.length)>0&&n.map(function(e){if(e){var t={error:e};a.push(t)}}),a},Oe=function(e){if(e.errorCategory===u.a.shareLink||e.errorCategory===u.a.shareObject)return e.error&&e.error.message?v.createElement("span",null,e.error.message.value):v.createElement("span",null,e.errorMessage)},we=function(e,t,n){return e?"error":n?"warning":t?"info":"warning"},Ee=function(e,t,n){return e?"AlertSolid":n?"WarningSolid":t?"InfoSolid":"WarningSolid"},Ae=function(e){var t=e.focused,n=e.color,a=e.error;return v.createElement(v.Fragment,null,v.createElement("div",{className:t?"SendLink-animation":void 0}),v.createElement("div",{className:"SendLink-underline ".concat(t&&"focused"," ").concat(a&&n)}))},Le=function(e){var t=e.messageLength,n=t>be,a=t>be/2,i="SendLink-characterCount ".concat(n?"error":"");return v.createElement("div",{className:"SendLink-characterContainer  ".concat(a?"visible":"hidden"),tabIndex:0},v.createElement("span",{className:i},t,"/",be),(n||a)&&(0,P.a)((0,ae.d)(E.Rb,t,be),"assertive","status"))},ke=n(201);(0,i.b)([{rawString:'.Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.Footer-button{border-radius:4px;font-family:"Segoe UI","Segoe UI Web (West European)","Segoe UI",-apple-system,BlinkMacSystemFont,Roboto,"Helvetica Neue",sans-serif!important}@supports (font:-apple-system-body){.Footer-button{font:-apple-system-body}}.Footer-button.Send-button{min-width:5.9375rem!important;min-height:2rem;height:100%}.Footer-button.Send-button.v2{margin-left:12px}.Footer-button.Send-button .ms-Button-flexContainer{height:100%}.Footer-button.Send-button .flexContainer{height:2rem}@supports (font:-apple-system-body){.Footer-button.Send-button .flexContainer{height:1rem}}.Footer-button.Footer-button-settings{border-radius:0 4px 4px 0;border-right:1px solid '},{theme:"themeSecondary",defaultValue:"#2b88d8"},{rawString:";border-top:1px solid "},{theme:"themeSecondary",defaultValue:"#2b88d8"},{rawString:";border-bottom:1px solid "},{theme:"themeSecondary",defaultValue:"#2b88d8"},{rawString:";background:"},{theme:"themeLighterAlt",defaultValue:"#eff6fc"},{rawString:";height:100%}.Footer-button.Footer-button-settings:hover{background:"},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:"}.Footer-button.Footer-button-settings i{font-size:.9375rem!important}@supports (font:-apple-system-body){.Footer-button.Footer-button-settings i{font:-apple-system-body}}.Footer-button.Footer-button-settings .flexContainer{height:2rem}@supports (font:-apple-system-body){.Footer-button.Footer-button-settings .flexContainer{height:1rem}}.Footer-button.Footer-button-copy{font-size:.875rem;font-weight:600;white-space:nowrap;min-width:5.9375rem!important;min-height:2rem;height:100%}.Footer-button.Footer-button-copy .ms-Button-flexContainer{height:100%}.Footer-button.Footer-button-copy.v1{margin-right:12px}.Footer-button.Footer-button-copy.v2.v2.v2.v2.v2{border-radius:4px 0 0 4px}.Footer-button.Footer-button-copy.v2.v2.v2.v2.v2.disabled{border-right:1px solid "},{theme:"themeSecondary",defaultValue:"#2b88d8"},{rawString:"}[dir=rtl] .Footer-button.Footer-button-copy{margin-left:12px;margin-right:0}.Footer-button.Footer-button-copy.enabled{color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:";background-color:"},{theme:"themeLighterAlt",defaultValue:"#eff6fc"},{rawString:";border-color:"},{theme:"themeSecondary",defaultValue:"#2b88d8"},{rawString:"}.Footer-button.Footer-button-copy.enabled:hover{background-color:"},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:"}.Footer-button.Footer-button-copy .flexContainer{height:2rem}@supports (font:-apple-system-body){.Footer-button.Footer-button-copy .flexContainer{height:1rem}}@supports (font:-apple-system-body){.Footer-button.Footer-button-copy{font:-apple-system-body}}.Footer-button .Footer-button-icon{font-size:1rem;padding:2px 0!important;visibility:visible;min-height:1rem;height:unset}[dir=rtl] .Footer-button .Footer-button-icon{transform:scale(-1,1)}.Footer-button .Footer-button-icon.Footer-button-icon-hidden{visibility:hidden}.Footer-button .Footer-button-label{padding-bottom:2px!important}.Footer-button .Footer-button-label.Footer-button-label-hidden{visibility:hidden}.Footer-button .Footer-send-button-spinner{top:15%;left:50%;right:50%;visibility:hidden}.Footer-button .Footer-copy-button-spinner{top:15%;left:45%;visibility:hidden}.Footer-button .Footer-copy-button-spinner.Footer-button-spinner-visible{visibility:visible}.Footer-button .Footer-button-text{font-size:.875rem;font-weight:600;visibility:visible;padding-bottom:2px!important}@supports (font:-apple-system-body){.Footer-button .Footer-button-text{font:-apple-system-body}}.Footer-button .visible{visibility:visible}.Footer-button .invisible{visibility:hidden}.Footer-tooltip{display:flex!important;max-width:250px;font-size:.75rem}@supports (font:-apple-system-footnote){.Footer-tooltip{font:-apple-system-footnote}}.Footer-tooltip-copy{height:100%;display:flex!important;max-width:250px;font-size:.75rem}.Footer-tooltip-copy.largeText{max-width:unset}@supports (font:-apple-system-footnote){.Footer-tooltip-copy{font:-apple-system-footnote}}.Footer-tooltip-copy{height:100%;display:flex!important;max-width:250px;font-size:.75rem}.Footer-tooltip-copy.largeText{max-width:unset}@supports (font:-apple-system-footnote){.Footer-tooltip-copy{font:-apple-system-footnote}}.Footer-copyLinkTooltip{display:flex}.Footer-copyLinkTooltip span{display:flex;align-items:center;padding-left:8px}.Footer-copyLinkTooltipIcon{align-items:center;border-radius:50%;border-style:solid;border-width:.0625rem;box-sizing:border-box;display:flex!important;height:1.5rem;justify-content:center;width:1.5rem;font-size:.875rem}.Footer-copyLinkTooltipIcon.icon-Globe{color:#0b6a0b;background:#f1f6f1;border:1px solid #0b6a0b}.Footer-copyLinkTooltipIcon.icon-Work{color:#004e8c;background:#f0f5f8;border:1px solid #004e8c}.Footer-copyLinkTooltipIcon.icon-AddFriend{color:#393939;background:#f2f2f2;border:1px solid #393939}.Footer-copyLinkTooltipIcon.icon-ReminderPerson{color:#8e562e;background:#f4efeb;border:1px solid #8e562e}"}]);var Me=n(285),Pe=n(454);function Te(e,t){var n=e.buttonRef,a=e.copyLinkToastStatus,i=e.copyMessageBarStatus,r=e.currentSettings,o=e.isSharingByCopyDisabled,c=e.permissionsLabel,d=e.focusCopyBtn,l=e.handlerForShareTargetClicked,u=e.onShareTargetClicked,f=e.setCopyMessageBarStatus,p=e.setCopyToastStatus,m=e.setIsDisabled,y=e.setShareTargetClicked,S=t.clientId,D=t.sharingStore,I=v.useState(null),x=I[0],C=I[1],A=(0,w.tb)(S,D),L=(0,ie.a)(function(){y(w.f.copy),l(w.f.copy)||(m(!0),f(de.inProgress),u(s.a.copy,!0),A||C(setTimeout(function(){p(Pe.a.closed),d()},3e3)))}),k=(0,ie.a)(function(){p(Pe.a.closed),x&&(clearInterval(x),C(null))}),M={iconName:"Link",className:"Footer-button-icon"},P="Footer-button-label",T="Footer-copy-button-spinner";(A&&i===de.inProgress||!A&&a===Pe.a.inProgress)&&(M.className+=" Footer-button-icon-hidden",P+=" Footer-button-label-hidden",T+=" Footer-button-spinner-visible");var U={hidden:a===Pe.a.success,styles:{root:{borderRadius:"4px"},beakCurtain:{borderRadius:"4px"}}},F={onRenderContent:function(){var e=He(r.sharingScope);return v.createElement("div",{className:"Footer-copyLinkTooltip",role:"alert","aria-label":c},v.createElement(h.a,{iconName:e,className:"Footer-copyLinkTooltipIcon icon-".concat(e)}),v.createElement("span",null,c))}};return v.createElement("div",null,v.createElement(_.a,{id:"Copy-button-tooltip-description",calloutProps:U,content:!A&&E.dc,styles:Ue,delay:Me.a.long,directionalHint:ne.a.topCenter,tooltipProps:A&&F,"aria-label":c},v.createElement(O.c,{componentRef:n,id:Re,className:"Footer-button Footer-button-copy ".concat(A?"v2 ":"v1 ").concat(o?"disabled ":"enabled "),iconProps:M,onClick:L,disabled:o,styles:Fe,ariaLabel:"".concat(E.lc)},v.createElement("span",{className:P},E.lc),v.createElement(b.a,{className:T,size:g.a.medium}))),v.createElement(v.Suspense,{fallback:null},v.createElement(J.q,{target:"#".concat(Re),onDismiss:k,status:a})))}Te.contextTypes={clientId:y.object.isRequired,sharingStore:y.object.isRequired};var Ue={root:["Footer-tooltip-copy ".concat(!(0,H.V)()&&"largeText")]},Fe={root:{height:"2rem",borderRadius:"0.25rem",padding:"0 1rem"},icon:{fontSize:"1rem",height:"1rem",lineHeight:"1rem"},flexContainer:["".concat((0,H.V)()&&"flexContainer")],label:{fontSize:"0.875rem",paddingBottom:"2px"}},He=function(e){switch(e){case f.a.organization:return"Work";case f.a.anyone:return"Globe";case f.a.existing:return"ReminderPerson";case f.a.specificPeople:return"AddFriend";default:return"Settings"}},Re="copy-button";function Ne(e,t){var n=e.engagementExtraData,a=(e.errorMessage,e.isDisabled),i=e.messageText,r=e.showSendButtonSpinner,o=e.handlerForShareTargetClicked,s=e.onSendLinkClicked,c=e.setIsDisabled,d=e.setShareTargetClicked,l=t.clientId,u=t.sharingStore,f=(0,w.tb)(l,u),p=(0,ie.a)(function(){d(w.f.send),o(w.f.send)||(c(!0),s(i)),u.getEngagementHelper().log("ShareV3.SendLinkSendButtonClicked",n)}),m="Footer-button-icon",h="Footer-button-text",y="Footer-send-button-spinner";r&&(m+=" invisible",h+=" invisible",y+=" visible");var S={iconName:"Send",className:m},D="".concat(f?E.Rj:E.Uj),I=E.Ai;return v.createElement(_.a,{id:"Send-button-tooltip-description",content:D,styles:je,delay:Me.a.long,directionalHint:ne.a.topRightEdge},v.createElement(O.c,{primary:!0,className:"Footer-button Send-button ".concat(f?"v2":"v1"),iconProps:S,disabled:a,onClick:p,ariaLabel:I,"aria-describedby":"Send-button-tooltip-description",id:"Send-button",styles:Be},v.createElement("div",{className:"Footer-button-text ".concat(h)},I),v.createElement(b.a,{className:"Footer-send-button-spinner ".concat(y),size:g.a.medium})))}Ne.contextTypes={clientId:y.object.isRequired,sharingStore:y.object.isRequired};var Be={root:{height:"2rem",borderRadius:"0.25rem",padding:"0 1rem"},icon:{fontSize:"1rem",height:"1rem",lineHeight:"1rem"},flexContainer:["".concat((0,H.V)()&&"flexContainer")],label:{fontSize:"0.875rem",paddingBottom:"2px"}},je={root:["Footer-tooltip"]},Ve=n(211),ze=n(335),Ge=n(145),Ke=n(97),We=n(133),qe=n(320),Qe=R.f(),Ye=window.require.toUrl("odsp-media/images/brand-icons/product-fluent/svg/outlook_48x1.svg"),Je=window.require.toUrl("odsp-media/images/brand-icons/product-fluent/svg/teams_48x1.svg");(0,M.L)({icons:{outlookSVG:v.createElement("img",{src:Ye}),teamsSVG:v.createElement("img",{src:Je})}});var Xe=n(471);(0,i.b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.AttachACopy-center{width:100%;text-align:center}.AttachACopy-button{font-size:.875rem;font-weight:600;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.AttachACopy-button :active{color:"},{theme:"themeDarker",defaultValue:"#004578"},{rawString:"}.AttachACopy-container{padding-top:6px}"}]);var Ze=n(336);function $e(e){var t=e.engagementExtraData,n=e.sharingStore;return v.createElement("div",{className:"AttachACopy-container"},v.createElement(Ze.a,null),v.createElement("div",{className:"AttachACopy-center"},v.createElement(O.a,{className:"AttachACopy-button",iconProps:et,onClick:function(){tt(t,n)}},E.ob)))}var et={iconName:"ShareiOS"},tt=function(e,t){t&&t.getEngagementHelper().sendACopyClicked(e);try{window.external.SendCopy()}catch(e){}};(0,i.b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.CopyMessageBar-container{height:0;transition:height .2s cubic-bezier(.33, 0, .1, 1);overflow:hidden}.CopyMessageBar-icon{padding-top:1px;margin:8px 0 8px 12px}.CopyMessageBar-bar{display:flex;flex-direction:row;border-radius:6px!important;margin-top:12px!important;min-height:auto!important;font-size:.75rem!important;color:#000}@supports (font:-apple-system-body){.CopyMessageBar-bar{font:-apple-system-body}}.CopyMessageBar-message{margin:8px 12px 8px 8px}.CopyMessageBar-message .CopyMessageBar-message-statusIcons{font-size:.75rem;padding-left:8px}.CopyMessageBar-moreDetails{display:flex;flex-direction:row;border:none!important;padding:0!important;font-weight:400!important;font-size:.75rem!important;background-color:transparent!important;color:#000!important}.CopyMessageBar-moreDetails:hover{background-color:transparent!important}.CopyMessageBar-moreDetailsTitle:hover{text-decoration:underline}.CopyMessageBar-moreDetailsText{word-break:break-word}.CopyMessageBar-toggleIcon{padding-left:5px}"}]);var nt=n(134);function at(e,t){var n,a=e.copyMessageBarStatus,i=e.messageBarError,r=e.permissionsLabel,o=e.shareMainContainerRef,s=e.sharingInformation,c=e.sharingStore,d=e.setCopyMessageBarStatus,l=e.setShareTargetClicked,u=t.resize,f=v.useState(null),p=f[0],m=f[1],_=v.useState(0),h=_[0],b=_[1],g=v.useState(!1),y=g[0],S=g[1],D=v.useRef(null),I=function(){d(de.closed),l(w.f.none),(null==o?void 0:o.current)&&o.current.removeEventListener("click",I,!1)};return v.useEffect(function(){switch(a){case de.success:rt({copyMessageBarStatus:a,messageBarRef:D,permissionsLabel:r,sharingStore:c,setMessageBar:m}),(null==o?void 0:o.current)&&o.current.addEventListener("click",I,!1);break;case de.error:ot({copyMessageBarStatus:a,messageBarError:i,messageBarRef:D,sharingInformation:s,showDetails:y,setShowDetails:S,setMessageBar:m});break;case de.closed:st({setMessageBar:m,setMessageBarHeight:b})}},[a,y]),v.useEffect(function(){setTimeout(function(){u()},200)},[h]),v.useEffect(function(){var e;(null===(e=null==D?void 0:D.current)||void 0===e?void 0:e.clientHeight)&&b(D.current.clientHeight+12)},[p,null===(n=null==D?void 0:D.current)||void 0===n?void 0:n.clientHeight]),p?v.createElement("div",{className:"CopyMessageBar-container",style:{height:h},"aria-live":"assertive",role:"alert"},p):v.createElement(v.Fragment,null)}at.contextTypes={resize:y.func.isRequired};var it=(0,M.D)(),rt=function(e){var t=e.copyMessageBarStatus,n=e.messageBarRef,a=e.permissionsLabel,i=e.sharingStore,r=e.setMessageBar,o={iconName:"CompletedSolid",styles:{root:{fontSize:"14px",height:"14px",color:it.semanticColors.successIcon}}},s=dt(i),c=v.createElement("div",null,v.createElement("b",null,E.bf)," ",a," ",s);r(v.createElement(ct,{iconProps:o,message:c,messageBarRef:n,messageBarStatus:t}))},ot=function(e){var t,n,a,i=e.copyMessageBarStatus,r=e.messageBarError,o=e.messageBarRef,s=e.sharingInformation,c=e.showDetails,d=e.setShowDetails,l=e.setMessageBar,f={iconName:"CompletedSolid",styles:{root:{fontSize:"14px",height:"14px",color:it.semanticColors.errorIcon}}};if(s.error&&s.error.message&&(n=v.createElement("span",null,s.error.message.value)),s.errorCategory===u.a.shareLink){var p=function(){d(!c)},m=v.createElement("div",null,v.createElement(O.c,{className:"CopyMessageBar-moreDetails",onClick:p},v.createElement("div",{className:"CopyMessageBar-moreDetailsText"},E.ze),v.createElement(h.a,{className:"CopyMessageBar-toggleIcon",iconName:"ChevronDown"}))),_=v.createElement("div",null,v.createElement(O.c,{className:"CopyMessageBar-moreDetails",onClick:p},v.createElement("div",{className:"CopyMessageBar-moreDetailsTitle"},E.Wd),v.createElement(h.a,{className:"CopyMessageBar-toggleIcon",iconName:"ChevronUp"})),v.createElement("div",{className:"CopyMessageBar-moreDetailsText"},n));t=c?_:m}a=s.errorCategory!==u.a.shareLink&&r?r:s.errorMessage?v.createElement("div",null,s.errorMessage):v.createElement("div",null,v.createElement("div",null,v.createElement("b",null,"".concat(E.Ek," ").concat(E.Ok))),n&&t),l(v.createElement(ct,{iconProps:f,message:a,messageBarRef:o,messageBarStatus:i}))},st=function(e){var t=e.setMessageBar,n=e.setMessageBarHeight;t(null),n(0)},ct=function(e){var t,n,i=e.iconProps,r=e.message,o=e.messageBarRef;switch(e.messageBarStatus){case de.success:t=it.semanticColors.successBackground,n="success";break;case de.error:t=it.semanticColors.errorBackground,n="error"}return v.createElement("div",{ref:o,className:"CopyMessageBar-bar ".concat(n),style:{backgroundColor:t}},v.createElement(h.a,(0,a.a)({className:"CopyMessageBar-icon"},i)),v.createElement("div",{className:"CopyMessageBar-message","aria-live":"assertive"},r))},dt=function(e){var t=null==e?void 0:e.getSharingLinkCreated();if(!t)return null;var n=t.expiration,a=t.hasPassword,i=[];return n&&n.getTime()!==new Date(0).getTime()&&i.push({icon:"Calendar",tooltip:"".concat((0,ae.d)(E.md,(0,nt.d)(n)))}),a&&i.push({icon:"Lock",tooltip:E.Ki}),i.map(function(e){return v.createElement(_.a,{key:e.icon,id:e.icon,tooltipProps:{onRenderContent:function(){return v.createElement("div",{className:"od-ShareHintDetail-iconTooltipContent"},e.tooltip)}}},v.createElement(h.a,{iconName:e.icon,"aria-label":e.tooltip,styles:{root:["CopyMessageBar-message-statusIcons"]}}))})},lt=n(81),ut=n(469),ft=500,pt=H._b()?1500:1e3,mt=v.lazy(function(){return n.e(20).then(n.bind(n,578))});function _t(e,t){var n,i=this,r=e.clientId,o=e.companyName,u=e.copyButtonRef,f=e.copyLinkToastStatus,p=e.correlationId,m=e.createPeopleSharingLinks,_=e.currentSettings,h=e.engagementExtraData,b=e.groupsMemberCount,g=e.hostOptions,y=e.isFREAbandoned,D=e.index,x=e.item,C=e.linkRecipients,O=e.messageText,A=e.summaryState,k=e.permissionsMap,M=e.permissionsLabel,P=e.sharingInformation,T=e.outlookAvailability,U=e.fullscreenIframeMode,F=e.copyMessageBarStatus,N=e.sharingInfoBarMessageTypeId,B=e.showSendButtonSpinner,j=e.scenarioId,V=e.renderBackButton,z=e.focusCopyButton,G=e.getGraphToken,K=e.onAudienceChange,W=e.onRoleChange,q=e.onShareTargetClicked,Q=e.onSelectedPeopleChange,Y=e.onSendLinkClicked,J=e.onSendLinkMessageChange,X=e.onSendLinkSummaryStateChange,Z=e.onViewPolicyTipClicked,$=e.showLinkSettings,ee=e.showPermissionsList,te=e.setCopyToastStatus,ae=e.setCopyMessageBarStatus,re=e.setIndex,se=e.generateSummary,ce=e.getStatusIcons,le=e.renderSharingInfoBar,ue=e.returnToPreviousView,fe=t.campaignKey,pe=t.platformDetection,me=t.shareClickTime,_e=t.sharingClientMessenger,be=t.sharingStore,ge=t.loadTeachingBubbleCampaigns,ve=t.markTeachingBubbleAsDismissed,ye=t.onDismiss,Se=t.onTeachingBubbleSeen,De=t.shouldTeachingBubbleBeShown,Ie=v.useState([]),xe=Ie[0],Ce=Ie[1],Oe=v.useState(null),we=Oe[0],Ee=Oe[1],Ae=v.useState([]),Le=Ae[0],Me=Ae[1],Pe=v.useState(null),Ue=Pe[0],Fe=Pe[1],He=v.useState(!1),Re=He[0],Be=He[1],je=v.useState(w.c.unseen),Ve=je[0],ze=je[1],Ge=v.useState(!1),Ye=Ge[0],Je=Ge[1],Ze=v.useState(!1),$e=Ze[0],et=Ze[1],tt=v.useState(!1),nt=tt[0],at=tt[1],it=v.useState(""),rt=it[0],ot=it[1],st=v.useState(""),ct=st[0],dt=st[1],ft=v.useState(0),pt=ft[0],mt=ft[1],_t=v.useState(w.f.none),Dt=_t[0],Rt=_t[1],Nt=v.useState({showMarker:!1,teachingBubbleCampaigns:void 0}),Bt=Nt[0],jt=Nt[1],Vt=v.useState(y),zt=Vt[0],Gt=Vt[1],Kt=v.useRef(null);v.useEffect(function(){var e=setTimeout(function(){return(0,a.b)(i,void 0,void 0,function(){return(0,a.e)(this,function(e){return Promise.all([ge(),De(fe)]).then(function(e){var t=e[0],n=e[1];jt({teachingBubbleCampaigns:t,showMarker:n}),at(n||zt&&D>1&&D<ut.a.length-1)}),[2]})})},50);return function(){return clearTimeout(e)}},[jt]),v.useEffect(function(){_e?_e.sendShareReady():L.r(me,r,c.a.share,j,p)},[]),v.useEffect(function(){var e=Pt(P,Dt,mn);(0,w.V)(P)||e?(e&&Ee(e),et(!0),Je(!0)):$t()},[P]),v.useEffect(function(){if(!mn&&_.audience===d.a.existing&&C)for(var e=0,t=C;e<t.length;e++){var n=t[e];void 0===k[n.email]&&void 0===k[n.userId]&&Je(!0)}},[_,C,k]),v.useEffect(function(){var e;Re||(null===(e=null==we?void 0:we.props)||void 0===e?void 0:e.children)!==E.Tk||(Ee(null),et(!1),Je(!1))},[Re]),v.useEffect(function(){we||0!==C.length||Rt(w.f.none)},[we,C]),v.useEffect(function(){Dt===w.f.send&&(ae(de.closed),Fe(null))},[Dt]),v.useEffect(function(){Pt(P,Dt,mn)||$t()},[_,C,k,O,Ve]),v.useEffect(function(){var e=tn();Me(e)},[F]),v.useEffect(function(){rt&&dt(rt)},[rt]);var Wt=(0,ie.a)(function(e){Q(e)}),qt=(0,ie.a)(function(e){return At(e,Be)}),Qt=(0,ie.a)(function(e){return Lt(e,J)}),Yt=(0,ie.a)(function(e){return kt(e,X)}),Jt=function(){$()},Xt=(0,ie.a)(function(e,t){return Tt(ct,h,be,Y,e,t)}),Zt=function(e){return Mt(m,_,C,Re,e,mn,nn,an,ae,Fe,Ee,et,Je)},$t=function(){var e,t,n=en(),a=tn();mn&&Dt!==w.f.copy||(e=nn()),mn&&Dt===w.f.send&&(t=an()),Ee(n.peoplePickerError||(null==e?void 0:e.peoplePickerError)||(null==t?void 0:t.peoplePickerError)),Me(a),Fe(null==e?void 0:e.messageBarError),(null==e?void 0:e.messageBarError)||F!==de.error||ae(de.closed),et(n.copyDisabled||(null==e?void 0:e.copyDisabled)),Je(n.sendDisabled||!mn&&(null==e?void 0:e.sendDisabled)||(null==t?void 0:t.sendDisabled))},en=function(){var e=S.l({selectedItems:C,canAddExternalPrincipal:P.canAddExternalPrincipal,sharingInformation:P,audience:_.audience,viewPolicyTipCallback:Z}),t=xt(_,h,C,P,be,Ve,Ce,ze),n=Et(O,!!rt);return{copyDisabled:!!e||t,sendDisabled:!!e||t||n,peoplePickerError:e,messageBarError:void 0}},tn=function(){var e=[],t=S.a(_,k);return mn&&F!==de.success||t&&e.push(t),e.push.apply(e,It([_n,hn])),e},nn=function(){var e=S.a(_,k),t=S.b({scope:_.sharingScope,selectedItems:C,sharingInformation:P,simplifiedV2:mn});return{copyDisabled:!!t,sendDisabled:!(mn||!t&&!e),peoplePickerError:!mn&&(e||t),messageBarError:mn&&(e||t)}},an=function(){var e=S.c({sharingInformation:P,selectedItems:C});return{copyDisabled:void 0,sendDisabled:!!e,peoplePickerError:e,messageBarError:void 0}},rn=null==g?void 0:g.isSendCopyEnabled,on=null==g?void 0:g.isSendPdfEnabled,sn=function(e,t,n,a,i,r,o,c,d,u){var f=[],p=function(e,t){var n=I.r(e)&&t===We.a.available;return H.$()||(n=(I.r(e)||I.p(e))&&t===We.a.available),n?We.a.available:(0,L.e)()}(n,a);(0,Ke.a)()&&window.sessionStorage.setItem("outlookAvailability",a.toString());var m={root:["SimplifiedShareTargets icon-width"]},_={height:"100%",minHeight:"2rem",lineHeight:"unset","ms-ContextualMenu-itemText":{whiteSpace:"prewrap"}};if(p===We.a.available){var h="outlookSVG",b="".concat(E.Li," ").concat(E.Wf);f.push({key:"outlook",text:b,iconProps:{iconName:h,styles:m},id:"od-ShareTargets-outlookButton",style:_,onClick:function(){return u(s.a.outlook)}})}else a===We.a.other&&(b="".concat(E.Li," ").concat(E.pf),f.push({key:"nonOutlook",text:b,iconProps:{iconName:"font:Mail"},id:"od-ShareTargets-nonOutlookButton",style:_,onClick:function(){return u(s.a.nonOutlook)}}));if((0,L.n)()?(b="".concat(E.Li," ").concat(E.Dk),f.push({key:"outlook",text:b,iconProps:{iconName:"teamsSVG",styles:m},id:"od-ShareTargets-mobileTeamsButton",style:_,onClick:function(){return u(s.a.mobileShareToTeams)}})):t&&Qe&&!e.isIE&&(h="teamsSVG",b="".concat(E.Li," ").concat(E.Dk),f.push({key:"webTeams",text:b,iconProps:{iconName:h},id:"od-ShareTargets-webTeamsButton",style:_,onClick:function(){return u(s.a.webShareToTeams)}})),(0,L.k)()&&(b="".concat(E.je),f.push({key:"moreApps",text:b,iconProps:{iconName:"AppIconDefault"},id:"od-ShareTargets-moreAppsButton",style:_,onClick:function(){return u(s.a.moreApps)}})),I.i(n)){var g=qe.a.getAttachAsCopyOptions(n,i,o,r,c,d);1===g.length&&"pdf"!==g[0].key?f.push({key:"attachcopy",alignTargetEdge:!1,directionalHintFixed:!0,text:"".concat(E.ob),iconProps:{iconName:"MailAttached"},id:"od-ShareTargets-attachACopyButton",style:_,onClick:function(){g[0].onClick}}):g.length>0&&f.push({key:"attachcopy",text:"".concat(E.ob),iconProps:{iconName:"MailAttached"},subMenuProps:{items:g},id:"od-ShareTargets-attachACopyButton",style:_})}else(L.l()||c)&&n===l.a.ngsc&&f.push({key:"attachcopy",alignTargetEdge:!1,directionalHintFixed:!0,text:"".concat(E.ob),iconProps:{iconName:"MailAttached"},id:"od-ShareTargets-attachACopyButton",style:_,onClick:function(){!function(e,t){t.getEngagementHelper().sendACopyClicked(e);try{window.external.SendCopy()}catch(e){}}(r,o)}});return{items:f,directionalHint:ne.a.bottomRightEdge,className:"SimplifiedShareTargets ".concat(e.isIE?"ie":"")}}(pe,U,r,T,x,h,be,rn,on,q),cn=null!==(n=null==g?void 0:g.showCloseButton)&&void 0!==n?n:I.q(r),dn=we;Ve===w.c.seeing&&(dn=null);var ln=P.item.itemType===lt.a.Folder?E.Td:E.kd,un=22,fn=(0,R.c)()&&P.requiresAccessApproval;fn&&(un=10);var pn=(0,w.ab)(x.name,un),mn=(0,w.tb)(r,be),_n=v.useMemo(function(){return S.f(C)},[C]),hn=v.useMemo(function(){return S.g(C,b,mn)},[C,b]),bn=mn&&be&&be.isSharingLimitedOnSite();return v.createElement("div",{className:"ShareMain"},v.createElement("div",{ref:Kt},v.createElement("div",{className:"ShareMain-header"},v.createElement(oe.a,{actions:yt(ve,ye,jt,at,re,Jt,fe,Bt,cn,sn,be,nt,mn),mainHeaderText:vt(pn,fn),fullHeaderText:vt(x.name,fn),isFilenameTruncated:pn.length>un,renderBackButton:V,onBackButtonClicked:ue,itemTypePrefix:ln}),P.sensitivityLabelInformation&&v.createElement(Xe.a,{sensitivityLabelInformation:P.sensitivityLabelInformation,getGraphToken:G,engagementExtraData:h})),le(ht(N)),St(P)&&v.createElement(he,{clientId:r,copyMessageBarStatus:F,currentSettings:_,engagementExtraData:h,errorMessage:dn,linkRecipients:C,messageText:O,summaryState:A,oversharingExternalsWarning:_n,oversharingGroupsWarning:hn,permissionsMap:k,permissionsLabel:M,shareTargetClicked:Dt,sharingInformation:P,sharingByCopyIsDisabled:$e,sharingBySendIsDisabled:bn||Ye,showExternalSharingConfirmationDialog:Ve,warningMessages:Le,onInputChange:qt,onRoleChange:W,onSelectedPeopleChange:Wt,onSendLinkMessageChange:Qt,onSendLinkSummaryStateChange:Yt,getStatusIcons:ce,generateSummary:se,updateSummaryData:ot,handlerForOnLinkSettingsClicked:Jt}),Ot(o,P,be,ee),v.createElement("div",{className:"ShareMain-flex-row"},v.createElement("div",{className:"ShareMain-flex-grow space-between"},wt(P,be,ee)),v.createElement("div",{className:"ShareMain-action-footer flex-end"},v.createElement("div",{className:"ShareMain-copy-button-container"},v.createElement(Te,{buttonRef:u,copyLinkToastStatus:f,copyMessageBarStatus:F,currentSettings:_,isSharingByCopyDisabled:$e,permissionsLabel:M,shareTargetClicked:Dt,unresolvedPeoplePickerText:Re,handlerForShareTargetClicked:Zt,focusCopyBtn:z,onShareTargetClicked:q,setCopyMessageBarStatus:ae,setCopyToastStatus:te,setIsDisabled:et,setShareTargetClicked:Rt}),mn&&v.createElement("div",null,v.createElement(ke.a,{className:"Footer-button Footer-button-settings",iconProps:{iconName:"Settings"},ariaLabel:E.ye,onClick:Jt,tooltipContent:E.ye,tooltipStyles:gt(),directionalHint:ne.a.topAutoEdge,automationId:"Footer-button-settings",styles:bt(pe)}))),v.createElement(Ne,{engagementExtraData:h,errorMessage:we,messageText:rt?function(e){var t,n,a,i,r;if(H.Vb()){var o={id:null===(t=null==P?void 0:P.sensitivityLabelInformation)||void 0===t?void 0:t.id,displayName:null===(n=null==P?void 0:P.sensitivityLabelInformation)||void 0===n?void 0:n.displayName,hasIrmProtection:null===(a=null==P?void 0:P.sensitivityLabelInformation)||void 0===a?void 0:a.hasIRMProtection,color:null};return JSON.stringify({isAiGenerated:!!rt,sensitivtyLabelInfo:o,messageText:e})}return H.fb()&&(null===(i=null==P?void 0:P.sensitivityLabelInformation)||void 0===i?void 0:i.displayName)?"[".concat(null===(r=null==P?void 0:P.sensitivityLabelInformation)||void 0===r?void 0:r.displayName,"]: ")+e:e}(O):O,isDisabled:bn||Ye,linkRecipients:C,showSendButtonSpinner:B,handlerForShareTargetClicked:Zt,onSendLinkClicked:Xt,setIsDisabled:Je,setShareTargetClicked:Rt})))),mn&&Ht(F,Ue,M,Kt,P,be,ae,Rt),Ct(xe,Ve,K,ze),Ut(r,h,be),mn&&!(0,Ke.a)()&&Ft(fe,pt,nt,D,Se,re,Gt,mt,jt,at))}_t.contextTypes={platformDetection:y.object.isRequired,shareClickTime:y.number,sharingClientMessenger:y.object,sharingStore:y.object.isRequired,loadTeachingBubbleCampaigns:y.func.isRequired,markTeachingBubbleAsDismissed:y.func.isRequired,onDismiss:y.func.isRequired,onTeachingBubbleSeen:y.func.isRequired,shouldTeachingBubbleBeShown:y.func.isRequired,campaignKey:y.object};var ht=function(e){var t;switch(e){case te.a.PageSharingAssetWarning:t=12;break;case te.a.LimitedSharing:t=40;break;case te.a.LinkReShare:t=28;break;default:t=0}return{extraHeight:t,parentCssClass:"SimplifiedShare",isSimplifiedDialog:!0}},bt=function(e){return{root:{height:"2rem",padding:e.isIE?"0":"0 1rem"},icon:{fontSize:"1rem",height:"1rem",lineHeight:"1rem"},flexContainer:["flexContainer"],label:{fontSize:"0.875rem",paddingBottom:"2px"}}},gt=function(){return{root:{height:"100%",display:"flex !important",maxWidth:"250px",fontSize:"12px"}}},vt=function(e,t){var n=E.Fj;return t&&(n=E.Hj),(0,ae.d)(n,e)},yt=function(e,t,n,a,i,r,o,s,c,d,l,u,f){var p=Dt(o,e,n,a,i);return v.createElement(v.Fragment,null,!f&&v.createElement(ke.a,{className:"ShareMain-sharingSettings",iconProps:{iconName:"Settings"},ariaLabel:E.fj,onClick:r,tooltipContent:E.fj,directionalHint:ne.a.bottomAutoEdge}),d.items.length>0&&v.createElement(ke.a,{className:"ShareMain-moreApps",menuIconProps:{iconName:"More"},ariaLabel:E.Ve,tooltipContent:E.Ve,menuProps:d,directionalHint:ne.a.bottomAutoEdge}),f&&v.createElement(v.Fragment,null,s.showMarker&&s.teachingBubbleCampaigns&&v.createElement("div",{className:"ShareMain-firstTimeUserMarker"}),v.createElement(ke.a,{className:"ShareMain-helpMenu",menuIconProps:{iconName:"Unknown"},ariaLabel:E.Kd,menuProps:p,tooltipContent:E.Kd,directionalHint:ne.a.bottomAutoEdge,automationId:"ShareMain-helpMenu"})),c&&v.createElement(ke.a,{className:"ShareMain-close",iconProps:{iconName:"Clear"},ariaLabel:E.jb,onClick:function(e){e.stopPropagation(),e.preventDefault(),t(),u&&l.getEngagementHelper().simplifiedV2TeachingBubbleAbandoned()},tooltipContent:E.jb,directionalHint:ne.a.bottomAutoEdge}))},St=function(e){return!e.blockPeoplePickerAndSharing||(0,w.V)(e)},Dt=function(e,t,n,a,i){return{items:[{key:"viewUpdate",text:E.Wk,onClick:function(){a(!0),i(1)},onRender:function(e,t){return v.createElement(O.c,{className:"ShareMain-contextualMenu-link",onClick:function(){e.onClick(),t()}},v.createElement("div",{className:"ShareMain-contextualMenu-linkContent"},v.createElement("span",{className:"ms-ContextualMenu-itemText"},e.text),v.createElement("div",{className:"ShareMain-badge"},E.af)))}},{key:"learnMore",text:E.se,onClick:function(){window.open("https://go.microsoft.com/fwlink/?linkid=2247024","_blank")}}],directionalHint:ne.a.bottomAutoEdge,className:"ShareMain-helpMenu",onMenuOpened:function(){t(e),n({teachingBubbleCampaigns:void 0,showMarker:!1})}}},It=function(e){var t=[];return e.map(function(e){e&&t.push(v.createElement("div",null,v.createElement("span",{role:"alert","aria-live":"assertive"},e)))}),t},xt=function(e,t,n,a,i,r,o,s){var c=n.filter(function(e){return e.isExternal}),l=!1;if(H.rc()){var u=e.audience===d.a.organization||e.audience===d.a.existing,p=i.isPeopleSharingLinksEnabled(),m=c.filter(function(e){return S.h(e)});l=(a.canAddExternalPrincipal||m.length)&&u&&c.length&&p}else{var _=e.sharingScope===f.a.organization,h=a.canAddExternalPrincipal;l=_&&h&&!!c.length}return(l=l&&r!==w.c.dismissed)&&s(w.c.seeing),o(c),i.getEngagementHelper().externalSharingCslError(t),l},Ct=function(e,t,n,a){return t===w.c.seeing&&e.length?v.createElement(v.Suspense,{fallback:v.createElement(b.a,null)},v.createElement(J.c,{confirmationCode:Ve.a.shareDialogExternalSharing,participant:null,participants:e,onApply:function(){a(w.c.dismissed),n(d.a.specificPeopleFlex,o.a.flexible,f.a.specificPeople)},onCancel:function(){a(w.c.dismissed)}})):null},Ot=function(e,t,n,a){if(H.F()&&!H.G()&&n.isCOB&&!n.isCOB()){var i=(0,w.eb)(t),r=function(e,t){return function(){e(),t.getEngagementHelper().discoverableMessageBarClicked()}}(a,n);return i&&v.createElement(v.Suspense,{fallback:v.createElement(v.Fragment,null)},v.createElement(J.e,{companyName:e,onClick:r}))}},wt=function(e,t,n){var a=(0,w.H)(e,t.isConsumer()),i=a.shared,r=a.activeLinks,o=a.sharingPrincipals,s=t&&!t.isConsumer(),c=function(){t&&t.isBundleShare()||n()},d=!1,l=!1;H.F()&&!H.G()&&t.isCOB&&!t.isCOB()&&(d=!(!t.getAllOrgSG||!t.getAllOrgSG()),l=!(!t.getEEEU||!t.getEEEU()));var u=i?v.createElement("div",{className:"ShareMain-sharedWithSection"},v.createElement(ze.a,{getPhotoUrl:(0,Ge.b)(e.webUrl),onClick:c,sharingLinks:r,sharingPrincipals:o,personaSizeInPixels:20,renderOverlap:!0,isNotification:!1,isDiscoverable:d||l})):v.createElement("div",{className:"ShareMain-notShared"},v.createElement(_.a,{content:E._f},v.createElement(O.d,{className:"ShareMain-notShared-button",iconProps:{iconName:"Lock"},ariaLabel:E._f,onClick:c})));return s?u:null},Et=function(e,t){var n=H.w()&&t?pt:ft;return(0,w.s)(e)>n},At=function(e,t){t(""!==e)},Lt=function(e,t){t(e)},kt=function(e,t){t(e)},Mt=function(e,t,n,a,i,r,o,s,c,l,u,p,m){var _,h=!1,b=!1;0===n.length&&(t.sharingScope===f.a.specificPeople?(h=!0,b=!0,_=v.createElement("span",{role:"alert","aria-live":"assertive"},E.Rg)):i===w.f.send&&(b=!0,_=v.createElement("span",{role:"alert","aria-live":"assertive"},E.Hg)));var g=a&&t.sharingScope===f.a.specificPeople;if(h=h||g,b=b||a,(g||a&&i===w.f.send)&&(_=v.createElement("span",{role:"alert","aria-live":"assertive"},E.Tk)),i===w.f.copy&&!e&&t.audience===d.a.specificPeople){for(var y=!1,S=!1,D=0,I=n;D<I.length;D++){var x=I[D];y||(y=x.isExternal&&!x.providerName),S||(S=!x.isExternal||x.isExternal&&!!x.providerName)}y&&S&&(_=v.createElement("span",{role:"alert","aria-live":"assertive"},E.Fe),h=!0)}if(r)if(i===w.f.copy){var C=o();h=h||C.copyDisabled,b=b||C.sendDisabled,C.peoplePickerError&&(_=C.peoplePickerError),(null==C?void 0:C.messageBarError)&&(l(C.messageBarError),c(de.error))}else if(i===w.f.send){var O=s();b=b||O.sendDisabled,O.peoplePickerError&&(_=O.peoplePickerError)}return u(_),p(h),m(b),i===w.f.copy?h:i===w.f.send?b:void 0},Pt=function(e,t,n){if(e.errorCategory===u.a.shareLink||e.errorCategory===u.a.shareObject)return n?t===w.f.copy?v.createElement("div",null,"".concat(E.fc," ").concat(E.Ok)):t===w.f.send?!H.l()&&e.errorMessage?v.createElement("div",null,e.errorMessage):v.createElement("div",null,"".concat(E.pc," ").concat(E.Ok)):v.createElement("div",null,"".concat(E.Rd)):v.createElement("div",null,"".concat(E.Ek," ").concat(E.Ok))},Tt=function(e,t,n,a,i,r){H.u()&&(-1!==i.indexOf(e)&&""!==e?n.getEngagementHelper().summarizationSent(t,"exactMatch"):""!==e&&(function(e,t){for(var n,a,i,r=new re.a({name:"LevenshteinDistanceMeasuringEvent"}),o=[],s=0;s<=t.length;s++)o[s]=s;for(var c=0;c<e.length;c++)for(i=o[0],o[0]=c+1,s=1;s<=t.length;s++)e[c]===t[s-1]?(n=[Math.min(o[s-1]+1,o[s]+1,i),o[s]],o[s]=n[0],i=n[1]):(a=[Math.min(o[s-1],o[s],i)+1,o[s]],o[s]=a[0],i=a[1]);return r.end({resultType:re.b.Success}),o[o.length-1]}(i,e)/e.length*100<=50?n.getEngagementHelper().summarizationSent(t,"substantialMatch"):n.getEngagementHelper().summarizationSent(t,"marginalMatch"))),a(i,r)},Ut=function(e,t,n){return L.l()&&I.g(e)?v.createElement($e,{engagementExtraData:t,sharingStore:n}):v.createElement(v.Fragment,null)},Ft=function(e,t,n,a,i,r,o,s,c,d){return n&&i(e),v.createElement("div",{className:"od-FirstRunExperienceMessageBar-container",style:{height:t}},n&&v.createElement(v.Suspense,{fallback:v.createElement(v.Fragment,null)},v.createElement(mt,{freHeight:t,index:a,setIndex:r,setFREIsAbandoned:o,setFreHeight:s,setMarkerInfo:c,setShowFirstRunExperience:d})))},Ht=function(e,t,n,a,i,r,o,s){return v.createElement(v.Suspense,{fallback:v.createElement(v.Fragment,null)},v.createElement(at,{copyMessageBarStatus:e,messageBarError:t,permissionsLabel:n,shareMainContainerRef:a,sharingInformation:i,sharingStore:r,setCopyMessageBarStatus:o,setShareTargetClicked:s}))},Rt=n(598),Nt=n(592),Bt=n(455);(0,M.L)({icons:{BlockDownloadIcon:v.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},v.createElement("path",{d:"M3.28034 2.21968C2.98745 1.92678 2.51257 1.92677 2.21968 2.21966C1.92678 2.51255 1.92677 2.98743 2.21966 3.28032L10.9993 12.0602L10.999 16.4329L7.27997 12.7192L7.1958 12.6467C6.90204 12.429 6.48539 12.4535 6.21931 12.72C5.92661 13.0131 5.92694 13.4879 6.22003 13.7806L11.2235 18.7772L11.3076 18.8498C11.6012 19.0673 12.0176 19.043 12.2837 18.7769L15.0001 16.0611L20.7194 21.7805C21.0123 22.0734 21.4872 22.0734 21.7801 21.7805C22.073 21.4876 22.073 21.0127 21.7801 20.7198L3.28034 2.21968ZM13.9393 15.0002L12.499 16.4399L12.4992 13.5601L13.9393 15.0002ZM17.1218 13.9399L16.0611 12.8792L16.2208 12.7196C16.4871 12.4533 16.9038 12.4291 17.1974 12.647L17.2815 12.7197C17.5477 12.986 17.5719 13.4026 17.354 13.6962L17.2814 13.7803L17.1218 13.9399ZM10.9996 7.81764L12.4995 9.31756L12.5 2.75488L12.4932 2.65311C12.4435 2.28704 12.1297 2.00488 11.75 2.00488L11.6482 2.01173C11.2822 2.06139 11 2.37519 11 2.75488L10.9996 7.81764ZM18.2498 20.4999C18.664 20.4998 19 20.8355 19 21.2497C19 21.6639 18.6644 21.9998 18.2502 21.9999L5.25022 22.0037C4.836 22.0038 4.5 21.6681 4.5 21.2539C4.5 20.8397 4.83557 20.5038 5.24978 20.5037L18.2498 20.4999Z",fill:"currentColor"}))}}),H.Qb()&&(0,M.L)({icons:{Shield16RegularIcon:v.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16",fill:"none"},v.createElement("path",{d:"M7.64728 2.14638C7.84268 1.95105 8.15946 1.95123 8.35464 2.14678C9.5947 3.38913 10.9689 4 12.5 4C12.7761 4 13 4.22386 13 4.5V7.50126C13 10.7196 11.3587 12.9075 8.15811 13.9743C8.05548 14.0086 7.94452 14.0086 7.84189 13.9743C4.64126 12.9075 3 10.7196 3 7.50126V4.5C3 4.22386 3.22386 4 3.5 4C5.02923 4 6.40416 3.38902 7.64728 2.14638ZM8.00042 3.18917C6.81393 4.25491 5.47941 4.86879 4 4.98118V7.50126C4 8.9349 4.36269 10.0655 5.02127 10.9453C5.65858 11.7967 6.62953 12.4885 8 12.9715C9.37047 12.4885 10.3414 11.7967 10.9787 10.9453C11.6373 10.0655 12 8.9349 12 7.50126V4.98121C10.5195 4.86895 9.18521 4.25528 8.00042 3.18917Z",fill:"#242424"})),ShieldLock16RegularIcon:v.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16",fill:"none"},v.createElement("path",{d:"M7.64728 2.14638C7.84268 1.95105 8.15946 1.95123 8.35464 2.14678C9.5947 3.38913 10.9689 4 12.5 4C12.7761 4 13 4.22386 13 4.5V5.40135C12.6963 5.22567 12.359 5.1017 12 5.04148V4.98121C10.5195 4.86895 9.18521 4.25528 8.00042 3.18917C6.81393 4.25491 5.47941 4.86879 4 4.98118V7.50126C4 8.9349 4.36269 10.0655 5.02127 10.9453C5.49089 11.5727 6.14168 12.1134 7 12.5478V13.6523C4.35378 12.4971 3 10.4242 3 7.50126V4.5C3 4.22386 3.22386 4 3.5 4C5.02923 4 6.40416 3.38902 7.64728 2.14638ZM9.5 8V9H9C8.44772 9 8 9.44772 8 10V14C8 14.5523 8.44771 15 9 15H14C14.5523 15 15 14.5523 15 14V10C15 9.44772 14.5523 9 14 9H13.5V8C13.5 6.89543 12.6046 6 11.5 6C10.3954 6 9.5 6.89543 9.5 8ZM10.5 9V8C10.5 7.44772 10.9477 7 11.5 7C12.0523 7 12.5 7.44772 12.5 8V9H10.5ZM11.5 11.25C11.9142 11.25 12.25 11.5858 12.25 12C12.25 12.4142 11.9142 12.75 11.5 12.75C11.0858 12.75 10.75 12.4142 10.75 12C10.75 11.5858 11.0858 11.25 11.5 11.25Z",fill:"#242424"}))}});var jt=function(e){function t(t,n){var i,u,f=e.call(this,t)||this;f._viewStates=[],f._shareMainControl=(0,v.createRef)(),f._topLevelDivRef=v.createRef(),f._dialogHeightRef=v.createRef(),f._copyBtnRef=v.createRef(),f._isFREAbandoned=!1,f._setFREIndex=function(e){f.setState({index:e})},f._copyLinkOnCancelClicked=function(){f._returnToPreviousView()},f._copyLinkOnApplyClicked=function(e,t){var n={currentSettings:e,linkRecipients:e.specificPeople,viewState:f.state.viewState};f.setState(n,function(){f._store.getEngagementHelper().linkSettingsApplyClicked(f._engagementExtraData),f._onCopyLinkClicked({copyLinkShortcut:!0})})},f._closeButtonOnBlur=function(){f.setState({isCloseButtonOnFocus:!1})},f._closeButtonOnFocus=function(){f.setState({isCloseButtonOnFocus:!0})},f._onAudienceChange=function(e,t,n){f.setState({currentSettings:(0,a.a)((0,a.a)({},f.state.currentSettings),{audience:e,sharingLinkKind:t,sharingScope:n})})},f._onRoleChange=function(e){var t=(0,w.T)(e),n=e===r.a.view,i=e===r.a.review,s=e==r.a.manageList,c=e===r.a.restrictedview;if(!(t||n||i||s||c))throw new Error("Role not implemented: "+r.a[e]);var d=f.state.currentSettings,l=i||s||c?o.a.flexible:(0,w.z)(d.audience,t);d.sharingRole!==e&&f._store.getEngagementHelper().SharingRoleChangedFromCompactRoleSelector({sharingRole:r.a[e],isEdit:t,isReview:i,blockDownload:c,isManageList:s});var u=d.preventDownload;(f._isVideo||f._showSimplifiedDialogV2)&&(u=c),f.setState((0,a.a)((0,a.a)({},f.state),{currentSettings:(0,a.a)((0,a.a)({},d),{sharingRole:e,isEdit:t,isReview:i,isManageList:s,sharingLinkKind:l,preventDownload:u})}))},f._onShareTargetClicked=function(e,t){var n;switch(L.y(e),e){case s.a.outlook:n="outlookClicked";break;case s.a.webShareToTeams:n="webShareToTeamsClicked";break;case s.a.mobileShareToTeams:n="mobileShareToTeamsClicked";break;case s.a.nonOutlook:n="nonOutlookClicked";break;case s.a.copy:n="copyButtonClicked";break;case s.a.moreApps:n="moreAppsClicked"}if(e!==s.a.copy){var i=new W.a({scenario:(0,K.a)("ShareDialog.shareLink"),perfGoalInMs:3e4,extraData:{sharingScenario:n}}),r=(0,Z.c)(f.props.clientId);if(r){var o=new W.a({scenario:"".concat(r,"-ShareDialog.shareLink"),perfGoalInMs:3e4,extraData:{sharingScenario:n}});f._shareCustomerPromise=[i,o]}else f._shareCustomerPromise=[i]}if(f._store.getEngagementHelper().log("ShareV3.shareTargetClicked",(0,a.a)((0,a.a)({},f._engagementExtraData),{shareType:e})),e!==s.a.share)return e===s.a.copy?(f._sharingClientMessenger?f._sharingClientMessenger.sendCopyLinkShareTargetClicked():L.c(),void f._onCopyLinkClicked({copyLinkShortcut:t})):void(e!==s.a.webShareToTeams?f.setState({shareType:e,shareTargetClicked:!0},function(){f._store.shareLink({settings:f.state.currentSettings,recipients:f.state.linkRecipients,copyLinkCommand:!1,shareType:e})}):f._onRedirectTeamsClicked())},f._onLinkPermissionsApplyClicked=function(e){if(f._store.getEngagementHelper().linkSettingsApplyClicked(f._engagementExtraData),f._onSelectedPermissionsChange(e),f.props.mode===c.a.linkSettings){var t=new W.a({scenario:(0,K.a)("ShareDialog.shareLink"),perfGoalInMs:3e4,extraData:{sharingScenario:"linkSettingChangesApply"}}),n=(0,Z.c)(f.props.clientId);if(n){var a=new W.a({scenario:"".concat(n,"-ShareDialog.shareLink"),perfGoalInMs:3e4,extraData:{sharingScenario:"linkSettingChangesApply"}});f._shareCustomerPromise=[t,a]}else f._shareCustomerPromise=[t];f.setState({shareType:s.a.share,applyLinkSettingsClicked:!0},function(){var e=f.state.linkRecipients;if(I.m(f.props.clientId)){var t=f.state.currentSettings.sharingLinkKind;t!==o.a.organizationEdit&&t!==o.a.organizationView||(e=e.filter(function(e){return!e.isExternal}))}f._store.shareLink({settings:f.state.currentSettings,recipients:e,copyLinkCommand:!1})})}},f._focusCopyButton=function(){f._copyBtnRef&&f._copyBtnRef.current&&f._copyBtnRef.current.focus()},f.setCopyToastStatus=function(e){f.setState({copyLinkToastStatus:e})},f.setCopyMessageBarStatus=function(e){f.setState({copyMessageBarStatus:e})},f._onLinkPermissionsCancelClicked=function(){f.props.mode===c.a.linkSettings&&(f._sharingClientMessenger?f._sharingClientMessenger.sendDismiss():L.f()),f._returnToPreviousView()},f._returnToPreviousView=function(){f._viewStates&&f._viewStates.length&&(f.setState({viewState:f._viewStates.pop(),showTeamsDialog:!1},function(){var e,t;null===(t=null===(e=f._shareMainControl)||void 0===e?void 0:e.current)||void 0===t||t.shouldShowActivityIndicator(!1)}),f.state.viewState===Y.a.modifyPermissions&&f._store.getEngagementHelper().linkSettingsCancelClicked(f._engagementExtraData))},f._hideElementsInManageAccess=function(e){f.props.hideElementsInManageAccess&&f.props.hideElementsInManageAccess(e)},f._onLinkSettingsInfoMessageClick=function(){f._store.getEngagementHelper().linkSettingsInfoMessageClick(),f._viewStates=[],f.setState({viewState:Y.a.default})},f._onSelectedPeopleChange=function(e){var t=f.state.permissionsMap;f.state.currentSettings.audience===d.a.existing&&f._store.checkPermissions(e),f._store.resetPeoplePickerError();var n={recipientsCount:e.length,externalRecipientsCount:S.d(e),linkedinRecipientsCount:S.e(e)};f.setState((0,a.a)({linkRecipients:e,permissionsMap:t},n),function(){f._setEngagementExtraData(),f._store.fetchGroupsMemberCount(e)})},f._onGrantDirectAccess=function(e,t){var n,i;H.m()||(f._sharingClientMessenger?f._sharingClientMessenger.sendShareSendClicked():L.y(s.a.grantAccess));var r=f.state,o=r.linkRecipients,c=r.currentSettings.sharingRole,d={hasMessage:!!e,hasSubject:!!t,messageLength:e?e.length:0,shareType:s.a.grantAccess,debugErrorMessage:(0,w.Y)(null===(i=null===(n=f.state.sharingInformation)||void 0===n?void 0:n.error)||void 0===i?void 0:i.message)};f._setEngagementExtraData(d);var l=new W.a({scenario:(0,K.a)("ShareDialog.shareObject"),perfGoalInMs:3e4,extraData:(0,a.a)({sharingScenario:"shareObject"},f._engagementExtraData)}),u=(0,Z.c)(f.props.clientId);if(u){var p=new W.a({scenario:"".concat(u,"-ShareDialog.shareObject"),perfGoalInMs:3e4,extraData:{sharingScenario:"shareObject"}});f._shareCustomerPromise=[l,p]}else f._shareCustomerPromise=[l];f.setState({shareType:s.a.grantAccess,hasMessage:!!e,hasSubject:!!t,messageLength:e?e.length:0,shareTargetClicked:!0,showSendButtonSpinner:!0},function(){if(f._store.grantAccessV2({recipients:o,role:c,subject:t,message:e}),f._store.getEngagementHelper().shareCompleted(f._engagementExtraData),!H.m())if(f._sharingClientMessenger)f._sharingClientMessenger.sendShareCompleted();else{var n=H.rb()?s.a.grantAccess:s.a.share;L.z(n)}})},f._onSendLinkClicked=function(e,t){L.y(s.a.share);var n=f.state.linkRecipients,i={shareType:s.a.share,hasMessage:!!e,hasSubject:!!t,messageLength:e?e.length:0};f._setEngagementExtraData(i);var r=new W.a({scenario:(0,K.a)("ShareDialog.shareLink"),perfGoalInMs:3e4,extraData:(0,a.a)({sharingScenario:"sendLink"},f._engagementExtraData)}),o=(0,Z.c)(f.props.clientId);if(o){var c=new W.a({scenario:"".concat(o,"-ShareDialog.shareLink"),perfGoalInMs:3e4,extraData:{sharingScenario:"sendLink"}});f._shareCustomerPromise=[r,c]}else f._shareCustomerPromise=[r];f.setState({shareType:s.a.share,hasMessage:!!e,hasSubject:!!t,messageLength:e?e.length:0,shareTargetClicked:!0,showSendButtonSpinner:!0},function(){f._sharingClientMessenger?f._sharingClientMessenger.sendShareSendClicked():L.v(),f._store.shareLink({settings:f.state.currentSettings,recipients:n,emailMessage:e,emailSubject:t})})},f._onViewPolicyTipClicked=function(){f._viewStates.push(f.state.viewState),f.state.viewState!==Y.a.policyDetails&&f.setState({viewState:Y.a.policyDetails})},f._onSendLinkMessageChange=function(e){f.state.messageText!==e&&f.setState({messageText:e})},f._onSendLinkSummaryStateChange=function(e){f.state.summaryState!==e&&f.setState({summaryState:e})},f._onSendLinkSubjectChange=function(e){f.state.subjectText!==e&&f.setState({subjectText:e})},f._getStatusIcons=function(){var e=(0,w.N)(f.props.clientId,f.state.sharingInformation,f.state.currentSettings),t={root:["SendLink-statusIcon"]},n=e.map(function(e,n){var a={onRenderContent:function(){return v.createElement("div",{className:"SendLink-statusIconTooltip"},e.tooltip)}};return v.createElement("i",{className:f._useSimplifiedDialog?"SendLink-statusIconContainer":"SendLink-statusIconItem"},v.createElement(_.a,{id:e.icon,tooltipProps:a,styles:f._useSimplifiedDialog&&{root:{display:"flex",height:"100%",alignItems:"center"}}},v.createElement(h.a,{iconName:e.icon,"aria-describedby":e.icon,styles:!f._useSimplifiedDialog&&t,tabIndex:0,"data-is-focusable":!0,role:"note","aria-label":e.tooltip})))});return n},f._renderSharingInfoBar=function(e){var t,n,i=f._checkShouldRenderInfoBar(),r=f._showSharingBanner?null===(t=f._sharingInfoBarInformation)||void 0===t?void 0:t.sharingInfoBarMessageTypeId:null===(n=f.state.sharingInfoBarInformation)||void 0===n?void 0:n.sharingInfoBarMessageTypeId;return i&&f._store.getEngagementHelper().renderSharingInfoBar((0,a.a)((0,a.a)({},f._engagementExtraData),{sharingInfoBarMessageTypeId:te.a[r]})),i&&v.createElement(v.Suspense,{fallback:v.createElement(b.a,null)},v.createElement(J.o,(0,a.a)({},e,{sharingInfoBarMessageTypeId:r,sharingInfoBarState:f.state.sharingInfoBarState,onUpdateSharingInfoBarState:f._onUpdateSharingInfoBarState,sharingRole:f.state.currentSettings.sharingRole})))},f._getPermissionsLabel=function(e){return e&&"."!==e[e.length-1]?"".concat(e,"."):e},f._getLabelProps=function(){return{clientId:f.props.clientId,companyName:f.state.companyName,currentSettings:f.state.currentSettings,customLabeledAudienceConfig:f.props.customLabeledAudienceConfig,sharingInformation:f.state.sharingInformation,sharingStore:f._store}},f._onInterruptUseNew=function(){f._store.getEngagementHelper().copyLinkInterruptEditLinkChosen(f._engagementExtraData),f.setState({shareType:s.a.copy,shareTargetClicked:!0,showCopyLinkInterrupt:!1,currentSettings:(0,a.a)((0,a.a)({},f.state.currentSettings),{updatePassword:!0})},function(){f._store.shareLink({settings:f.state.currentSettings,recipients:f.state.linkRecipients,copyLinkCommand:!1})})},f._onInterruptUseExisting=function(){f._store.getEngagementHelper().copyLinkInterruptExistingLinkChosen(f._engagementExtraData),f.setState({shareType:s.a.copy,shareTargetClicked:!0,showCopyLinkInterrupt:!1,currentSettings:(0,a.a)((0,a.a)({},f.state.currentSettings),{updatePassword:!1,password:null})},function(){f._store.shareLink({settings:f.state.currentSettings,recipients:f.state.linkRecipients,copyLinkCommand:!0})})},f._onInterruptCancel=function(){f._store.getEngagementHelper().copyLinkInterruptCancelled(f._engagementExtraData),f.setState({showCopyLinkInterrupt:!1}),f._shareMainControl.current.shouldShowActivityIndicator(!1)},f._checkShouldRenderInfoBar=function(){var e,t,n=f.props.shouldWaitForSharingInfoBarInformation;switch(f._showSharingBanner?null===(e=f._sharingInfoBarInformation)||void 0===e?void 0:e.sharingInfoBarMessageTypeId:null===(t=f.state.sharingInfoBarInformation)||void 0===t?void 0:t.sharingInfoBarMessageTypeId){case te.a.PageSharingAssetWarning:return H.hc()&&n&&f.state.viewState!==Y.a.modifyPermissions;case te.a.LimitedSharing:case te.a.LinkReShare:return f._showSharingBanner&&f.state.viewState===Y.a.default;case te.a.LimitedSharingExisting:return f._showSharingBanner&&f.state.viewState===Y.a.modifyPermissions&&f.props.mode===c.a.copy;default:return!1}},f._onUpdateSharingInfoBarState=function(e){f.setState({sharingInfoBarState:e})},f._enterManageAccessView=function(){f._usePermissionsPivot?f.setState({viewState:Y.a.permissionsPivot}):f.setState({viewState:Y.a.permissionsList})},f._enterShareView=function(){f._store.getEngagementHelper().manageAccessLinkSectionShareClicked(f._engagementExtraData),f._viewStates.push(f.state.viewState),f.setState({viewState:Y.a.default})},f._enterGrantAccessView=function(){f._usePermissionsPivot?f._store.getEngagementHelper().manageAccessV3GrantAccessClicked(f._engagementExtraData):f._store.getEngagementHelper().manageAccessGrantAccessClicked(f._engagementExtraData),f.setState({viewState:Y.a.addPeople})},f._showModifyPermissions=function(e,t){f._viewStates.push(f.state.viewState),f._isFREAbandoned=!0,f.setState({viewState:Y.a.modifyPermissions,copyLinkShortcut:t},function(){f._store.getEngagementHelper().linkSettingsOpened(f._engagementExtraData,e)})},f._showPermissionsList=function(){f._viewStates.push(f.state.viewState),f._isFREAbandoned=!0,f._store.getEngagementHelper().manageAccessOpened(f._engagementExtraData);var e=f.props,t=e.invokeManageAccess,n=e.onManageAccessClicked,a=n&&!t;t?f._sharingClientMessenger?f._sharingClientMessenger.sendShareManageAccessClicked():L.i():a?n():f.setState({viewState:f._usePermissionsPivot||f._useSimplifiedDialog?Y.a.permissionsPivot:Y.a.permissionsList,showHeaderInManagedAccess:!0})},f._dismiss=n.onDismiss,f._resize=n.resize,f._store=n.sharingStore,f._shareClickTime=n.shareClickTime,f._sharingClientMessenger=n.sharingClientMessenger,f._isPeopleSharingLinksEnabled=!1,f._rumoneLogger=new q.a,f._platformDetection=n.platformDetection,f._showSimplifiedDialog=(0,w.nb)(f.props.clientId,f._store)&&!f.props.showItemInsights,f._showSimplifiedDialogV2=(0,w.tb)(f.props.clientId,f._store),f._useSimplifiedDialog=f._showSimplifiedDialog||f._showSimplifiedDialogV2,f._usePermissionsPivot=f._store.isConsumer()||f._showSimplifiedDialog||f._showSimplifiedDialogV2,f._showSharingBanner=f._showSimplifiedDialogV2&&f._store.isSharingLimitedOnSite()||R.c()&&f._store.getSharingInformation().requiresAccessApproval,f._isVideo="video"===(0,ee.a)(null===(i=f._store.getSharingInformation())||void 0===i?void 0:i.fileExtension),f.props.clientId===l.a.ngsc||f._platformDetection.isIE?f._maxHeight=void 0:f._maxHeight=f.props.maxHeight;var p=L.j()||(null===(u=f.props.hostOptions)||void 0===u?void 0:u.isDarkMode),m=t.theme;m||(m=L.g()),(m&&f.props.clientId!==l.a.wac||p)&&f._loadTheme(p?(0,w.p)():m),f._sizeConstraints={maxHeight:I.g(f.props.clientId)?"none":f._maxHeight||"none",maxWidth:f.props.maxWidth||"none",overflowY:f._useSimplifiedDialog?"hidden":"auto",overflowX:"hidden"};var g=(0,$.a)(location.search.substring(1)),y={isMigratedHosting:g.migratedhosting&&"true"===g.migratedhosting.toLowerCase()};f._setEngagementExtraData(y);var D=f._generateInitialStateFromStore();if(f.state=D,f.state.sharingInformation){var x=f.state.sharingInformation;f._setEngagementExtraData({webTemplateId:x.webTemplateId,itemUniqueId:x.itemUniqueId,isPremium:!!x.isPremium,requiresAccessApproval:!!x.requiresAccessApproval,userRole:r.a[x.userRole],hasInheritedLinks:!!x.hasInheritedLinks})}return f._baseProps=(0,V.a)(t),f._correlationId=f.props.correlationId||B.a.generate(),f._baseProps.correlationId=f._correlationId,f._resizeTracker=new N.a(n.resize),f._showAnimation=void 0!==window.ResizeObserver&&f.props.fullScreenIframeMode,f._store.getEngagementHelper().log(F.d.Opening,f._engagementExtraData),f}return(0,a.d)(t,e),t.prototype.componentWillUnmount=function(){var e;this._store.removeListeners&&this._store.removeListeners(),this._showAnimation&&(null===(e=this._dialogHeightRef)||void 0===e?void 0:e.current)&&this._dialogHeightRef.current.disconnect()},t.prototype.componentDidMount=function(){var e,t,n=this;try{var i=this._store,r=void 0;try{r=(0,j.a)((0,j.c)(i.getAuthToken())),this._engagementExtraData.appId=r}catch(e){}if(!this._isOpenEventLogged){var o=(0,a.a)({},this._engagementExtraData),d=this._store.getNavId();d&&(o.isNavIdBase64Url=(0,Nt.c)(d),o.navIdLength=d.length),this._store.getEngagementHelper().log(F.d.Opened,o),this._isOpenEventLogged=!0}if(new k.a(this).on(window,"keydown",function(e){e&&e.keyCode===U.a.escape&&n._handleEscKeyPress(e)}),this._shareComponentRenderedTime=Date.now(),i.addListener(this._sharingStoreListener.bind(this)),!(this.props.copyLinkShortcut&&this.state.sharingInformation&&this.state.currentSettings)||this.props.shareId||this.state.sharingInformation.error||this._copyLinkShortcutInvoked||this.state.sharingLinkCreated||(this._copyLinkShortcutInvoked=!0,this._onCopyLinkClicked({copyLinkShortcut:!0,initializedSettings:this.state.currentSettings,shareTargetClicked:!1})),i.fetchSuiteNavInformation(),i.fetchPolicyTipInformation(),this.props.useVroomCreateDefaultLink&&!this._copyLinkShortcutInvoked&&this.props.mode===c.a.copy&&!this.props.shareId&&I.m(this.props.clientId)&&(this._copyLinkShortcutInvoked=!0,this._store.shareLink({settings:this.state.currentSettings,recipients:this.state.linkRecipients,copyLinkCommand:!0}),this.setState({shareType:s.a.copy,shareTargetClicked:!0})),this._resizeIfNeeded(),this.state.sharingInformation){var l=this.props.mode,u=this.state.viewState;(this.state.viewState===Y.a.default||this.state.viewState===Y.a.linkSettings&&this.props.mode===c.a.linkSettings)&&(setTimeout(function(){n._writeShareDataToRumoneLogger({mode:l,viewState:u})},0),this._isInitialPageLoadDataLogged=!0),this.state.viewState===Y.a.linkSuccess&&this.props.mode===c.a.copy&&(this._isInitialPageLoadDataLogged=!0),null===(e=this.props.shareLoadingCustomerPromise)||void 0===e||e.forEach(function(e){return(0,Z.f)({customerPromise:e,engagementExtraData:n._engagementExtraData,sharingStore:n._store})})}var f=i.getSharingInformation();f.peoplePickerSettings||(f.peoplePickerSettings={}),(this._isWordFileEnabledFor3S(f)||this._isXPFileEnabledFor3S(f))&&(f.peoplePickerSettings.useNew3Ssearch=!0)}catch(e){this._setGenericErrorState(Z.a.generic,e)}if(this._showAnimation){this._dialogHeightRef={current:new ResizeObserver(function(e){for(var t=0,i=e;t<i.length;t++){var r=i[t];if(r.contentBoxSize){var o=r.contentBoxSize[0].blockSize;0!==o&&o!==n.state.height&&n.setState((0,a.a)((0,a.a)({},n.state),{height:o}))}}})};var p=document.getElementById("share-dialog-container");p&&(null===(t=this._dialogHeightRef)||void 0===t?void 0:t.current)&&this._dialogHeightRef.current.observe(p)}},t.prototype.componentDidUpdate=function(e,t){var n,a;if(this._resizeIfNeeded(),this.state.sharingInformation&&this._logRumone(),this._showSimplifiedDialogV2&&this.state.currentSettings!==t.currentSettings&&t.viewState===Y.a.modifyPermissions&&this._focusCopyButton(),t.viewState===Y.a.permissionsPivot&&this.state.viewState===Y.a.default){var i=te.a.LimitedSharing;(null===(n=this.state.sharingInformation)||void 0===n?void 0:n.requiresAccessApproval)&&(i=te.a.LinkReShare),this._sharingInfoBarInformation={sharingInfoBarMessageTypeId:i}}t.viewState===Y.a.linkSuccess&&this.state.viewState===Y.a.modifyPermissions&&(i=te.a.LimitedSharingExisting,(null===(a=this.state.sharingInformation)||void 0===a?void 0:a.requiresAccessApproval)&&(i=te.a.LinkReShare),this._sharingInfoBarInformation={sharingInfoBarMessageTypeId:i})},t.prototype.render=function(){var e,t,n,i,r,s=this,l=this.props.copyLinkShortcut,u=this.state,f=u.sharingInformation,p=u.currentSettings,m=u.showActivityIndicator,_=u.sharingLinkCreated,h="od-Share ".concat(this.props.fullScreenIframeMode?"not-IE":""," ").concat(this._useSimplifiedDialog&&"od-SimplifiedShare"),y=!1;if(!H.S()&&f&&p&&l&&_&&this.state.viewState!==Y.a.error&&this.state.viewState!==Y.a.policyDetails)y=!0,i=this._renderPostCopyShortcutView();else switch(this.state.viewState){case Y.a.error:i=this._renderError(f);var S="generic share link failure";L.A(this.state.shareType,this.state.sharingInformation.rawError||S,this.state.sharingInformation.errorCategory,this.state.sharingInformation.errorMessage),null===(e=this._shareCustomerPromise)||void 0===e||e.forEach(function(e){return(0,Z.e)({customerPromise:e,rawErrorMessage:f.rawError||S,engagementExtraData:s._engagementExtraData,errorType:f.rawError?Z.a.api:Z.a.generic,sharingStore:s._store})}),this._shareCustomerPromise=void 0;break;case Y.a.default:case Y.a.shareToTeams:h+=m?" od-Share--hasActivity":"",y=!0,i=this._renderShareMain(this.state.sharingInformation,this.state.currentSettings);break;case Y.a.modifyPermissions:y=!0,i=v.createElement(v.Fragment,null,this._renderModifyPermissions(Y.a.modifyPermissions),this._renderActivityIndicator());break;case Y.a.linkSuccess:null===(t=this._shareCustomerPromise)||void 0===t||t.forEach(function(e){return(0,Z.f)({customerPromise:e,engagementExtraData:s._engagementExtraData,sharingStore:s._store})}),this._shareCustomerPromise=void 0,i=this._renderNotification();break;case Y.a.permissionsList:y=!0,i=this._renderPermissionsList();break;case Y.a.permissionsPivot:y=!0,i=this._renderPermissionsPivot();break;case Y.a.policyDetails:i=v.createElement(v.Fragment,null,this._renderBackButtonForPolicyDetails(),this._renderPolicyDetails());break;case Y.a.atMention:h="",i=this._renderAtMention();break;case Y.a.linkSettings:h+=m?" od-Share--hasActivity":"",y=!0,i=v.createElement(v.Fragment,null,this._renderModifyPermissions(Y.a.linkSettings));break;case Y.a.notify:p.sharingLinkKind=o.a.direct,p.audience=d.a.existing,this._engagementExtraData=(0,a.a)((0,a.a)({},this._engagementExtraData),{appMap:f.item.appmap}),h="",i=v.createElement(v.Suspense,{fallback:v.createElement(b.a,null)},v.createElement(J.k,(0,a.a)({},this._baseProps,{currentSettings:p,sharingInformation:f,engagementExtraData:this._engagementExtraData,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig})));break;case Y.a.addPeople:y=!0,i=this._renderAddPeople();break;case Y.a.spinner:default:if(!H.r()&&(null===(n=this.props.hostOptions)||void 0===n?void 0:n.allowHostToHandleLoading)&&this.props.mode===c.a.copy)break;i=v.createElement("div",{className:"od-Share-spinnerHolder"},v.createElement(b.a,{className:"od-Share-spinner",label:E.zb,size:g.a.large,styles:{circle:{width:"1.75rem",height:"1.75rem",borderWidth:"0.09375rem"},label:{fontSize:"0.75rem"}}}))}if(y||h){var D=y?this._sizeConstraints:{};this._showAnimation?(D=(0,a.a)((0,a.a)({},D),{height:this.state.height}),h+=" animation",r=v.createElement("div",{className:h,style:D},v.createElement("div",{id:"share-dialog-container"},i))):r=v.createElement("div",{className:h,style:D},i)}else r=i;var C=I.m(this.props.clientId)?" teams":"";return v.createElement(x.a,null,v.createElement("div",{ref:this._topLevelDivRef,role:"presentation",className:C+" isFluent"},r))},t.prototype._sharingStoreListener=function(e){var t,n,i,o=this,d=this._store;try{if(this.state.viewState===Y.a.error)return;if(this.props.mode===c.a.copy&&e&&e.type===z.b.UnshareLink)return;this._useSimplifiedDialog&&d.parsePermissions&&void 0!==d.getSharingInformation()&&d.parsePermissions();var l=d.getSharingInformation(),f=d.getSharingLinkCreated(),p=d.getCompanyName(),m=d.getGroupsMemberCount(),_=d.getPolicyTipInformation(),h=d.getPermissionsMap(),b=d.getDefaultRecipients();if(this._outlookAvailability=d.getOutlookAvailability()||(null===(t=this.props.hostOptions)||void 0===t?void 0:t.outlookAvailability),this._isPeopleSharingLinksEnabled=d.isPeopleSharingLinksEnabled(),!l)return;this._setEngagementExtraData({webTemplateId:l.webTemplateId,itemUniqueId:l.itemUniqueId,isPremium:!!l.isPremium,requiresAccessApproval:!!l.requiresAccessApproval,userRole:r.a[l.userRole],hasInheritedLinks:!!l.hasInheritedLinks}),l.isStubFile&&(this._store.getEngagementHelper().shareErrorFileIsUploading(this._engagementExtraData),d.fetchSharingInformation(!0,!0));var g=this._store.getItemInformationForLogging(),v=g.itemType,y=g.extension;this._engagementExtraData.itemType=v,this._engagementExtraData.extension=y,this._sanitizeSharingContextInfo(l);var D=this._getSettings(l),I=(0,a.a)({},this.state);this.state.viewState===Y.a.spinner&&(I.viewState=this._getInitialViewState(l,D,f),I.viewState!==Y.a.spinner&&(H.S()&&this.props.mode===c.a.copy?this._sharingClientMessenger?this._sharingClientMessenger.sendShareReady():L.r(this._shareClickTime,this.props.clientId,c.a.copy,this.props.scenarioId,this.props.correlationId):this._sharingClientMessenger?this._sharingClientMessenger.sendShareUIReady():L.D()));var x=!!f;if(H.S()&&this.props.shareId&&(x=(null==e?void 0:e.type)===z.b.ShareLink),(null==e?void 0:e.type)!==z.b.ShareLink&&(null==e?void 0:e.type)!==z.b.GrantAccess||(I.showSendButtonSpinner=!1),l&&l.error||(null==l?void 0:l.isStubFile))!(null==l?void 0:l.error)||l.errorCategory!==u.a.shareLink&&l.errorCategory!==u.a.shareObject&&l.errorCategory!==u.a.createLink&&l.errorCategory!==u.a.invite?null===(i=this.props.shareLoadingCustomerPromise)||void 0===i||i.forEach(function(e){return(0,Z.e)({customerPromise:e,rawErrorMessage:(null==l?void 0:l.isStubFile)?new Error("Is stub file"):null==l?void 0:l.rawError,engagementExtraData:o._engagementExtraData,errorType:Z.a.api,sharingStore:o._store})}):(null===(n=this._shareCustomerPromise)||void 0===n||n.forEach(function(e){return(0,Z.e)({customerPromise:e,rawErrorMessage:l.error,engagementExtraData:o._engagementExtraData,errorType:l.error||l.errorMessage?Z.a.api:Z.a.generic,sharingStore:o._store})}),this._shareCustomerPromise=void 0,(null==e?void 0:e.type)!==z.b.GrantAccess&&this.state.shareType!==s.a.grantAccess&&(I.copyLinkToastStatus=Pe.a.error,this._showSimplifiedDialogV2&&(I.copyMessageBarStatus=de.error))),this._flushAriaAndReportError(l),l.errorCategory===u.a.shareLink&&this.props.mode!==c.a.copy?(I.viewState=Y.a.default,I.copyLinkToastStatus=Pe.a.error,this._showSimplifiedDialogV2&&(I.copyMessageBarStatus=de.error)):l.errorCategory===u.a.shareObject?I.viewState=Y.a.default:(this._engagementExtraData.errorCategory=l.errorCategory,this._engagementExtraData.errorMessage=l.errorMessage,this._engagementExtraData.isStubFile=l.isStubFile,I.viewState=Y.a.error),H.tb()&&S.i(l.error)&&l.errorCategory===u.a.invite&&(I.viewState=this.state.viewState),I.sharingInformation=l;else if((e&&e.type===z.b.ShareLink||this.props.shareId)&&x&&(this.state.shareTargetClicked||this.props.copyLinkShortcut||this.state.applyLinkSettingsClicked)){var C=this._handleCreatedShareLink({settings:D,sharingInformation:l,sharingLinkCreated:f,viewState:I.viewState});I=(0,a.a)((0,a.a)({},I),C)}else e&&e.type===z.b.GrantAccess?I=(0,a.a)((0,a.a)({},I),{viewState:this._store.getGrantAccessResult()?Y.a.linkSuccess:this.state.viewState}):(!this.props.copyLinkShortcut||!l||this.props.shareId||l.error||this._copyLinkShortcutInvoked||(this._copyLinkShortcutInvoked=!0,this._onCopyLinkClicked({copyLinkShortcut:!0,initializedSettings:D,shareTargetClicked:!1})),I=(0,a.a)((0,a.a)({},I),{sharingInformation:l,companyName:p,groupsMemberCount:m,currentSettings:D,policyTipInformation:_,isLoadingDefaultRecipients:d.isValidatingDefaultRecipients(),showActivityIndicator:!1,permissionsMap:h}),b&&!b.isConsumed&&(I.linkRecipients=b.recipients,this._store.consumeDefaultRecipients()));if(H.Wb()&&!this.state.summaryText&&!I.summaryText){var O=d.getDocumentInformation();O&&O.documentSummary&&(I=(0,a.a)((0,a.a)({},I),{summaryText:O.documentSummary}),this._engagementExtraData.withSummary=!0,this._engagementExtraData.withSummaryFailed=-1!==O.documentSummary.indexOf("Something went wrong with retrieving a summary"))}if(this.props.shouldWaitForSharingInfoBarInformation&&H.qb()&&!this.state.sharingInfoBarInformation&&!I.sharingInfoBarInformation&&!this._showSharingBanner){var w=d.getSharingInfoBarInformation();w&&w.sharingInfoBarMessageTypeId&&(I=(0,a.a)((0,a.a)({},I),{sharingInfoBarInformation:w}))}this.setState(I)}catch(e){this._setGenericErrorState(Z.a.generic,e)}},t.prototype._handleCreatedShareLink=function(e){var t=e.sharingInformation,n=e.settings,i=e.sharingLinkCreated,r=e.initialState,o=e.viewState,s=this._store.getCompanyName(),d=r||this.state,l=(0,a.a)({},d);this._modifiedSharingLinkUrl=(0,w.C)(i,d.shareType,this._store);var u=d.shareType,f=d.currentSettings,p=f?f.isEdit:n.isEdit,m=f?f.isReview:n.isReview,_=f?f.preventDownload:n.preventDownload,h=f?f.audience:n.audience,b=A.k(h,t.sharingAbilities,t.fileExtension),g=A.n(h,t.sharingAbilities,t.fileExtension),v={audience:i.audience,isEdit:p,isReview:g&&m,daysUntilExpiry:this._getNumberOfDaysUntilExpiry(i),sharingLinkKind:i.sharingLinkKind,isDefaultLink:t.defaultSharingLink.sharingLinkKind===i.sharingLinkKind,linkBlocksDownload:!!_,linkWithOfficeReviewMode:b&&m,sharingAudienceChanged:t.defaultSharingLink.audience!==i.audience,shareViewState:o,shareType:d.shareType};this._setEngagementExtraData(v),I.s(this.props.clientId)&&(this._engagementExtraData.sharedToFamilyGroup=d.linkRecipients.some(function(e){return e.familySharingTargetType===T.a.Family}),this._engagementExtraData.sharedToFamilyMember=d.linkRecipients.some(function(e){return e.familySharingTargetType===T.a.FamilyMember}));var y=this._store.getEngagementHelper();y.shareCompleted(this._engagementExtraData),y.logShareLinkGeneration(i,this._engagementExtraData);var S=(0,w.O)(i.sharingLinkKind);return this._sharingClientMessenger?this._sharingClientMessenger.sendShareCompleted():L.z(d.shareType,S),l=(0,a.a)((0,a.a)({},l),this._handleCreatedShareLinkForShareTypes(i,r)),this.props.mode===c.a.linkSettings?L.o(i,s,this.props.customLabeledAudienceConfig,this.state.sharingInformation.sharedObjectType===G.a.list,this.props.clientId):l=(0,a.a)((0,a.a)({},l),{viewState:this._getViewStateFromShareTypeOnLinkSuccess(u,o),sharingLinkCreated:i,companyName:s,showActivityIndicator:!1,sharingInformation:t,currentSettings:this._getSettings(t)}),(0,a.a)((0,a.a)({},l),{showSendButtonSpinner:!1})},t.prototype._getViewStateFromShareTypeOnLinkSuccess=function(e,t){switch(e){case s.a.webShareToTeams:return Y.a.shareToTeams;case s.a.moreApps:return Y.a.default;case s.a.copy:return this._useSimplifiedDialog&&this.props.mode!==c.a.copy&&e===s.a.copy||R.c()&&t==Y.a.default?Y.a.default:Y.a.linkSuccess;default:return Y.a.linkSuccess}},t.prototype._handleCreatedShareLinkForShareTypes=function(e,t){var n,i=this,r=t||this.state,o=(0,a.a)({},r),d=r.shareType,l=this._store.getCompanyName();if(null===(n=this._shareCustomerPromise)||void 0===n||n.forEach(function(e){return(0,Z.f)({customerPromise:e,engagementExtraData:i._engagementExtraData,sharingStore:i._store})}),this._shareCustomerPromise=void 0,d===s.a.outlook||d===s.a.nonOutlook)I.r(this.props.clientId)?(this._store.navigateToOwa(this._getRecipientEmails(r.linkRecipients),this._modifiedSharingLinkUrl),this._sharingClientMessenger?this._sharingClientMessenger.sendOutlookClicked():L.p(),this._dismiss()):L.x(this._getRecipientEmails(this.state.linkRecipients),this.state.linkRecipients.length,this.state.messageText,this._modifiedSharingLinkUrl);else if(d===s.a.mobileShareToTeams)this._dismiss(),this._sharingClientMessenger?this._sharingClientMessenger.sendTeamsClicked(e,this._getRecipientEmails(r.linkRecipients),r.messageText):L.C(e,this._getRecipientEmails(r.linkRecipients),r.messageText);else if(d===s.a.moreApps)try{o=(0,a.a)((0,a.a)({},o),{viewState:Y.a.linkSuccess,companyName:l,sharingLinkCreated:e,showActivityIndicator:!1}),window.external.SendLinkViaMoreApps(e.url)}catch(e){}else if(d===s.a.webShareToTeams){if(this._modifiedSharingLinkUrl){var u="https://teams.microsoft.com/share?href="+this._modifiedSharingLinkUrl+"&referrer=SharePoint.com";this._teamsUrl=u,o=(0,a.a)((0,a.a)({},o),{showTeamsDialog:!0})}}else if(this._useSimplifiedDialog&&d===s.a.copy&&(this.props.mode!==c.a.copy||R.c()&&r.viewState===Y.a.default)){o=(0,a.a)((0,a.a)({},o),{companyName:l,sharingLinkCreated:e,showActivityIndicator:!1});var f={clientId:this.props.clientId,textField:null,linkUrl:this._modifiedSharingLinkUrl,itemName:this.state.sharingInformation.item.name,extraQosData:this._engagementExtraData};(0,w.m)(f).then(function(){i._showSimplifiedDialogV2?i.setCopyMessageBarStatus(de.success):i.setCopyToastStatus(Pe.a.success)}).catch(function(e){i._showSimplifiedDialogV2&&i.setCopyMessageBarStatus(de.error)})}return o},t.prototype._generateInitialStateFromStore=function(){var e,t,n=this,i=this._store;this._useSimplifiedDialog&&i.parsePermissions&&void 0!==i.getSharingInformation()&&i.parsePermissions();var r=i.getSharingInformation(),o=i.getSharingLinkCreated(),d=i.getCompanyName(),l=i.getGroupsMemberCount(),u=i.getPolicyTipInformation(),f=i.getPermissionsMap(),p=i.getDefaultRecipients();if(this._outlookAvailability=i.getOutlookAvailability(),this._isPeopleSharingLinksEnabled=i.isPeopleSharingLinksEnabled(),r){this._engagementExtraData.webTemplateId=r.webTemplateId,this._engagementExtraData.itemUniqueId=r.itemUniqueId;var m=this._store.getItemInformationForLogging(),_=m.itemType,h=m.extension;this._engagementExtraData.itemType=_,this._engagementExtraData.extension=h,r.isStubFile&&(this._store.getEngagementHelper().shareErrorFileIsUploading(this._engagementExtraData),i.fetchSharingInformation(!0,!0));var b=this._getSettings(r);this._engagementExtraData.defaultAudience=null==b?void 0:b.audience;var g=i.getUnhealthyLinks&&(null===(e=i.getUnhealthyLinks())||void 0===e?void 0:e.length);this._engagementExtraData.numUnhealthyLinks=g,this._store.getEngagementHelper().logNumberOfUnhealthyLinks(g);var v=[];p&&!p.isConsumed&&(v=p.recipients||[],this._store.consumeDefaultRecipients());var y=this._getInitialViewState(r,b,o);y!==Y.a.spinner&&(H.S()&&this.props.mode===c.a.copy?this._sharingClientMessenger?this._sharingClientMessenger.sendShareReady():L.r(this._shareClickTime,this.props.clientId,c.a.copy,this.props.scenarioId,this.props.correlationId):this._sharingClientMessenger?this._sharingClientMessenger.sendShareUIReady():L.D());var S=s.a.share;H.S()&&this.props.mode===c.a.copy&&(S=s.a.copy);var D={companyName:d,currentSettings:b,sharingInformation:r,sharingLinkCreated:o,readyToCopy:!1,shareType:S,viewState:y,groupsMemberCount:l,policyTipInformation:u,linkRecipients:v,shareTargetClicked:!1,applyLinkSettingsClicked:!1,showActivityIndicator:!1,permissionsMap:f,messageText:this.props.messageText||"",summaryText:this.props.summaryText||"",summaryState:0,subjectText:this.props.subjectText||"",index:0,isLoadingDefaultRecipients:this._store.isValidatingDefaultRecipients(),isCloseButtonOnFocus:!1,showCopyLinkInterrupt:!1,showTeamsDialog:!1,copyLinkToastStatus:Pe.a.closed,copyMessageBarStatus:de.closed,showSendButtonSpinner:!1,height:this._showAnimation?0:"auto",sharingInfoBarState:this._getInitialSharingInfoBarState()};if(this._sharingInfoBarInformation=this._showSharingBanner&&this._getInitialSharingInfoBarInformation(y),r.error)return null===(t=this.props.shareLoadingCustomerPromise)||void 0===t||t.forEach(function(e){return(0,Z.e)({customerPromise:e,rawErrorMessage:r.rawError,engagementExtraData:n._engagementExtraData,errorType:Z.a.api,sharingStore:n._store})}),this._flushAriaAndReportError(r),(0,a.a)((0,a.a)({},D),{viewState:Y.a.error,sharingInformation:r,height:"auto"});var I=i.getSharingLinkCreated();if(I){var x=this._handleCreatedShareLink({settings:b,sharingInformation:r,sharingLinkCreated:I,initialState:D,viewState:y});D=(0,a.a)((0,a.a)({},D),x)}return D}return null},t.prototype._getInitialViewState=function(e,t,n){switch(this.props.mode){case c.a.share:if(e&&t)return Y.a.default;break;case c.a.atMention:if(e&&t)return Y.a.atMention;break;case c.a.linkSettings:if(t)return Y.a.linkSettings;break;case c.a.manageAccess:if(t)return this._usePermissionsPivot?Y.a.permissionsPivot:Y.a.permissionsList;break;case c.a.copy:if(e&&t&&n)return Y.a.linkSuccess;break;case c.a.notify:if(e)return Y.a.notify;break;case c.a.addPeople:if(e)return Y.a.addPeople;break;default:throw new Error("Mode not implemented: "+this.props.mode)}return Y.a.spinner},t.prototype._renderAtMention=function(){var e,t=this.props.callbacks?this.props.callbacks.onAtMentionComplete:void 0;return v.createElement(v.Suspense,{fallback:v.createElement(b.a,null)},v.createElement(J.a,(0,a.a)({},this._baseProps,{currentSettings:this.state.currentSettings,sharingInformation:this.state.sharingInformation,recipients:this.state.linkRecipients,canGrantEditPermissions:null===(e=this.props.hostOptions)||void 0===e?void 0:e.canGrantEditPermissions,onComplete:t})))},t.prototype._renderPostCopyShortcutView=function(){var e,t,n=this,i=this.state,r=i.sharingInformation,o=i.currentSettings,s=i.companyName,c=i.sharingLinkCreated,d=i.viewState,l=i.groupsMemberCount,u=c&&c.createdViaCopyLinkCommand||this._copyLinkShortcutInvoked;return this._shareCustomerPromise&&d===Y.a.linkSuccess&&(null===(e=this._shareCustomerPromise)||void 0===e||e.forEach(function(e){return(0,Z.f)({customerPromise:e,engagementExtraData:n._engagementExtraData,sharingStore:n._store})}),this._shareCustomerPromise=void 0),v.createElement(X,(0,a.a)({},this._baseProps,{mode:this.props.mode,shareId:this.props.shareId,companyName:s,currentSettings:o,item:r.item,onLinkPermissionsApplyClicked:this._copyLinkOnApplyClicked,onLinkPermissionsCancelClicked:this._copyLinkOnCancelClicked,onSelectedPeopleChange:this._onSelectedPeopleChange,onShareHintClick:this._getNotificationHintClickHandler(u),sharingInformation:r,showExistingAccessOption:this.props.showExistingAccessOption,viewState:d,groupsMemberCount:l,onViewPolicyTipClicked:this._onViewPolicyTipClicked,createPeopleSharingLinks:this._isPeopleSharingLinksEnabled,displayUrl:this._modifiedSharingLinkUrl,engagementExtraData:this._engagementExtraData,recipients:this.state.linkRecipients,isLoadingDefaultRecipients:this.state.isLoadingDefaultRecipients,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,omitCustomLabeledAudience:this.props.omitCustomLabeledAudience,preferCustomLabeledAudience:this.props.preferCustomLabeledAudience,hostOptions:this.props.hostOptions,onShareNotificationRenderComplete:c&&function(){n._writeShareDataToRumoneLogger({mode:n.props.mode,viewState:n.state.viewState})},shouldWaitForSharingInfoBarInformation:this.props.shouldWaitForSharingInfoBarInformation,sharingInfoBarMessageTypeId:null===(t=this.state.sharingInfoBarInformation)||void 0===t?void 0:t.sharingInfoBarMessageTypeId,onShowPermissionsListClicked:this._showPermissionsList}))},t.prototype._renderError=function(e){return v.createElement(v.Suspense,{fallback:v.createElement(b.a,null)},v.createElement(J.f,(0,a.a)({},this._baseProps,{theme:this.props.theme,viewState:Y.a.error,sharingInformation:e,showReportProblem:this._store.isReportProblemSupported()})))},t.prototype._getSettings=function(e){var t,n=this,a=null===(t=this.state)||void 0===t?void 0:t.currentSettings,i=e&&e.error,o=e.sharingLinks&&e.sharingLinks.length&&this.props.shareId,s=A.f(e.sharingAbilities,e.sharingLinkTemplates),c=!1;if(!a&&!i){var d,l=e.defaultSharingLink;o&&(d=e.sharingLinks.filter(function(e){return e.shareId===n.props.shareId&&e.isActive})[0])&&(l=d,c=!0),void 0!==s&&s.length>0&&((d=s.filter(function(t){return t.sharingLinkKind===e.defaultSharingLink.sharingLinkKind})[0])||(d=s.filter(function(t){return t.audience===e.defaultSharingLink.audience})[0])?(l=d,c=!0):(l=s[0],c=!0)),a=this._initializeCurrentSettings(l,e,this.props.copyLinkShortcut,c),s.length>0&&(a.shareId=l.shareId,a.fetchLinkOnly=!0,a.audience=l.audience,a.expiration=l.expiration,a.isEdit=l.isEdit,a.isReview=l.isReview,a.sharingRole=l.isEdit?(0,w.r)(this.props.clientId,e):l.isReview?r.a.review:r.a.view,a.trackLinkUsers=l.trackLinkUsers,a.preventDownload=l.blockDownload,a.sharingLinkKind=l.sharingLinkKind,this._engagementExtraData.isRedeemedUserResharing=!0,this._engagementExtraData.redeemedLinksCount=s.length)}return a},t.prototype._getRecipientEmails=function(e){for(var t=[],n=0,a=e;n<a.length;n++){var i=a[n].email;i&&t.push(i)}return t},t.prototype._getNumberOfDaysUntilExpiry=function(e){var t=e.expiration&&new Date(e.expiration),n=new Date;if(t){var a=(t.getTime()-n.getTime())/864e5;return Math.floor(a)}},t.prototype._handleEscKeyPress=function(e){this._viewStates.length>0?this._returnToPreviousView():this._dismiss(),e.stopImmediatePropagation()},t.prototype._initializeCurrentSettings=function(e,t,n,a){if(this._store.isConsumer())return this._store.getInitialLinkSettings(e);if(R.c()){var i=this._store.getReShareLink(d.a.organization)||this._store.getReShareLink(d.a.anyone);if(t.requiresAccessApproval&&i)return{allowEditing:!1,audience:i.audience,expiration:i.expiration||null,isEdit:!1,sharingRole:(0,w.K)(i,this.props.clientId,t),sharingLinkKind:i.sharingLinkKind,specificPeople:[],updatePassword:!1,password:"",preventDownload:i.blockDownload,shareId:"",trackLinkUsers:!1,sharingScope:i.sharingScope}}if(t.requiresAccessApproval&&n){var s=(0,w.r)(this.props.clientId,t),c=!0;return R.c()&&(s=t.userRole||s,c=!1),{allowEditing:c,audience:d.a.existing,expiration:null,isEdit:!0,sharingRole:s,sharingLinkKind:o.a.direct,specificPeople:[],updatePassword:!1,password:"",preventDownload:!1,shareId:"",trackLinkUsers:!1,sharingScope:e.sharingScope}}if(t.defaultSharingLink===e&&t.sharingAbilities)return this._initializeCurrentSettingsWithSharingAbilities(e,t,n,!!H.Gb()&&!!this.props.overrideDefaultPermission);if(e.audience===d.a.specificPeople)if(!t.canManagePermissions||t.blockPeoplePickerAndSharing)e.audience=d.a.existing;else if(this._isPeopleSharingLinksEnabled)return{allowEditing:!0,audience:d.a.specificPeopleFlex,expiration:null,isEdit:!0,sharingRole:(0,w.r)(this.props.clientId,t),sharingLinkKind:o.a.flexible,specificPeople:[],updatePassword:!1,password:"",preventDownload:!1,shareId:"",trackLinkUsers:!1,sharingScope:e.sharingScope};e.audience===d.a.specificPeopleFlex&&n&&!a&&(e.audience=d.a.existing,e.sharingLinkKind=o.a.direct);var l=e.sharingLinkKind,u=l===o.a.anonymousEdit||l===o.a.organizationEdit||l===o.a.direct||l===o.a.flexible,f=e.isEdit&&2===t.defaultShareLinkPermission,p=[];this.props.shareId&&e.principals&&(p=(0,w.B)(e));var m=H.pc()?r.a.view:(0,w.K)(e,this.props.clientId,t);return{allowEditing:u,audience:(this.props.preferCustomLabeledAudience||!H.Lb()&&(0,w.S)(this.props.clientId,this.props.mode,this.props.customLabeledAudienceConfig))&&e.audience===d.a.specificPeopleFlex?d.a.customLabeledSpecificPeople:e.audience,expiration:e.expiration||null,isEdit:f,sharingRole:f?(0,w.r)(this.props.clientId,t):m,sharingLinkKind:e.sharingLinkKind,specificPeople:p,updatePassword:!1,password:"",preventDownload:e.blockDownload,shareId:"",trackLinkUsers:t.anyoneLinkTrackUsers,sharingScope:e.sharingScope}},t.prototype._initializeCurrentSettingsWithSharingAbilities=function(e,t,n,a){var i,s,c,l,u=t.sharingAbilities,m="00000000-0000-0000-0000-000000000000"===this.props.shareId,_=m?o.a.direct:t.defaultSharingLink.sharingLinkKind,h=m?f.a.existing:t.defaultSharingLink.sharingScope,b=(0,w.S)(this.props.clientId,this.props.mode,this.props.customLabeledAudienceConfig)?d.a.customLabeledSpecificPeople:d.a.specificPeople;if(t.defaultShareLinkToExistingAccess)b=d.a.existing,_=o.a.direct;else if(null!=h)switch(h){case f.a.anyone:b=d.a.anyone;break;case f.a.organization:b=d.a.organization;break;case f.a.specificPeople:(H.Lb()||b!==d.a.customLabeledSpecificPeople)&&(b=d.a.specificPeopleFlex);break;case f.a.existing:default:m||!t.canManagePermissions||t.blockPeoplePickerAndSharing?b=d.a.existing:this._isPeopleSharingLinksEnabled?(b!==d.a.customLabeledSpecificPeople&&(b=d.a.specificPeopleFlex),_=o.a.flexible):b=d.a.existing}else switch(_){case o.a.anonymousEdit:case o.a.anonymousView:b=d.a.anyone;break;case o.a.organizationEdit:case o.a.organizationView:b=d.a.organization;break;case o.a.direct:default:m||!t.canManagePermissions||t.blockPeoplePickerAndSharing?b=d.a.existing:this._isPeopleSharingLinksEnabled?(b!==d.a.customLabeledSpecificPeople&&(b=d.a.specificPeopleFlex),_=o.a.flexible):b=d.a.existing}b===d.a.specificPeopleFlex&&n&&(b=d.a.existing,_=o.a.direct);var g=null,v=A.e(b,u).linkExpiration;(v?v.defaultExpirationInDays:null)>0&&(g=new Date((new Date).toDateString())).setDate(g.getDate()+v.defaultExpirationInDays);var y=6===t.defaultShareLinkPermission,S=!A.g(d.a.specificPeople,u,p.a.forceCheckoutEditLink),D=this._showSimplifiedDialogV2?S:A.h(b,u);H.Gb()&&(this._engagementExtraData.didOverrideTenantDefaultPermission=!1);var I,x=D&&2===t.defaultShareLinkPermission&&(!H.Gb()||!this._shouldOverrideIsEditToFalse(a,e.audience,t.sharingAbilities,t)),C=x?(0,w.r)(this.props.clientId,t):y?r.a.review:r.a.view;(I=7===t.defaultShareLinkPermission)&&(C=this._isVideo&&this._showSimplifiedDialogV2?r.a.restrictedview:r.a.view);var O=(null===(s=null===(i=this.props)||void 0===i?void 0:i.hostOptions)||void 0===s?void 0:s.hiddenAudienceOptions)||[],E=(null===(l=null===(c=this.props)||void 0===c?void 0:c.hostOptions)||void 0===l?void 0:l.disabledAudienceOptions)||[];return b=-1===O.indexOf(b)&&-1===E.indexOf(b)?b:d.a.existing,A.i(b,u)&&(b=d.a.existing),{allowEditing:D,audience:b,expiration:g,isEdit:x,sharingRole:C,isReview:y,preventDownload:I,sharingLinkKind:b===d.a.existing?o.a.direct:H.Gb()?this._getSharingLinkKindAfterReadOverrideCheck(a,_,e.audience,t.sharingAbilities):_,specificPeople:[],updatePassword:!1,password:"",shareId:"",trackLinkUsers:t.anyoneLinkTrackUsers,sharingScope:e.sharingScope}},t.prototype._setEngagementExtraData=function(e){var t,n,i=this.state,o=this.props,s=null==i?void 0:i.currentSettings;this._engagementExtraData=(0,a.a)((0,a.a)((0,a.a)({},this._engagementExtraData),{scenarioId:o.scenarioId,correlationId:this._correlationId,hostSessionId:o.hostSessionId||"",mode:o.mode||(o.copyLinkShortcut?c.a.copy:c.a.share),withSummary:!!o.summaryText,withSummaryFailed:!!o.summaryText&&-1!==o.summaryText.indexOf("Something went wrong with retrieving a summary"),audience:null==s?void 0:s.audience,isEdit:null==s?void 0:s.isEdit,isReview:null==s?void 0:s.isReview,sharingRole:r.a[null==s?void 0:s.sharingRole],recipientsCount:null===(t=null==i?void 0:i.linkRecipients)||void 0===t?void 0:t.length,externalRecipientsCount:null==i?void 0:i.externalRecipientsCount,linkedinRecipientsCount:null==i?void 0:i.linkedinRecipientsCount,hasMessage:!!(null==i?void 0:i.hasMessage),hasSubject:!!(null==i?void 0:i.hasSubject),messageLength:null==i?void 0:i.messageLength,shareViewState:null==i?void 0:i.viewState,hasNavId:!!this._store.getNavId(),groupRecipientCount:null===(n=null==i?void 0:i.linkRecipients)||void 0===n?void 0:n.filter(function(e){return e.entityType===D.a.group&&null==e.familySharingTargetType}).length,isSimplifiedShareDialog:this._showSimplifiedDialog,isSimplifiedShareDialogV2:this._showSimplifiedDialogV2,isWebview2:!H.n()&&(0,Bt.b)(o.scenarioId),timeToShareDuration:Date.now()-this._shareComponentRenderedTime,shareType:null==i?void 0:i.shareType}),e)},t.prototype._shouldOverrideIsEditToFalse=function(e,t,n,a){var i=this.props.scenarioId,r=e&&A.l(t,a,n,a.requiresAccessApproval,i),o=e&&A.m(t,n,i);return(o||r)&&(this._engagementExtraData.didOverrideTenantDefaultPermission=!0),!H._c()&&this._showSimplifiedDialogV2?r:o},t.prototype._getSharingLinkKindAfterReadOverrideCheck=function(e,t,n,a){if(!e||!A.m(n,a,this.props.scenarioId))return t;var i=this._getOverriddenSharingLinkKind(t);return i!==t&&(this._engagementExtraData.didOverrideTenantDefaultPermission=!0),i},t.prototype._getOverriddenSharingLinkKind=function(e){switch(e){case o.a.organizationEdit:return o.a.organizationView;case o.a.anonymousEdit:return o.a.anonymousView;default:return e}},t.prototype._loadTheme=function(e){try{var t=e;(0,M.G)(t)}catch(e){}},t.prototype._onRedirectTeamsClicked=function(){var e=this;this._store.getEngagementHelper().webShareToTeamsTargetClicked(this._engagementExtraData),this._store.getEngagementHelper().shareCompleted(this._engagementExtraData),this.setState({shareType:s.a.webShareToTeams,shareTargetClicked:!0,viewState:Y.a.shareToTeams},function(){e._store.shareLink({settings:e.state.currentSettings,recipients:e.state.linkRecipients,copyLinkCommand:!1,shareType:s.a.webShareToTeams}),e._viewStates.push(e.state.viewState)})},t.prototype._onCopyLinkClicked=function(e){var t;return(0,a.b)(this,void 0,void 0,function(){var n,i,r,o,l,u,f,p,m,_,h=this;return(0,a.e)(this,function(b){switch(b.label){case 0:return n=e.copyLinkShortcut,i=e.initializedSettings,r=e.shareTargetClicked,o=void 0===r||r,l=(0,a.a)((0,a.a)({sendInvitation:!1},i),null===(t=this.state)||void 0===t?void 0:t.currentSettings),this._copyTargetClickTime=Date.now(),u=new W.a({scenario:(0,K.a)("ShareDialog.shareLink"),perfGoalInMs:3e4,extraData:{sharingScenario:"copyLink"}}),(f=(0,Z.c)(this.props.clientId))?(p=new W.a({scenario:"".concat(f,"-ShareDialog.shareLink"),perfGoalInMs:3e4,extraData:{sharingScenario:"copyLink"}}),this._shareCustomerPromise=[u,p]):this._shareCustomerPromise=[u],(m=this.props.mode!==c.a.copy)?[4,this._store.shouldInterruptCopyLink(l.isEdit)]:[3,2];case 1:m=b.sent(),b.label=2;case 2:return m?(this._store.getEngagementHelper().copyLinkInterruptOpened(this._engagementExtraData),this.setState({showCopyLinkInterrupt:!0})):(_=this.state.copyLinkToastStatus,this._showSimplifiedDialog&&(_=Pe.a.inProgress),this.setState({shareType:s.a.copy,shareTargetClicked:o,copyLinkToastStatus:_},function(){var e=h.state.linkRecipients;h._store.isConsumer()&&(null==l?void 0:l.audience)!==d.a.specificPeople&&(e=[]),h._store.shareLink({settings:l,recipients:e,copyLinkCommand:n,shareType:s.a.copy})})),[2]}})})},t.prototype._onSelectedPermissionsChange=function(e){var t=this.state.permissionsMap;e.audience===d.a.existing?this._store.checkPermissions(this.state.linkRecipients):t={};var n=Y.a.default;this.props.mode===c.a.linkSettings?n=this.state.viewState:this._viewStates&&this._viewStates.length>0&&(n=this._viewStates.pop());var a=this.state.linkRecipients;H.Y()&&this.props.mode!==c.a.share&&(a=e.specificPeople),this.setState({viewState:n,currentSettings:{allowEditing:e.allowEditing,trackLinkUsers:e.trackLinkUsers,audience:e.audience,expiration:e.expiration,isEdit:e.isEdit,isReview:e.isReview,sharingRole:e.sharingRole,sharingLinkKind:e.sharingLinkKind,specificPeople:e.specificPeople,updatePassword:e.updatePassword,password:e.password,hasPassword:e.hasPassword,preventDownload:e.preventDownload,shareId:e.shareId,fetchLinkOnly:e.fetchLinkOnly,requireSignIn:e.audience===d.a.specificPeople,sharingScope:e.sharingScope},permissionsMap:t,linkRecipients:a})},t.prototype._renderBackButtonForPriorView=function(){if(this._viewStates.length>0)return P.b(v.createElement(O.d,{className:"od-Share-backButton absolute priorView",id:"od-Share-prevView-backButton",onClick:this._returnToPreviousView,iconProps:{iconName:"Back"},ariaLabel:E.db}),E.db,{tooltipId:"od-Share-backButton-tooltip",position:ne.a.bottomCenter,targetElementId:"od-Share-prevView-backButton"})},t.prototype._renderBackButtonForPolicyDetails=function(){if(this.state.viewState===Y.a.policyDetails)return P.b(v.createElement(O.d,{className:"od-Share-backButton absolute",onClick:this._returnToPreviousView,iconProps:{iconName:"Back"},ariaLabel:E.db}),E.db)},t.prototype._renderShareMain=function(e,t){var n,i,r=this._checkShouldRenderInfoBar(),o=this._showSharingBanner?null===(n=this._sharingInfoBarInformation)||void 0===n?void 0:n.sharingInfoBarMessageTypeId:null===(i=this.state.sharingInfoBarInformation)||void 0===i?void 0:i.sharingInfoBarMessageTypeId;return v.createElement("div",{className:"od-Share-shareMainDiv",style:{maxHeight:this._maxHeight}},!this._useSimplifiedDialog&&this._renderBackButtonForPriorView(),this._useSimplifiedDialog?v.createElement(_t,(0,a.a)({},this._baseProps,{key:"simplified-share",companyName:this.state.companyName,copyButtonRef:this._copyBtnRef,copyLinkToastStatus:this.state.copyLinkToastStatus,copyMessageBarStatus:this.state.copyMessageBarStatus,createPeopleSharingLinks:this._isPeopleSharingLinksEnabled,currentSettings:t,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,engagementExtraData:this._engagementExtraData,focusCopyButton:this._focusCopyButton,groupsMemberCount:this.state.groupsMemberCount,isFREAbandoned:this._isFREAbandoned,index:this.state.index,item:e.item,linkRecipients:this.state.linkRecipients,messageText:this.state.messageText,summaryState:this.state.summaryState,permissionsMap:this.state.permissionsMap,permissionsLabel:this._getPermissionsLabel((0,w.w)(this._getLabelProps())),sharingInformation:e,outlookAvailability:this._outlookAvailability,fullscreenIframeMode:this.props.fullScreenIframeMode,getGraphToken:this.props.getGraphToken,onAudienceChange:this._onAudienceChange,onRoleChange:this._onRoleChange,onShareTargetClicked:this._onShareTargetClicked,onSelectedPeopleChange:this._onSelectedPeopleChange,onSendLinkClicked:this._showSimplifiedDialogV2?this._onGrantDirectAccess:this._onSendLinkClicked,onSendLinkMessageChange:this._onSendLinkMessageChange,onSendLinkSummaryStateChange:this._onSendLinkSummaryStateChange,onViewPolicyTipClicked:this._onViewPolicyTipClicked,shouldRenderSharingInfoBar:r,showLinkSettings:this._showModifyPermissions,showPermissionsList:this._showPermissionsList,setCopyToastStatus:this.setCopyToastStatus,setCopyMessageBarStatus:this.setCopyMessageBarStatus,setIndex:this._setFREIndex,sharingInfoBarMessageTypeId:o,showSendButtonSpinner:this.state.showSendButtonSpinner,renderSharingInfoBar:this._renderSharingInfoBar,returnToPreviousView:this._returnToPreviousView,getStatusIcons:this._getStatusIcons,renderBackButton:this._viewStates.length>0,generateSummary:this.props.generateSummary})):v.createElement(m.b,(0,a.a)({},this._baseProps,{key:"share",ref:this._shareMainControl,companyName:this.state.companyName,currentSettings:t,item:e.item,onSelectedPeopleChange:this._onSelectedPeopleChange,onSendLinkClicked:this._onSendLinkClicked,onShareHintClick:this._showModifyPermissions,onShowPermissionsListClicked:this._showPermissionsList,sharingInformation:e,groupsMemberCount:this.state.groupsMemberCount,onViewPolicyTipClicked:this._onViewPolicyTipClicked,linkRecipients:this.state.linkRecipients,permissionsMap:this.state.permissionsMap,messageText:this.state.messageText,summaryText:this.state.summaryText,subjectText:this.state.subjectText,onSendLinkMessageChange:this._onSendLinkMessageChange,onSendLinkSubjectChange:this._onSendLinkSubjectChange,onShareTargetClicked:this._onShareTargetClicked,hideShareDialogOverflowButton:this.props.hideShareDialogOverflowButton,createPeopleSharingLinks:this._isPeopleSharingLinksEnabled,outlookAvailability:this._outlookAvailability,engagementExtraData:this._engagementExtraData,isLoadingDefaultRecipients:this.state.isLoadingDefaultRecipients,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,closeButtonOnFocus:this._closeButtonOnFocus,closeButtonOnBlur:this._closeButtonOnBlur,onRoleChange:this._onRoleChange,onAudienceChange:this._onAudienceChange,fullScreenIframeMode:this.props.fullScreenIframeMode,getGraphToken:this.props.getGraphToken,hasBackButton:this.props.mode===c.a.manageAccess,onBackButtonClicked:this._returnToPreviousView,showItemInsights:this.props.showItemInsights,shouldWaitForSharingInfoBarInformation:this.props.shouldWaitForSharingInfoBarInformation,sharingInfoBarMessageTypeId:o})),this.state.showCopyLinkInterrupt&&this._renderCopyLinkInterrupt({updatePassword:!!t.password}),this.state.showTeamsDialog&&this._renderTeamsDialog())},t.prototype._renderTeamsDialog=function(){return v.createElement(v.Suspense,{fallback:v.createElement(b.a,null)},v.createElement(J.n,{url:this._teamsUrl,onDismiss:this._dismiss,height:this.props.calculatedIframeHeight,onBackButtonClicked:this._returnToPreviousView.bind(this)}))},t.prototype._renderPolicyDetails=function(){return v.createElement(v.Suspense,{fallback:v.createElement(b.a,null)},v.createElement(J.m,{clientId:this.props.clientId,sharingInformation:this.state.sharingInformation,policyTipInformation:this.state.policyTipInformation,onBackButtonClicked:this._returnToPreviousView}))},t.prototype._renderCopyLinkInterrupt=function(e){var t=e.updatePassword;return v.createElement(v.Suspense,{fallback:v.createElement(b.a,null)},v.createElement(J.c,{confirmationCode:t?12:13,participant:null,onApply:t?this._onInterruptUseNew:this._onInterruptUseExisting,onCancel:this._onInterruptCancel,onDiscard:t?this._onInterruptUseExisting:this._onInterruptUseNew}))},t.prototype._renderModifyPermissions=function(e){var t=this._checkShouldRenderInfoBar();return v.createElement(v.Suspense,{fallback:v.createElement(b.a,null)},v.createElement(J.h,(0,a.a)({},this._baseProps,{shareId:this.props.shareId,mode:this.props.mode,companyName:this.state.companyName,currentSettings:this.state.currentSettings,doesCreate:!0,onCancel:this._onLinkPermissionsCancelClicked,onSelectedPermissionsChange:this.state.copyLinkShortcut?this._copyLinkOnApplyClicked:this._onLinkPermissionsApplyClicked,onSelectedPeopleChange:this._onSelectedPeopleChange,sharingInformation:this.state.sharingInformation,showExistingAccessOption:!0,groupsMemberCount:this.state.groupsMemberCount,onViewPolicyTipClicked:this._onViewPolicyTipClicked,createPeopleSharingLinks:this._isPeopleSharingLinksEnabled,copyLinkShortcut:this.state.copyLinkShortcut,engagementExtraData:this._engagementExtraData,recipients:this.state.linkRecipients,isLoadingDefaultRecipients:this.state.isLoadingDefaultRecipients,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,omitCustomLabeledAudience:this.props.omitCustomLabeledAudience,preferCustomLabeledAudience:this.props.preferCustomLabeledAudience,onShowPermissionsListClicked:this._showPermissionsList,fullScreenIframeMode:this.props.fullScreenIframeMode,maxHeight:this._maxHeight,renderBackButton:this._viewStates.length>0,renderSharingInfoBar:this._renderSharingInfoBar,shouldRenderSharingInfoBar:t,shouldAnnounceModeChange:this._viewStates.length>0,onLinkSettingsInfoMessageClick:this._onLinkSettingsInfoMessageClick})),this.state.showCopyLinkInterrupt&&this._renderCopyLinkInterrupt({updatePassword:!!this.state.currentSettings.password}))},t.prototype._renderNotification=function(){var e,t,n=this,i=this.state,r=i.sharingInformation,o=i.sharingLinkCreated,d=i.shareType===s.a.share?this.state.linkRecipients:null;this._showSimplifiedDialogV2&&(d=i.shareType===s.a.share||i.shareType===s.a.grantAccess?this.state.linkRecipients:null),H.$b()&&(d=this.state.linkRecipients);var l={companyName:i.companyName,currentSettings:i.currentSettings,sharingInformation:r,clientId:this.props.clientId,onShareHintClick:this._getNotificationHintClickHandler(o&&o.createdViaCopyLinkCommand),linkRecipients:d,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig},u=!H.Hb()||i.shareType===s.a.copy,f=v.createElement(v.Suspense,{fallback:v.createElement(b.a,null)},v.createElement(J.p,(0,a.a)({},this._baseProps,{permissionsLabel:this._getPermissionsLabel((0,w.w)(this._getLabelProps())),sharingHintProps:l,onSharedWithClick:this._showPermissionsList,loadFloodgateDataSource:this.context.loadFloodgateDataSource,shareType:i.shareType,getStatusIcons:this._getStatusIcons,maxHeight:this._maxHeight})));if(this._useSimplifiedDialog)switch(this.props.mode){case c.a.share:case c.a.manageAccess:return f;case c.a.linkSettings:if(!H.Zb())return f;break;case c.a.copy:if(!H.$b())break;return this._store.getEngagementHelper().setEngagementExtraData(this._engagementExtraData),R.c()&&i.shareType===s.a.grantAccess?f:v.createElement(v.Suspense,{fallback:v.createElement(b.a,null)},v.createElement(J.d,(0,a.a)({},(0,V.a)(this.props),{linkUrl:this._modifiedSharingLinkUrl,sharingHintProps:l,permissionsLabel:this._getPermissionsLabel((0,w.w)(this._getLabelProps())),onSharedWithClick:this._showPermissionsList,onRenderComplete:function(){n._writeShareDataToRumoneLogger({mode:n.props.mode,viewState:n.state.viewState})},renderSharingInfoBar:this._renderSharingInfoBar,shouldRenderSharingInfoBar:this._checkShouldRenderInfoBar(),shouldWaitForSharingInfoBarInformation:u&&this.props.shouldWaitForSharingInfoBarInformation,sharingInfoBarMessageTypeId:u?null===(e=this.state.sharingInfoBarInformation)||void 0===e?void 0:e.sharingInfoBarMessageTypeId:void 0})))}return v.createElement(v.Suspense,{fallback:v.createElement(b.a,null)},v.createElement(J.l,(0,a.a)({},(0,V.a)(this.props),{shareType:i.shareType,itemName:r.item.name,linkUrl:this._modifiedSharingLinkUrl,sharingHintProps:l,shouldCopyLinkToClipboard:!0,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,generatedFromTargetClick:i.shareTargetClicked,shouldWaitForSharingInfoBarInformation:u&&this.props.shouldWaitForSharingInfoBarInformation,sharingInfoBarMessageTypeId:u?null===(t=this.state.sharingInfoBarInformation)||void 0===t?void 0:t.sharingInfoBarMessageTypeId:void 0,engagementExtraData:this._engagementExtraData,onRenderComplete:o&&this.props.mode===c.a.copy&&function(){n._writeShareDataToRumoneLogger({mode:n.props.mode,viewState:n.state.viewState})}})))},t.prototype._getInitialSharingInfoBarInformation=function(e){if(this._showSharingBanner)switch(e){case Y.a.default:if(R.c()){var t=this._store.getReShareLink(d.a.organization)||this._store.getReShareLink(d.a.anyone);if(this._store.getSharingInformation().requiresAccessApproval&&t)return{sharingInfoBarMessageTypeId:te.a.LinkReShare}}return{sharingInfoBarMessageTypeId:te.a.LimitedSharing};case Y.a.modifyPermissions:return{sharingInfoBarMessageTypeId:te.a.LimitedSharingExisting}}},t.prototype._getInitialSharingInfoBarState=function(){return this._showSharingBanner?Rt.a.Visible:this.props.shouldWaitForSharingInfoBarInformation?Rt.a.WaitingForSharingInfoBarInformation:Rt.a.None},t.prototype._getNotificationHintClickHandler=function(e){return e?this._showModifyPermissions.bind(this,F.b.CopyLinkSettingsHint,e):null},t.prototype._renderPermissionsPivot=function(){var e,t,n=this,i=H.h&&!this.state.sharingInformation.addressBarLinkSettings,r=null!==(t=null===(e=this.props.hostOptions)||void 0===e?void 0:e.showCloseButton)&&void 0!==t?t:I.q(this.props.clientId);return this.state.sharingInformation&&this.state.sharingInformation.hasPermissionsInformation&&!i||this._store.fetchSharingInformation(!0,i),v.createElement(v.Suspense,{fallback:v.createElement(b.a,null)},v.createElement(J.j,(0,a.a)({},this._baseProps,{engagementExtraData:this._engagementExtraData,sharingInformation:this.state.sharingInformation,clientId:this.props.clientId,onDefaultShare:function(){return n._showShare()},showCloseButton:r,onDismiss:this._dismiss,store:this._store,companyName:this.state.companyName,onStopSharingClicked:this.props.onStopSharingClicked,pageContext:this.props.pageContext,advancedUrl:this.props.advancedUrl,mode:this.props.mode,backButtonClicked:this._returnToPreviousView,getGraphToken:this.props.getGraphToken,sensitivityLabelInformation:this.state.sharingInformation.sensitivityLabelInformation,grantAccessClicked:this._enterGrantAccessView,maxHeight:this._maxHeight})))},t.prototype._showShare=function(){this._viewStates.push(this.state.viewState),this.setState({viewState:Y.a.default})},t.prototype._renderPermissionsList=function(){this._store.isConsumer()?this.state.sharingInformation&&this.state.sharingInformation.hasPermissionsInformation||this._store.fetchSharingInformation(!0,!1):this.state.sharingInformation&&this.state.sharingInformation.hasPermissionsInformation&&this.state.sharingInformation.addressBarLinkSettings||this._store.fetchSharingInformation(!0,!0);var e=!1;return A.j(this.state.currentSettings.audience,this.state.sharingInformation.sharingAbilities)&&(e=!0),this.state.sharingInformation&&this.state.sharingInformation.sharedObjectType===G.a.list&&H.N(),v.createElement(v.Suspense,{fallback:v.createElement(b.a,null)},v.createElement(J.i,(0,a.a)({},this._baseProps,{onStopSharingClicked:this.props.onStopSharingClicked,centeredManageAccessEnabled:!0,grantAccessClicked:this._enterGrantAccessView,shareButtonClicked:this._enterShareView,showHeader:!0,advancedUrl:this.props.advancedUrl,mode:this.props.mode,companyName:this.state.companyName,sharingInformation:this.state.sharingInformation,linkRecipients:this.state.linkRecipients,groupsMemberCount:this.state.groupsMemberCount,backButtonClicked:this._returnToPreviousView,hideElementsInManageAccess:this._hideElementsInManageAccess,engagementExtraData:this._engagementExtraData,isInfectedFile:e})))},t.prototype._renderAddPeople=function(){var e=this,t=!this.props.hideShareDialogOverflowButton;return v.createElement(v.Suspense,{fallback:v.createElement(b.a,null)},v.createElement(J.g,(0,a.a)({},this._baseProps,{backButtonClicked:this._enterManageAccessView,centeredManageAccessEnabled:!0,onManageExistingAccessClick:t?function(){return e._showPermissionsList()}:void 0,sharingInformation:this.state.sharingInformation,currentSettings:this.state.currentSettings,onViewPolicyTipClicked:this._onViewPolicyTipClicked,maxHeight:this._maxHeight,mode:this.props.mode})))},t.prototype._renderActivityIndicator=function(){if(this.state.showActivityIndicator)return v.createElement(C.a,{message:E.Y})},t.prototype._resizeIfNeeded=function(){R.f()&&this.state.viewState===Y.a.shareToTeams||this._resizeTracker&&this._resizeTracker.checkSizeChangeForRef(this._topLevelDivRef)},t.prototype._setGenericErrorState=function(e,t,n){var a,i=this,r=(0,Z.b)(this.state.sharingInformation,e,t,n);null===(a=this.props.shareLoadingCustomerPromise)||void 0===a||a.forEach(function(t){return(0,Z.e)({customerPromise:t,rawErrorMessage:r.rawError,engagementExtraData:i._engagementExtraData,errorType:e,sharingStore:i._store})}),this.setState({sharingInformation:r,viewState:Y.a.error}),H.oc()&&window.parent.postMessage(JSON.stringify({name:"share_resetMakeVisible"}),"*")},t.prototype._sanitizeSharingContextInfo=function(e){if(e&&(this._isSanitizedUrl(e.customizedExternalSharingServiceUrl)||(e.customizedExternalSharingServiceUrl=""),this._isSanitizedUrl(e.fixItUrl)||(e.fixItUrl=""),e.defaultSharingLink&&!this._isSanitizedUrl(e.defaultSharingLink.url)&&(e.defaultSharingLink.url=""),e.directLink&&!this._isSanitizedUrl(e.directLink.url)&&(e.directLink.url=""),e.sharingLinks))for(var t=0;t<e.sharingLinks.length;t++)e.sharingLinks[t]&&!this._isSanitizedUrl(e.sharingLinks[t].url)&&(e.sharingLinks[t].url="")},t.prototype._isSanitizedUrl=function(e){return!e||0===e.length||0===e.toLowerCase().indexOf("http://")||0===e.toLowerCase().indexOf("https://")},t.prototype._logRumone=function(){var e,t,n=this,a=function(){n._isInitialPageLoadDataLogged=!0;var e=n.props.mode,t=n.state.viewState;setTimeout(function(){n._writeShareDataToRumoneLogger({mode:e,viewState:t})},0)},i=this.state.viewState===Y.a.linkSuccess;if(this._showSimplifiedDialog&&this.state.copyLinkToastStatus===Pe.a.success&&(i=!0),this._showSimplifiedDialogV2&&this.state.copyMessageBarStatus===de.success&&(i=!0),(this.props.mode===c.a.share||this.props.mode===c.a.copy)&&this.state.shareTargetClicked&&i)e=n.props.mode,t=n.state.viewState,setTimeout(function(){n._writeCopyLinkTargetDataToRumoneLogger({mode:e,viewState:t,clickTime:n._copyTargetClickTime})});else if(this.state.viewState===Y.a.linkSuccess&&this.props.mode===c.a.copy)H.$b()||(this._isInitialPageLoadDataLogged=!0);else if(!this._isInitialPageLoadDataLogged)switch(this.props.mode){case c.a.share:this.state.viewState!==Y.a.default||this.state.shareTargetClicked||a();break;case c.a.copy:this.state.viewState!==Y.a.linkSuccess||this.state.shareTargetClicked||a();break;case c.a.manageAccess:this.state.viewState!==Y.a.permissionsList&&this.state.viewState!==Y.a.permissionsPivot||a();break;case c.a.linkSettings:this.state.viewState===Y.a.linkSettings&&a();break;case c.a.atMention:this.state.linkRecipients.length>0&&a()}},t.prototype._writeShareDataToRumoneLogger=function(e){var t=e.mode,n=e.viewState,a=this.props.clickTime||this._store.getSharingClickTime()||performance.timing.navigationStart,i=this._store.getWebView2Times();this._writePerfData({pageTransitionType:Q.a.fullPageLoad,startTime:a,mode:this.props.mode,originalMode:t,viewState:this.state.viewState,originalViewState:n,audience:this.state.currentSettings.audience,webView2Times:i})},t.prototype._writeCopyLinkTargetDataToRumoneLogger=function(e){if(this._rumoneLogger.resetRumOne()){var t=e.mode,n=e.viewState,a=e.clickTime;this._writePerfData({pageTransitionType:Q.a.onePageAppNavigation,startTime:a,mode:c.a.copy,originalMode:t,viewState:this.state.viewState,originalViewState:n,audience:this.state.currentSettings.audience})}},t.prototype._writePerfData=function(e){var t=this,n=e.pageTransitionType,i=e.startTime,r=e.mode,o=e.originalMode,s=e.viewState,d=e.originalViewState,u=e.audience,f=e.webView2Times;if(this.props&&i&&this.props.clientId){var p=Object.keys(c.a).filter(function(e){return c.a[e]===r})[0],m=Object.keys(c.a).filter(function(e){return c.a[e]===o})[0],_=Object.keys(l.a).filter(function(e){return l.a[e]===t.props.clientId})[0],h=this._store.getSharingInformationAPIStats(),b=this._store.getShareLinkAPIStats(),g=this._store.getWaitSharingAPIsDuration?this._store.getWaitSharingAPIsDuration():null,v=this._rumoneLogger.breakdownData,y={modeName:p,startTime:i,endTime:Date.now(),breakDownData:(0,a.a)({sharingClientId:v(_),mode:v(p),audience:v(u),originalMode:v(m),viewState:v(s),originalViewState:v(d),getSharingInformationAPIStats:h?v(h):null,shareLinkAPIStats:b?v(b):null,realUserClickTime:v(i!==performance.timing.navigationStart),beforeNavigation:v(i<performance.timing.navigationStart?performance.timing.navigationStart-i:0),isInstantSecondLoad:!!this.props.isInstantSecondLoad,isLightSpeed:!0,waitSharingAPIsDuration:g,clickTime:i,navigationStart:performance.timing.navigationStart,isWebview2:!H.n()&&(0,Bt.b)(this.props.scenarioId)},f?{webView2Times:f}:{})};this._rumoneLogger.logSharingPerformance(y,n)}},t.prototype._flushAriaAndReportError=function(e){var t=this,n=Promise.resolve();this.props.flushTelemetry&&(n=this.props.flushTelemetry()),n.then(function(){setTimeout(function(){t._sharingClientMessenger?t._sharingClientMessenger.sendShareError(e):L.q(t._shareClickTime,t.props.clientId,t.props.mode,t.props.scenarioId,e,t._correlationId)},0)})},t.prototype._isWordFileEnabledFor3S=function(e){return H.Mb()&&(this.props.clientId===l.a.wac||this.props.clientId===l.a.word||this.props.clientId===l.a.odcWac)&&(0,ee.e)(e.fileExtension)},t.prototype._isXPFileEnabledFor3S=function(e){return H.Pb()&&(this.props.clientId===l.a.wac||this.props.clientId===l.a.odcWac||this.props.clientId===l.a.excel||this.props.clientId===l.a.powerpoint)&&((0,ee.c)(e.fileExtension)||(0,ee.d)(e.fileExtension))},t.childContextTypes={hasTeamsLicense:y.bool,sharingStore:y.object.isRequired},t.contextTypes={resize:y.func.isRequired,onDismiss:y.func.isRequired,sharingStore:y.object.isRequired,shareClickTime:y.number,shouldTeachingBubbleBeShown:y.func,onTeachingBubbleSeen:y.func,markTeachingBubbleAsDismissed:y.func,sharingClientMessenger:y.object,loadFloodgateDataSource:y.func,platformDetection:y.object.isRequired},t}(v.Component)}
,function(e,t,n){n.d(t,{a:function(){return i}});var a=n(0);function i(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return t.reduce(function(e,t){return(0,a.a)((0,a.a)((0,a.a)((0,a.a)({},e),t),e.extraMetrics||t.extraMetrics?{extraMetrics:(0,a.a)((0,a.a)({},e.extraMetrics||{}),t.extraMetrics||{})}:{}),e.extraData||t.extraData?{extraData:(0,a.a)((0,a.a)({},e.extraData||{}),t.extraData||{})}:{})},e)}}
,,,,,,,,,,,,,,,,,,function(e,t){var n;!function(e){e[e.None=0]="None",e[e.PageSharingAssetWarning=1]="PageSharingAssetWarning",e[e.LimitedSharing=2]="LimitedSharing",e[e.LimitedSharingExisting=3]="LimitedSharingExisting",e[e.LinkReShare=4]="LinkReShare"}(n||(n={})),t.a=n}
,function(e,t,n){var a;n.d(t,{a:function(){return a}}),function(e){e.success="success",e.error="error",e.inProgress="inProgress",e.closed="closed"}(a||(a={}))}
,function(e,t,n){var a;function i(e){return!!(null==e?void 0:e.match("-WV2$"))}n.d(t,{a:function(){return a},b:function(){return i}}),function(e){e.SharePrivateDraft="SharePrivateDraft",e.ShareSitePage="ShareSitePage",e.ShareSitePageDraft="ShareSitePageDraft",e.ShareSitePageDraftFromLibrary="ShareSitePageDraftFromLibrary",e.ShareSitePageFromLibrary="ShareSitePageFromLibrary"}(a||(a={}))}
,function(e,t,n){n.d(t,{a:function(){return o},b:function(){return s}});var a={"3g2":1,"3gp":1,"3gp2":1,"3gpp":1,"3mf":1,ai:1,arw:1,asf:1,avci:1,avcs:1,avi:1,bas:1,bmp:1,cbl:1,cfg:1,cool:1,cr2:1,crw:1,csv:2,cur:1,dcm:1,dcm30:1,dds:1,dib:1,dic:1,dicm:1,dicom:1,dng:1,doc:2,docm:2,docx:2,dot:2,dotm:2,dotx:2,dwg:1,eml:1,epdf:1,epub:1,erf:1,exif:1,fbx:1,flac:1,fppx:1,gif:1,hdp:1,heic:1,heics:1,heif:1,heifs:1,ico:1,icon:1,jfif:1,jpe:1,jpeg:1,jpg:1,jxr:1,kdc:1,key:1,m2ts:1,m4a:1,m4v:1,mat:1,mov:1,movie:1,mp3:1,mp4:1,mp4v:1,mrw:1,msg:1,mts:1,nef:1,notebook:2,nrw:1,numbers:1,obj:1,odf:2,odp:2,ods:2,odt:2,ogg:1,one:2,onepkg:2,onetoc2:2,opus:1,orf:1,pages:1,pano:1,pdf:1,pdfa:1,pef:1,pict:1,ply:1,png:1,pot:2,potm:2,potx:2,ppa:2,ppam:2,pps:2,ppsm:2,ppsx:2,ppsxm:1,ppt:2,pptm:2,pptx:2,psb:1,psd:1,raf:1,raw:1,rle:1,rtf:2,rw2:1,rwl:1,sketch:1,sr2:1,srw:1,stl:1,tif:1,tiff:1,vdw:2,vsd:2,vsdm:2,vsdx:2,vsl:2,vss:2,vssm:2,vssx:2,vst:2,vstm:2,vstx:2,wdp:1,webm:1,webp:1,wma:1,wmv:1,xbm:1,xcf:1,xd:1,xla:2,xlam:2,xll:2,xls:2,xlsb:2,xlsm:2,xlsx:2,xlt:2,xltm:2,xltx:2,xpm:1},i={"3fr":1,"3g2":1,"3gp":1,"3gp2":1,"3gpp":1,"3mf":1,ai:1,ari:1,arw:1,asf:1,avci:1,avcs:1,avi:1,bas:1,bay:1,bmp:1,cap:1,cbl:1,cfg:1,cool:1,cr2:1,cr3:1,crw:1,csv:2,cur:1,dcm:1,dcm30:1,dcr:1,dcs:1,dds:1,dib:1,dic:1,dicm:1,dicom:1,dng:1,doc:2,docm:2,docx:2,dot:2,dotm:2,dotx:2,drf:1,dwg:1,eip:1,eml:1,epdf:1,epub:1,erf:1,exif:1,fbx:1,fff:1,flac:1,fppx:1,gif:1,hdp:1,heic:1,heics:1,heif:1,heifs:1,ico:1,icon:1,iiq:1,jfif:1,jpe:1,jpeg:1,jpg:1,jxr:1,k25:1,kdc:1,key:1,m2ts:1,m4a:1,m4v:1,mat:1,mef:1,mkv:1,mos:1,mov:1,movie:1,mp3:1,mp4:1,mp4v:1,mpeg:1,mpg:1,mrw:1,msg:1,mts:1,nef:1,notebook:2,nrw:1,numbers:1,obj:1,odf:2,odp:2,ods:2,odt:2,ogg:1,one:2,onepkg:2,onetoc2:2,opus:1,orf:1,ori:1,pages:1,pano:1,pdf:1,pdfa:1,pef:1,pict:1,ply:1,png:1,pot:2,potm:2,potx:2,ppa:2,ppam:2,pps:2,ppsm:2,ppsx:2,ppsxm:1,ppt:2,pptm:2,pptx:2,psb:1,psd:1,ptx:1,pxn:1,raf:1,raw:1,rle:1,rtf:2,rw2:1,rwl:1,sketch:1,sr2:1,srf:1,srw:1,stl:1,tif:1,tiff:1,vdw:2,vsd:2,vsdm:2,vsdx:2,vsl:2,vss:2,vssm:2,vssx:2,vst:2,vstm:2,vstx:2,wdp:1,webm:1,webp:1,wma:1,wmv:1,x3f:1,xbm:1,xcf:1,xd:1,xla:2,xlam:2,xll:2,xls:2,xlsb:2,xlsm:2,xlsx:2,xlt:2,xltm:2,xltx:2,xpm:1},r=n(1),o={None:0,AllowMediaTA:1,OfficeOnly:2};function s(e,t){return!!e&&(e=("."===e[0]?e.slice(1):e).toLowerCase(),r.b.isActivated("3B12E0BA-483A-4E92-B6EC-89DC316832D6","01/25/2022","Update BlockDownloadSupported")?a[e]>=t:i[e]>=t)}}
,,,,,,,,,,,,,function(e,t,n){n.d(t,{a:function(){return i}});var a=n(470),i=[{targetElementId:void 0,title:a.t,bodyText:a.s,bodyAria:"",primaryButtonText:a.i,secondaryButtonText:void 0},{targetElementId:"SendLink-roleSelectorCompact",title:a.o,bodyText:a.n,bodyAria:a.m,primaryButtonText:a.l,secondaryButtonText:a.b},{targetElementId:"Send-button",title:a.r,bodyText:a.q,bodyAria:a.p,primaryButtonText:a.l,secondaryButtonText:a.b},{targetElementId:"copy-button",title:a.f,bodyText:a.e,bodyAria:a.d,primaryButtonText:a.l,secondaryButtonText:a.b},{targetElementId:"Footer-button-settings",title:a.w,bodyText:a.v,bodyAria:a.u,primaryButtonText:a.l,secondaryButtonText:a.b},{targetElementId:"od-SharedWith-List",title:a.z,bodyText:a.y,bodyAria:a.x,primaryButtonText:a.h,secondaryButtonText:a.b}]}
,,function(e,t,n){n.d(t,{a:function(){return u}});var a=n("react-lib"),i=n("prop-types-lib");(0,n(8).b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-sensitivity-label-left-align{display:flex!important;border-radius:4px;padding:1px 8px!important;background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";margin:1px;overflow:hidden;align-items:center}.od-sensitivity-label-left-align:focus-visible{outline:1px solid}.od-sensitivity-label{border-radius:4px;padding:2px 6px!important;background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";display:flex;margin:1px;overflow:hidden}[dir=ltr] .od-sensitivity-label{margin-left:8px}[dir=rtl] .od-sensitivity-label{margin-right:8px}.od-sensitivity-label:focus-visible{outline:1px solid}.od-sensitivity-text{font-size:.75rem;font-weight:400;margin:0;text-overflow:ellipsis;overflow:hidden;white-space:nowrap}@supports (font:-apple-system-body){.od-sensitivity-text{font:-apple-system-body}}.od-sensitivity-tooltip-text{font-size:.75rem;font-weight:600;margin:0;margin-bottom:2px}.od-sensitivity-tooltip-information{font-size:.75rem;margin:0}.od-sensitivity-label-container{display:flex}.od-sensitivity-aria-label{visibility:hidden}.od-sensitivity-shieldIcon{display:flex}[dir=ltr] .od-sensitivity-shieldIcon{margin-left:-4px}[dir=rtl] .od-sensitivity-shieldIcon{margin-right:-4px}[dir=ltr] .od-sensitivity-shieldIcon{margin-right:3px}[dir=rtl] .od-sensitivity-shieldIcon{margin-left:3px}.od-sensitivity-shieldIcon svg path{fill:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}@media screen and (-ms-high-contrast:active){.od-sensitivity-shieldIcon svg path{filter:invert(100%)}.od-sensitivity-label-left-align{border:1px solid "},{theme:"white",defaultValue:"#fff"},{rawString:"}}@media screen and (-ms-high-contrast:black-on-white){.od-sensitivity-shieldIcon svg path{filter:invert(0%)}}"}]);var r=n(61),o=n(14),s=n(20),c=n(24),d=n(13),l=n(21);function u(e,t){var n=a.useState(null),i=n[0],u=n[1],f=((0,c.nb)(t.clientId,t.sharingStore)||(0,c.tb)(t.clientId,t.sharingStore))&&s.Pi;return e.sensitivityLabelInformation.displayName&&t.sharingStore.getEngagementHelper().showSensitivityLabel(e.engagementExtraData),a.createElement("div",{className:"od-sensitivity-label-container"},a.createElement(r.a,{tooltipProps:{directionalHint:o.a.bottomAutoEdge,onRenderContent:function(){return t.sharingStore.getEngagementHelper().hoverOverSensitivityLabel(e.engagementExtraData),a.createElement("div",{className:"od-sensitivity-tooltip"},a.createElement("p",{className:"od-sensitivity-tooltip-text"},f,e.sensitivityLabelInformation.displayName),a.createElement("p",{className:"od-sensitivity-tooltip-information"},i))},calloutProps:{hidden:null===i||0===i.length}},onTooltipToggle:function(n){return n?void(null===i&&t.sharingStore.getSensitivityLabels(e.getGraphToken).then(function(t){if(t){var n=t.filter(function(t){return t.id===e.sensitivityLabelInformation.id});0!==n.length?u(n[0].tooltip):u("")}else u("")}).catch(function(){u("")})):null},styles:{root:{display:"flex",overflow:"hidden",width:"min-content"}},id:"sensitivity-label"},a.createElement("span",{className:e.filename&&0!==e.filename.length?"od-sensitivity-label":"od-sensitivity-label-left-align",tabIndex:0,role:"note","aria-label":i?f+e.sensitivityLabelInformation.displayName+", "+i:e.sensitivityLabelInformation.displayName},(0,l.Qb)()&&function(){var t,n;return void 0===(null===(t=e.sensitivityLabelInformation)||void 0===t?void 0:t.hasIRMProtection)?null:(null===(n=e.sensitivityLabelInformation)||void 0===n?void 0:n.hasIRMProtection)?a.createElement(d.a,{iconName:"ShieldLock16RegularIcon",className:"od-sensitivity-shieldIcon"}):a.createElement(d.a,{iconName:"Shield16RegularIcon",className:"od-sensitivity-shieldIcon"})}(),a.createElement("p",{className:"od-sensitivity-text"},e.sensitivityLabelInformation.displayName))))}u.contextTypes={sharingStore:i.object.isRequired,clientId:i.number.isRequired}}
,function(e,t,n){var a,i,r,o,s;function c(e){return"spdf"===e?o.DOGFOOD:o.PRODUCTION}n.d(t,{a:function(){return o},b:function(){return s},c:function(){return i},d:function(){return a},e:function(){return c}}),function(e){e[e.Default=0]="Default",e[e.InProgress=1]="InProgress",e[e.Succeeded=2]="Succeeded",e[e.Failed=3]="Failed"}(a||(a={})),function(e){e.AuthTokenUnavailable="AuthTokenUnavailable",e.BlockedByLanguage="BlockedByLanguage",e.BlockedByPostfilter="BlockedByPostfilter",e.BlockedByQualityCheck="BlockedByQualityCheck",e.CatchAll="CatchAll",e.DocumentContentUnavailable="DocumentContentUnavailable",e.DocumentEncrypted="DocumentEncrypted",e.DocumentLengthTooShort="DocumentLengthTooShort",e.ResourceUnavailable="ResourceUnavailable",e.Timeout="Timeout",e.UserNotAuthorized="UserNotAuthorized"}(i||(i={})),function(e){e[e.Icon=0]="Icon",e[e.Text=1]="Text",e[e.AriaLabel=2]="AriaLabel"}(r||(r={})),function(e){e.DEV="DEV",e.DOGFOOD="DOGFOOD",e.PRODUCTION="PRODUCTION"}(o||(o={})),function(e){e[e.LIKE=0]="LIKE",e[e.DISLIKE=1]="DISLIKE"}(s||(s={}))}
,,,,,,function(e,t,n){n.d(t,{a:function(){return V}});var a={};n.r(a),n.d(a,{indexedDB:function(){return c},localStorage:function(){return s},none:function(){return d}});var i,r=n(0),o=n(7),s=0,c=1,d=2,l=a,u=n(29),f=n(120),p="undefined"==typeof window?self:window,m=n(4),_=n(1).b.isActivated("18a3d374-cced-4d7f-be15-3b0a8dda8152");!function(e){e.success="success",e.error="error"}(i||(i={}));var h="app",b="app_lastRead",g="ODSP_DB",v="ODSP_DB_TABLE",y="lastModified",S="lastRead",D="ODSP_DB_METADATA_TABLE",I="database_metadata",x="parentKey",C="reads",O=(new u.a).isFirefox,w="indexedDB is not supported",E=function(){function e(t){if(!("indexedDB"in p)||!p.indexedDB)throw new Error(w);var n,a;this._logger=t,e._openDBPromise||(_||(n=this._logger({name:"PersistentCacheIDB.openDB"}),a=Date.now()),e._openDBPromise=this._openIndexedDB().then(function(t){return _||n&&n({resultType:m.b.Success,extraData:{dbOpen:Math.round(Date.now()-a)}}),e._db=t,t}).catch(function(e){throw _||n&&n({resultType:m.b.Failure,error:e.message?e.message:e.toString()}),e}))}return e.prototype.freeSpace=function(t,n){return(0,r.b)(this,void 0,void 0,function(){var a,i,o,s=this;return(0,r.e)(this,function(r){switch(r.label){case 0:return i=e,(o=e._db)?[3,2]:[4,e._openDBPromise];case 1:o=r.sent(),r.label=2;case 2:return a=i._db=o,[2,new Promise(function(e,i){var r=a.transaction([v],"readwrite").objectStore(v).index(b).openCursor();r.onsuccess=function(a){var i=r.result;i?(i.value.app===t&&n>0&&(n-=i.value.size,i.delete()),n>0?i.continue():e()):e()},r.onerror=function(e){s._errorHandling(e,i)}})]}})})},e.prototype.read=function(e){return(0,r.b)(this,void 0,void 0,function(){return(0,r.e)(this,function(t){return[2,this._readInternal(v,function(t){return t.get(e)})]})})},e.prototype.rangeQuery=function(t){return(0,r.b)(this,void 0,void 0,function(){var n,a,i,o,s,c,d,l,u,f,p,m,_,h=this;return(0,r.e)(this,function(r){switch(r.label){case 0:return n={},i=e,(o=e._db)?[3,2]:[4,e._openDBPromise];case 1:o=r.sent(),r.label=2;case 2:return a=i._db=o,s=a.transaction([v],"readonly"),c=s.objectStore(v),d=[],l=t.index,u=t.range,f=t.direction,p=t.count,m=c.index(l),(_=m.openKeyCursor(u,f)).onerror=function(e){h._errorHandling(e,n.reject)},_.onsuccess=function(e){var t=e.target.result;t?(d.push(t.primaryKey),d.length>=p?n.resolve(d):t.continue()):n.resolve(d)},[2,new Promise(function(e,t){n.resolve=e,n.reject=t})]}})})},e.prototype.write=function(e){return(0,r.b)(this,void 0,void 0,function(){var t;return(0,r.e)(this,function(n){return t=e.key,void 0!==e.data?[2,this._writeInternal({tableName:v,key:t,row:(0,r.a)((0,r.a)({},e),{lastModified:Date.now()})})]:void 0!==e.parentKey?[2,this._deleteDataRows(e.parentKey)]:[2,this._writeInternal({tableName:v,key:t,row:void 0})]})})},e.prototype.statistics=function(){return(0,r.b)(this,void 0,void 0,function(){var e,t;return(0,r.e)(this,function(n){switch(n.label){case 0:return this._dbMetaData?[3,2]:[4,this._readAndSetMetadataDB()];case 1:e=n.sent(),this._dbMetaData=e,n.label=2;case 2:return[4,this._iterate(v,function(e){return e.size})];case 3:return t=n.sent(),[2,{metaData:this._dbMetaData,count:t.length,totalBytes:t.reduce(function(e,t){return e+t},0)}]}})})},e.prototype._openIndexedDB=function(){var t=this;return new Promise(function(n,a){if(e._db)n(e._db);else{var i=O?indexedDB.open(g,{version:4,storage:"temporary"}):indexedDB.open(g,4);i.onerror=function(e){t._errorHandling(e,a)},i.onsuccess=function(t){var a=e._db=i.result;n(a)},i.onupgradeneeded=function(e){var n=e.target.result;n.onerror=function(e){t._errorHandling(e,a)};var r=e.oldVersion;t._handleDBUpgrade(i,n,r)}}})},e.prototype._handleDBUpgrade=function(e,t,n){var a;n<1&&((a=t.createObjectStore(v,{keyPath:"key"})).createIndex(y,y,{unique:!1}),a.createIndex(C,C,{unique:!1}),t.createObjectStore(D,{keyPath:"key"})),n<2&&((a=a||e.transaction.objectStore(v)).createIndex(h,h,{unique:!1}),a.createIndex(S,S,{unique:!1}),a.createIndex(b,[h,S],{unique:!1})),n<3&&((a=a||e.transaction.objectStore(v)).createIndex("app_lastModified",[h,y],{unique:!1}),a.createIndex("app_reads",[h,C],{unique:!1})),n<4&&((a=a||e.transaction.objectStore(v)).createIndex(x,x,{unique:!1}),a.createIndex("parentKey_app",[x,h],{unique:!1}),a.createIndex("parentKey_app_lastModified",[x,h,y],{unique:!1}),a.createIndex("parentKey_app_lastRead",[x,h,S],{unique:!1}),a.createIndex("parentKey_app_reads",[x,h,C],{unique:!1}))},e.prototype._readAndSetMetadataDB=function(){var e=this;return this._readInternal(D,function(e){return e.get(I)}).then(function(t){if(t)return t.data;var n={id:f.generate(),created:Date.now(),cacheType:l.indexedDB};return e._writeInternal({tableName:D,key:I,row:{key:I,data:n}}).then(function(){return n})})},e.prototype._readInternal=function(t,n){return(0,r.b)(this,void 0,void 0,function(){var a,i,o,s=this;return(0,r.e)(this,function(r){switch(r.label){case 0:return i=e,(o=e._db)?[3,2]:[4,e._openDBPromise];case 1:o=r.sent(),r.label=2;case 2:return a=i._db=o,[2,new Promise(function(e,i){var r=s._logger({name:"PersistentCacheIDB.readInternal"}),o=Date.now(),c=a.transaction([t],"readonly").objectStore(t),d=n(c);d.onsuccess=function(t){r({resultType:m.b.Success,extraData:{io:Math.round(Date.now()-o)}}),e(d.result)},d.onerror=function(e){r({resultType:m.b.Failure,extraData:{io:Math.round(Date.now()-o)}}),s._errorHandling(e,i)}})]}})})},e.prototype._iterate=function(t,n){return(0,r.b)(this,void 0,void 0,function(){var a,i,o,s,c=this;return(0,r.e)(this,function(r){switch(r.label){case 0:return i=e,(o=e._db)?[3,2]:[4,e._openDBPromise];case 1:o=r.sent(),r.label=2;case 2:return a=i._db=o,s=[],[2,new Promise(function(e,i){var r=a.transaction([t],"readonly").objectStore(t).openCursor();r.onsuccess=function(t){var a=r.result;a?(s.push(n(a.value)),a.continue()):e(s)},r.onerror=function(e){c._errorHandling(e,i)}})]}})})},e.prototype._writeInternal=function(t){return(0,r.b)(this,void 0,void 0,function(){var n,a,i,o,s,c,d=this;return(0,r.e)(this,function(r){switch(r.label){case 0:return n=t.tableName,a=t.key,i=t.row,s=e,(c=e._db)?[3,2]:[4,e._openDBPromise];case 1:c=r.sent(),r.label=2;case 2:return o=s._db=c,[2,new Promise(function(e,t){try{var r=o.transaction([n],"readwrite"),s=r.objectStore(n);r.oncomplete=function(){},r.onerror=function(e){d._errorHandling(e,t)};var c=i?s.put(i):s.delete(a);c.onsuccess=function(t){e()},c.onerror=function(e){d._errorHandling(e,t)}}catch(e){throw e}})]}})})},e.prototype._deleteDataRows=function(e){return(0,r.b)(this,void 0,void 0,function(){var t,n=this;return(0,r.e)(this,function(a){return t=e.slice(0,e.length-1)+String.fromCharCode(e.charCodeAt(e.length-1)+1),[2,this.rangeQuery({index:x,range:IDBKeyRange.bound(e,t,!1,!0),direction:"next"}).then(function(e){return Promise.all(e.map(function(e){return n._writeInternal({tableName:v,key:e,row:void 0})}))}).then(function(){})]})})},e.prototype._errorHandling=function(e,t){if(e.type===i.error){var n=e.target.error;t({name:n.name,message:n.message,code:n.code})}},e}(),A="PersistentCache",L="PersistentCache_metadata",k=function(){function e(){try{if("localStorage"in p&&p.localStorage&&(this._localStorage=p.localStorage,!this._localStorage.getItem(L))){var e={id:f.generate(),created:Date.now(),cacheType:l.localStorage};this._localStorage.setItem(L,JSON.stringify(e))}}catch(e){}if(!this._localStorage)throw new Error("localStorage is not supported")}return e.prototype.freeSpace=function(e,t){throw new Error("Method not implemented.")},e.prototype.read=function(e){return JSON.parse(this._localStorage.getItem(this._cacheKey(e)))},e.prototype.write=function(e){var t=e.key;if(void 0!==e.data){var n=(0,r.a)((0,r.a)({},e),{lastModified:Date.now()});this._localStorage.setItem(this._cacheKey(t),JSON.stringify(n))}else this._localStorage.removeItem(this._cacheKey(t))},e.prototype.statistics=function(){var e=[];for(var t in this._localStorage)if(0===t.indexOf(A)){var n=this._localStorage.getItem(t);e.push(n?n.length:0)}return{metaData:JSON.parse(this._localStorage.getItem(L)),count:e.length,totalBytes:e.reduce(function(e,t){return e+t},0)}},e.prototype.rangeQuery=function(e){return(0,r.b)(this,void 0,void 0,function(){return(0,r.e)(this,function(e){return[2,void 0]})})},e.prototype._cacheKey=function(e){return"".concat(A,"_").concat(e)},e}(),M=0,P=function(){function e(){this._queue={}}return e.prototype.enqueue=function(e,t){var n=this._queue[e]=this._queue[e]||[],a=!0,i=[];n.length>0&&(n[0].schedule?(i=n.slice(1),this._queue[e]=[n[0]],a=!1):(i=this._queue[e],this._queue[e]=[]));var r=this._createUpateTask(e,t);return i.length>0&&(r.signal=i[0].signal),this._queue[e].push(r),a&&this._scheduleTask(e),r},e.prototype._createUpateTask=function(e,t){var n=this,a={};a.promise=new Promise(function(e,t){a.resolve=e,a.reject=t});var i={execute:function(){return(0,r.b)(n,void 0,void 0,function(){var e;return(0,r.e)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,3,4]),[4,t()];case 1:return n.sent(),[3,4];case 2:return e=n.sent(),i.error=e,[3,4];case 3:return this._completeTask(i),[7];case 4:return[2]}})})},schedule:0,id:M++,key:e,signal:a};return i},e.prototype._scheduleTask=function(e){var t=this._queue[e];if(t&&t.length>0){var n=t[0];n.schedule=p.setTimeout(n.execute,5)}},e.prototype._completeTask=function(e){var t=e.id,n=e.key,a=this._queue[n],i=a[0],r=a.slice(1);if(i.id!==t)throw new Error("this should not happen, currently running task must be the top of the queue");this._queue[n]=r,this._scheduleTask(n),e.error?e.signal.reject(e.error):e.signal.resolve()},e}();function T(){return p.performance&&performance.now?Math.round(performance.now()):Date.now()}var U=n(35),F="_odspcache_",H="_____",R={cacheType:l.indexedDB},N=function(){function e(e){var t=e.cacheType,n=void 0===t?R.cacheType:t,a=(0,r.f)(e,["cacheType"]);if(this._config=(0,r.a)((0,r.a)({},a),{cacheType:n}),this._cacheSecret=this._config.secret,this._dataIsEncrypted=!!this._cacheSecret,this._crypto=this._config.crypto,this._dataIsEncrypted&&!this._crypto)throw new Error("When data needs encryption, crypto implementing ICrypto has to be provided when initiating PersistentCache.");this._cacheType=this._config.cacheType,this._app=e.app,this._cacheUpdateTaskManager=new P,this._qos=this._config.telemetry&&this._config.telemetry.qos,this._initLocalStorage(this._cacheType)}return Object.defineProperty(e.prototype,"configuration",{get:function(){return this._config},enumerable:!1,configurable:!0}),e.prototype.read=function(e){return(0,r.b)(this,void 0,void 0,function(){var t,n,a,i,o,s,c;return(0,r.e)(this,function(r){switch(r.label){case 0:t=e.cacheKey,n=e.validBufferTime,a=this._logQos({name:"PersistentCache.read"}),o=T(),Date.now(),r.label=1;case 1:return r.trys.push([1,4,,5]),(s=this._getStorageKey(t))?[4,this._getData({cacheKey:t,storageKey:s,validBufferTime:n})]:[3,3];case 2:i=r.sent(),r.label=3;case 3:return i=i||{key:{original:t,encoded:s},app:this._app,data:void 0,cacheStats:{lastModified:NaN,lastRead:NaN,reads:0},cacheType:this._cacheType,performance:{total:Math.round(T()-o)}},[3,5];case 4:throw c=r.sent(),a({resultType:U.a.Failure,error:c.message?c.message:c.toString(),extraData:{cacheResult:"miss"}}),c;case 5:return a({resultType:U.a.Success,extraData:{cacheResult:"".concat(void 0!==i.data?"hit":"miss")}}),[2,Promise.resolve(i)]}})})},e.prototype.rangeQuery=function(e){return(0,r.b)(this,void 0,void 0,function(){var t,n,a,i,o,s,c,d=this;return(0,r.e)(this,function(r){if(this._cacheType!==l.indexedDB)throw new Error("Only indexedDB supports range query, your storage does not support!");t=this._logQos({name:"PersistentCache.rangeQuery"}),n=0,a=T(),i=Date.now(),s={lastModified:NaN,lastRead:i,reads:1};try{c=T(),o=this._storage.rangeQuery(e).then(function(e){return n=Math.round(T()-c),{key:void 0,app:void 0,data:e.map(function(e){return{original:d._getOriginalKeyFromCacheKey(e),encoded:e}}),cacheStats:s,cacheType:d._cacheType,performance:{io:n,total:Math.round(T()-a)}}})}catch(e){throw t({resultType:U.a.Failure,error:e.message?e.message:e.toString()}),e}return t({resultType:U.a.Success}),[2,o||Promise.resolve({key:void 0,app:void 0,data:[],cacheStats:s,cacheType:this._cacheType,performance:{io:n,total:Math.round(T()-a)}})]})})},e.prototype.update=function(e){return(0,r.b)(this,void 0,void 0,function(){var t,n,a,i=this;return(0,r.e)(this,function(r){switch(r.label){case 0:return t=e.cacheKey,n=e.data,a=this._getStorageKey(t),[4,this._cacheUpdateTaskManager.enqueue(a,function(){return i._doCacheUpdate(t,n)}).signal.promise];case 1:return r.sent(),this._logCacheStats(),[2]}})})},e.prototype.remove=function(e){var t=e.cacheKey;return(0,r.b)(this,void 0,void 0,function(){return(0,r.e)(this,function(e){return[2,this.update({cacheKey:t,data:void 0})]})})},e.prototype.freeSpace=function(e,t){return(0,r.b)(this,void 0,void 0,function(){return(0,r.e)(this,function(n){return[2,this._storage.freeSpace(e,t)]})})},e.prototype.readAndUpdate=function(e){return(0,r.b)(this,void 0,void 0,function(){var t,n,a,i,o,s,c,d,u=this;return(0,r.e)(this,function(r){switch(r.label){case 0:t=e.cacheKey,n=e.getData,a=T(),i=Date.now(),o=this._logQos({name:"PersistentCache.readAndUpdate"}),s=n().then(function(e){var n={app:u._app,key:{original:t,encoded:u._getStorageKey(t)},data:e,cacheType:l.none,cacheStats:{lastModified:void 0,lastRead:i,reads:1},performance:{total:Math.round(T()-a)}};return u.update({cacheKey:t,data:e}),n}),r.label=1;case 1:r.trys.push([1,8,,9]),r.label=2;case 2:return r.trys.push([2,4,,5]),[4,Promise.race([this.read(e),s])];case 3:return c=r.sent(),[3,5];case 4:return r.sent(),[3,5];case 5:return!c||c.cacheType!==l.none&&void 0===c.data?[4,s]:[3,7];case 6:c=r.sent(),r.label=7;case 7:return[3,9];case 8:throw d=r.sent(),o({resultType:U.a.Failure,error:d.message?d.message:d.toString()}),d;case 9:return o({resultType:U.a.Success}),[2,c]}})})},e.prototype._initLocalStorage=function(e){if(e===l.localStorage)this._storage=new k;else try{this._storage=new E(this._logQos.bind(this))}catch(e){e.message===w&&(this._storage=new k,this._cacheType=l.localStorage)}},e.prototype._getStorageKey=function(e){var t=encodeURIComponent("".concat(e.key).concat(e.user?H+e.user:""));return"".concat(F).concat(this._dataIsEncrypted?btoa(t):t)},e.prototype._getOriginalKeyFromCacheKey=function(e){var t=e.replace(F,""),n=this._dataIsEncrypted?atob(t):t,a=decodeURIComponent(n);if(a.indexOf(H)>=0){var i=a.split(H);return{key:i[0],user:i[1]}}return{key:a}},e.prototype._getData=function(t){var n,a;return(0,r.b)(this,void 0,void 0,function(){var i,o,s,c,d,l,u,f,p,m,_,h,b,g,v,y,S,D,I,x,C=this;return(0,r.e)(this,function(O){switch(O.label){case 0:return i=t.cacheKey,o=t.storageKey,s=t.validBufferTime,c=T(),(d=e._buffer[o])&&s&&c-d.readTime<s?[2,d.data]:(l=T(),u=Date.now(),[4,this._storage.read(o)]);case 1:if(f=O.sent(),p=Math.round(T()-l),m={lastModified:(null==f?void 0:f.lastModified)||NaN,lastRead:u,reads:((null==f?void 0:f.reads)||0)+1},_=void 0,h=function(t){var n=(0,r.a)({cacheStats:m,cacheType:C._cacheType,app:(null==f?void 0:f.app)||C._app,key:{original:i,encoded:(null==f?void 0:f.key)||o},performance:{io:p,crypto:_,total:Math.round(T()-c)}},t);return e._buffer[o]={data:n,readTime:l},n},!f)return[2,h({data:void 0})];if(f.lastModified&&(null===(a=null===(n=null==d?void 0:d.data)||void 0===n?void 0:n.cacheStats)||void 0===a?void 0:a.lastModified)===f.lastModified)return[2,h(d.data)];if(void 0===(b=f.data))return[2,h({data:void 0})];if(!this._dataIsEncrypted)return[2,h({data:b})];g=b,v=this._cacheSecret,y=v.CurrentKey.Key,S=v.PreviousKey.Key,D=T(),O.label=2;case 2:return O.trys.push([2,4,,7]),[4,this._crypto.decrypt({encryptedData:g,encryptionSecret:y})];case 3:return I=O.sent(),[3,7];case 4:return(x=O.sent())&&x.message&&x.message.indexOf("wrong secret or signature.")>=0?[4,this._crypto.decrypt({encryptedData:g,encryptionSecret:S})]:[3,6];case 5:void 0!==(I=O.sent())&&this.update({cacheKey:i,data:I}),O.label=6;case 6:if(void 0===I)throw x;return[3,7];case 7:return _=Math.round(T()-D),[2,h({data:I})]}})})},e.prototype._doCacheUpdate=function(t,n){var a;return(0,r.b)(this,void 0,void 0,function(){var i,o,s,c,d,u,f;return(0,r.e)(this,function(p){switch(p.label){case 0:i=this._logQos({name:"PersistentCache.update"}),p.label=1;case 1:return p.trys.push([1,9,,10]),o=this._getStorageKey(t),void 0===n?[3,6]:(s=(0,r.a)((0,r.a)({cacheStats:{lastModified:NaN,lastRead:T(),reads:1}},null===(a=e._buffer[o])||void 0===a?void 0:a.data),{data:n,app:this._app,cacheType:this._cacheType,key:{original:t,encoded:o}}),e._buffer[o]={data:s,readTime:T()},c=n,d=NaN,this._dataIsEncrypted?(u=this._cacheSecret.CurrentKey.Key,[4,this._crypto.encrypt({encryptionSecret:u,data:n,doSerialize:this._cacheType===l.localStorage})]):[3,3]);case 2:return c=p.sent(),d=c.cipherText?c.cipherText.byteLength:0,[3,4];case 3:try{d="string"==typeof n?n.length:JSON.stringify(n).length}catch(e){}p.label=4;case 4:return[4,this._storage.write({app:this._app,key:o,data:c,lastRead:s.cacheStats.lastRead,parentKey:t.parentKey,reads:s.cacheStats.reads,size:d})];case 5:return p.sent(),[3,8];case 6:return delete e._buffer[o],[4,this._storage.write({key:o,app:void 0,data:void 0,lastRead:void 0,parentKey:t.parentKey,reads:void 0,size:void 0})];case 7:p.sent(),p.label=8;case 8:return[3,10];case 9:throw f=p.sent(),i({resultType:U.a.Failure,error:f.message?f.message:f.toString()}),f;case 10:return i({resultType:U.a.Success}),[2]}})})},e.prototype._logCacheStats=function(){return(0,r.b)(this,void 0,void 0,function(){var e=this;return(0,r.e)(this,function(t){return this._logStatsTimer||(this._logStatsTimer=setTimeout(function(){return(0,r.b)(e,void 0,void 0,function(){return(0,r.e)(this,function(e){switch(e.label){case 0:return[4,this._storage.statistics()];case 1:return e.sent(),[2]}})})},3e4)),[2]})})},e.prototype._logQos=function(e){if(this._qos){var t=this._app;e.extraData||(e.extraData={}),e.extraData.alias=e.extraData.alias||t;var n=new this._qos(e);return function(e){e.extraData||(e.extraData={}),e.extraData.alias=e.extraData.alias||t,n.end(e)}}return function(e){}},e._buffer={},e}(),B=n(327),j=n(479),V=function(){function e(e,t){this._getDataPromises={};var n=e.id,a=e.dataSourceName,i=e.cacheType,o=void 0===i?l.indexedDB:i,s=(t.pageContext||{}).aadUserId;this._id=n,this._userId=s;var c=a||n,d=m.a.withData(function(e){return e.name&&c&&!e.name.startsWith(c)?(0,r.a)((0,r.a)({},e),{name:"".concat(c,".").concat(e.name)}):e});this._cache=new N({cacheType:o,telemetry:{qos:d}})}return e.prototype.getDataUtilizingCache=function(e){var t=this,n=e,a=n.cacheRequestKey,i=n.cachingStrategy,r=void 0===i?B.a.useCacheAndUpdateInTheBackground:i,s=n.cacheTimeoutTime,c=void 0===s?j.c:s,d=n.getData,l=n.returnStatistics,u=void 0!==l&&l,f=n.cacheRequestParentKey,p={key:a,user:this._userId,parentKey:f},m=function(){var e=t._getDataPromises[a];if(!e){var n=d();t._getDataPromises[a]=n,e=n.then(function(e){return t._cache.update({cacheKey:p,data:e}).catch(function(){}),delete t._getDataPromises[a],e}).catch(function(e){throw delete t._getDataPromises[a],e})}return e.then(function(e){return u?{data:e,cacheStats:{lastModified:NaN,lastRead:Date.now(),reads:1}}:e})};return r===B.a.onlyCache?o.c.resolve(this._cache.read({cacheKey:p})).then(function(e){var t=e||{},n=t.data,a=t.cacheStats;return null==n?null:u?{data:n,cacheStats:a}:n}).catch(function(){return null}):o.c.resolve(this._cache.read({cacheKey:p})).then(function(e){var n=e||{},a=n.data,i=n.cacheStats;if(null==a)return m();var o=u?{data:a,cacheStats:i}:a,s=t._isCacheExpired(i.lastModified,c);switch(r){case B.a.useCacheAndNoUpdate:return o;case B.a.useCacheAndUpdateInTheBackground:return s&&m(),o;case B.a.useCacheIfNotExpired:return s?m():o;case B.a.bypassCache:default:return m()}},function(){return m()})},e.prototype.getRequestKey=function(e,t,n){var a=[];return a.push(e),a.push(t),n&&a.push(n.toString()),a.join(",")},Object.defineProperty(e.prototype,"cacheId",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cacheVersionId",{get:function(){return this._id+"-version"},enumerable:!1,configurable:!0}),e.prototype.flushCache=function(e,t){var n={key:e,user:this._userId,parentKey:t};delete this._cache[e],this._cache.remove({cacheKey:n})},e.prototype.updateCache=function(e,t){var n={key:e,user:this._userId};this._cache.update({cacheKey:n,data:t})},e.prototype._isCacheExpired=function(e,t){return e<=(new Date).valueOf()-t},e}()}
,function(e,t,n){n.d(t,{a:function(){return r},b:function(){return a},c:function(){return i}});var a=3e5,i=864e5,r="odsp-ds-"}
,,,,,,function(e,t,n){n.d(t,{a:function(){return k}});var a,i,r,o=n(486),s=n(0),c=n("react-lib"),d=n(43),l=n(488),u=n(3),f=n(490),p=n(491),m=n(317),_=n(492),h=n(331),b=n(5),g=n(2),v=n(13),y=n(44),S=new Set(["componentRef","messageBarType","actions","ariaLabel","onDismiss","isMultiline","dismissButtonAriaLabel","truncated"]),D=((a={})[h.a.info]="info",a[h.a.warning]="warning",a[h.a.error]="error",a[h.a.severeWarning]="error",a[h.a.success]="success",a[h.a.blocked]="error",a),I=[h.a.warning,h.a.error,h.a.severeWarning,h.a.blocked],x=(0,d.a)({infoBackground:{backgroundColor:"#f3f2f1"},warningBackground:{backgroundColor:"#FFF4CE"},errorBackground:{backgroundColor:"#FDE7E9"},severeWarningBackground:{backgroundColor:"#FED9CC"},successBackground:{backgroundColor:"#DFF6DD"},infoIcon:{color:"#605e5c"},warningIcon:{color:"#797775"},errorIcon:{color:"#A80000"},severeWarningIcon:{color:"#D83B01"},successIcon:{color:"#107C10"},infoBackgroundInverted:{backgroundColor:"#323130"},warningBackgroundInverted:{backgroundColor:"#433519"},errorBackgroundInverted:{backgroundColor:"#442726"},severeWarningBackgroundInverted:{backgroundColor:"#4F2A0F"},successBackgroundInverted:{backgroundColor:"#393D1B"},infoIconInverted:{color:"#C8C6C4"},warningIconInverted:{color:"#C8C6C4"},errorIconInverted:{color:"#F1707B"},severeWarningIconInverted:{color:"#FCE100"},successIconInverted:{color:"#92C353"},body:{"& a:last-child":{paddingLeft:"4px"}},actions:{"& button:nth-child(n+2)":{marginLeft:"8px"}},noActions:{display:"none"}}),C=((i={})[h.a.info]="infoBackground",i[h.a.warning]="warningBackground",i[h.a.error]="errorBackground",i[h.a.severeWarning]="severeWarningBackground",i[h.a.success]="successBackground",i[h.a.blocked]="errorBackground",i),O=((r={})[h.a.info]="infoIcon",r[h.a.warning]="warningIcon",r[h.a.error]="errorIcon",r[h.a.severeWarning]="severeWarningIcon",r[h.a.success]="successIcon",r[h.a.blocked]="errorIcon",r),w=(0,b.a)(),E=function(e){var t=x(),n=c.useState(!0),a=n[0],i=n[1],r=w(e.styles,{theme:e.theme}),o=(0,g.D)().isInverted,d=t["".concat(C[e.messageBarType||h.a.info]).concat(o?"Inverted":"")],b=t["".concat(O[e.messageBarType||h.a.info]).concat(o?"Inverted":"")],E=function(e,t){var n,a="info",i="polite",r="auto";e.messageBarType&&(a=D[e.messageBarType],I.includes(e.messageBarType)&&(i="assertive")),(e.isMultiline||e.truncated)&&(r="multiline");var o={intent:a,politeness:i,layout:r,"aria-label":e.ariaLabel||e["aria-label"],"aria-live":e["aria-live"],icon:(0,s.a)({className:(0,u.a)("ms-MessageBar-icon",null==t?void 0:t.icon)},(null===(n=e.messageBarIconProps)||void 0===n?void 0:n.iconName)?{children:c.createElement(v.a,(0,s.a)({},e.messageBarIconProps,{className:null==t?void 0:t.icon}))}:{})};return(0,s.a)((0,s.a)({},o),(0,y.b)(e,S))}(e,r);return a?c.createElement(l.a,(0,s.a)({},E,{className:(0,u.a)("ms-MessageBar",E.className,d,r.root),icon:{className:(0,u.a)("ms-MessageBar-icon",b,r.icon)}}),c.createElement(f.a,{className:(0,u.a)("ms-MessageBar-content","ms-MessageBar-text",t.body,r.content)},e.children),e.actions||e.onDismiss?c.createElement(p.a,{containerAction:e.onDismiss?c.createElement(m.a,{onClick:function(){var t;null===(t=e.onDismiss)||void 0===t||t.call(e),i(!1)},"aria-label":e.dismissButtonAriaLabel?e.dismissButtonAriaLabel:"dismiss",appearance:"transparent",icon:c.createElement(_.a,null),className:(0,u.a)("ms-MessageBar-dismissal",r.dismissal)}):void 0,className:(0,u.a)("ms-MessageBar-actions",t.actions,r.actions,e.actions?void 0:t.noActions)},e.actions):void 0):c.createElement(c.Fragment,null)};E.displayName="MessageBarShim";var A=n(42),L=n(34),k=function(e){return(0,A.a)(o.a,E,e,L.a.FluentUIV9ShimMessageBar)}}
,,,,,,,,,,,,,,,,,function(e,t,n){n.d(t,{a:function(){return se},b:function(){return ce}});var a=n(0),i=n(8);(0,i.b)([{rawString:'.Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareMain.blocker{position:relative}.od-ShareMain.blocker:after{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background-color:'},{theme:"white",defaultValue:"#fff"},{rawString:";opacity:.8}.od-ShareMain.wide{min-width:480px}@media (max-width:480px){.od-ShareMain.wide{min-width:320px}}.od-ShareMain-section{padding:16px 16px 0;background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";border-radius:12px}.od-ShareMain-section.new{padding:24px;padding-top:14px}.od-ShareMain-section.full-bleed{padding:0}.od-ShareMain-section.separator-top{border-top:1px solid "},{theme:"variantBorder",defaultValue:"#edebe9"},{rawString:"}.od-ShareMain-section.od-ShareMain-SharedWith{align-self:stretch;padding-bottom:20px;height:2.25rem}.od-ShareMain-section .od-ShareMain-ShareHint.animation{animation:highlight 2s ease-in-out}.od-ShareMain-targets{clear:both;padding:0 20px 20px 20px}.od-ShareMain-targets-newPadding{clear:both;padding:10px}.od-ShareMain-footer{outline:transparent;position:relative;font-size:12px;font-weight:400;display:flex!important;align-items:center;justify-content:flex-start;padding:0 16px!important;width:100%;height:44px!important;color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";background-color:"},{theme:"neutralLighterAlt",defaultValue:"#faf9f8"},{rawString:";cursor:pointer!important;border:none!important;border-top:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:'!important;font:-apple-system-subheadline;bottom:0}.od-ShareMain-footer::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-ShareMain-footer:focus:after,.od-ShareMain-footer[data-fui-focus-visible]:focus:after{content:"";position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid '},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}.od-ShareMain-attachIcon{margin-top:2px;font-size:16px}[dir=ltr] .od-ShareMain-attachIcon{margin-right:4px}[dir=rtl] .od-ShareMain-attachIcon{margin-left:4px}.od-ShareMain-attachmentOptions .is-open{border:none;width:auto}.od-ShareMain-attachmentOptions button{width:auto}@media screen and (-ms-high-contrast:active){.od-ShareMain-footer:focus,.od-ShareMain-footer:hover{outline:2px solid}}@media all and (-ms-high-contrast:none),(-ms-high-contrast:active){.od-ShareMain-section-body{margin-bottom:0}}.od-ShareMain-copyLink.shareType-section{display:flex;align-items:center;justify-content:space-between}[dir=ltr] .od-ShareMain-Header-backBtnAdjust{margin-left:16px}[dir=rtl] .od-ShareMain-Header-backBtnAdjust{margin-right:16px}@keyframes highlight{from{background:"},{theme:"themeLight",defaultValue:"#a8d1ef"},{rawString:"}35%{background:"},{theme:"themeLighter",defaultValue:"#d7eaf9"},{rawString:"}to{background:0 0}}"}]);var r=n(321),o=n(32),s=n(39),c=n(82),d=n(107),l=n(40),u=n(41),f=n(98);(0,i.b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-SendLink--exclustionNotification .ms-BasePicker-text{border-bottom:.0625rem solid "},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-SendLink-method{display:flex;justify-content:space-between;align-items:center}.od-SendLink-message .od-SendLink-message-TextField{margin-bottom:12px}.od-SendLink-message .ms-TextField.ms-TextField--multiline .ms-TextField-field{padding:.375rem 0;font-size:.875rem;font-weight:"},{theme:"mediumFontWeight",defaultValue:"400"},{rawString:";font:-apple-system-body}.od-SendLink-message .ms-TextField.ms-TextField--multiline .ms-TextField-field:-ms-input-placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:.875rem;font:-apple-system-body}.od-SendLink-message .ms-TextField.ms-TextField--multiline .ms-TextField-field::placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:.875rem;font:-apple-system-body}#od-SendLink-message-id .ms-Button::after{left:2px;right:2px;top:2px;bottom:2px}@media screen and (-ms-high-contrast:active){#od-SendLink-message-id .ms-Button::after{outline-color:window}}.od-SendLink-spinner .ms-Spinner-circle{display:inline-block}[dir=ltr] .od-SendLink-spinner .ms-Spinner-circle{margin-right:8px}[dir=rtl] .od-SendLink-spinner .ms-Spinner-circle{margin-left:8px}.od-SendLink-spinner .ms-Spinner-label{display:inline}.od-SendLink-ITPolicy{position:absolute;top:-24px}[dir=ltr] .od-SendLink-ITPolicy{right:0}[dir=rtl] .od-SendLink-ITPolicy{left:0}.od-SendLink-emailButtons{font:-apple-system-headline}[dir=ltr] .od-SendLink-emailButtons{float:right}[dir=rtl] .od-SendLink-emailButtons{float:left}.od-SendLink-emailButtons-allCaps{font:-apple-system-headline;font-style:uppercase;border-radius:2px}[dir=ltr] .od-SendLink-emailButtons-allCaps{float:right}[dir=rtl] .od-SendLink-emailButtons-allCaps{float:left}[dir=ltr] div.od-SendLink-emailButtons-left{text-align:right}[dir=rtl] div.od-SendLink-emailButtons-left{text-align:left}.od-SendLink-emailButtons-rounded{font:-apple-system-headline}[dir=ltr] .od-SendLink-emailButtons-rounded{float:right}[dir=rtl] .od-SendLink-emailButtons-rounded{float:left}[dir=ltr] .od-SendLink-emailButtons-roleSelector{float:right}[dir=rtl] .od-SendLink-emailButtons-roleSelector{float:left}.od-SendLink-emailButtons-roleSelector .ms-Button{border-radius:2px}.od-SendLink-sendWrapper{display:block;width:100%;height:24px;padding-bottom:5px}.od-SendLink-email{position:relative}.od-SendLink-email .ms-TextField-field{height:4.0625rem;padding-bottom:30px;font-size:.75rem}[dir=ltr] .od-SendLink-email .ms-TextField-field{padding-left:0}[dir=rtl] .od-SendLink-email .ms-TextField-field{padding-right:0}.od-SendLink-email .ms-BasePicker .ms-BasePicker-input{font-size:.875rem;height:2rem;width:100%}@supports (font:-apple-system-footnote){.od-SendLink-email .ms-BasePicker .ms-BasePicker-input{font:-apple-system-body;height:auto}}.od-SendLink-email .ms-BasePicker .ms-BasePicker-input:-ms-input-placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:.875rem;font:-apple-system-body}.od-SendLink-email .ms-BasePicker .ms-BasePicker-input::placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:.875rem;font:-apple-system-body}.od-SendLink-sendContainer{justify-content:flex-end}.od-SendLink-characterCounter{font-size:.75rem}[dir=ltr] .od-SendLink-characterCounter{float:right}[dir=rtl] .od-SendLink-characterCounter{float:left}.od-SendLink-characterCounter--error{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-SendLink-characterCounterWrapper{display:block;height:16px;padding-bottom:5px}.od-SendLink-permissions{display:flex;flex-direction:row}.od-SendLink-peoplePicker{margin-bottom:12px;flex-grow:2;width:100%}.SendLink-statusIconContainer{height:100%;margin-bottom:0;font-size:.625rem}[dir=ltr] .SendLink-statusIconContainer{margin-left:4px}[dir=rtl] .SendLink-statusIconContainer{margin-right:4px}[dir=ltr] .SendLink-statusIconContainer{margin-right:4px}[dir=rtl] .SendLink-statusIconContainer{margin-left:4px}.SendLink-statusIconContainer .ms-Icon{background-color:transparent;position:relative}.SendLink-statusIconContainer .ms-Icon:after{position:absolute;width:12px;height:12px;background-color:"},{theme:"green",defaultValue:"#107c10"},{rawString:"}"}]);var p=n(333),m=n(136),_=n("react-lib"),h=n("prop-types-lib"),b=n(322),g=n(515),v=n(346),y=n(20),S=n(24),D=n(100),I=n(101),x=n(55),C=n(192),O=n(306),w=n(332);(0,i.b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareTargets{padding-top:20px}.od-ShareTargets-items{list-style:none;display:inline-block}[dir=ltr] .od-ShareTargets-items{margin-right:-10px}[dir=rtl] .od-ShareTargets-items{margin-left:-10px}.od-ShareTargets-item{vertical-align:top;display:inline-block;text-align:center}[dir=ltr] .od-ShareTargets-item{margin-right:10px}[dir=rtl] .od-ShareTargets-item{margin-left:10px}.od-ShareTargets-item.new{margin:0}.od-ShareTargets-item--bottomMargin{margin-bottom:16px}.od-ShareTargets-itemImage{align-items:center;background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";border-radius:50%;color:"},{theme:"neutralPrimaryAlt",defaultValue:"#3b3a39"},{rawString:";cursor:pointer;display:inline-block;height:3rem;margin-bottom:8px;width:3rem}.od-ShareTargets-itemImage.new{height:2rem;width:2rem;margin-bottom:0;display:flex;align-items:center;justify-content:center}.od-ShareTargets-icon{font-size:1.625rem;padding-top:.6875rem}.od-ShareTargets-icon.new{padding:0;height:24px;width:24px;font-size:24px}.od-ShareTargets-itemImage--border{border:.0625rem solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-ShareTargets-itemText{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:';font:-apple-system-short-caption2;font-size:.625rem}.od-ShareTargets-target{outline:transparent;position:relative;background:0 0;border:none}.od-ShareTargets-target::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-ShareTargets-target:focus:after,.od-ShareTargets-target[data-fui-focus-visible]:focus:after{content:"";position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid '},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}.od-ShareTargets-target.new{padding:0 8px 0 0}.od-ShareTargets-disabled{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}@media screen and (-ms-high-contrast:active){.od-Share button:not(.ms-Button).od-ShareTargets-target{outline:.0625rem solid windowText}.od-Share button:not(.ms-Button).od-ShareTargets-target:focus{outline:.125rem solid highlight}}"}]);var E=n(133),A=n(13),L=n(61),k=n(14),M=n(72);function P(e,t){var i=this,r=_.useState({showCoachmark:!1,teachingBubbleCampaigns:void 0}),o=r[0],s=r[1],c=_.lazy(function(){return(0,a.b)(i,void 0,void 0,function(){return(0,a.e)(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t){return setTimeout(t,e.delayTimeInMilliseconds)})];case 1:return t.sent(),[2,n.e(16).then(n.bind(n,581))]}})})});return _.useEffect(function(){var n=setTimeout(function(){return(0,a.b)(i,void 0,void 0,function(){return(0,a.e)(this,function(e){return Promise.all([t.loadTeachingBubbleCampaigns(),t.shouldTeachingBubbleBeShown(t.campaignKey)]).then(function(e){var t=e[0],n=e[1];s({teachingBubbleCampaigns:t,showCoachmark:n})}),[2]})})},e.delayTimeInMilliseconds);return function(){return clearTimeout(n)}},[s]),o.showCoachmark&&o.teachingBubbleCampaigns&&_.createElement(_.Suspense,{fallback:_.createElement(_.Fragment,null)},_.createElement(c,{componentRef:e.componentRef,delayTimeInMilliseconds:e.delayTimeInMilliseconds,target:e.target,teachingBubbleCampaign:o.teachingBubbleCampaigns[t.campaignKey],dismissCallback:function(){t.markTeachingBubbleAsDismissed(t.campaignKey),s({showCoachmark:!1,teachingBubbleCampaigns:void 0})},onTeachingBubbleSeen:e.onTeachingBubbleSeen,onPrimaryButtonClicked:e.onPrimaryButtonClicked}))}P.contextTypes={shouldTeachingBubbleBeShown:h.func,markTeachingBubbleAsDismissed:h.func,loadTeachingBubbleCampaigns:h.func,campaignKey:h.number};var T=n(71),U=n(97),F=window.require.toUrl("odsp-media/images/brand-icons/product-fluent/svg/outlook_48x1.svg"),H=window.require.toUrl("odsp-media/images/brand-icons/product-fluent/svg/teams_48x1.svg"),R=function(e){function t(t){var n=e.call(this,t)||this;return n._shareToTeamsExperiment=M.f(),n._shareToTeamsCoachmarkTarget=_.createRef(),n._coachmarkRef=_.createRef(),n._showTeams=!1,n.state={areTargetsReady:!1},n}return(0,a.d)(t,e),t.prototype.componentDidMount=function(){var e=this;this._shareToTeamsExperiment&&this.context.canUseTeams().then(function(t){e._showTeams=t,e.setState({areTargetsReady:!0})})},t.prototype.render=function(){var e=this.props.sharingInformation.requiresAccessApproval&&this.props.currentSettings.audience!==o.a.existing&&this.props.currentSettings.audience!==o.a.anyone&&this.props.currentSettings.audience!==o.a.organization;return this._shareToTeamsExperiment?(this._shareTargetsData=this.state.areTargetsReady&&this._getShareTargetsData(),e?_.createElement(L.a,{content:y.e,calloutProps:{calloutWidth:300,directionalHint:k.a.topCenter}},_.createElement("ul",{className:"od-ShareTargets-items","aria-label":y.Gf},this.state.areTargetsReady&&this._renderTargets())):_.createElement("ul",{className:"od-ShareTargets-items","aria-label":y.Gf},this.state.areTargetsReady&&this._renderTargets())):(this._shareTargetsData=this._getShareTargetsData(),e?_.createElement(L.a,{content:y.e,calloutProps:{calloutWidth:300,directionalHint:k.a.topCenter}},_.createElement("ul",{className:"od-ShareTargets-items","aria-label":y.Gf},this._renderTargets())):_.createElement("ul",{className:"od-ShareTargets-items","aria-label":y.Gf},this._renderTargets()))},t.prototype._renderTargets=function(){for(var e=[],t=this.props.sharingInformation.requiresAccessApproval&&this.props.currentSettings.audience!==o.a.existing&&this.props.currentSettings.audience!==o.a.anyone&&this.props.currentSettings.audience!==o.a.organization,n=this.props.sharingInformation.blockPeoplePickerAndSharing&&this.props.currentSettings.audience!==o.a.existing,a=0,i=this._shareTargetsData;a<i.length;a++){var r,s=i[a],c=s.icon,l=c.split(":",2)[1],u=t||n||(0,S.V)(this.props.sharingInformation),f="od-ShareTargets-icon ".concat(u?"od-ShareTargets-disabled":""," new");"od-ShareTargets-itemText ms-font-xs ".concat(u?"od-ShareTargets-disabled":""),r=c.indexOf("font:")>-1?_.createElement(A.a,{iconName:l,className:f}):_.createElement("img",{src:c,className:f}),e.push(_.createElement("li",{key:s.shareType,className:"od-ShareTargets-item new"},_.createElement(L.a,{content:s.label,styles:{root:{display:"inline-block"}}},_.createElement("button",{className:"od-ShareTargets-target new","aria-label":s.label,disabled:u,onClick:s.action,id:s.id,ref:s.shareType===d.a.webShareToTeams?this._shareToTeamsCoachmarkTarget:null},s.shareType===d.a.webShareToTeams?this._renderCoachmark():_.createElement(_.Fragment,null),_.createElement("div",{role:"presentation","aria-hidden":"true",className:"od-ShareTargets-itemImage new"},r)))))}return e},t.prototype._renderCoachmark=function(){return _.createElement(P,{componentRef:this._coachmarkRef,delayTimeInMilliseconds:200,target:this._shareToTeamsCoachmarkTarget,onTeachingBubbleSeen:this.context.onTeachingBubbleSeen(this.context.campaignKey),onPrimaryButtonClicked:this._onClick.bind(this,d.a.webShareToTeams)})},t.prototype._getShareTargetsData=function(){var e=[],t=this._determineMailShareTarget(this.props.clientId);if((0,U.a)()&&window.sessionStorage.setItem("outlookAvailability",t.toString()),t===E.a.available){var n=x.g(this.props.clientId)?"font:OutlookLogo":F,a="".concat(y.qi," ").concat(y.Kf);e.push({label:a,icon:n,bgColor:"ms-bgColor-themePrimary",shareType:d.a.outlook,action:this._onClick.bind(this,d.a.outlook),id:"od-ShareTarget-outlookButton"})}else t===E.a.other&&(a="".concat(y.qi," ").concat(y.pf),e.push({label:a,icon:"font:Mail",bgColor:"ms-bgColor-themePrimary",shareType:d.a.nonOutlook,action:this._onClick.bind(this,d.a.nonOutlook),id:"od-ShareTarget-nonOutlookButton"}));return(0,T.n)()?(a="".concat(y.qi," ").concat(y.Dk),e.push({label:a,icon:"font:TeamsLogo",bgColor:"ms-bgColor-themePrimary",shareType:d.a.mobileShareToTeams,action:this._onClick.bind(this,d.a.mobileShareToTeams),id:"od-ShareTarget-mobileTeamsButton"})):this.props.fullscreenIframeMode&&this._shareToTeamsExperiment&&!this.context.platformDetection.isIE&&this._showTeams&&(n=H,a="".concat(y.qi," ").concat(y.Dk),e.push({label:a,icon:n,bgColor:"ms-bgColor-themePrimary",shareType:d.a.webShareToTeams,action:this._onClick.bind(this,d.a.webShareToTeams),id:"od-ShareTarget-webTeamsButton"})),(0,T.k)()&&(a="".concat(y.qi," ").concat(y.je),e.push({label:a,icon:"font:More",bgColor:"ms-bgColor-themePrimary",shareType:d.a.moreApps,action:this._onClick.bind(this,d.a.moreApps),id:"od-ShareTarget-moreAppsButton"})),e},t.prototype._onClick=function(e){var t;e===d.a.webShareToTeams&&(null===(t=this._coachmarkRef.current)||void 0===t||t.dismiss()),this.props.onShareTargetClicked(e)},t.prototype._determineMailShareTarget=function(e){return x.r(this.props.clientId)&&this.props.outlookAvailability===E.a.available?E.a.available:(0,T.e)()},t.contextTypes={platformDetection:h.object.isRequired,shouldTeachingBubbleBeShown:h.func,onTeachingBubbleSeen:h.func,markTeachingBubbleAsDismissed:h.func,campaignKey:h.number,canUseTeams:h.func},t}(_.Component);(0,i.b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-SummaryBox-header-Area{display:flex;justify-content:space-between;align-items:center;min-height:24px}.od-SummaryBox-header-TextField{display:flex;font-weight:600;font-size:.625rem;align-self:center}.od-SummaryBox-summary-Main{margin:auto;padding-top:0}.od-SummaryBox-header-sparkle{height:15%;width:15%;align-self:center}[dir=ltr] .od-SummaryBox-header-sparkle{margin-right:3px}[dir=rtl] .od-SummaryBox-header-sparkle{margin-left:3px}.od-Summary-tooltipIcon{vertical-align:middle}[dir=ltr] .od-Summary-tooltipIcon{margin-left:calc(50% - 5px + 5px)}[dir=rtl] .od-Summary-tooltipIcon{margin-right:calc(50% - 5px + 5px)}.od-SummaryBox-buttonsContainer{display:flex}.od-SummaryBox-header-closeButton{height:16px;width:16px}.od-SummaryBox-header-closeButtonIcon{font-size:.625rem}.od-SummaryBox-summary-Main::-webkit-scrollbar{width:5px;height:27px}.od-SummaryBox-summary-Main::-webkit-scrollbar-thumb{background-color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:";border-radius:38px}.od-SummaryBox-summary-Main::-webkit-scrollbar-track{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";border-radius:38px}.od-SummaryBox-footer-CharacterCount{text-align:right;font-size:.625rem;margin-top:5px;align-self:center}"}]);var N=n(56),B=n(336),j=function(e){var t,n=e.summaryText,a=e.onSave,i=e.renderSeparator,r=(0,_.useState)(!1),o=r[0],s=r[1],c=(0,_.useState)(n),d=c[0],l=c[1],u=(0,_.useState)(!1),f=u[0],m=u[1],h="(".concat(d.length,"/").concat(500,")");return _.createElement(_.Fragment,null,!o&&_.createElement(_.Fragment,null,i&&_.createElement(B.a,null),_.createElement("div",{className:"od-SummaryBox-Entire"},_.createElement("div",{className:"od-SummaryBox-header-Area"},_.createElement("div",{className:"od-SummaryBox-header-TextField"},(t=window.require.toUrl("odsp-media/images/photostream/sparklepreviewcolor.svg"),_.createElement("img",{role:"presentation",src:t,className:"od-SummaryBox-header-sparkle"})),y.Ji,_.createElement(L.a,{content:y.Xi},_.createElement(A.a,{iconName:"Error",className:"od-Summary-tooltipIcon"}))),_.createElement(N.d,{className:"od-SummaryBox-header-closeButton",onClick:function(){s(!0),a("")},iconProps:{iconName:"Cancel",className:"od-SummaryBox-header-closeButtonIcon"},title:y.$h})),_.createElement("div",{className:"od-SummaryBox-summary-TextArea"},_.createElement(p.a,{className:"od-SummaryBox-summary-Main",borderless:!0,ariaLabel:y.Qi,placeholder:y.Yi,defaultValue:d,value:d,styles:{fieldGroup:{border:"none",borderRadius:"0px"}},multiline:!0,resizable:!1,onChange:function(e,t){l(t||""),m(!0)},onBlur:function(){f&&(a(d),m(!1))}}),d.length>250&&_.createElement("div",{className:"od-SummaryBox-footer-CharacterCount"},h)))))};j.propTypes={summaryText:h.string.isRequired,onSave:h.func.isRequired};var V=j,z=function(e){function t(t,n){var i=e.call(this,t)||this;return i._topLevelDivRef=_.createRef(),i._validateMessage=function(e){i.props.onSendLinkMessageChange(e);var t=(0,S.s)(e);return i.setState((0,a.a)((0,a.a)({},i.state),{messageLength:t})),""},i._validateSubject=function(e){i.props.onSendLinkSubjectChange(e);var t=(0,S.s)(e);return i.setState((0,a.a)((0,a.a)({},i.state),{subjectLength:t})),e.length<=i.props.maximumSubjectLength?"":e.length+"/"+i.props.maximumSubjectLength},i._onResolvedSuggestions=function(e){return i.context.sharingStore.getEngagementHelper().peoplePickerLinkedinSuggestions(i.props.engagementExtraData,e),e},i._onSendLinkClicked=function(e,t){if(i.props.summaryText){var n=(0,a.a)((0,a.a)({},i.props.engagementExtraData),{summaryTextRemoved:""===i.state.summaryContent,summaryTextEdited:""!==i.state.summaryContent&&i.state.summaryContent!==i.props.summaryText,summaryTextFailed:!!i.props.summaryText&&-1!==i.props.summaryText.indexOf("Something went wrong with retrieving a summary")});i.context.sharingStore.getEngagementHelper().log("ShareV3.SendLinkSendButtonClicked.WithSummary",n)}i.props.onSendLinkClicked(e,t)},i._platformDetection=n.platformDetection,i.state={messageLength:0,summaryContent:i.props.summaryText,subjectLength:0},i._onManageExistingAccessClick=i._onManageExistingAccessClick.bind(i),i._resizeTracker=new C.a(n.resize),i}return(0,a.d)(t,e),t.prototype.UNSAFE_componentWillReceiveProps=function(e){m.k({selectedItems:e.linkRecipients,sharingLinkKind:e.currentSettings.sharingLinkKind,canAddExternalPrincipal:e.sharingInformation.canAddExternalPrincipal,sharingInformation:e.sharingInformation,viewPolicyTipCallback:e.onViewPolicyTipClicked,onShareHintClick:(0,S.h)(e.sharingInformation)?e.onShareHintClick:void 0,permissionsMap:e.permissionsMap}),this.setState((0,a.a)({},this.state))},t.prototype.componentDidMount=function(){this._resizeIfNeeded()},t.prototype.componentDidUpdate=function(e){this._resizeIfNeeded(),e.summaryText!==this.props.summaryText&&this.props.showItemInsights&&this.props.summaryText&&this.updateSummaryContent(this.props.summaryText)},t.prototype.render=function(){var e=this.props,t=e.currentSettings,n=e.linkRecipients,a=m.f(n),i=m.g(n,e.groupsMemberCount),r=this._platformDetection.isIOS||x.f(this.props.clientId)?"od-SendLink-emailButtons-rounded":this._platformDetection.isAndroid||x.c(this.props.clientId)?"od-SendLink-emailButtons-allCaps":"od-SendLink-emailButtons-left";r+=this._isRoleSelectorCompactExperimentOn?" od-SendLink-emailButtons-roleSelector":"";var o=_.createElement(R,{fullscreenIframeMode:this.props.fullscreenIframeMode,clientId:this.props.clientId,currentSettings:this.props.currentSettings,onShareTargetClicked:this.props.onShareTargetClicked,outlookAvailability:this.props.outlookAvailability,sharingInformation:this.props.sharingInformation}),s=this.props.showSendButton?_.createElement("div",{className:r},_.createElement(g.a,{ctaLabel:this.props.ctaLabel,currentSettings:this.props.currentSettings,errorMessage:this.props.errorMessage,linkRecipients:this.props.linkRecipients,maximumMessageLength:this.props.maximumMessageLength,maximumSubjectLength:this.props.maximumSubjectLength,messageText:""===this.props.summaryText?this.props.messageText:this.props.messageText+"\n"+this.state.summaryContent,subjectText:this.props.subjectText,onSendLinkClicked:this._onSendLinkClicked,permissionsMap:this.props.permissionsMap,sendButtonType:v.a.button,sharingInformation:this.props.sharingInformation})):"",c=e.isLoadingDefaultRecipients?_.createElement("div",null,_.createElement(D.a,{className:"od-SendLink-spinner",label:y.Oe,size:I.a.small})):_.createElement(b.a,{defaultSelectedItems:n,error:e.errorMessage,onChange:e.onSelectedPeopleChange,onResolvedSuggestions:this._onResolvedSuggestions,oversharingExternalsWarning:a,oversharingGroupsWarning:i,pickerSettings:e.sharingInformation.peoplePickerSettings,sharingLinkKind:t.sharingLinkKind,sharingInformation:e.sharingInformation,permissionsMap:e.permissionsMap,disableGraph:this.context.sharingStore.shouldDisableGraphForPeopleSearch(),clientId:e.clientId,onInputChange:e.onPeoplePickerInputChange||null,renderRoleSelector:this._shouldRenderRoleSelector(),roleSelectorProps:this._getRoleSelectorProps()});return _.createElement("div",{ref:this._topLevelDivRef,className:"od-SendLink"},_.createElement("div",{className:"od-SendLink-email"},_.createElement("div",{className:"od-SendLink-peoplePicker"},c),_.createElement("div",{className:"od-SendLink-message",id:"od-SendLink-message-id"},this._renderTextArea(),this._renderCharacterCounter(),_.createElement("div",{className:"od-SendLink-method"},o,s))))},t.prototype._shouldRenderRoleSelector=function(){return this.props.currentSettings.audience!==o.a.existing},t.prototype._getRoleSelectorProps=function(){var e=(0,S.V)(this.props.sharingInformation),t=(0,O.c)({clientId:this.props.clientId,sharingStore:this.context.sharingStore,sharingInformation:this.props.sharingInformation,audience:this.props.currentSettings.audience,mode:u.a.share,isPreventDownloadAllowed:this.context.sharingStore.isPreventDownloadAllowed()}),n=(0,O.k)(this.props.currentSettings.audience,this.props.sharingInformation.sharingAbilities,this.props.sharingInformation.fileExtension);return{shimmer:e,menuPermissionOptions:t,sharingRole:this.props.currentSettings.sharingRole,mode:u.a.share,clientId:this.props.clientId,ariaLabel:y.he,showStopSharing:!1,onRoleChange:this.props.onRoleChange,showLinkSettings:!0,onLinkSettingsClicked:this.props.onLinkSettingsClicked,currentSettings:this.props.currentSettings,roleSelectorAs:w.a,showDropdownWithOfficeReview:n}},t.prototype._resizeIfNeeded=function(){this._resizeTracker&&this._resizeTracker.checkSizeChangeForRef(this._topLevelDivRef)},t.prototype._onManageExistingAccessClick=function(){this.context.sharingStore.getEngagementHelper().whoElseHasAccessClicked(this.props.engagementExtraData),this.props.onManageExistingAccessClick()},t.prototype.updateSummaryContent=function(e){this.setState({summaryContent:e})},t.prototype._renderTextArea=function(){var e=this;if(this.props.showTextArea){var t=this.props.showItemInsights&&!!this.props.summaryText,n=this.props.summaryText;return _.createElement("div",{className:"od-SendLink-message-TextField"},this._isSubjectExperimentOn&&_.createElement(p.a,{borderless:!0,underlined:!0,placeholder:y.ak,onGetErrorMessage:this._validateSubject,defaultValue:this.props.subjectText}),_.createElement(p.a,{borderless:!0,placeholder:y.Ue,ariaLabel:y.Pe,multiline:!0,resizable:!1,onGetErrorMessage:this._validateMessage,defaultValue:this.props.messageText}),t&&_.createElement(V,{summaryText:n,onSave:function(t){n=t,e.updateSummaryContent(t)},renderSeparator:!0}))}},t.prototype._renderCharacterCounter=function(){var e=this.state.messageLength,t=e>this.props.maximumMessageLength,n="od-SendLink-characterCounter ".concat(t?"od-SendLink-characterCounter--error":"");if(e>this.props.maximumMessageLength/2)return t?_.createElement("div",{className:"od-SendLink-characterCounterWrapper"},_.createElement("span",{"aria-label":y.Hb,role:"alert",className:n},e,"/",this.props.maximumMessageLength)):_.createElement("div",{className:"od-SendLink-characterCounterWrapper"},_.createElement("span",{className:n},e,"/",this.props.maximumMessageLength))},t.contextTypes={platformDetection:h.object.isRequired,sharingStore:h.object.isRequired,resize:h.func.isRequired},t}(_.Component),G=n(335),K=n(503),W=n(320),q=n(347),Q=n(145),Y=n(112),J=n(21),X=n(193),Z=n(514),$=n(304),ee=n(201),te=function(e,t){te.contextTypes={onDismiss:h.func};var n={hideItemName:!e.singleComponent,doNotrenderHeaderButtons:!e.singleComponent,titleIsSubLevel:!0,sendButtonType:e.singleComponent?v.a.button:v.a.copyLink,shouldBeFocused:e.singleComponent,hostOptions:e.hostOptions};return _.createElement("div",{className:"od-ShareMain-section new"},ae(e,t.onDismiss),_.createElement("div",{className:"od-ShareMain-copyLink shareType-section"},_.createElement(K.a,{clientId:e.clientId,companyName:e.companyName,currentSettings:e.currentSettings,onShareHintClick:function(){e.onShareHintClick(X.b.CopyLinkSettingsHint,!0)},sharingInformation:e.sharingInformation,linkRecipients:null,customLabeledAudienceConfig:e.customLabeledAudienceConfig}),_.createElement("div",{className:"od-ShareMain-copyLink copyLink-button"},_.createElement(g.a,{ctaLabel:y.cc,currentSettings:e.currentSettings,linkRecipients:null,onSendLinkClicked:e.onSendLinkClicked,permissionsMap:null,sharingInformation:e.sharingInformation,sendButtonType:n.sendButtonType,shouldBeFocused:n.shouldBeFocused}))))},ne=function(e,t){var n,a;return(null!==(a=null===(n=null==e?void 0:e.hostOptions)||void 0===n?void 0:n.showCloseButton)&&void 0!==a?a:x.q(e.clientId))&&_.createElement(ee.a,{className:"ShareMain-close",iconProps:{iconName:"Clear"},ariaLabel:y.jb,onClick:function(e){e.stopPropagation(),e.preventDefault(),t()},tooltipContent:y.jb,directionalHint:k.a.bottomAutoEdge})},ae=function(e,t){var n,i,o=!e.singleComponent,s=!e.singleComponent,c=(e.singleComponent?v.a.button:v.a.copyLink,e.singleComponent,e.hostOptions,null===(i=null===(n=e.sharingInformation)||void 0===n?void 0:n.item)||void 0===i?void 0:i.name);return _.createElement(r.a,(0,a.a)({},(0,$.a)(e),{actions:s?void 0:ne(e,t),mainHeaderText:y.lc,subHeaderText:o?"":c}))},ie=te,re=n(211),oe=n(302),se=500,ce=function(e){function t(t,n){var a=e.call(this,t)||this;return a._peoplePickerHasUnresolvedText=!1,a._onSharedWithClicked=function(){a.context.sharingStore.getEngagementHelper().manageAccessFacePileClicked(a._engagementExtraData),a.props.onShowPermissionsListClicked()},a._onConfirmationExternalSharingApply=function(){a.setState({showConfirmationDialog:!1,showShareHintAnimation:!0},function(){a.props.onAudienceChange(o.a.specificPeopleFlex,s.a.flexible,c.a.specificPeople)})},a._onConfirmationExternalSharingCancel=function(){a.setState({showConfirmationDialog:!1})},a._onSelectedPeopleChange=function(e){var t=a.props,n=void 0;(0,S.h)(t.sharingInformation)&&(n=t.onShareHintClick,J.W()&&(n=t.onShareHintClick.bind(a,X.b.PeoplePickerErrorLinkSettingsHint)));var i=m.k({selectedItems:e,sharingLinkKind:t.currentSettings.sharingLinkKind,canAddExternalPrincipal:t.sharingInformation.canAddExternalPrincipal,sharingInformation:t.sharingInformation,viewPolicyTipCallback:t.onViewPolicyTipClicked,onShareHintClick:n,permissionsMap:t.permissionsMap,audience:t.currentSettings.audience,scope:t.currentSettings.sharingScope}),r=!1,o=!1,s=null;if(i){for(var d=t.currentSettings.sharingScope===c.a.organization,l=0,u=e;l<u.length;l++){var f=u[l];if(f.isExternal&&d){r=!0,M.b()&&(o=!0,s=f);break}}r&&a.context.sharingStore.getEngagementHelper().externalSharingCslError(a._engagementExtraData)}a.setState({peoplePickerErrorMessage:i,showConfirmationDialog:o,externalSharingPerson:s},function(){t.onSelectedPeopleChange(e)})},a._onPeoplePickerInputChange=function(e){a._peoplePickerHasUnresolvedText=""!==e},a._onShareTargetClicked=function(e,t){(a.context.sharingStore.isConsumer()&&a.props.currentSettings.audience!==o.a.specificPeople||a._isPeoplePickerValid(e)||!(a.props.currentSettings.audience===o.a.specificPeopleFlex||a.props.currentSettings.audience===o.a.specificPeople||a.props.linkRecipients.length>0))&&a.setState({showActivityIndicator:!0,shareType:e},function(){a.props.onShareTargetClicked(e,t)})},a._onCopyLinkSectionCopyButtonClicked=function(){a.context.sharingStore.getEngagementHelper().log("ShareV3.copyLinkSectionCopyButtonClicked",a.props.engagementExtraData),a._onShareTargetClicked(d.a.copy,!0)},a._onSendLinkClicked=function(e,t){a.context.sharingStore.getEngagementHelper().log("ShareV3.SendLinkSendButtonClicked",a.props.engagementExtraData),a._isPeoplePickerValid(d.a.share)&&a.setState({showActivityIndicator:!0,shareType:d.a.share},function(){a.props.onSendLinkClicked(e,t)})},a._onAttachAsCopyClicked=function(){var e=a.props.clientId;if(a.context.sharingStore.getEngagementHelper().sendACopyClicked(a._engagementExtraData),x.i(e)){var t=!a.state.isAttachAsCopyContextualMenuVisible;a.setState({isAttachAsCopyContextualMenuVisible:t},function(){})}else if(e===l.a.ngsc||x.g(e))try{window.external.SendCopy()}catch(e){}},a._shareClickTime=n.shareClickTime,a._engagementExtraData=t.engagementExtraData,a._sharingClientMessenger=n.sharingClientMessenger,a._dismiss=n.onDismiss,a.state={isAttachAsCopyContextualMenuVisible:!1,shareType:d.a.share,showActivityIndicator:!1,peoplePickerErrorMessage:null,showConfirmationDialog:!1,externalSharingPerson:null,showShareHintAnimation:!1},a}return(0,a.d)(t,e),t.prototype.componentDidMount=function(){this._sharingClientMessenger?this._sharingClientMessenger.sendShareReady():T.r(this._shareClickTime,this.props.clientId,u.a.share,this.props.scenarioId,this.props.correlationId),this._updatePeoplePickerError(this.props)},t.prototype.UNSAFE_componentWillReceiveProps=function(e){this._updatePeoplePickerError(e)},t.prototype.render=function(){var e=this.props,t=this.state.showActivityIndicator?this._getActivityMessage():"",n=this._renderFooter();return _.createElement("div",{className:"od-ShareMain ".concat(this.state.showActivityIndicator?" blocker":"")},_.createElement("div",{className:"od-ShareMain-section new"},this._renderHeader(),_.createElement("div",{className:"od-ShareMain-ShareHint ".concat(this.state.showShareHintAnimation?"animation":"")},_.createElement(K.a,{clientId:e.clientId,companyName:e.companyName,currentSettings:e.currentSettings,onShareHintClick:e.onShareHintClick.bind(this,X.b.MainLinkSettingsHint),sharingInformation:e.sharingInformation,linkRecipients:null,customLabeledAudienceConfig:e.customLabeledAudienceConfig})),this._renderSendLink(),this.props.shouldWaitForSharingInfoBarInformation&&this._renderSharingInfoBar()),this._renderCopyLinkSection(!0),this._renderSharedWith(),n,this._renderActivityIndicator(),this._renderConfirmationDialogExternalSharing(),Y.a(t,"assertive","alert",!0))},t.prototype._getHeaderActions=function(){var e,t,n,a=this;return(null!==(n=null===(t=null===(e=this.props)||void 0===e?void 0:e.hostOptions)||void 0===t?void 0:t.showCloseButton)&&void 0!==n?n:x.q(this.props.clientId))&&_.createElement(ee.a,{className:"ShareMain-close",iconProps:{iconName:"Clear"},ariaLabel:y.jb,onClick:function(e){e.stopPropagation(),e.preventDefault(),a._dismiss()},tooltipContent:y.jb,directionalHint:k.a.bottomAutoEdge})},t.prototype._renderHeader=function(){var e;return _.createElement(r.a,{actions:this._getHeaderActions(),mainHeaderText:y.zi,subHeaderText:null===(e=this.props.item)||void 0===e?void 0:e.name,renderBackButton:this.props.hasBackButton,onBackButtonClicked:this.props.onBackButtonClicked})},t.prototype._renderSharingInfoBar=function(){return _.createElement(_.Suspense,{fallback:_.createElement(D.a,null)},_.createElement(oe.o,{sharingInfoBarMessageTypeId:this.props.sharingInfoBarMessageTypeId,parentCssClass:"ShareMain"}))},t.prototype._renderCopyLinkSection=function(e){return _.createElement(_.Fragment,null,_.createElement(Z.a,null),_.createElement(ie,{singleComponent:!1,clientId:this.props.clientId,companyName:this.props.companyName,currentSettings:this.props.currentSettings,sharingInformation:this.props.sharingInformation,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,hostOptions:this.props.hostOptions,onShareHintClick:this.props.onShareHintClick,onSendLinkClicked:this._onCopyLinkSectionCopyButtonClicked}))},t.prototype._renderFooter=function(){var e,t,n=this.props,a=n.clientId,i=null===(e=n.hostOptions)||void 0===e?void 0:e.isSendCopyEnabled,r=null===(t=n.hostOptions)||void 0===t?void 0:t.isSendPdfEnabled;if(x.i(a)){var o=W.a.getAttachAsCopyOptions(a,n.item,this.context.sharingStore,this._engagementExtraData,i,r);if(1===o.length&&"pdf"!==o[0].key)return _.createElement("div",null,_.createElement("button",{className:"od-ShareMain-footer",onClick:o[0].onClick},_.createElement("div",{"aria-hidden":!0,role:"presentation",className:"od-ShareMain-attachIcon"},_.createElement(A.a,{iconName:"Copy"})),_.createElement("span",null,y.ob)));if(o.length>0)return _.createElement("div",null,_.createElement(N.c,{className:"od-ShareMain-footer",text:y.ob,iconProps:{iconName:"Copy"},menuProps:{shouldFocusOnMount:!0,items:o},styles:{label:{marginLeft:"0px"}}}))}else if((a===l.a.ngsc||x.g(a))&&this._isSendCopyEnabled())return _.createElement("div",null,_.createElement("button",{className:"od-ShareMain-footer",onClick:this._onAttachAsCopyClicked},_.createElement("div",{className:"od-ShareMain-attachIcon"},_.createElement(A.a,{iconName:"Copy"})),_.createElement("span",null,y.ob)))},t.prototype._renderSendLink=function(){if(!this.props.sharingInformation.blockPeoplePickerAndSharing||(0,S.V)(this.props.sharingInformation)){var e=this.props;return _.createElement(z,{fullscreenIframeMode:this.props.fullScreenIframeMode,ctaLabel:y.Ai,showTextArea:!0,sharingInformation:e.sharingInformation,onSendLinkClicked:this._onSendLinkClicked,currentSettings:e.currentSettings,onSelectedPeopleChange:this._onSelectedPeopleChange,groupsMemberCount:e.groupsMemberCount,onViewPolicyTipClicked:e.onViewPolicyTipClicked,linkRecipients:e.linkRecipients,permissionsMap:e.permissionsMap,messageText:e.messageText,summaryText:e.summaryText,subjectText:e.subjectText,onSendLinkMessageChange:e.onSendLinkMessageChange,onSendLinkSubjectChange:e.onSendLinkSubjectChange,createPeopleSharingLinks:e.createPeopleSharingLinks,errorMessage:this.state.peoplePickerErrorMessage,clientId:e.clientId,showSendButton:!0,maximumMessageLength:se,maximumSubjectLength:100,isLoadingDefaultRecipients:e.isLoadingDefaultRecipients,onManageExistingAccessClick:this.props.onShowPermissionsListClicked,engagementExtraData:this._engagementExtraData,onShareHintClick:this.props.onShareHintClick,onRoleChange:this.props.onRoleChange,onPeoplePickerInputChange:this._onPeoplePickerInputChange,onLinkSettingsClicked:e.onShareHintClick.bind(this,X.b.RoleSelector),onShareTargetClicked:this._onShareTargetClicked,outlookAvailability:this.props.outlookAvailability,showItemInsights:this.props.showItemInsights})}},t.prototype._renderSharedWith=function(){var e=(0,S.H)(this.props.sharingInformation,this.context.sharingStore.isConsumer()),t=e.shared,n=e.activeLinks,a=e.sharingPrincipals;return t?_.createElement("div",{className:"od-ShareMain-section od-ShareMain-SharedWith new separator-top"},_.createElement(G.a,{ariaLabel:y.Ae,label:y.$i,getPhotoUrl:(0,Q.b)(this.props.sharingInformation.webUrl),onClick:this._onSharedWithClicked,sharingLinks:n,sharingPrincipals:a})):null},t.prototype._renderActivityIndicator=function(){if(this.state.showActivityIndicator)return _.createElement(q.a,{message:this._getActivityMessage(),ariaHidden:!0})},t.prototype._renderConfirmationDialogExternalSharing=function(){if(!M.b()||!this.state.showConfirmationDialog||!this.state.externalSharingPerson)return null;var e=this.state.externalSharingPerson;return _.createElement(_.Suspense,{fallback:_.createElement(D.a,null)},_.createElement(oe.c,{confirmationCode:re.a.shareDialogExternalSharing,participant:e,onApply:this._onConfirmationExternalSharingApply,onCancel:this._onConfirmationExternalSharingCancel}))},t.prototype._getActivityMessage=function(){switch(this.state.shareType){case d.a.share:return y.o;case d.a.mobileShareToTeams:case d.a.webShareToTeams:return y.m;case d.a.outlook:return y.l;case d.a.copy:case d.a.nonOutlook:case d.a.moreApps:default:return y.n}},t.prototype._isSendCopyEnabled=function(){return T.l()},t.prototype._isPeoplePickerValid=function(e){if(!this.state.peoplePickerErrorMessage){if(e!==d.a.share&&!this.props.createPeopleSharingLinks&&this.props.currentSettings.audience===o.a.specificPeople){for(var t=!1,n=!1,a=0,i=this.props.linkRecipients;a<i.length;a++){var r=i[a];t||(t=r.isExternal&&!r.providerName),n||(n=!r.isExternal||r.isExternal&&!!r.providerName)}if(t&&n)return this.setState({peoplePickerErrorMessage:_.createElement("span",{role:"alert","aria-live":"assertive"},y.Fe)}),!1}var s=this.props.currentSettings.audience===o.a.specificPeopleFlex||this.props.currentSettings.audience===o.a.specificPeople||e===d.a.share;return this._peoplePickerHasUnresolvedText?(this.setState({peoplePickerErrorMessage:_.createElement("span",{role:"alert","aria-live":"assertive"},y.Tk)}),!1):0!==this.props.linkRecipients.length||!s||(this.setState({peoplePickerErrorMessage:_.createElement("span",{role:"alert","aria-live":"assertive"},y.Zh)}),!1)}},t.prototype._updatePeoplePickerError=function(e){var t=void 0;if((0,S.h)(e.sharingInformation)&&(t=e.onShareHintClick,J.W()&&(t=e.onShareHintClick.bind(this,X.b.PeoplePickerErrorLinkSettingsHint))),e.linkRecipients||e.sharingInformation.errorCategory==f.a.shareLink){var n=m.k({selectedItems:e.linkRecipients,sharingLinkKind:e.currentSettings.sharingLinkKind,canAddExternalPrincipal:e.sharingInformation.canAddExternalPrincipal,sharingInformation:e.sharingInformation,viewPolicyTipCallback:e.onViewPolicyTipClicked,onShareHintClick:t,permissionsMap:e.permissionsMap,audience:e.currentSettings.audience,scope:e.currentSettings.sharingScope});n||e.sharingInformation.errorCategory!=f.a.shareLink||(n=_.createElement("span",null,e.sharingInformation.errorMessage)),this.setState({peoplePickerErrorMessage:n,showActivityIndicator:!n&&this.state.showActivityIndicator})}},t.prototype.shouldShowActivityIndicator=function(e){this.setState({showActivityIndicator:e})},t.contextTypes={shareClickTime:h.number,sharingStore:h.object.isRequired,sharingClientMessenger:h.object,onDismiss:h.func.isRequired},t}(_.Component)}
,function(e,t,n){n.d(t,{a:function(){return x}});var a=n(8);(0,a.b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareHint{background:0 0;margin:0 16px;position:relative}.od-ShareHint.new{margin:0;padding:0;flex:1}.od-ShareHint.od-ShareHint--shimmerFadeout .od-ShareHint-shimmer{opacity:0;display:none}.od-ShareHint.od-ShareHint--loaded .od-ShareHint-data{opacity:1;line-height:1rem}.od-ShareHint .ms-Label{font-size:.75rem;padding:5px 8px;vertical-align:top}.od-ShareHint .ms-Icon--CaretDownSolid8{vertical-align:top;font-size:.625rem;padding-top:9px;color:"},{theme:"neutralPrimaryAlt",defaultValue:"#3b3a39"},{rawString:"}.od-ShareHint .od-ShareHint-data,.od-ShareHint .od-ShareHint-shimmer{display:flex;align-items:center}.od-ShareHint .od-ShareHint-data{font-size:.875rem;background:0 0;padding:10px 10px 10px 0;margin:0;opacity:0;transition:opacity .2s;border-radius:"},{theme:"roundedCorner2",defaultValue:"2px"},{rawString:";border:0}@media screen and (-ms-high-contrast:active){.od-ShareHint .od-ShareHint-data{border:1px solid WindowText}}.od-ShareHint .od-ShareHint-data .od-ShareHint-iconHolder{vertical-align:top}.od-ShareHint .od-ShareHint-data .od-ShareHint-chevron{display:inline-block;vertical-align:top;margin-top:4px;font-size:.625rem;color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}[dir=ltr] .od-ShareHint .od-ShareHint-data .od-ShareHint-chevron{margin-left:auto}[dir=rtl] .od-ShareHint .od-ShareHint-data .od-ShareHint-chevron{margin-right:auto}[dir=ltr] .od-ShareHint .od-ShareHint-data .od-ShareHint-chevron{padding-left:4px}[dir=rtl] .od-ShareHint .od-ShareHint-data .od-ShareHint-chevron{padding-right:4px}.od-ShareHint .od-ShareHint-data.copyLinkNotification{padding:0}.od-ShareHint div.od-ShareHint-data{border:0}.od-ShareHint button.od-ShareHint-data{width:100%}.od-ShareHint .od-ShareHint-shimmer{width:100%;position:absolute;top:0;box-sizing:border-box;border:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";padding:14px 10px;background:linear-gradient(to right, "},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:" 0, "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:" 50%, "},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:" 100%);background-size:90% 100%;background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";background-clip:content-box;background-repeat:no-repeat;animation:2s ease-in-out infinite placeholderShimmer;transition:opacity .2s,visibility .2s}.od-ShareHint .od-ShareHint-shimmer .od-ShareHint-iconHolder-shimmer{width:2.25rem;height:1.5rem}.od-ShareHint .od-ShareHint-shimmer .od-ShareHint-iconHolder-shimmer svg{fill:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-ShareHint .od-ShareHint-shimmer .od-ShareHint-text-shimmer{color:transparent;width:100%;height:1.5rem;border-bottom:4px solid "},{theme:"white",defaultValue:"#fff"},{rawString:";border-top:4px solid "},{theme:"white",defaultValue:"#fff"},{rawString:";box-sizing:border-box}.teams .od-ShareHint-data .od-ShareHint-chevron{transform:rotate(90deg);margin-top:0}.ms-TeachingBubble-closebutton{color:#fff}@keyframes placeholderShimmer{0%{background-position:-900%}100%{background-position:1000%}}"}]);var i=n(0);(0,a.b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareHintDetail-status{padding:0 8px;vertical-align:middle}.od-ShareHintDetail-statusText{display:inline-block;font-size:.875rem;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";word-break:break-word}[dir=ltr] .od-ShareHintDetail-statusText{margin-right:4px}[dir=rtl] .od-ShareHintDetail-statusText{margin-left:4px}.od-ShareHintDetail-statusText.accessSummaryLink{font-size:.75rem}.od-ShareHintDetail-statusText.unHealthy{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-ShareHintDetail-statusText:hover{cursor:default}.od-ShareHintDetail-statusText:hover.clickable{cursor:pointer}.od-ShareHintDetail-statusText i{vertical-align:middle;padding:5px 6px 7px 6px}@supports (font:-apple-system-body){.od-ShareHintDetail-statusText{font:-apple-system-body}}.od-ShareHintDetail{height:100%;background-color:transparent;border:none}.od-ShareHintDetail.od-ShareHintDetail--clickable:hover{cursor:pointer}.od-ShareHintDetail.od-ShareHintDetail--clickable:hover .od-ShareHintDetail-statusText{text-decoration:underline}.od-ShareHintDetail.copyLinkNotification{padding:0}.od-ShareHintDetail.copyLinkNotification .od-ShareHintDetail-status{padding:0}.od-ShareHintDetail--hover:hover{border:none}.od-ShareHintDetail--hover:hover:active{border:none}.od-ShareHintDetail-statusDetails{position:absolute;top:0}[dir=ltr] .od-ShareHintDetail-statusDetails{right:-36px}[dir=rtl] .od-ShareHintDetail-statusDetails{left:-36px}[dir=ltr] .od-ShareHintDetail-statusDetails{text-align:right}[dir=rtl] .od-ShareHintDetail-statusDetails{text-align:left}.od-ShareHintDetail-expirationText{font-size:.75rem;color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-ShareHintDetail-iconsList{display:inline-block}.od-ShareHintDetail-item{display:inline-block;margin-bottom:0;font-size:.75rem;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}[dir=ltr] .od-ShareHintDetail-item{margin-left:4px}[dir=rtl] .od-ShareHintDetail-item{margin-right:4px}.od-ShareHintDetail-item .ms-Icon{background-color:transparent;position:relative}.od-ShareHintDetail-item .ms-Icon:after{position:absolute;width:12px;height:12px;background-color:"},{theme:"green",defaultValue:"#107c10"},{rawString:"}.od-ShareHintDetail-item-expired{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}[dir=ltr] .od-ShareHintDetail-description{text-align:left}[dir=rtl] .od-ShareHintDetail-description{text-align:right}.od-ShareHintDetail-chevron{margin-left:4px;font-size:.5rem;color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-ShareHintDetail-iconTooltipContent{font-size:.875rem}@media screen and (-ms-high-contrast:active){.od-ShareHintDetail.od-ShareHintDetail--clickable:hover .od-ShareHintDetail-statusText{color:highlight}}"}]);var r=n(13),o=n(32),s=n(39),c=n(52),d=n(61),l=n("react-lib"),u=n(19),f=n(21),p=n(20),m=n(134),_=n(24),h=n(177),b=n(55),g=n(126),v=n(56),y=n("prop-types-lib"),S=function(e){function t(t,n){var a=e.call(this,t)||this;return a._renderStatusIcons=a._renderStatusIcons.bind(a),a}return(0,i.d)(t,e),t.prototype.render=function(){var e=this._getLabel(this.props.currentSettings);(0,f.J)()&&this.props.isCopyLinkNotification&&(e=(0,_.w)({clientId:this.props.clientId,sharingInformation:this.props.sharingInformation,currentSettings:this.props.currentSettings,companyName:this.props.companyName,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,sharingStore:this.context.sharingStore}));var t="od-ShareHintDetail ".concat((0,f.lb)()?"od-ShareHintDetail--hover":""," ").concat(this.props.isClickable?"od-ShareHintDetail--clickable":""," ").concat(this.props.isCopyLinkNotification?"copyLinkNotification":""),n=e+", "+p.ji;return l.createElement(v.a,{className:t,onClick:this.props.isClickable?this.props.onClickCallback:void 0,"aria-label":n},l.createElement("div",{className:"od-ShareHintDetail-description"},l.createElement("div",{className:"od-ShareHintDetail-status"},l.createElement("span",{className:"od-ShareHintDetail-statusText ".concat(this.props.isClickable?"clickable":"")},e,this._renderStatusIcons(),this._renderChevron(this.props.isClickable)))))},t.prototype._renderStatusIcons=function(){if(this.props.currentSettings){var e=this.props.currentSettings.expiration,t=this.props.currentSettings.hasPassword,n=(this.props.currentSettings.preventDownload,[]);e&&e.getTime()!==new Date(0).getTime()&&n.push({icon:"Calendar",tooltip:"".concat(u.d(p.md,(0,m.d)(e)))}),t&&n.push({icon:"Lock",tooltip:p.Ki}),this.props.currentSettings.audience!==o.a.existing&&this.props.currentSettings.isReview&&h.a[this.props.sharingInformation.fileExtension]&&n.push({icon:"Feedback",tooltip:p.Nf}),this.props.currentSettings.audience===o.a.anyone&&this.props.currentSettings.trackLinkUsers&&n.push({icon:"ReminderPerson",tooltip:b.d(this.props.clientId)?p.hi:p.gi});var a=n.map(function(e,t){var n={onRenderContent:function(){return l.createElement("div",{className:"od-ShareHintDetail-iconTooltipContent"},e.tooltip)}};return l.createElement("span",{className:"od-ShareHintDetail-item"},l.createElement(d.a,{id:e.icon,tooltipProps:n},l.createElement(r.a,{iconName:e.icon,"tab-index":0,"data-is-focusable":!0,role:"button","aria-label":e.tooltip,styles:{root:{fontSize:"0.625rem",width:"2.75",height:"2.75",padding:"7px"}}})))});return l.createElement("div",{className:"od-ShareHintDetail-iconsList"},a)}},t.prototype._renderChevron=function(e){if(e)return l.createElement(r.a,{iconName:g.a.isRightToLeft?"ChevronLeft":"ChevronRight",className:"od-ShareHintDetail-chevron",styles:{root:{fontSize:"0.625rem",width:"2.75",height:"2.75"}}})},t.prototype._getLabel=function(e){var t=this.props.companyName,n=this.props.sharingInformation.addressBarLinkSettings,a=this.props.sharingInformation.sharingAbilities;if(this.props.isAddressBarLinkHint&&n)return n.linkDisabled||!(0,_.i)(a)?p.eh:u.d(p.Sc,t);if(!e)return"";if(e.preventDownload){if(e.audience===o.a.anyone)return p.U;if(e.audience===o.a.organization)return u.d(p.Dc,t);if(e.audience===o.a.specificPeopleFlex)return p.Jj}switch(e.sharingLinkKind){case s.a.direct:return e.audience===o.a.specificPeople?this.props.sharingInformation.requiresAccessApproval?p.oi:e.sharingRole?(0,_.T)(e.sharingRole)?p.zj:e.sharingRole===c.a.review?h.a[this.props.sharingInformation.fileExtension]?p.qj:p.Qj:p.Yj:e.isEdit?p.zj:p.Yj:p.ad;case s.a.organizationView:return u.d(p.Sc,t);case s.a.organizationEdit:return u.d(p._c,t);case s.a.anonymousView:return p.T;case s.a.anonymousEdit:return p.J;case s.a.flexible:return this._getFlexibleLabel(e,t);default:return""}},t.prototype._getFlexibleLabel=function(e,t){return e.audience===o.a.existing?p.ad:e.audience===o.a.specificPeopleFlex?e.sharingRole?e.sharingRole==c.a.manageList?p.Wj:(0,_.T)(e.sharingRole)?p.zj:e.sharingRole===c.a.review?h.a[this.props.sharingInformation.fileExtension]?p.qj:p.Qj:p.Yj:e.isEdit?p.zj:p.Yj:e.audience===o.a.customLabeledSpecificPeople?e.sharingRole===c.a.review?this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.entityName?u.d(p.Oc,this.props.customLabeledAudienceConfig.entityName):(0,_.o)(this.props.clientId,"review",this.props.customLabeledAudienceConfig,this.props.sharingInformation.fileExtension):e.isEdit?this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.entityName?u.d(p.xc,this.props.customLabeledAudienceConfig.entityName):(0,_.o)(this.props.clientId,"edit",this.props.customLabeledAudienceConfig):this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.entityName?u.d(p.wc,this.props.customLabeledAudienceConfig.entityName):(0,_.o)(this.props.clientId,"view",this.props.customLabeledAudienceConfig):e.audience===o.a.organization?e.sharingRole===c.a.review?h.a[this.props.sharingInformation.fileExtension]?u.d(p.vc,t):u.d(p.yc,t):e.sharingRole==c.a.manageList?u.d(p.gc,t):e.isEdit?u.d(p._c,t):u.d(p.Sc,t):e.audience===o.a.anyone?e.sharingRole===c.a.review?h.a[this.props.sharingInformation.fileExtension]?p.N:p.S:e.sharingRole==c.a.manageList?p.M:e.isEdit?p.J:p.T:""},t.contextTypes={sharingStore:y.object.isRequired},t}(l.Component),D=n(504),I=n(337);function x(e){var t,n,a=e.clientId,i=e.companyName,s=e.currentSettings,c=e.onShareHintClick,d=e.sharingInformation,f=e.linkRecipients,m=e.customLabeledAudienceConfig,h=e.isAddressBarLinkHint,b=e.addressBarLink,v=e.isCopyLinkNotification,y=l.useRef(),x=(0,l.createRef)(),C=(l.useCallback(function(e){if(e)return l.createElement("div",{ref:x},l.createElement(r.a,{iconName:g.a.isRightToLeft?"ChevronLeft":"ChevronRight",className:"od-ShareHint-chevron",styles:{root:{fontSize:"1.3125rem",width:"2.75",height:"2.75"}}}))},[]),l.useCallback(function(){c&&c()},[c])),O=l.useCallback(function(){var e=s.audience;return e===o.a.anyone?I.a.anyone:e===o.a.organization?I.a.workGroup:e===o.a.existing?I.a.existing:e===o.a.customLabeledSpecificPeople?I.a.chat:I.a.specificPeople},[s]),w=l.useCallback(function(e){return e===I.a.anyone?p.Qg:e===I.a.workGroup?u.d(p.Xg,i):e===I.a.existing?p.eh:e===I.a.specificPeople?p.Sh:void 0},[i]),E=!!c,A="od-ShareHint ".concat((0,_.V)(e.sharingInformation)?"":"od-ShareHint--shimmerFadeout od-ShareHint--loaded"," new"),L="od-ShareHint-data ".concat(E?"od-ShareHint--clickable":""," ").concat(v?"copyLinkNotification":"");if(t=l.createElement("div",{className:"od-ShareHint-shimmer"},!v&&l.createElement("div",{className:"od-ShareHint-iconHolder-shimmer"},l.createElement("svg",{viewBox:"0 0 15 10",width:"36",height:"24"},l.createElement("path",{d:"M0,0 L15,0 L15,10 L0,10 L0,0 Z M0,5 C0,7.76142375 2.23857625,10 5,10 C7.76142375,10 10,7.76142375 10,5 C10,2.23857625 7.76142375,2.22044605e-16 5,0 C2.23857625,-2.22044605e-16 0,2.23857625 0,5 L0,5 Z"}))),l.createElement("div",{className:"od-ShareHint-text-shimmer"})),h){var k=d.addressBarLinkSettings,M=d.sharingAbilities,P=(T=k.linkDisabled||!(0,_.i)(M)?I.a.existing:I.a.workGroup)===I.a.existing?p.eh:u.d(p.Xg,i);n=l.createElement("div",{className:L,ref:y},!v&&l.createElement("div",{className:"od-ShareHint-iconHolder"},l.createElement(D.a,{label:P,permissionsType:T,showLabel:!1})),l.createElement(S,{clientId:a,companyName:i,currentSettings:null,sharingInformation:d,linkRecipients:f,customLabeledAudienceConfig:null,isAddressBarLinkHint:!0,addressBarLink:b,isClickable:E,onClickCallback:C,isCopyLinkNotification:v}))}else{P=w(T=O());var T,U=s.audience===o.a.customLabeledSpecificPeople&&m&&m.iconUrl;n=c?l.createElement("div",{className:L,ref:y},!v&&l.createElement("div",{className:"od-ShareHint-iconHolder"},l.createElement(D.a,{label:P,permissionsType:T,iconUrl:U,showLabel:!1})),l.createElement(S,{clientId:a,companyName:i,currentSettings:s,sharingInformation:d,linkRecipients:f,customLabeledAudienceConfig:m,isClickable:E,onClickCallback:C})):l.createElement("div",{className:L,autoFocus:!0},!v&&l.createElement("div",{className:"od-ShareHint-iconHolder"},l.createElement(D.a,{label:P,permissionsType:T,iconUrl:U,showLabel:!1})),l.createElement(S,{clientId:a,companyName:i,currentSettings:s,sharingInformation:d,linkRecipients:f,customLabeledAudienceConfig:m,isClickable:E,isCopyLinkNotification:e.isCopyLinkNotification}))}return l.createElement("div",{"aria-label":p.Ne,className:A},n,t)}}
,function(e,t,n){n.d(t,{a:function(){return d}});var a=n(0),i=n("react-lib"),r=n("prop-types-lib");(0,n(8).b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareLinkDescription{align-items:top;display:flex;padding:0;width:100%}.od-ShareLinkDescription .od-ShareLinkDescription-label-section{width:80%;text-align:left}[dir=ltr] .od-ShareLinkDescription .od-ShareLinkDescription-label-section{padding-left:16px}[dir=rtl] .od-ShareLinkDescription .od-ShareLinkDescription-label-section{padding-right:16px}[dir=rtl] .od-ShareLinkDescription .od-ShareLinkDescription-label-section{text-align:right}@supports (font:-apple-system-body){.od-ShareLinkDescription .od-ShareLinkDescription-label-section{font:-apple-system-body}}.od-ShareLinkDescription .od-ShareLinkDescription-label-section .od-ShareLinkDescription-detailText{font-size:.75rem;font-weight:400;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}@supports (font:-apple-system-caption1){.od-ShareLinkDescription .od-ShareLinkDescription-label-section .od-ShareLinkDescription-detailText{font:-apple-system-caption1}}.od-ShareLinkDescription-label{font-size:.875rem;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";display:flex;overflow:hidden;text-overflow:ellipsis;vertical-align:top;top:2px;position:relative;margin:0;width:100%}[dir=ltr] .od-ShareLinkDescription-label{text-align:left}[dir=rtl] .od-ShareLinkDescription-label{text-align:right}@supports (font:-apple-system-body){.od-ShareLinkDescription-label{font:-apple-system-body}}.od-ShareLinkDescription-image{width:1rem;height:1rem}.od-ShareLinkDescription-icon{align-items:center;border-radius:50%;border-style:solid;border-width:.0625rem;box-sizing:border-box;display:flex;height:1.5rem;justify-content:center;width:1.5rem;font-size:.875rem}@supports (height:-apple-system-body){.od-ShareLinkDescription-icon{height:-apple-system-body;width:-apple-system-body}}.od-ShareLinkDescription-icon .ms-Icon{font-size:.875rem}.od-ShareLinkDescription-icon.icon-AddFriend{color:#393939;background:#f2f2f2;border:1px solid #393939}.od-ShareLinkDescription-icon.icon-Work{color:#004e8c;background:#f0f5f8;border:1px solid #004e8c}.od-ShareLinkDescription-icon.icon-Chat{color:#6264a7;background:#f6f6fa;border:1px solid #6264a7}.od-ShareLinkDescription-icon.icon-Mail{color:"},{theme:"teal",defaultValue:"#008272"},{rawString:";background:#f0f5f7;border:1px solid "},{theme:"teal",defaultValue:"#008272"},{rawString:"}.od-ShareLinkDescription-icon.icon-Globe{color:#0b6a0b;background:#f1f6f1;border:1px solid #0b6a0b}.od-ShareLinkDescription-icon.icon-ReminderPerson{color:#8e562e;background:#f4efeb;border:1px solid #8e562e}.od-ShareLinkDescription-icon .ms-Icon--AddFriend{top:50%;left:50%;transform:translate(-50%,-50%);color:"},{theme:"orangeLight",defaultValue:"#ea4300"},{rawString:";position:relative;display:inline-block;border-radius:50%;width:1.5rem;height:1.5rem;border:.0625rem solid "},{theme:"black",defaultValue:"#000"},{rawString:"}[dir=ltr] .od-ShareLinkDescription-icon .ms-Icon--AddFriend{padding-right:10px}[dir=rtl] .od-ShareLinkDescription-icon .ms-Icon--AddFriend{padding-left:10px}.od-ShareLinkDescription-IELabel{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.od-ShareLinkDescription-InfoBtn i{vertical-align:middle;padding:5px 6px 7px 6px}"}]);var o=n(505),s=n(506),c=n(13),d=function(e){function t(t,n){var a=e.call(this,t)||this;return a._platformDetection=n.platformDetection,a}return(0,a.d)(t,e),t.prototype.render=function(){var e=o.a[this.props.permissionsType],t=this.props.iconUrl?i.createElement("img",{"aria-hidden":"true",className:"od-ShareLinkDescription-image",src:this.props.iconUrl,alt:this.props.label}):i.createElement(c.a,{"aria-hidden":"true",iconName:e,styles:{root:{fontSize:"0.875rem",width:"2.75",height:"2.75"}}});return i.createElement("div",{className:"od-ShareLinkDescription"},!1!==this.props.renderIcon&&i.createElement("div",{className:"od-ShareLinkDescription-icon icon-".concat(e),"aria-hidden":"true"},t),this._renderLabel())},t.prototype._renderLabel=function(){var e=this.props.infoButtonMessage,t=e?i.createElement(s.a,{className:"od-ShareLinkDescription-InfoBtn",message:e,disableKeyboard:!0}):"";if(this.props.showLabel){var n=this.props.isSelected||this.props.showDetailText;t=n?null:t;var a=i.createElement("div",{className:"od-ShareLinkDescription-label"},i.createElement("div",{className:"".concat(this._platformDetection.isIE?"od-ShareLinkDescription-IELabel":"")},this.props.label),t);return i.createElement("div",{className:"od-ShareLinkDescription-label-section"},a,n&&i.createElement("span",{className:"od-ShareLinkDescription-detailText"},this.props.detailText))}},t.contextTypes={platformDetection:r.object.isRequired},t}(i.Component)}
,function(e,t,n){n.d(t,{a:function(){return r}});var a,i=n(337),r=((a={})[i.a.anyone]="Globe",a[i.a.onlyYou]="Lock",a[i.a.specificPeople]="AddFriend",a[i.a.workGroup]="Work",a[i.a.existing]="ReminderPerson",a[i.a.chat]="Chat",a[i.a.mail]="Mail",a)}
,function(e,t,n){n.d(t,{a:function(){return d}});var a=n(0);(0,n(8).b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-InfoButton-infoIcon{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";padding:5px 4px 4px 4px;font-size:.75rem}@supports (font:-apple-system-body){.od-InfoButton-infoIcon{font-size:inherit}}.od-InfoButton-button{background:0 0;border:none;padding:0}.od-InfoButton-content{font-size:.75rem;display:flex;flex-direction:column;padding:10px;width:250px}@supports (font:-apple-system-caption1){.od-InfoButton-content{font:-apple-system-caption1}}"}]);var i=n(507),r=n(14),o=n(13),s=n("react-lib"),c=n("prop-types-lib"),d=function(e){function t(t,n){var i=e.call(this,t)||this;return i._onShowCallout=function(){i.setState((0,a.a)((0,a.a)({},i.state),{isCalloutVisible:!0}))},i._onDismissCallout=function(){i.setState((0,a.a)((0,a.a)({},i.state),{isCalloutVisible:!1}))},i._onInfoButton=function(e){i._infoButton=e},i.state={isCalloutVisible:!1},i}return(0,a.d)(t,e),t.prototype.render=function(){var e=this.props,t=this.state;return s.createElement("div",{style:{display:"inline"}},s.createElement("div",{className:"od-InfoButton-button ".concat(e.className),onClick:this._onShowCallout,ref:this._onInfoButton,onFocus:e.disableKeyboard?void 0:this._onShowCallout,onBlur:e.disableKeyboard?void 0:this._onDismissCallout,role:"button",tabIndex:e.disableKeyboard?-1:0,"aria-label":e.ariaLabel||e.message},s.createElement(o.a,{iconName:"Info",className:"od-InfoButton-infoIcon",onMouseOver:this._onShowCallout,onMouseLeave:this._onDismissCallout,styles:{root:{fontSize:"0.75rem"}}})),t.isCalloutVisible&&s.createElement(i.a,{directionalHint:r.a.topCenter,gapSpace:2,onDismiss:this._onDismissCallout,target:this._infoButton,setInitialFocus:!0},s.createElement("div",{className:"od-InfoButton-content"},s.createElement("span",{className:"od-InfoButton-message"},e.message))))},t.contextTypes={strings:c.object.isRequired},t}(s.Component)}
,function(e,t,n){n.d(t,{a:function(){return k}});var a=n(138),i=n(0),r=n("react-lib"),o=n(508),s=n(512),c=n(14),d=n(140),l=n(338),u=n(44),f=["above-start","above","above-end","above","below-start","below","below-end","below","before-top","before","before-bottom","after-top","after","after-bottom"],p=new Set(["target","directionalHint","directionalHintForRTL","gapSpace","beakWidth","calloutWidth","calloutMaxWidth","calloutMinWidth","backgroundColor","bounds","minPagePadding","isBeakVisible","preventDismissOnScroll","preventDismissOnResize","preventDismissOnLostFocus","dismissOnTargetClick","preventDismissOnEvent","shouldDismissOnWindowFocus","coverTarget","alignTargetEdge","role","ariaLabel","ariaLabelledBy","ariaDescribedBy","className","style","onLayerMounted","layerProps","popupProps","onPositioned","onDismiss","doNotLayer","directionalHintFixed","finalHeight","hideOverflow","setInitialFocus","calloutMaxHeight","onScroll","theme","styles","hidden","shouldUpdateWhenHidden","shouldRestoreFocus","onRestoreFocus"]),m=new Set(["role","ariaLabel","ariaLabelledBy","ariaDescribedBy","onDismiss","className","shouldRestoreFocus","onRestoreFocus","enableAriaHiddenSiblings"]),_=function(e){return e instanceof HTMLElement?e:"string"==typeof e?document.querySelector(e):e&&"current"in e?e.current:void 0},h=function(e,t){return function(n,a){var i,r;if(!0!==a.open){var o=(null===(i=e.popupProps)||void 0===i?void 0:i.onDismiss)||e.onDismiss;if("keydown"!==n.type||"Escape"!==n.key)if("click"!==n.type&&"focus"!==n.type)if("wheel"!==n.type);else{if(e.preventDismissOnScroll)return;var s=new Event("scroll");null==o||o(s)}else{if("focus"===n.type&&e.preventDismissOnLostFocus)return;if(null===(r=e.preventDismissOnEvent)||void 0===r?void 0:r.call(e,n))return;t&&!e.dismissOnTargetClick&&n.target instanceof Node&&t.contains(n.target)||null==o||o(n)}else null==o||o(n)}}},b=n(5),g=n(43),v=n(83),y=n(3),S=(0,b.a)(),D="--lengthCalloutWidth",I="--lengthCalloutMaxWidth",x="--lengthCalloutMinWidth",C="--lengthCalloutMaxHeight",O=(0,g.a)({calloutRoot:(0,i.a)((0,i.a)({},v.a.padding(0)),{boxSizing:"border-box",display:"flex"}),calloutMain:{overflowX:"hidden",overflowY:"auto",position:"relative",width:"100%"},overflowYHidden:{overflowY:"hidden"},calloutWidth:{width:"var(".concat(D,")")},calloutMaxWidth:{maxWidth:"var(".concat(I,")")},calloutMinWidth:{minWidth:"var(".concat(x,")")},calloutMaxHeight:{maxHeight:"var(".concat(C,")")}}),w=n(197),E=r.forwardRef(function(e,t){var n=(0,w.a)("CalloutContent",e),a=function(e){var t,n,a,r,o=e.target,s=e.trapFocus,c=e.doNotLayer,d=e.isBeakVisible,f=void 0===d||d,b=e.hidden,g={open:!(void 0!==b&&b),withArrow:f,onOpenChange:h(e,_(o)),closeOnScroll:!0,trapFocus:s,inline:c},v=(0,u.b)(e,p);return delete v["aria-roledescription"],{popoverProps:g,popoverSurfaceProps:v,popoverSurfaceMainProps:(0,i.a)({role:(null===(t=e.popupProps)||void 0===t?void 0:t.role)||e.role,"aria-roledescription":e["aria-roledescription"],"aria-describedby":(null===(n=e.popupProps)||void 0===n?void 0:n.ariaDescribedBy)||e.ariaDescribedBy,"aria-label":(null===(a=e.popupProps)||void 0===a?void 0:a.ariaLabel)||e.ariaLabel,"aria-labelledby":(null===(r=e.popupProps)||void 0===r?void 0:r.ariaLabelledBy)||e.ariaLabelledBy},(0,u.b)(e.popupProps||{},m)),focusTrapZoneProps:e.trapFocus&&e.focusTrapProps&&(0,l.a)(e.focusTrapProps)||{}}}(n),b=a.popoverProps,g=a.popoverSurfaceProps,v=a.popoverSurfaceMainProps,E=a.focusTrapZoneProps,A=function(e){var t,n=e.className,a=e.calloutWidth,i=e.calloutMaxWidth,o=e.calloutMinWidth,s=e.calloutMaxHeight,c=e.hideOverflow,d=e.styles,l=e.theme,u=O(),f=S(d,{theme:l}),p={root:(0,y.a)("ms-Callout",n,u.calloutRoot,f.root,!!a&&u.calloutWidth,!!i&&u.calloutMaxWidth,!!o&&u.calloutMinWidth,!!s&&u.calloutMaxHeight),main:(0,y.a)("ms-Callout-main",null===(t=e.popupProps)||void 0===t?void 0:t.className,u.calloutMain,f.calloutMain,!!s&&u.calloutMaxHeight,c&&u.overflowYHidden)},m=r.useMemo(function(){var e;return(e={})[D]=!!a&&"".concat(a,"px")||void 0,e[I]=!!i&&"".concat(i,"px")||void 0,e[x]=!!o&&"".concat(o,"px")||void 0,e[C]=!!s&&"".concat(s,"px")||void 0,e},[a,i,o,s]),_=r.useMemo(function(){var e;return(e={})[C]=!!s&&"".concat(s,"px")||void 0,e},[s]);return{classNames:p,styles:r.useMemo(function(){var e={};return Object.keys(m).some(function(e){return void 0!==e})&&(e.root=m),Object.keys(_).some(function(e){return void 0!==e})&&(e.main=_),e},[m,_])}}(n),L=A.classNames,k=A.styles,M=function(e){var t=e.target,n=e.coverTarget,a=e.gapSpace,i=e.directionalHint,o=void 0===i?c.a.bottomAutoEdge:i,s=r.useRef(null);r.useEffect(function(){var e,n=_(t);n&&(null===(e=s.current)||void 0===e||e.setTarget(n))},[t]);var l=(0,d.a)(f[o]);return l.positioningRef=s,void 0!==n&&(l.coverTarget=n),void 0!==a&&(l.offset={mainAxis:a}),l}(n);return r.createElement(o.a,(0,i.a)({},b,{positioning:M}),r.createElement(s.a,(0,i.a)({},g,{className:L.root,style:k.root,ref:t}),r.createElement("div",(0,i.a)({},v,{className:L.main,style:k.main}),e.trapFocus?r.createElement("div",(0,i.a)({},E),e.children):e.children)))});E.displayName="CalloutShim";var A=n(42),L=n(34),k=function(e){return(0,A.a)(a.a,E,e,L.a.FluentUIV9ShimCallout)}}
,,,,,,,function(e,t,n){n.d(t,{a:function(){return i}});var a=n("react-lib");function i(){return a.createElement("div",{className:"separator"})}(0,n(8).b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.separator{border-top:1px solid "},{theme:"variantBorder",defaultValue:"#edebe9"},{rawString:"}"}])}
,function(e,t,n){n.d(t,{a:function(){return f}});var a=n(0);(0,n(8).b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-SendButton{font-size:.875rem;font:-apple-system-title1;margin:0;padding:0;border-radius:.25rem;min-height:2rem;height:-moz-fit-content;height:fit-content}.od-SendButton .ms-Button-label{font:-apple-system-body}@media screen and (-ms-high-contrast:active){.od-SendButton.send:focus,.od-SendButton.send:hover{background:highlight}}"}]);var i=n("react-lib"),r=n(56),o=n(280),s=n(32),c=n(346),d=n(24),l=n("prop-types-lib"),u=n(2),f=function(e){function t(t,n){var a=e.call(this,t)||this;return a._buttonRef=i.createRef(),a._onSendLinkClicked=function(){a.props.onSendLinkClicked(a.props.messageText,a.props.subjectText)},a._platformDetection=n.platformDetection,a}return(0,a.d)(t,e),t.prototype.componentDidMount=function(){this._buttonRef&&this.props.shouldBeFocused&&this._buttonRef.current.focus()},t.prototype.render=function(){if(!this.props.ctaLabel)return null;var e=!1;if(this.props.currentSettings.audience===s.a.existing&&this.props.linkRecipients)for(var t=0,n=this.props.linkRecipients;t<n.length;t++){var a=n[t];if(void 0===this.props.permissionsMap[a.email]&&void 0===this.props.permissionsMap[a.userId]){e=!0;break}}var l=!!this.props.errorMessage||(0,d.V)(this.props.sharingInformation)||e||(0,d.s)(this.props.messageText)>this.props.maximumMessageLength||(0,d.s)(this.props.subjectText)>this.props.maximumSubjectLength;switch(this.props.sendButtonType){case c.a.button:return i.createElement(r.e,{className:"od-SendButton send",disabled:l,onClick:this._onSendLinkClicked,componentRef:this._buttonRef},this.props.ctaLabel);case c.a.link:return i.createElement("div",{className:"od-SendButton link"},i.createElement(o.a,{disabled:l,onClick:this._onSendLinkClicked},this._platformDetection.isAndroid?this.props.ctaLabel.toUpperCase():this.props.ctaLabel));case c.a.copyLink:var f=(0,u.D)(),p={color:f.palette.themeDarker,backgroundColor:f.palette.neutralLighter,borderColor:f.palette.neutralSecondary},m={root:{color:f.palette.themePrimary,backgroundColor:f.palette.white,borderColor:f.palette.neutralTertiary},rootHovered:p,rootFocused:p,rootDisabled:{color:f.palette.themeTertiary,backgroundColor:f.palette.white,borderColor:f.palette.neutralTertiary}};return this.context.sharingStore.isConsumer()&&this.props.currentSettings.audience!==s.a.specificPeople&&(l=!1),i.createElement(r.c,{className:"od-SendButton copy",onClick:this._onSendLinkClicked,styles:m,disabled:l},this.props.ctaLabel)}},t.contextTypes={platformDetection:l.object.isRequired,sharingStore:l.object.isRequired},t}(i.Component)}
,function(e,t,n){n.d(t,{a:function(){return v}});var a=n(517),i=n(0),r=n("react-lib"),o=n(519),s=n(342),c=n(25),d=n(3),l=n(48),u=n(340),f=n(339),p=n(46),m=n(338),_=void 0,h=r.forwardRef(function(e,t){var n=(0,o.a)({tabBehavior:"limited-trap-focus"}),a=e.disabled?{}:n,h=r.useRef(null),b=(0,p.a)(h,t),g=(0,s.a)().findFirstFocusable,v=(0,c.b)().targetDocument;r.useImperativeHandle(e.componentRef,function(){return{focus:S}}),r.useLayoutEffect(function(){e.disabled||e.disableFirstFocus||e.forceFocusInsideTrap||S();var t=e.elementToFocusOnDismiss||v.activeElement;return function(){return y(t)}},[e.disabled,e.disableFirstFocus,e.forceFocusInsideTrap]);var y=(0,l.a)(function(t){if(v){var n=v.activeElement;e.disableRestoreFocus||"function"!=typeof(null==t?void 0:t.focus)||!(0,u.a)(h.current,n)&&n!==v.body||t.focus()}});(0,f.a)({contains:u.a,element:window,disabled:e.disabled||e.isClickableOutsideFocusTrap,callback:function(e){e.stopPropagation(),e.preventDefault(),S()},refs:[h]});var S=r.useCallback(function(){if(h.current){var t=null;if("string"==typeof e.firstFocusableTarget)t=h.current.querySelector(e.firstFocusableTarget);else if(e.firstFocusableTarget)t=e.firstFocusableTarget(h.current);else if(e.firstFocusableSelector){var n="string"==typeof e.firstFocusableSelector?e.firstFocusableSelector:e.firstFocusableSelector();t=h.current.querySelector("."+n)}if(t=t||g(h.current)||null){var a=window;a&&(void 0!==_&&a.cancelAnimationFrame(_),_=a.requestAnimationFrame(function(){t&&t.focus(),_=void 0}))}}},[e.firstFocusableTarget,e.firstFocusableSelector,h.current]),D=(0,l.a)(function(t){!1===e.forceFocusInsideTrap||e.disabled||(0,u.a)(h.current,t.target)||S()});r.useEffect(function(){return null==v||v.addEventListener("focus",D,!0),function(){null==v||v.removeEventListener("focus",D,!0)}},[]);var I=(0,m.a)(e);return r.createElement("div",(0,i.a)({ref:b},I,a,{className:(0,d.a)("fui-FocusTrapZoneShim",e.className)}),e.children)}),b=n(42),g=n(34),v=function(e){return(0,b.a)(a.a,h,e,g.a.FluentUIV9ShimFocusTrapZone)}}
,,,,function(e,t,n){n.d(t,{a:function(){return ee}});var a,i=n(0),r=n(41),o=n(32),s=n(39),c=n(107),d=n(98),l=n(52);!function(e){e[e.NONE=0]="NONE",e[e.VIEW=1]="VIEW",e[e.EDIT=2]="EDIT",e[e.OWNER=3]="OWNER",e[e.REVIEW=6]="REVIEW",e[e.RESTRICTED_VIEW=7]="RESTRICTED_VIEW"}(a||(a={}));var u,f=n(281);!function(e){e[e.CompletedSuccessfully=0]="CompletedSuccessfully",e[e.AccessRequestsQueued=1]="AccessRequestsQueued",e[e.NoResolvedUsers=-1]="NoResolvedUsers",e[e.AccessDenied=-2]="AccessDenied",e[e.CrossSiteRequestNotSupported=-3]="CrossSiteRequestNotSupported",e[e.UnknowError=-4]="UnknowError",e[e.EmailBodyTooLong=-5]="EmailBodyTooLong",e[e.ListUniqueScopesExceeded=-6]="ListUniqueScopesExceeded",e[e.CapabilityDisabled=-7]="CapabilityDisabled",e[e.ObjectNotSupported=-8]="ObjectNotSupported",e[e.NestedGroupsNotSupported=-9]="NestedGroupsNotSupported",e[e.QuotaExceeded=-10]="QuotaExceeded",e[e.InvalidValue=-11]="InvalidValue",e[e.UserDoesNotExist=-12]="UserDoesNotExist",e[e.TooManyChildItemsWithUniqueScopes=-13]="TooManyChildItemsWithUniqueScopes",e[e.OperationCancelled=-14]="OperationCancelled",e[e.SharingBufferExceeded=-15]="SharingBufferExceeded",e[e.InvalidObjectStatus=-16]="InvalidObjectStatus",e[e.MountPointSharingNotAllowed=-17]="MountPointSharingNotAllowed",e[e.RequestThrottled=-18]="RequestThrottled",e[e.FileNotFound=-19]="FileNotFound",e[e.ForceCheckoutEditLink=-20]="ForceCheckoutEditLink",e[e.ShareByLinkDisabled=-21]="ShareByLinkDisabled",e[e.NotSupportedByWOPI=-22]="NotSupportedByWOPI",e[e.ListItemNotFound=-23]="ListItemNotFound",e[e.ParentListIsPrivate=-24]="ParentListIsPrivate",e[e.DocLibIsCatalog=-25]="DocLibIsCatalog",e[e.IRMIsEnabled=-26]="IRMIsEnabled",e[e.NonClaimsWebapp=-27]="NonClaimsWebapp",e[e.ParentListIsNull=28]="ParentListIsNull",e[e.RoledefinitionNotFound=-29]="RoledefinitionNotFound",e[e.ObjectNotShareableByLink=-30]="ObjectNotShareableByLink",e[e.AccessDeniedToAnonGuest=-31]="AccessDeniedToAnonGuest",e[e.AccessDeniedNotEnoughPermissions=-32]="AccessDeniedNotEnoughPermissions",e[e.DocumentIsProtectedByDLP=-33]="DocumentIsProtectedByDLP",e[e.AnonymousEditLinkNotAllowedByTenant=-34]="AnonymousEditLinkNotAllowedByTenant",e[e.UserBlockedByWhoCanShareSettings=-35]="UserBlockedByWhoCanShareSettings",e[e.ShareDoesNotExist=-36]="ShareDoesNotExist",e[e.ExternalInviteeNotAllowed=-37]="ExternalInviteeNotAllowed",e[e.SecurableNotFound=-38]="SecurableNotFound",e[e.UserIsInBlockedSecurityGroupForODB=-39]="UserIsInBlockedSecurityGroupForODB",e[e.ExternalInvitationFailed=-40]="ExternalInvitationFailed",e[e.DuplicateValuesInSharingList=-41]="DuplicateValuesInSharingList",e[e.LimitedAccessLockdownModeEnabled=-42]="LimitedAccessLockdownModeEnabled",e[e.AddressBarLinkNotUpdateable=-43]="AddressBarLinkNotUpdateable",e[e.AnonymousLinkBlockedBySiteIB=-44]="AnonymousLinkBlockedBySiteIB",e[e.ListNotFound=-45]="ListNotFound",e[e.WebNotFound=-46]="WebNotFound",e[e.ListNotShareableByLink=-47]="ListNotShareableByLink",e[e.WebNotShareableByLink=-48]="WebNotShareableByLink",e[e.AnonymousLinkDisallowedFileType=-49]="AnonymousLinkDisallowedFileType",e[e.ExternalInvitationFailedUnexpected=-50]="ExternalInvitationFailedUnexpected",e[e.AnyoneLinkDisabledForFileType=-51]="AnyoneLinkDisabledForFileType",e[e.StubFileSharingNotAllowed=-52]="StubFileSharingNotAllowed",e[e.SharingBlockedBySiteIBMode=-53]="SharingBlockedBySiteIBMode",e[e.SharingBlockedByVirusCheckStatus=-54]="SharingBlockedByVirusCheckStatus",e[e.UpdateSPShareFailed=-55]="UpdateSPShareFailed",e[e.InvitationNotSent=-56]="InvitationNotSent",e[e.ClaimNotAllowed=-57]="ClaimNotAllowed",e[e.SharingAnonymousLink=-58]="SharingAnonymousLink",e[e.SharingToBlockedDomain=-59]="SharingToBlockedDomain",e[e.SharingToInvalidEmail=-60]="SharingToInvalidEmail",e[e.SharingToUnresolvedEntity=-61]="SharingToUnresolvedEntity",e[e.SharingToBlockedUserOnODB=-62]="SharingToBlockedUserOnODB",e[e.InvalidPermissionLevel=-63]="InvalidPermissionLevel",e[e.MembersCannotShareNonListItem=-66]="MembersCannotShareNonListItem",e[e.SharingWebBlockedForChannelSite=-67]="SharingWebBlockedForChannelSite",e[e.ExternalInviteeNotAllowedForFluidComponent=-68]="ExternalInviteeNotAllowedForFluidComponent",e[e.NumInvitationsOverlimit=-69]="NumInvitationsOverlimit",e[e.NumUsersOverlimit=-70]="NumUsersOverlimit",e[e.ObjectLocked=-71]="ObjectLocked",e[e.NavParameterExceedsLengthLimit=-72]="NavParameterExceedsLengthLimit",e[e.NavParameterIsNotBase64UrlEncoded=-73]="NavParameterIsNotBase64UrlEncoded",e[e.SharingBlockedBySiteLockDown=-74]="SharingBlockedBySiteLockDown",e[e.SharingUnsupportedCspContainerSite=-75]="SharingUnsupportedCspContainerSite",e[e.SharingToNonOIdRecipient=-76]="SharingToNonOIdRecipient",e[e.AllRecipientsFailed=-77]="AllRecipientsFailed",e[e.PartialSuccess=-78]="PartialSuccess",e[e.ExternalSharingNotAllowedViaAMSRCT=-79]="ExternalSharingNotAllowedViaAMSRCT",e[e.LinkTypeNotAllowedViaAMSRCT=-80]="LinkTypeNotAllowedViaAMSRCT",e[e.SharingToGuestUserNotCurrentlyOnSharedChannelNotAllowed=-81]="SharingToGuestUserNotCurrentlyOnSharedChannelNotAllowed",e[e.InvitationBlockedByAADB2BCollaborationSettings=-82]="InvitationBlockedByAADB2BCollaborationSettings",e[e.SharingToBlockedUser=-83]="SharingToBlockedUser",e[e.SharingToBlockedBySiteRAC=-84]="SharingToBlockedBySiteRAC"}(u||(u={}));var p,m=n(40),_=n(82),h=n(305),b=n(181),g=n(133),v=n(411),y=n(422),S=n(127),D=n(80),I=n(79),x=n(412),C=n(38),O=n(7),w=n(19),E=n(134),A=n(158),L=n(58),k=n(20),M=n(521),P=n(1),T=n(4),U=n(24),F=n(145),H=n(124),R=n(55),N=n(193),B=n(132),j=n(81),V=n(135),z=n(21),G=n(72),K=n(123),W=n(169),q=n(97),Q=n(404),Y=n(31),J=n(71);!function(e){e[e.Undefined=0]="Undefined",e[e.MinorWithoutParentalConsent=1]="MinorWithoutParentalConsent",e[e.MinorWithParentalConsent=2]="MinorWithParentalConsent",e[e.Adult=3]="Adult",e[e.NotAdult=4]="NotAdult",e[e.MinorNoParentalConsentRequired=5]="MinorNoParentalConsentRequired"}(p||(p={}));var X=n(29),Z=n(592),$=n(596),ee=function(){function e(e,t){var n,a=this;this._listeners=null,this.stopSharing=function(){a._storeContents.filteredPrincipals={},a._sharingInformationInvalidated=!0,a.fetchSharingInformation(!0),a._updateIsShared()};var i=e.item,r=e.sharingInformation,o=e.policyTipInfo,s=e.outlookAvailability,c=e.companyName,d=e.defaultRecipients,l=e.accessChecked,u=void 0===l||l,f=e.mode,p=e.isListItem,_=e.prefetchGSI,h=e.waitSharingAPIsDuration,b=e.copilotHelper;this._item=i,this._multiShareIds=(null===(n=e.sharingContextInformation)||void 0===n?void 0:n.multiShareIds)||[],this._mode=f,this._sharingContextInformation=e.sharingContextInformation,this._clientId=this._sharingContextInformation&&(0,m.b)(this._sharingContextInformation.clientId),this._sharingProvider=t.sharingProvider,this._suiteNavProvider=t.suiteNavProvider||void 0,this._graphPeoplePickerHelper=t.graphPeoplePickerHelper,this._substratePeoplePickerHelper=t.substratePeoplePickerHelper,this._peoplePickerProvider=t.peoplePickerProvider,this._policyTipProvider=t.policyTipProvider||void 0,this._permissions=this._sharingContextInformation&&this._sharingContextInformation.rawInvite&&this._sharingContextInformation.rawInvite.value,this._sharingService=e.sharingService,this._firstShareLinkRequest=!0,this._listeners=[],this._groupsMemberCountCache=[],this._sharingInformationInvalidated=!1,this._groupMembersCountHash={},this._isListItem=p,this._prefetchGSI=_,this._waitSharingAPIsDuration=h,this._copilotHelper=b,this._family=void 0,this._familyMembers=[],this._sharingContextInformation&&this._sharingContextInformation.experimentContext&&(0,G.a)(this._sharingContextInformation.experimentContext),this._useSimplifiedSharingDialog=(0,U.tb)(this._clientId,this),this._platformDetection=new X.a;var v=this._sharingContextInformation?this._sharingContextInformation.scenarioId:"";if(this._telemetryExtraData={mode:this._mode,clientId:this._clientId,scenarioId:v},this._engagementHelper=new N.a(e.telemetryManager,this._telemetryExtraData),this._storeContents={sharingInformation:r,sharingLinkCreated:null,companyName:c||this._sharingContextInformation&&this._sharingContextInformation.organizationName||k.Vb,groupsMemberCount:0,policyTipInfo:o||{info:null,actionResult:null},permissionsMap:{},invitedUsers:[],defaultLink:null,defaultRecipients:null,outlookAvailability:s||g.a.none,grantAccessResult:null,addPeopleResult:null,accessRequestCreated:!1,isValidatingDefaultRecipients:!1,filteredPrincipals:{},documentInformation:null,sharingInfoBarInformation:null,copilotHelper:null},r&&r.userPhotoCdnBaseUrl&&(0,F.a)(r.userPhotoCdnBaseUrl),d&&0!==d.length?this._resolveDefaultRecipients(d,u,f):(this._eventGroup=new L.a(this),this._eventGroup.on(window,"message",function(e){if(e&&e.data)try{var t=JSON.parse(e.data);if("atMention_defaultRecipients"===t.name){var n=t.recipientIds;a._resolveDefaultRecipients(n,u,f)}}catch(e){}})),this._configureLinkIfShareId(),(0,S.d)()&&z.O()){var y=R.s(this._clientId),D=y?this._sharingService.getFamily():Promise.resolve(),I=y?this._sharingService.getFamilyMembers():Promise.resolve();Promise.all([this._toTuple(D),this._toTuple(I)]).then(function(e){var t=e[0],n=e[1];if(y&&!a._isError(t)&&!a._isError(n)&&t.value){var i=a._parseFamilyInfo(t.value.id,n.value.value),r=i.family,o=i.familyMembers;a._family=r,a._familyMembers=o}})}}return e.prototype.getWaitSharingAPIsDuration=function(){return this._waitSharingAPIsDuration},e.prototype.getAuthToken=function(){var e;return null===(e=this._sharingContextInformation)||void 0===e?void 0:e.authToken},e.prototype.getScenarioId=function(){var e;return null===(e=this._sharingContextInformation)||void 0===e?void 0:e.scenarioId},e.prototype.isConsumer=function(){return!1},e.prototype.isCOB=function(){return(0,S.d)()},e.prototype.isConsumerLists=function(){return!!(window&&window._spPageContextInfo&&window._spPageContextInfo.isSiteListsHost)},e.prototype.isListItem=function(){return this._isListItem},e.prototype.getCopilotHelper=function(){return this._copilotHelper},e.prototype.setCopilotHelper=function(e){this._copilotHelper=e},e.prototype.getEngagementHelper=function(){return this._engagementHelper},e.prototype.addListener=function(e){this._listeners.push(e)},e.prototype.removeListeners=function(){this._listeners=[]},e.prototype.getInitialLinkSettings=function(e){return null},e.prototype.getSharingInformation=function(){return this._storeContents.sharingInformation},e.prototype.shouldDisableGraphForPeopleSearch=function(){return this._storeContents&&this._storeContents.sharingInformation&&(this._storeContents.sharingInformation.enforceIBSegmentFiltering||this._storeContents.sharingInformation.enforceSPOSearch)},e.prototype.isPeopleSharingLinksEnabled=function(){if(this._storeContents.sharingInformation){var e=this._storeContents.sharingInformation.sharingAbilities;return!(!e||!e.peopleSharingLinkAbilities)&&!!e&&(e.peopleSharingLinkAbilities.canManageEditLink.enabled||e.peopleSharingLinkAbilities.canManageReadLink.enabled)}return!1},e.prototype.showManageAccess=function(){return!0},e.prototype.fetchSharingInformation=function(e,t){var n=this;return new Promise(function(a){if(n._storeContents.sharingInformation&&!n._sharingInformationInvalidated&&(!e||n._storeContents.sharingInformation.hasPermissionsInformation)&&!t)return n._getSharingInformationStats={name:"GetSharingInformationProvided",resultType:T.b.Success,duration:0},n._configureLinkIfShareId(),n._emitChange({type:h.b.FetchSharingInformation}),void a();var i=(new Date).getTime(),r=!!n._sharingContextInformation||e;n._prefetchGSI&&n._checkPrefetchSupportExpansion(r,t)?n._raceGSI(r,t,i):n._sharingProvider.getSharingInformation(n._item,r,!0,null,t).then(function(e){n._setGSIResponse(e,i)},function(e){n._setGSIError(e,i)}),a()})},e.prototype.fetchMemberCount=function(e){var t=this;this._groupMembersCountHash[e.email]||this._peoplePickerProvider.getPickerEntityInformation(e).then(function(n){var a=n.totalMemberCount;t._groupMembersCountHash[e.email]=a,t._emitChange()}).catch(function(n){t._groupMembersCountHash[e.email]=null,t._emitChange()})},e.prototype.getMembersCounts=function(){return this._groupMembersCountHash},e.prototype.shareLink=function(e){var t=this,n=new T.a({name:"shareLinkInvestigation"}),a=this._firstShareLinkRequest;this._firstShareLinkRequest=!1,(0,K.f)("sharelink.start");var l=e.settings,u=e.recipients,f=e.emailMessage,p=e.emailSubject,m=e.copyLinkCommand,_=e.allRecipientsHaveAccess,g=e.shareId,v=e.inviteesToRemove,I=e.shareType;if(e.copyLinkCommand&&R.m(this._clientId)&&this._mode===r.a.copy&&!this._sharingContextInformation.shareId&&this._sharingService&&(this._sharingContextInformation.itemUrl||this._sharingContextInformation.webAbsoluteUrl&&this._sharingContextInformation.serverRelativeItemUrl||this._sharingContextInformation.webAbsoluteUrl&&this._sharingContextInformation.uniqueId)&&a)return this._getDefaultLink(),void n.end({resultType:T.b.Success,extraData:(0,i.a)({sharingLinkPath:0},this._telemetryExtraData)});var x=0,C=0,O=!1,L=(u=u||[]).map(function(e){var t;return e.entityType===D.a.externalUser?C++:x++,e.rawPersonData&&e.rawPersonData.EntityData&&"UNVALIDATED_EMAIL_ADDRESS"===e.rawPersonData.EntityData.PrincipalType&&(O=!0),(0,S.d)()&&z.O()?{userId:e.userId,name:e.name,email:e.email,rawPersonData:null!==(t=e.rawPersonData)&&void 0!==t?t:e.entityType===D.a.group?{Key:e.userId,EntityData:{PermissionIdentityType:"Group"},isResolved:!1}:{Key:e.email,isResolved:!1}}:{userId:e.userId,name:e.name,email:e.email,rawPersonData:e.rawPersonData}});if(L=this._dedupeRecipients(L),g&&g.length>0||l.shareId&&l.shareId.length>0)n.end({resultType:T.b.Success,extraData:(0,i.a)({sharingLinkPath:1},this._telemetryExtraData)}),this._shareLink(l,L,f,p,m,a,g,v);else{if(!this.isPeopleSharingLinksEnabled()||!this._doesPSLSupportNewExternalUsers()&&O||l.audience===o.a.existing||this._storeContents.sharingInformation.requiresAccessApproval){var M=!G.c()||this._storeContents.sharingInformation.requiresAccessApproval&&m;if(l.sharingLinkKind!==s.a.direct&&l.sharingLinkKind!==s.a.flexible&&M)G.c()&&m&&!(0,U.W)(l.audience)&&(L=[]),n.end({resultType:T.b.Success,extraData:(0,i.a)({sharingLinkPath:3,settings:l},this._telemetryExtraData)}),this._shareLink(l,L,f,p,m,a,g,v);else{var P;P=l.sharingRole?this._getRoleString(l.sharingRole):this._getRoleValue(l.isEdit);var F={items:[this._item],roleValue:P,sendEmail:void 0!==f,message:f,subject:p,requireSignIn:!0,propagateSharing:!0},H=this._storeContents.sharingInformation.directLink,N=(null==l?void 0:l.audience)==o.a.existing&&(I===c.a.copy||I===c.a.outlook||I===c.a.mobileShareToTeams||I===c.a.nonOutlook||I===c.a.moreApps||I===c.a.webShareToTeams);if(0===u.length||l.audience==o.a.existing&&(this._mode===r.a.copy||this._mode==r.a.linkSettings)||N)n.end({resultType:T.b.Success,extraData:(0,i.a)({sharingLinkPath:4,useDirectLinkForShareTarget:N,recipientsLength:u.length},this._telemetryExtraData)}),this._invokeShareStatsEvent({name:"NoExtraCallReturnCanonical",duration:0,resultType:T.b.Success}),(0,K.f)("sharelink.existing"),this._handleSharedLink(H,m);else{for(var B=!0,j=0,V=u;j<V.length;j++){var q=V[j];this._storeContents.permissionsMap[q.email]!==b.a.hasAccess&&this._storeContents.permissionsMap[q.userId]!==b.a.hasAccess&&(B=!1)}if(B||_){n.end({resultType:T.b.Success,extraData:(0,i.a)({sharingLinkPath:5,useDirectLinkForShareTarget:N,recipientsLength:u.length,allUsersArePermissioned:B,allRecipientsHaveAccess:_},this._telemetryExtraData)});var Q=(new Date).getTime();(0,K.f)("sharelink.emailWithoutPermissioning.start"),this._sharingProvider.emailWithoutPermissioning(L,this._item,f,p).done(function(e){(0,K.f)("sharelink.emailWithoutPermissioning.end");var n=e.statusCode;if(n===y.a.CompletedSuccessfully)t._invokeShareStatsEvent({name:"ForwardObjectLink",duration:(new Date).getTime()-Q,resultType:T.b.Success}),t._handleSharedLink(H,m);else{var a=d.b.generic,r=k.Rd;n===y.a.ObjectNotSupported?(a=d.b.objectNotSupported,r=k.uj):n===y.a.TooManyChildItemsWithUniqueScopes?(a=d.b.invalidEmail,r=w.d(k.$d,e.invalidEmails.join(", "))):n===y.a.CapabilityDisabled?(a=d.b.generic,r=e.errorMessage):n&&(r=(0,W.d)(n)||r),t._invokeShareStatsEvent({name:"ForwardObjectLink",duration:(new Date).getTime()-Q,resultType:T.b.Failure,error:a}),t._storeContents.sharingInformation=(0,i.a)((0,i.a)({},t._storeContents.sharingInformation),{error:a,errorCategory:d.a.shareLink,errorMessage:r}),t._emitChange({type:h.b.ShareLink})}})}else{var Y=(new Date).getTime();(0,K.f)("sharelink.share.start"),n.end({resultType:T.b.Success,extraData:(0,i.a)({sharingLinkPath:6,useDirectLinkForShareTarget:N,recipientsLength:u.length,allUsersArePermissioned:B,allRecipientsHaveAccess:_},this._telemetryExtraData)}),this._sharingProvider.share(L,F,!0).done(function(e){(0,K.f)("sharelink.share.end");var n=e.statusCode;if(n===y.a.CompletedSuccessfully){var a=H;0===x&&1===C&&e.invitationLink?a=(0,i.a)((0,i.a)({},H),{url:e.invitationLink}):0===x&&C>1&&e.invitationLink&&(a=(0,i.a)((0,i.a)({},H),{url:t._removeEmailQueryParamFromInvitationLink(e.invitationLink)})),l.audience===o.a.customLabeledSpecificPeople&&(a=(0,i.a)((0,i.a)({},a),{audience:o.a.customLabeledSpecificPeople})),t._invokeShareStatsEvent({name:"ShareObject",resultType:T.b.Success,duration:(new Date).getTime()-Y}),t._handleSharedLink(a,m)}else if(n===y.a.AccessRequestsQueued)t._storeContents.accessRequestCreated=!0,t._invokeShareStatsEvent({name:"ShareObject",resultType:T.b.Success,duration:(new Date).getTime()-Y}),t._handleSharedLink(H,m);else{var r=d.b.generic,s=k.Rd;n===y.a.ObjectNotSupported?(r=d.b.objectNotSupported,s=k.uj):n===y.a.TooManyChildItemsWithUniqueScopes?(r=d.b.invalidEmail,s=w.d(k.$d,e.invalidEmails.join(", "))):n===y.a.CapabilityDisabled?(r=d.b.generic,s=e.errorMessage):n&&(s=(0,W.d)(n)||s),t._storeContents.sharingInformation=(0,i.a)((0,i.a)({},t._storeContents.sharingInformation),{error:r,errorCategory:d.a.shareObject,errorMessage:s}),t._invokeShareStatsEvent({name:"ShareObject",resultType:T.b.Failure,duration:(new Date).getTime()-Y,error:r}),t._emitChange({type:h.b.ShareLink})}})}}}}else n.end({resultType:T.b.Success,extraData:(0,i.a)({sharingLinkPath:2,settings:l},this._telemetryExtraData)}),this.isBundleShare()?this._sharingService.createBundle(this._multiShareIds,w.d(k.oj,E.a(new Date))).then(function(e){var n,i=e;i.properties={ItemChildCount:""+i.childCount},t._item=i;var r=i.parentReference.sharepointIds;if(r){var o=null===(n=null==i?void 0:i.id)||void 0===n?void 0:n.match(/^[0-9a-fA-F]{1,16}!s([0-9a-fA-F]{8}[0-9a-fA-F]{4}[0-9a-fA-F]{4}[0-9a-fA-F]{4}[0-9a-fA-F]{12})$/);o&&((0,A.a)(t._sharingContextInformation,{listId:r.listId,listItemId:i.id,uniqueId:o[1],itemName:i.name}),t._shareLink(l,L,f,p,m,a,g,v),t._multiShareIds=[],(0,A.a)(t._sharingContextInformation,{multiShareIds:[]}))}}).catch(function(e){t._storeContents.sharingInformation=(0,i.a)((0,i.a)({},t._storeContents.sharingInformation),{error:e,errorMessage:e.message})}):this._shareLink(l,L,f,p,m,a,g,v);z.cb()||m&&this._storeContents.defaultLink&&this._storeContents.defaultLink.audience!==l.audience&&this._cleanupDefaultLink()}},e.prototype.unshareLink=function(e,t){var n=this,a={item:this._item,kind:e,shareId:t};if((0,S.d)()){var r=this._getInheritedFromItem(t);r&&(a=(0,i.a)((0,i.a)({},a),{item:r}))}this._sharingProvider.unshareLink(a).then(function(e){!0===e&&(n._removeLinkByShareId(t),n.updatePermissionsInfoOnLinkChange(t,l.a.none),n._updateIsShared(),n._emitChange({type:h.b.UnshareLink}))}).then(function(){n._sharingInformationInvalidated=!0,n.fetchSharingInformation(!0,!0)})},e.prototype.getSharingLinkCreated=function(){return this._storeContents.sharingLinkCreated},e.prototype.getLinksCount=function(){return this.getActiveLinks().length},e.prototype.getAllPrincipals=function(){var e=this.getSharingInformation().sharingPrincipals,t=this.getActiveLinks();this._addPrincipals(e);for(var n=0,a=t;n<a.length;n++){var i=a[n];(i.principals.length||i.invitees.length)&&this._addPrincipals(i.principals)}return this._storeContents.filteredPrincipals},e.prototype.parsePermissions=function(){var e,t,n=[],a=[],r=[],o=this.getSharingInformation(),s=o.permissionsInformation;if(s){for(var c=s.links.results,d=s.principals.results,u=s.siteAdmins.results,f=o.webUrl,p=0,m=c;p<m.length;p++)for(var _=m[p],h=void 0,b=0,g=_.linkMembers.results;b<g.length;b++){var v=(I=g[b]).role||this._getRoleFromLink(_);h=(0,i.a)((0,i.a)({},I),{primaryText:I.name,secondaryText:I.jobTitle,type:I.principalType,imageUrl:I.imageUrl||I.loginName?(0,F.b)(f)(I.loginName):"",role:v}),v===l.a.submit&&o.sharedObjectType!==B.a.folder||(r.push(I.loginName),this._buildPrincipalAccessMap((0,i.a)({addedIds:n,principals:a,sharingPrincipal:h,link:_},(0,S.d)()&&_.isInherited&&_.inheritedFrom?{inheritedFrom:_.inheritedFrom}:{})))}for(var y=0,D=d;y<D.length;y++){var I=D[y];h=(0,i.a)((0,i.a)({},I.principal),{primaryText:I.principal.name,secondaryText:I.principal.jobTitle,type:I.principal.principalType,imageUrl:I.principal.loginName?(0,F.b)(f)(I.principal.loginName):"",role:I.role}),r.push(I.principal.loginName),this._buildPrincipalAccessMap((0,i.a)({addedIds:n,principals:a,sharingPrincipal:h,link:void 0,isDirectAccess:!0},(0,S.d)()&&I.isInherited&&I.inheritedFrom?{inheritedFrom:I.inheritedFrom}:{}))}for(var x=function(o){if(-1===r.indexOf(o.principal.loginName)){var s=(0,i.a)((0,i.a)({},o.principal),{primaryText:o.principal.name,secondaryText:o.principal.jobTitle,type:o.principal.principalType,imageUrl:o.principal.loginName?(0,F.b)(f)(o.principal.loginName):"",role:o.role});C._buildPrincipalAccessMap({addedIds:n,principals:a,sharingPrincipal:s})}else{var c=a.filter(function(e){return e.loginName===o.principal.loginName})[0];if(c){c.role=o.role;var d=null===(e=c.accessMap)||void 0===e?void 0:e.get(o.principal.id.toString());null===(t=null==c?void 0:c.accessMap)||void 0===t||t.set(o.principal.id.toString(),(0,i.a)((0,i.a)({},d),{role:o.role}))}}},C=this,O=0,w=u;O<w.length;O++)x(w[O]);this._storeContents.sharingInformation=(0,i.a)((0,i.a)({},this._storeContents.sharingInformation),{sharingPrincipals:a})}},e.prototype.getSensitivityLabels=function(e){var t=new T.a({name:"Sharing.sensitivityLabelGraphAPI"});return n.e(13).then(n.bind(n,585)).then(function(n){return new n.SensitivityLabelsDataSource({getOAuthToken:e},{pageContext:window._spPageContextInfo}).getSensitivityLabels().then(function(e){return t.end({resultType:T.b.Success}),e}).catch(function(e){return t.end({resultType:T.b.Failure,resultCode:(0,Q.d)(e),extraData:(0,Q.c)(e)}),Promise.resolve(null)})})},e.prototype.getOptInSendNavIdInShareLink=function(){return this._sharingContextInformation&&this._sharingContextInformation.optInSendNavIdInShareLink},e.prototype.onDocumentInformation=function(e){this._storeContents.documentInformation=e,this._emitChange()},e.prototype.getDocumentInformation=function(){return this._storeContents.documentInformation},e.prototype.onReceivingSharingInfoBarInformation=function(e){e&&(this._storeContents.sharingInfoBarInformation=e),this._emitChange()},e.prototype.getSharingInfoBarInformation=function(){return this._storeContents.sharingInfoBarInformation},e.prototype._getInheritedFromItem=function(e){var t=this._storeContents.sharingInformation.sharingLinks.filter(function(t){if(t.shareId===e&&t.inheritedLinkInfo)return t}),n=t&&t.length>0?t[0].inheritedLinkInfo:null;if(n)return(0,i.a)((0,i.a)({},this._item),{type:j.a.Folder,name:n.name,properties:(0,i.a)((0,i.a)({},this._item.properties),{uniqueId:n.sharepointIds.listItemUniqueId})})},e.prototype._buildPrincipalAccessMap=function(e){var t,n,a,r,o=e.addedIds,s=e.principals,c=e.sharingPrincipal,d=e.link,l=e.isDirectAccess,u=e.inheritedFrom;d?(r=d.linkDetails.ShareId,a=this._getRoleFromLink(d),n=d.linkDetails.ShareId):l?(r=c.id.toString(),a=this._getRoleForPrincipal(c)||c.role,n=c.id.toString()):(r=c.id.toString(),a=this._getRoleForPrincipal(c)||c.role,n=c.loginName);var f={id:r,role:a,isSPO:!0,rawPermission:(0,i.a)({shareId:r,scope:null===(t=null==d?void 0:d.linkDetails)||void 0===t?void 0:t.Scope},u?{inheritedFrom:u}:{})};if(-1===o.indexOf(c.id)){var p=new Map;p.set(n,f),c=(0,i.a)((0,i.a)({},c),{accessMap:p})}else s.filter(function(e){return e.id===c.id})[0].accessMap.set(n,f);c&&(s.push(c),o.push(c.id))},e.prototype._getRoleFromLink=function(e){switch(e.linkDetails.LinkKind){case s.a.organizationEdit:case s.a.anonymousEdit:return l.a.edit;case s.a.organizationView:case s.a.anonymousView:return l.a.view;case s.a.flexible:default:return this._getRoleFromLinkDetails(e.linkDetails)}},e.prototype._getRoleForPrincipal=function(e){switch(e.sharingLinkKind){case s.a.organizationEdit:case s.a.anonymousEdit:return l.a.edit;case s.a.organizationView:case s.a.anonymousView:return l.a.view;default:return l.a.none}},e.prototype._getRoleFromLinkDetails=function(e){if(e.IsCreateOnlyLink&&!e.allowsAnonymousAccess)return l.a.submit;if(e.IsManageListLink)return l.a.manageList;if(e.IsReviewLink)return l.a.review;var t="video"===(0,V.a)(this.getSharingInformation().fileExtension);return e.IsEditLink?l.a.edit:e.BlocksDownload&&(t||(0,U.tb)(this._clientId,this))?l.a.restrictedview:l.a.view},e.prototype.parsePrincipals=function(){var e=this.getAllPrincipals(),t=[],n=[],a=[];for(var i in e){var r=e[i],o=r.role===l.a.owner;r.accessMap&&(r.type===I.a.user?(o?t.unshift(r):t.push(r),a.push({alias:i})):(r.type===I.a.securityGroup||r.type===I.a.sharePointGroup||(0,S.d)()&&z.O()&&r.type===I.a.ConsumerGroup)&&(o?n.unshift(r):n.push(r)))}return this._engagementHelper.manageAccessV3NumberOfSharingPrincipals({numberOfUsers:t.length,numberOfGroups:n.length}),{users:t,groups:n}},e.prototype.getAddressBarLink=function(){return this._storeContents.sharingInformation.sharingLinks.filter(function(e){return e.isAddressBarLink&&!e.isUnhealthy&&e.isActive})[0]},e.prototype.getActiveLinks=function(){var e=this;return this._storeContents.sharingInformation.sharingLinks.filter(function(t){return t.isActive&&t.sharingLinkKind!==s.a.direct&&(e._useSimplifiedSharingDialog?!1===t.isUnhealthy:!(t.isAddressBarLink&&!0===t.isUnhealthy))})},e.prototype.getReShareLink=function(e){return this.getActiveLinks().filter(function(t){return t.audience===e&&t.enabled})[0]},e.prototype.getUnhealthyLinks=function(){var e,t=null===(e=this._storeContents.sharingInformation)||void 0===e?void 0:e.sharingLinks;return null==t?void 0:t.filter(function(e){return e.isUnhealthy})},e.prototype.getAvailableReShareLink=function(e){var t,n=this;return e.settings.updatePassword||(null===(t=e.recipients)||void 0===t?void 0:t.length)||e.settings.sendEmail?[]:this.getActiveLinks().filter(function(t){return t.enabled&&t.expiration===e.settings.expiration&&t.sharingScope===e.settings.scope&&t.allowsAnonymousAccess===e.settings.allowAnonymousAccess&&t.sharingLinkKind===e.settings.sharingLinkKind&&(a=t.password,i=e.settings.password,!a&&!i||a===i)&&e.settings.role===(0,U.K)(t,n._clientId,n._storeContents.sharingInformation)&&t.audience===(0,S.c)(e.settings.sharingLinkKind,e.settings.allowAnonymousAccess,e.settings.restrictShareMembership)&&(!(!z.R()&&(0,S.d)())||!t.inheritedLinkInfo);var a,i})},e.prototype.updatePermissions=function(e,t){var n=this,r=this._item;if((0,S.d)()){var o=this._storeContents.sharingInformation.permissionsInformation.principals.results.filter(function(e){if(e.isInherited&&e.inheritedFrom)return e}),s=o&&o.length>0?o[0].inheritedFrom:null;s&&(r=(0,i.a)((0,i.a)({},this._item),{type:j.a.Folder,name:s.name,properties:(0,i.a)((0,i.a)({},this._item.properties),{uniqueId:s.sharepointIds.listItemUniqueId})}))}this._sharingProvider.updatePermissions2(e,r,t).done(function(t){var r=n._storeContents.sharingInformation.sharingPrincipals;if(t.role===a.NONE){if(n._useSimplifiedSharingDialog){var o=n._storeContents.sharingInformation.permissionsInformation.principals.results;n._storeContents.sharingInformation.permissionsInformation.principals.results=o.filter(function(t){return t.principal.id!==e.id}),n._storeContents.sharingInformation.sharingPrincipals=r.map(function(t){var a;if(t.id===e.id)if(t.accessMap){var i=t.id.toString();null===(a=t.accessMap)||void 0===a||a.delete(i),t.role=(0,U.v)(t),n._removePrincipalById(t.loginName)}else r.pop();return t}),n._updateIsShared(),n._studyEmitChangeUsage("updatePermissions0"),n._emitChange()}else n._storeContents.sharingInformation.sharingPrincipals=r.filter(function(t){return t.id===e.id&&n._removePrincipalById(t.loginName),t.id!==e.id});n._updateIsShared(),n._studyEmitChangeUsage("updatePermissions0"),n._emitChange()}else if(n._useSimplifiedSharingDialog)n._storeContents.sharingInformation.sharingPrincipals=r.map(function(r){var o,s,c,d,u,f,p;if(r.id===e.id){var m=void 0,_=void 0;switch((m=null===(o=r.accessMap)||void 0===o?void 0:o.get(r.loginName))?_=r.loginName:(m=null===(s=r.accessMap)||void 0===s?void 0:s.get(r.id.toString()))&&(_=r.id.toString()),t.role){case a.VIEW:r.role=l.a.view,null===(c=r.accessMap)||void 0===c||c.set(_,(0,i.a)((0,i.a)({},m),{role:l.a.view}));break;case a.EDIT:r.role=l.a.edit,null===(d=r.accessMap)||void 0===d||d.set(_,(0,i.a)((0,i.a)({},m),{role:l.a.edit}));break;case a.OWNER:r.role=l.a.owner,null===(u=r.accessMap)||void 0===u||u.set(_,(0,i.a)((0,i.a)({},m),{role:l.a.owner}));break;case a.REVIEW:r.role=l.a.review,null===(f=r.accessMap)||void 0===f||f.set(_,(0,i.a)((0,i.a)({},m),{role:l.a.review}));break;case a.RESTRICTED_VIEW:r.role=l.a.restrictedview,null===(p=r.accessMap)||void 0===p||p.set(_,(0,i.a)((0,i.a)({},m),{role:l.a.restrictedview}))}r.accessMap&&n._updatePrincipal(r)}return n._updateIsShared(),n._studyEmitChangeUsage("updatePermissions0"),n._emitChange(),r}),n._storeContents.sharingInformation.permissionsInformation.principals.results.map(function(n){if(n.principal.id===e.id)switch(t.role){case a.VIEW:n.role=l.a.view;break;case a.EDIT:n.role=l.a.edit;break;case a.OWNER:n.role=l.a.owner;break;case a.REVIEW:n.role=l.a.review;break;case a.RESTRICTED_VIEW:n.role=l.a.restrictedview}return n}),n._studyEmitChangeUsage("updatePermissions1"),n._emitChange();else for(var s=0,c=r;s<c.length;s++){var d=c[s];if(d.id===e.id){switch(t.role){case a.VIEW:d.role=l.a.view;break;case a.EDIT:d.role=l.a.edit;break;case a.OWNER:d.role=l.a.owner;break;case a.REVIEW:d.role=l.a.review}n._studyEmitChangeUsage("updatePermissions1"),n._emitChange()}}})},e.prototype.grantDirectAccess=function(e,t){var n=this,a=this._storeContents.sharingInformation.sharingPrincipals.filter(function(t){return t.id===parseInt(e)})[0],r=this._getRoleString(t),o={items:[this._item],roleValue:r,requireSignIn:!0,propagateSharing:!0},s=(0,i.a)((0,i.a)({},a),{userId:a.email,name:a.loginName,email:a.email,rawData:{Key:a.email,isResolved:!1},rawPersonData:{Key:a.email,isResolved:!1},isResolved:!1});this._sharingProvider.share([s],o,!0).then(function(r){switch(r.statusCode){case 0:var o=n._storeContents.sharingInformation.sharingPrincipals;n._storeContents.addPeopleResult=h.a.CompletedSuccessfully,n._storeContents.sharingInformation.permissionsInformation.principals.results.push({role:t,principal:(0,i.a)((0,i.a)({},a),{isActive:!0,principalType:a.type,userId:"",jobTitle:a.secondaryText,name:a.primaryText,email:a.email,id:parseInt(e)}),inheritedFrom:void 0,isInherited:!1});var s={id:e,role:t,isSPO:!0,rawPermission:{scope:void 0}};a.accessMap.set(e,s),n._updatePrincipal(a),n._storeContents.sharingInformation.sharingPrincipals=o.map(function(t){return t.id===parseInt(e)?a:t});break;case 1:n._storeContents.addPeopleResult=h.a.AccessRequestsQueued;break;default:n._storeContents.addPeopleResult=h.a.Error}n._emitChange()},function(){n._storeContents.addPeopleResult=!1,n._emitChange()})},e.prototype.updatePermissionsInfoOnLinkChange=function(e,t){var n=this._storeContents.sharingInformation.permissionsInformation.links.results;switch(t){case l.a.none:this._storeContents.sharingInformation.permissionsInformation.links.results=n.filter(function(t){return t.linkDetails.ShareId!==e});break;case l.a.view:this._storeContents.sharingInformation.permissionsInformation.links.results=n.map(function(t){return t.linkDetails.ShareId===e&&(t.linkDetails.IsEditLink=!1),t});break;case l.a.edit:this._storeContents.sharingInformation.permissionsInformation.links.results=n.map(function(t){return t.linkDetails.ShareId===e&&(t.linkDetails.IsEditLink=!0),t});break;case l.a.review:this._storeContents.sharingInformation.permissionsInformation.links.results=n.map(function(t){return t.linkDetails.ShareId===e&&(t.linkDetails.IsReviewLink=!0),t})}t!==l.a.none&&this._updateAccessMap(e,t),this._updateIsShared(),this._emitChange()},e.prototype.updatePermissionById=function(e,t){var n=this.getSharingInformation().sharingPrincipals.filter(function(t){return t.id===parseInt(e)})[0];return this.updatePermissions(n,t),O.a.resolve()},e.prototype.addPeople=function(e,t,n,a){var i=this,r=this._getRoleString(t),o={items:[this._item],roleValue:r,sendEmail:n,message:a,requireSignIn:!0,propagateSharing:!0};this._sharingProvider.share(e,o,!0).then(function(e){switch(e.statusCode){case 0:i._storeContents.addPeopleResult=h.a.CompletedSuccessfully;break;case 1:i._storeContents.addPeopleResult=h.a.AccessRequestsQueued;break;default:i._storeContents.addPeopleResult=h.a.Error}i._emitChange()},function(){i._storeContents.addPeopleResult=!1,i._emitChange()})},e.prototype.fetchSuiteNavInformation=function(){var e=this;this._suiteNavProvider?this._suiteNavProvider.loadData().then(function(t){var n=t.CompanyDisplayName||e._storeContents.companyName,a=t?JSON.parse(t.ClientData):{HasEXOLicense:!1};e._storeContents.companyName=n,e._storeContents.outlookAvailability=a.HasEXOLicense?g.a.available:g.a.none,e._emitChange()}):(this._storeContents.outlookAvailability=g.a.none,this._emitChange())},e.prototype.getCompanyName=function(){return this._storeContents.companyName},e.prototype.getOutlookAvailability=function(){return this._storeContents.outlookAvailability},e.prototype.navigateToOwa=function(e,t){(0,q.a)()?window.sessionStorage.setItem("OWA_sharingLinkUrl",this._getOwaUrl(e,t)):window.open(this._getOwaUrl(e,t),"_blank")},e.prototype.getNavId=function(){return this._sharingContextInformation&&this._sharingContextInformation.navId},e.prototype.getContextualSharingInformation=function(){return this._sharingContextInformation&&this._sharingContextInformation.contextualSharingInformation},e.prototype.getInvitationId=function(){var e,t;return null!==(t=null===(e=this._sharingContextInformation)||void 0===e?void 0:e.invitationId)&&void 0!==t?t:""},e.prototype.fetchGroupsMemberCount=function(e){for(var t=this,n=0,a=function(e){var a={userId:e.userId,name:e.name,email:e.email,rawPersonData:e.rawPersonData,principalType:e.principalType};if(e.principalType===I.a.securityGroup){var r=i._groupsMemberCountCache[e.userId];void 0!==r?n+=r:i._peoplePickerProvider.getPickerEntityInformation(a).then(function(a){var i=a.totalMemberCount;t._groupsMemberCountCache[e.userId]=i,n+=i,t._storeContents.groupsMemberCount=n,t._emitChange()}).catch(function(n){t._groupsMemberCountCache[e.userId]=null,t._emitChange()})}},i=this,r=0,o=e;r<o.length;r++)a(o[r]);this._storeContents.groupsMemberCount=n,this._emitChange()},e.prototype.getGroupsMemberCount=function(){return this._storeContents.groupsMemberCount},e.prototype.fetchPolicyTipInformation=function(){var e=this;if(this._policyTipProvider){if(this._storeContents.policyTipInfo.info)return void this._emitChange();var t=this._storeContents.sharingInformation;if(!t)return;if(!this._item)return;var n=!this._isPolicyTipFlagSet(this._item.policyTip,x.a.blockSharing),a=t.sharingAbilities;if(a){if((a&&a.directSharingAbilities&&a.directSharingAbilities.canAddExternalPrincipal.disabledReason)!==f.a.documentIsProtectedByDlp&&n)return}else if(n)return;this._policyTipProvider.getPolicyTip(this._item).then(function(t){t&&(e._storeContents.policyTipInfo.info=t,e._emitChange())})}},e.prototype.getPolicyTipInformation=function(){return this._storeContents.policyTipInfo},e.prototype.updatePolicy=function(e,t){var n=this;if(this._policyTipProvider){var a={item:this._item,action:e};t&&(a.justification=t),this._policyTipProvider.updatePolicy(a).then(function(e){n._storeContents.policyTipInfo.actionResult=e,n._sharingInformationInvalidated=!0,n.fetchSharingInformation(!0),n._emitChange()})}},e.prototype.checkUserAccess=function(e){var t=this,n=new T.a({name:"Sharing.checkUserAccessAPI"});if(0!==e.length){for(var a=[],r=0,o=e;r<o.length;r++){var s=o[r];a.push(s)}return this._sharingProvider.checkPermissions(a,this._item).then(function(e){for(var a=function(e){var n=t._storeContents.sharingInformation.sharingPrincipals.filter(function(t){return t.loginName===e.inputEntity})[0],a=t._storeContents.sharingInformation.sharingPrincipals.filter(function(e){return e.role===l.a.owner}).length>=1;if((0,U.k)(e.role,n.role,U.d.GREATERTHAN)){var i=a&&e.role===l.a.owner?n.role:e.role,r={id:e.inputEntity,role:i,isSPO:!0,rawPermission:{shareId:e.inputEntity}};n.role=i,n.accessMap.set(r.id,r),n.hasGSIAndCheckAccessPerms=!0,t._updatePrincipal(n)}},i=0,r=e;i<r.length;i++)a(r[i]);n.end({resultType:T.b.Success})}).catch(function(e){t._storeContents.sharingInformation=(0,i.a)((0,i.a)({},t._storeContents.sharingInformation),{error:e,errorMessage:k.Nb}),n.end({resultType:T.b.Failure,extraData:e})})}},e.prototype.checkPermissions=function(e,t){var n=this;if(0===e.length)return this._storeContents.permissionsMap={},void this._emitChange();var a=[];this._recipients=[];for(var i=0,r=e;i<r.length;i++){var o=r[i];a.push({alias:P.b.isActivated("00bdc590-2d96-4d10-bb1c-66fb6cb59dfd")?o.email:o.userId||o.email}),this._recipients.push(o.email)}t=t||this._storeContents.invitedUsers,this._invitedUsers=[];for(var s=0,c=t;s<c.length;s++){var d=c[s];a.push({alias:d.email}),this._invitedUsers.push(d.email)}var l=a.map(function(e){return e.alias});this._sharingProvider.checkPermissions(a,this._item).then(function(e){n._storeContents.permissionsMap={};for(var t=0,a=e;t<a.length;t++){var i=a[t];n._invitedUsers.indexOf(i.inputEntity)>-1?n._storeContents.permissionsMap[i.inputEntity]=i.hasAccess?b.a.hasAccess:b.a.pending:(n._recipients.indexOf(i.inputEntity)>-1||l.indexOf(i.inputEntity)>-1)&&(n._storeContents.permissionsMap[i.inputEntity]=i.hasAccess?b.a.hasAccess:b.a.none)}n._emitChange()})},e.prototype.getPermissionsMap=function(){return this._storeContents.permissionsMap},e.prototype.getDefaultRecipients=function(){return this._storeContents.defaultRecipients},e.prototype.consumeDefaultRecipients=function(){this._storeContents.defaultRecipients={isConsumed:!0,recipients:this._storeContents.defaultRecipients.recipients}},e.prototype.getAllOrgSG=function(){var e=this._storeContents.sharingInformation.allOrganizationSecurityGroupId,t=this._storeContents.sharingInformation.permissionsInformation.principals.results.filter(function(t){if(-1!==t.principal.loginName.indexOf(e))return t});if(1===t.length)return t[0]},e.prototype.getEEEU=function(){var e=this._storeContents.sharingInformation.permissionsInformation.principals.results.filter(function(e){if(-1!==e.principal.loginName.indexOf(U.a))return e});if(1===e.length)return e[0]},e.prototype.doesSPGroupContainAllOrgSGOrEEEU=function(){var e=this._storeContents.sharingInformation.allOrganizationSecurityGroupId;return this._storeContents.sharingInformation.permissionsInformation.principals.results.filter(function(t){return t.principal.principalType===I.a.sharePointGroup&&t.members.results.filter(function(t){return-1!==t.loginName.indexOf(U.a)||-1!==t.loginName.indexOf(e)}).length>0}).length>0},e.prototype.removeAccessToAllOrgSGAndEEEU=function(){var e=new T.a({name:"SimplifiedSharingV2.AllOrgSG.RemoveAccess"}),t=new T.a({name:"SimplifiedSharingV2.EEEU.RemoveAccess"}),n=this.getAllOrgSG(),a=this.getEEEU();return Promise.all([this._removeAccess(null==n?void 0:n.principal,e),this._removeAccess(null==a?void 0:a.principal,t)])},e.prototype.grantAccessToAllOrgSG=function(){var e=this,t=this._storeContents.sharingInformation.allOrganizationSecurityGroupId,n=new T.a({name:"SimplifiedSharingV2.AllOrgSG.GrantAccess"}),a={principalSource:15,principalType:I.a.securityGroup,forceResolve:!0,maximumEntitySuggestions:1};return this._peoplePickerProvider.resolve(t,a).then(function(t){var a={items:[e._item],roleValue:e._getRoleString(l.a.restrictedview),sendEmail:!1,requireSignIn:!0,propagateSharing:!0};return e._sharingProvider.share([t],a,!0).done(function(t){t.statusCode===y.a.CompletedSuccessfully?(n.end({resultType:T.b.Success,extraData:(0,i.a)((0,i.a)({},e._telemetryExtraData),{result:t})}),e._sharingInformationInvalidated=!0,e.fetchSharingInformation(!0),e._emitChange({type:h.b.GrantAccess})):e._handleGrantAccessError(t,n)})}).catch(function(t){n.end({resultType:T.b.Failure,extraData:(0,i.a)((0,i.a)({},e._telemetryExtraData),(0,Q.c)(t))})})},e.prototype.grantAccessV2=function(e){var t=this,n=e.recipients,a=e.role,r=e.subject,o=e.message,s=new T.a({name:"SimplifiedSharingV2.ShareObject"}),c=(n=n||[]).map(function(e){return{userId:e.userId,name:e.name,email:e.email,rawPersonData:e.rawPersonData}});c=this._dedupeRecipients(c),this._engagementHelper.logShareObject(c,a);var d={items:[this._item],roleValue:this._getRoleString(a),sendEmail:!0,requireSignIn:!0,propagateSharing:!0,subject:r,message:o};this._sharingProvider.share(c,d,!0).done(function(n){if(t._storeContents=(0,i.a)((0,i.a)({},t._storeContents),{grantAccessResult:n.statusCode===y.a.CompletedSuccessfully||n.statusCode===y.a.AccessRequestsQueued}),n.error||n.statusCode!==y.a.CompletedSuccessfully&&n.statusCode!==y.a.AccessRequestsQueued)t._handleGrantAccessError(n,s);else{var a=n,r=e.role,o=e.recipients,c=e.subject,d=e.message;s.end({resultType:T.b.Success,extraData:(0,i.a)((0,i.a)({},t._telemetryExtraData),{role:r,recipientsCount:null==o?void 0:o.length,hasSubject:!!c,hasMessage:!!d,result:a})})}t._sharingInformationInvalidated=n.statusCode===y.a.CompletedSuccessfully,t.fetchSharingInformation(!0),t._emitChange({type:h.b.GrantAccess})})},e.prototype.grantAccess=function(e,t){var n=this;void 0===t&&(t=!0);var a=(e=e||[]).map(function(e){return{userId:e.userId,name:e.name,email:e.email,rawPersonData:e.rawPersonData}});a=this._dedupeRecipients(a);var r={items:[this._item],roleValue:this._getRoleValue(t),sendEmail:!1,requireSignIn:!0,propagateSharing:!0};this._sharingProvider.share(a,r,!0).done(function(e){n._storeContents=(0,i.a)((0,i.a)({},n._storeContents),{grantAccessResult:e.statusCode===y.a.CompletedSuccessfully||e.statusCode===y.a.AccessRequestsQueued}),0!==e.statusCode&&1!==e.statusCode&&J.A(c.a.grantAccess,n._storeContents.sharingInformation.rawError||"grant access failure",n._storeContents.sharingInformation.errorCategory,n._storeContents.sharingInformation.debugErrorMessage||n._storeContents.sharingInformation.errorMessage),n._emitChange({type:h.b.GrantAccess})})},e.prototype.getGrantAccessResult=function(){return this._storeContents.grantAccessResult},e.prototype.getAddPeopleResult=function(){return this._storeContents.addPeopleResult},e.prototype.dispose=function(){this._eventGroup&&(this._eventGroup.dispose(),this._eventGroup=void 0)},e.prototype.hasAccessRequestBeenCreated=function(){return this._storeContents.accessRequestCreated},e.prototype.isValidatingDefaultRecipients=function(){return this._storeContents.isValidatingDefaultRecipients},e.prototype.setAddressBarLinkCapability=function(e){var t=this;return new Promise(function(n){t._sharingProvider.setAddressBarLinkCapability(t._item,e).done(function(e){e&&z.yc()&&t.fetchSharingInformation(!0,!0),n(e)})})},e.prototype._handleGrantAccessError=function(e,t){var n,a,r,o,s,l,f;if(e.error){var p=JSON.parse(e.debugErrorMessage);l=(s=p.status)+" "+p.code,f=e.debugErrorMessage}e.statusCode!==y.a.CompletedSuccessfully&&e.statusCode!==y.a.AccessRequestsQueued&&(s=e.statusCode,l=e.errorMessage,z.l()||(l=(0,W.d)(s)||l));var m=e;t.end({resultType:T.b.Failure,resultCode:s,extraData:(0,i.a)((0,i.a)({},this._telemetryExtraData),{result:m}),error:l}),J.A(c.a.grantAccess,this._storeContents.sharingInformation.rawError||"grant access failure",this._storeContents.sharingInformation.errorCategory,this._storeContents.sharingInformation.debugErrorMessage||this._storeContents.sharingInformation.errorMessage);var _="",h="";try{var b=JSON.parse(f);h="".concat(null==b?void 0:b.status),_="".concat(null==b?void 0:b.status," ").concat(null==b?void 0:b.code," ").concat(null!==(a=null===(n=null==b?void 0:b.message)||void 0===n?void 0:n.value)&&void 0!==a?a:"")}catch(e){}this._storeContents.sharingInformation=(0,i.a)((0,i.a)({},this._storeContents.sharingInformation),{error:{name:u[e.statusCode]||h||"Unknown",message:"Status Code: ".concat(null!==(r=e.statusCode)&&void 0!==r?r:""," ").concat(null!==(o=e.errorMessage)&&void 0!==o?o:""," ").concat(_),stack:e.debugErrorMessage},errorCategory:d.a.shareObject,debugErrorMessage:f,errorMessage:l})},e.prototype._addPrincipals=function(e){for(var t=0,n=e;t<n.length;t++){var a=n[t],i=a.loginName||a.email;this._storeContents.filteredPrincipals[i]||(this._storeContents.filteredPrincipals[i]=a)}},e.prototype._updatePrincipal=function(e){var t=e.loginName||e.email;this._storeContents.filteredPrincipals[t]&&this._storeContents.filteredPrincipals[t].accessMap&&(this._storeContents.filteredPrincipals[t]=e)},e.prototype._removePrincipals=function(e){for(var t=0,n=e;t<n.length;t++){var a=n[t],i=a.loginName||a.email;this._removePrincipalById(i)}},e.prototype._removePrincipalById=function(e){this._storeContents.filteredPrincipals[e]&&delete this._storeContents.filteredPrincipals[e]},e.prototype._doesPSLSupportNewExternalUsers=function(){if(this._storeContents.sharingInformation){var e=this._storeContents.sharingInformation.sharingAbilities;return!(!e||!e.peopleSharingLinkAbilities)&&e.peopleSharingLinkAbilities.canAddNewExternalPrincipals.enabled}return!1},e.prototype.resetPeoplePickerError=function(){this._storeContents.sharingInformation.peoplePickerError&&(this._storeContents.sharingInformation.peoplePickerError=void 0,this._emitChange())},e.prototype.getSharingClickTime=function(){var e;return null===(e=this._sharingContextInformation)||void 0===e?void 0:e.clickTime},e.prototype.getWebView2Times=function(){return this._sharingContextInformation.webView2Times},e.prototype.isPasswordModificationAllowed=function(){return!0},e.prototype.isExpirationDateModificationAllowed=function(){return!0},e.prototype.isPremiumExperienceAllowed=function(){if((0,S.d)()){var e=this._storeContents.sharingInformation.sharingAbilities;if(!(e&&e.anyoneLinkAbilities.linkExpiration.enabled&&e.anyoneLinkAbilities.passwordProtected.enabled))return!1}return!0},e.prototype.disablePremiumUpsell=function(){if((0,S.d)()){var e=this._storeContents.sharingInformation.ageGroup;if(e)switch(e){case p.NotAdult:case p.MinorWithParentalConsent:case p.MinorWithoutParentalConsent:return!0;case p.Adult:case p.MinorNoParentalConsentRequired:default:return!1}}return!1},e.prototype.isReportProblemSupported=function(){return!1},e.prototype.shouldInterruptCopyLink=function(e){return new Promise(function(e,t){e(!1)})},e.prototype.isPreventDownloadAllowed=function(){return!(0,S.d)()},e.prototype.isBundleShare=function(){return!z.nc()&&(0,S.d)()&&this._multiShareIds&&this._multiShareIds.length>1},e.prototype.isSharingLimitedOnSite=function(){var e=this._storeContents.sharingInformation;return!(z.Rb()||(null==e?void 0:e.canAddInternalPrincipal)||(null==e?void 0:e.canAddExternalPrincipal)||(null==e?void 0:e.canRequestAccessForGrantAccess))},e.prototype.getSupportedAudienceOptions=function(){return this.isBundleShare()?[o.a.anyone,o.a.organization,o.a.customLabeledSpecificPeople,o.a.specificPeople,o.a.specificPeopleFlex]:[o.a.anyone,o.a.organization,o.a.customLabeledSpecificPeople,o.a.existing,o.a.specificPeople,o.a.specificPeopleFlex]},e.prototype.isOwner=function(){return(0,S.d)()?this._storeContents.sharingInformation.userRole===l.a.owner||this._storeContents.sharingInformation.userRole===l.a.edit&&this._storeContents.sharingInformation.sharingPrincipals.filter(function(e){return e.role===l.a.owner&&!!e.email&&!!window._spPageContextInfo&&!!window._spPageContextInfo.userEmail&&e.email.toLocaleLowerCase()===window._spPageContextInfo.userEmail.toLocaleLowerCase()}).length>=1:this._storeContents.sharingInformation.userRole===l.a.owner},e.prototype.isSpecificPeopleExpirationAllowed=function(){return!(!(0,U.tb)(this._clientId,this)||!z.J())},e.prototype.showAudienceLearnMore=function(){return!0},e.prototype.showEmailsInSuggestions=function(){return!z.Yb()&&(0,S.d)()},e.prototype.getFamily=function(){return(0,S.d)()&&z.O()?this._family:null},e.prototype.getFamilyMembers=function(){return(0,S.d)()&&z.O()?this._familyMembers:null},e.prototype.getCurrentUserId=function(){return null},e.prototype.getCanStopSharing=function(){return this.getSharingInformation().sharingAbilities.canStopSharing},e.prototype.isShared=function(){return this.getSharingInformation().isShared},e.prototype.getSharedObjectType=function(){return this.getSharingInformation().sharedObjectType},e.prototype.getItem=function(){return this._item},e.prototype.getItemInformationForLogging=function(){var e,t,n=!0,a=this.getSharingInformation();return a.fileExtension?(this._itemType=(0,V.a)(a.fileExtension),e=a.fileExtension):a.sharedObjectType?this._itemType=B.a[a.sharedObjectType]:a.item&&(this._itemType=(0,V.b)(a.item),e=a.item.extension,n=a.item.itemType===j.a.File),n&&this._itemType&&"other"!==this._itemType&&(t=e),{itemType:this._itemType,extension:t}},e.prototype.getSharingInformationAPIStats=function(){return this._getSharingInformationStats},e.prototype.getShareLinkAPIStats=function(){return this._getShareLinkStats},e.prototype._cleanupDefaultLink=function(){var e=this._storeContents.defaultLink;e&&(this.unshareLink(e.sharingLinkKind,e.shareId),this._storeContents.defaultLink=void 0)},e.prototype._emitChange=function(e){if(this._storeContents&&this._storeContents.sharingInformation){var t=this._storeContents.sharingInformation,n=this.getItemInformationForLogging(),a=n.itemType,i=n.extension;this._engagementHelper.setEngagementExtraData({webTemplateId:t.webTemplateId,itemUniqueId:t.itemUniqueId,itemType:a,extension:i})}for(var r=0,o=this._listeners;r<o.length;r++)(0,o[r])(e)},e.prototype._studyEmitChangeUsage=function(e){new T.a({name:"emitChangeInvestigation"}).end({resultType:T.b.Success,extraData:(0,i.a)({emitChangePath:e},this._telemetryExtraData)})},e.prototype.shareLinkExpress=function(){var e=this,t=this._sharingContextInformation;return new Promise(function(n){e._sharingProvider.shareLinkExpress(t.listId,t.listItemId).then(function(t){if(t.error){var a=t.error;e._storeContents.sharingInformation=(0,i.a)((0,i.a)({},e._storeContents.sharingInformation),{error:a,errorCategory:d.a.shareLink,debugErrorMessage:a.message&&a.message.value,errorMessage:k.Vi})}e._updateIsShared(),n()})})},e.prototype.getPermissionsViewSettings=function(){return{groupPivotHeader:(0,S.d)()&&z.O()?M.K:M.J,manageGroupLink:(0,S.d)()&&z.O()?"https://go.microsoft.com/fwlink/?linkid=2198883":"",manageUnknownUserLink:(0,S.d)()?"https://go.microsoft.com/fwlink/?linkid=2207620":"",itemStopSharingSupported:!(0,S.d)(),supportedGroupTypes:(0,S.d)()&&z.O()?[I.a.securityGroup,I.a.sharePointGroup,I.a.ConsumerGroup]:[I.a.securityGroup,I.a.sharePointGroup]}},e.prototype.init3s=function(){this._fetchSubstrateToken()},e.prototype._fetchGraphToken=function(){var e=this,t=this._graphPeoplePickerHelper&&this._graphPeoplePickerHelper.canUseGraph();t?this._graphPeoplePickerHelper.getGraphToken().then(function(n){t=!!n,e._storeContents.sharingInformation.isGraphAvailable=t}):this._storeContents.sharingInformation.isGraphAvailable=!1},e.prototype._fetchSubstrateToken=function(){var e=this,t=this._substratePeoplePickerHelper&&this._substratePeoplePickerHelper.canUseSubstrate();t?this._substratePeoplePickerHelper.getSubstrateToken().then(function(n){e._substratePeoplePickerHelper.init(n),t=!!n,e._storeContents.sharingInformation.isTsAvailable=t}):this._storeContents.sharingInformation.isTsAvailable=!1},e.prototype._fetchAdditionalAuthenticationTokens=function(){this._storeContents.sharingInformation&&(this._fetchGraphToken(),this._fetchSubstrateToken())},e.prototype._handleSharedLink=function(e,t,n){var a=this;e.createdViaCopyLinkCommand=t||!1;var i=new Y.a(e.url);this._sharingContextInformation&&this._sharingContextInformation.optInSendNavIdInShareLink&&!i.getQueryParameter("nav")&&(this._sharingContextInformation.navIdSendLinkOverride?i.setQueryParameter("nav",this._sharingContextInformation.navIdSendLinkOverride):this._sharingContextInformation.navId&&i.setQueryParameter("nav",this._sharingContextInformation.navId),e.url=i.toString()),this._sharingInformationInvalidated=!0,G.c()&&n||(this._storeContents.sharingLinkCreated=e,this.fetchSharingInformation(!0).then(function(){z.ob()||(a._updateIsShared(),a._studyEmitChangeUsage("handleSharedLink"),a._emitChange({type:h.b.ShareLink}))})),z.ob()&&(this._storeContents.sharingLinkCreated=e,this._updateIsShared(),this._studyEmitChangeUsage("handleSharedLink"),this._emitChange({type:h.b.ShareLink}))},e.prototype._getRoleValue=function(e){return e?v.a:v.e},e.prototype._getRoleString=function(e){switch(e){case l.a.owner:return v.c;case l.a.manageList:return v.b;case l.a.edit:return v.a;case l.a.view:return v.e;case l.a.review:return"roletype:Reviewer";case l.a.restrictedview:return v.d}},e.prototype._configureLinkIfShareId=function(){var e=this,t=this._sharingContextInformation&&this._sharingContextInformation.shareId;if(t&&this._mode===r.a.copy&&this._storeContents.sharingInformation&&!this._storeContents.sharingInformation.error){if("00000000-0000-0000-0000-000000000000"===t)this._storeContents.sharingLinkCreated=this._storeContents.sharingInformation.directLink;else{var n=this._storeContents.sharingInformation.sharingLinks.filter(function(t){return t.isActive&&t.shareId===e._sharingContextInformation.shareId})[0];this._storeContents.sharingLinkCreated=n||this._storeContents.sharingInformation.directLink}this._storeContents.sharingLinkCreated.createdViaCopyLinkCommand=!0}},e.prototype._removeLinkByShareId=function(e){var t=this;this._storeContents.sharingInformation.sharingLinks=this._storeContents.sharingInformation.sharingLinks.map(function(n){return e===n.shareId&&(n.expiration=null,n.isActive=!1,n.shareId=C.a.Empty,n.url=null,t._removePrincipals(n.principals),t._removePrincipals(n.invitees),n.principals=[]),n})},e.prototype._updateIsShared=function(){var e=this._storeContents.sharingInformation;if(e){var t=e.sharingLinks,n=e.sharingPrincipals,a=(0,S.a)(t,n);this._storeContents.sharingInformation.isShared=a}},e.prototype._getOwaUrl=function(e,t){var n,a,i="https://outlook.office.com/owa/",r=null===(a=null===(n=this._storeContents)||void 0===n?void 0:n.sharingInformation)||void 0===a?void 0:a.outlookEndpointHostUrl;r&&(i="https://".concat(r,"/owa/"));var o=encodeURIComponent(t);return"".concat(i,"?body=").concat(o,"&to=").concat(e.join(";"),"&path=/mail/action/compose")},e.prototype._resolveDefaultRecipients=function(e,t,n){var a=this,o=e||[],s=Promise.resolve();if(this._storeContents.isValidatingDefaultRecipients=e.length>0,!t){o=[];for(var c=[],d=0,l=e;d<l.length;d++){var u=l[d];c.push({alias:u})}s=this._sharingProvider.checkPermissions(c,this._item).then(function(e){for(var t=0,n=e;t<n.length;t++){var a=n[t];a.hasAccess||o.push(a.inputEntity)}})}s.then(function(){if(0!==o.length){for(var e=[],t=[],s={principalSource:15,principalType:13,allowEmailAddresses:!0,filterExternalUsers:!1,maximumEntitySuggestions:1,allowSharePointGroups:!1,forceResolve:!0},c=0,d=o;c<d.length;c++){var l=d[c];e.push(a._peoplePickerProvider.resolve(l,s).then(function(e){t.push(e)}))}Promise.all(e).then(function(){a._storeContents.defaultRecipients={isConsumed:!1,recipients:t},a._storeContents.isValidatingDefaultRecipients=!1,a._studyEmitChangeUsage("resolveDefaultRecipients1"),a._emitChange()},function(){a._storeContents.defaultRecipients={isConsumed:!1,recipients:[]},a._storeContents.isValidatingDefaultRecipients=!1,a._emitChange()})}else n===r.a.atMention&&(a._storeContents=(0,i.a)((0,i.a)({},a._storeContents),{grantAccessResult:!0}),a._studyEmitChangeUsage("resolveDefaultRecipients0"),a._emitChange())})},e.prototype._removeEmailQueryParamFromInvitationLink=function(e){var t=e.split("?");if(t.length>1){for(var n=[],a=0,i=t[1].split("&");a<i.length;a++){var r=i[a];-1===r.indexOf("email=")&&n.push(r)}var o=n.join("&");return"".concat(t[0],"?").concat(o)}return e},e.prototype._shareLink=function(e,t,n,a,u,f,p,b){var g,v,y,D,I,x,C=this;(0,K.f)("sharelink._shareLink.start");var w=this._item;if((0,S.d)()){var E=this._getInheritedFromItem(p);E&&(w=E)}var A={emailData:n,emailSubject:a,items:[w],recipients:t,settings:{createLink:!0,sharingLinkKind:e.sharingLinkKind,expiration:e.expiration,updatePassword:e.updatePassword,password:e.password,shareId:p,inviteesToRemove:b,role:e.sharingRole}};A.settings.role||(A.settings.role=e.isEdit?l.a.edit:l.a.view),e.shareId&&e.shareId.length>0&&(A.settings.shareId=e.shareId,e.fetchLinkOnly&&(A.settings.createLink=!1));var L=(new Date).getTime(),M=new T.a({name:"SharingShareLink.".concat(r.a[this._mode],".").concat(m.a[this._clientId]||"unknown")});this._getShareLinkStats={name:"ShareLinkInit",resultType:T.b.Success,duration:0},(e.updatePassword||e.hasPassword&&e.shareId&&e.shareId.length>0)&&e.audience===o.a.anyone&&(A.settings.sharingLinkKind=s.a.flexible,A.settings.allowAnonymousAccess=!0),e.audience===o.a.anyone?e.trackLinkUsers?(A.settings.allowAnonymousAccess=!1,A.settings.restrictShareMembership=!1,A.settings.trackLinkUsers=!0,A.settings.scope=_.a.anyone,A.settings.sharingLinkKind=s.a.flexible):(A.settings.allowAnonymousAccess=!0,A.settings.restrictShareMembership=!1,A.settings.trackLinkUsers=!1,A.settings.scope=_.a.anyone):e.audience===o.a.organization&&(A.settings.allowAnonymousAccess=!1,A.settings.restrictShareMembership=!1,A.settings.scope=_.a.organization),"video"===(0,V.a)(null===(v=this.getSharingInformation())||void 0===v?void 0:v.fileExtension)||(0,U.tb)(this._clientId,this)?e.sharingRole===l.a.restrictedview&&(A.settings.role=l.a.restrictedview,A.settings.sharingLinkKind=s.a.flexible):e.preventDownload&&(A.settings.role=l.a.restrictedview,e.sharingRole=l.a.restrictedview,A.settings.sharingLinkKind=s.a.flexible),e.audience!==o.a.specificPeopleFlex&&e.audience!==o.a.customLabeledSpecificPeople||(A.settings.restrictShareMembership=!0,A.settings.scope=_.a.specificPeople);var P=this.getDefaultRecipients();e.audience===o.a.customLabeledSpecificPeople&&P&&(A.recipients=P.recipients),e.isCreateOnlyLink&&(A.settings.role=l.a.submit,A.settings.description=e.description),e.sharingRole!==l.a.manageList&&e.sharingRole!==l.a.submit&&e.sharingRole!==l.a.review&&e.sharingRole!==l.a.restrictedview||(A.settings.sharingLinkKind=s.a.flexible);var F=(null===(y=this._sharingContextInformation)||void 0===y?void 0:y.navId)&&(0,Z.c)(this._sharingContextInformation.navId),H=!(null===(D=this._sharingContextInformation)||void 0===D?void 0:D.navId)||F&&this._sharingContextInformation.navId.length<=1024,R=(null===(I=this._sharingContextInformation)||void 0===I?void 0:I.navIdSendLinkOverride)&&(0,Z.c)(this._sharingContextInformation.navIdSendLinkOverride),N=!(null===(x=this._sharingContextInformation)||void 0===x?void 0:x.navIdSendLinkOverride)||R&&this._sharingContextInformation.navIdSendLinkOverride.length<=1024;if(!H||!N)return this._storeContents.sharingInformation=(0,i.a)((0,i.a)({},this._storeContents.sharingInformation),{error:d.b.invalidItem,errorCategory:d.a.shareLink,errorMessage:H?k.$e:k.Ze}),M.end({resultType:T.b.Failure}),this._getShareLinkStats={name:"ShareLink",resultType:T.b.Failure,duration:(new Date).getTime()-L,error:d.b.invalidItem},this._invokeShareStatsEvent(this._getShareLinkStats),void this._emitChange({type:h.b.ShareLink});var B=null,j=null,q=this.getAvailableReShareLink(A);if(G.c()&&q.length?(B=new O.a(function(e,t){e({link:q[0]})}),j=function(e){return(0,K.f)("sharelink._shareLink.end"),M.end({resultType:T.b.Success}),C._getShareLinkStats={name:"ShareLink",resultType:T.b.Success,duration:(new Date).getTime()-L},C._invokeShareStatsEvent(C._getShareLinkStats,!0),C._handleSharedLink(e.link,u,!0),e.link},this._engagementHelper.setEngagementExtraData({isReShare:!0})):(B=this._sharingProvider.shareLink(A),j=function(t){if((0,K.f)("sharelink._shareLink.end"),t.error){C._engagementHelper.setEngagementExtraData({shareLinkSettings:e});var n=t.error;C._storeContents.sharingInformation=(0,i.a)((0,i.a)({},C._storeContents.sharingInformation),{error:n,errorCategory:d.a.shareLink,debugErrorMessage:n.message&&n.message.value});try{429===n.status&&(C._storeContents.sharingInformation.errorMessage=k.Gi)}catch(e){}try{if(!z.l()){var a=null==t?void 0:t.error,r=null==a?void 0:a.code,s=void 0;try{r&&(s=parseInt(r.match(/-?\d+/g)[0],10))}catch(e){}var c=(0,W.d)(s);c&&(C._storeContents.sharingInformation.errorMessage=c)}}catch(e){}return M.end({resultType:T.b.Failure}),C._getShareLinkStats={name:"ShareLink",resultType:T.b.Failure,duration:(new Date).getTime()-L,error:t.error},C._invokeShareStatsEvent(C._getShareLinkStats),void C._emitChange({type:h.b.ShareLink})}M.end({resultType:T.b.Success}),C._getShareLinkStats={name:"ShareLink",resultType:T.b.Success,duration:(new Date).getTime()-L},C._invokeShareStatsEvent(C._getShareLinkStats);var l=t.link;return e.audience===o.a.customLabeledSpecificPeople&&(l.audience=o.a.customLabeledSpecificPeople),l.sharingLinkKind===C._storeContents.sharingInformation.defaultSharingLink.sharingLinkKind&&f&&u&&0===C._storeContents.sharingInformation.sharingLinks.filter(function(e){return e.shareId===l.shareId}).length&&(C._storeContents.defaultLink=l),p?(C._sharingInformationInvalidated=!0,C.fetchSharingInformation(!0).then(function(){b&&C._removePrincipals(b)})):(C._updateAccessMap(l.shareId,e.sharingRole),C._handleSharedLink(l,u)),l}),u&&this._platformDetection.isSafari){var Q=new ClipboardItem(((g={})["text/plain"]=B.then(j).then(function(e){var t=(0,U.C)(e,c.a.copy,C);return new Blob([t],{type:"text/plain"})}),g));window.navigator.clipboard.write([Q])}else B.done(j)},e.prototype._removeAccess=function(e,t){var n=this;return new Promise(function(a,r){try{n.updatePermissions(e,l.a.none),t.end((0,i.a)({resultType:T.b.Success},n._telemetryExtraData)),a()}catch(e){t.end({resultType:T.b.Failure,extraData:(0,i.a)((0,i.a)({},n._telemetryExtraData),(0,Q.c)(e))}),r(e)}})},e.prototype._invokeShareStatsEvent=function(e,t){var n=new T.a,a=this._getSharingInformationStats&&this._getSharingInformationStats.resultType;e&&(a=e.resultType);var o={mode:r.a[this._mode],clientId:m.a[this._clientId]||"unknown",getData:JSON.stringify(this._getSharingInformationStats),setData:JSON.stringify((0,i.a)((0,i.a)({},e),{isReShare:t}))};n.end({name:"SharingStats",resultType:a,extraData:o})},e.prototype._isPolicyTipFlagSet=function(e,t){return e&&(e&t)===t},e.prototype._getDefaultLink=function(){var e,t,n=this,a=new T.a({name:"SharingGetDefaultLink"}),i=this._sharingContextInformation.itemUrl;if(!i&&this._sharingContextInformation.serverRelativeItemUrl){var r=new H.a(this._sharingContextInformation.webAbsoluteUrl);i="".concat(r.authority).concat(this._sharingContextInformation.serverRelativeItemUrl)}var o=[];this._sharingContextInformation.defaultRecipients&&this._sharingContextInformation.defaultRecipients.length>0&&(o=this._sharingContextInformation.defaultRecipients.map(function(e){return{email:e}}));var s=this._sharingContextInformation.uniqueId;s||(s=null===(t=null===(e=this._storeContents)||void 0===e?void 0:e.sharingInformation)||void 0===t?void 0:t.itemUniqueId);var c=this._permissions?O.a.resolve(this._permissions):s?this._sharingService.getDefaultLinkByUniqueId(s||"",o,!0):this._sharingService.getDefaultLink(i,o,!0);(0,K.f)("sharelink.getDefaultLink.start"),c.then(function(e){(0,K.f)("sharelink.getDefaultLink.end");var t=e[0],i=t.link,r=t.roles&&t.roles.indexOf("write")>=0;a.end({resultType:T.b.Success});var o=(0,U.I)(i.scope),s=(0,U.M)(o);n._handleSharedLink({allowsAnonymousAccess:"anonymous"===i.scope,audience:o,expiration:t.expirationDateTime,isActive:!0,isEdit:r,principals:[],shareId:t.id,sharingLinkKind:(0,U.J)(i.scope,r),sharingScope:s,url:i.webUrl,createdViaCopyLinkCommand:!0,invitees:[],updatePassword:!1,password:""},!0)},function(e){a.end({resultType:T.b.Failure,extraData:{error:e}});var t="";try{t=JSON.stringify(e)}catch(e){}n._storeContents.sharingInformation={error:e,errorCategory:d.a.invite,errorMessage:k.Rd,debugErrorMessage:t,anonymousLinkExpirationRestrictionDays:void 0,canAddExternalPrincipal:void 0,canAddInternalPrincipal:void 0,canRequestAccessForGrantAccess:void 0,canManagePermissions:void 0,defaultSharingLink:void 0,defaultShareLinkScope:void 0,defaultShareLinkToExistingAccess:void 0,hasInheritedLinks:void 0,isShared:void 0,item:void 0,fileExtension:void 0,sharingLinks:void 0,sharingPrincipals:void 0,peoplePickerSettings:void 0,userDisplayName:void 0,blockPeoplePickerAndSharing:void 0,defaultShareLinkPermission:void 0,sharingAbilities:void 0,defaultLinkKind:void 0,directLink:void 0,hasPermissionsInformation:void 0,isGraphAvailable:!1,sharingLinkTemplates:void 0,webTemplateId:void 0,itemUniqueId:void 0,customizedExternalSharingServiceUrl:void 0,outlookEndpointHostUrl:void 0,webUrl:void 0},n._emitChange()})},e.prototype._dedupeRecipients=function(e){var t=[],n={};return e.forEach(function(e){n[e.userId]=e}),Object.keys(n).forEach(function(e){t.push(n[e])}),t},e.prototype._raceGSI=function(e,t,n){var a=this,i=this._sharingProvider.getSharingInformation(this._item,e,!0,null,t),r=this._prefetchGSI;Promise.race([r,i]).then(function(e){a._setGSIResponse(e,n)},function(e){a._setGSIError(e,n)})},e.prototype._checkPrefetchSupportExpansion=function(e,t){var n=window.g_expand;return!(!n||n.length<1||n.indexOf("pickerSettings")<0||n.indexOf("sharingLinkTemplates")<0||e&&n.indexOf("permissionsInformation")<0||t&&n.indexOf("addressBarLinkSettings")<0)},e.prototype._setGSIResponse=function(e,t){this._getSharingInformationStats={name:"GetSharingInformation",resultType:T.b.Success,duration:(new Date).getTime()-t,GSIsource:e.getSharingInformationSources},this._storeContents.sharingInformation&&this._storeContents.sharingInformation.error||(this._storeContents.sharingInformation=e,this._useSimplifiedSharingDialog&&void 0!==this.getSharingInformation()&&this.parsePermissions(),this._fetchAdditionalAuthenticationTokens(),this.fetchPolicyTipInformation(),this._configureLinkIfShareId(),(0,F.a)(e.userPhotoCdnBaseUrl),this._emitChange({type:h.b.FetchSharingInformation}))},e.prototype._setGSIError=function(e,t){var n=(0,W.b)(null,W.a.api,e);this._getSharingInformationStats={name:"GetSharingInformation",resultType:T.b.Failure,duration:(new Date).getTime()-t,error:n.error},this._invokeShareStatsEvent(),this._storeContents.sharingInformation=n,this._emitChange({type:h.b.FetchSharingInformation})},e.prototype._updateAccessMap=function(e,t){var n=this,a=this._storeContents.sharingInformation.sharingPrincipals;this._storeContents.sharingInformation.sharingPrincipals=a.map(function(a){var r,o,s;return(null===(r=a.accessMap)||void 0===r?void 0:r.get(e))&&(null===(o=a.accessMap)||void 0===o||o.set(e,(0,i.a)((0,i.a)({},null===(s=a.accessMap)||void 0===s?void 0:s.get(e)),{role:t})),n._updatePrincipal(a)),a})},e.prototype._parseFamilyInfo=function(e,t){var n=t.map(function(e){return{userId:e.id,name:e.firstName+" "+e.lastName,email:e.userPrincipalName,isResolved:!0,familySharingTargetType:$.a.FamilyMember}}),a=t[0].firstName;return t.forEach(function(e,t){0!==t&&(a+=", ".concat(e.firstName))}),{family:{userId:e,name:k.Od,email:a,isExternal:!1,isResolved:!0,entityType:D.a.group,familySharingTargetType:$.a.Family,detailedGroupInfo:D.c.family},familyMembers:n}},e.prototype._toTuple=function(e){return(0,i.b)(this,void 0,void 0,function(){var t;return(0,i.e)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),t={},[4,e];case 1:return[2,(t.value=n.sent(),t)];case 2:return[2,{error:n.sent()}];case 3:return[2]}})})},e.prototype._isError=function(e){return!!e.error},e}()}
,,function(e,t,n){function a(e){return function(e){return!!e&&"object"==typeof e&&"default"in e}(e)?e.default:e}n.d(t,{a:function(){return a}})}
,function(e,t,n){n.d(t,{a:function(){return u}});var a=n(8),i=n(7),r=n(267),o=n(2),s=n(289),c=n(266),d=n(0),l=n(4);(0,s.e)("body");var u=function(){function e(){}return e.initializeTheme=function(t,n,s,u,f){window.__loadTheme=o.G,(window.FabricConfig=window.FabricConfig||{}).fontBaseUrl="";var p=window._spModuleLink;if(p&&p.libraries&&p.libraries.length>0&&(0,a.a)(1),e._useOverrideTheme)return i.c.resolve((0,o.D)());var m=(0,r.a)(t,n);return m?(e._themePromise=m.loadFullFormattedThemeData(s).then(function(e){var t=e||{};if((0,c.b)(n)&&t.fontFaces)try{!function(e,t){void 0===t&&(t="Unknown"),(0,d.b)(this,void 0,void 0,function(){var n,a,i,r,o,s;return(0,d.e)(this,function(c){for(n=new l.a({name:"Theming.LoadAllFonts.".concat(t)}),a=[],i=function(e){var t,n,i=!1;if(document.fonts.forEach(function(t){t.family===e.fontFamily&&(i=!0)}),!i){var r=new FontFace(e.fontFamily,(n=(t=e).remappedPaths)?n.map(function(e){return"url(".concat(e,")")}).join(","):"url(".concat(t.path,")"));r.display="swap",document.fonts.add(r),a.push(r.load())}},r=0,o=e;r<o.length;r++)s=o[r],i(s);return[2,Promise.all(a).then(function(){n.end({resultType:l.b.Success})},function(e){n.end({resultType:l.b.Failure,error:null==e?void 0:e.message})})]})})}(t.fontFaces,t.fontPackageSource)}catch(e){}return(0,c.c)(t,n,u,f),e}),e._themePromise):i.c.resolve((0,c.c)({},n,u))},e.overrideTheming=function(t,n){t&&(0,c.c)(t,n,!0),e._useOverrideTheme=!0,e._themePromise&&e._themePromise.cancel()},e._useOverrideTheme=!1,e}();window.FabricConfig&&window.FabricConfig.legacyTheme&&u.overrideTheming()}
,function(e,t,n){n.d(t,{a:function(){return s}});var a,i,r=n(0);function o(){return(0,r.b)(this,void 0,void 0,function(){return(0,r.e)(this,function(e){switch(e.label){case 0:return a?[3,2]:[4,a=n.e(37).then(n.bind(n,588))];case 1:i=e.sent().tools,e.label=2;case 2:return[2]}})})}function s(){return window.$copilot||(window.$copilot={availability:{},loadDebugTools:o,get tools(){if(!i)throw Error("Call `await $copilot.loadDebugTools()` first to load the tools");return i},context:{}}),window.$copilot}}
,function(e,t,n){n.d(t,{a:function(){return a}});var a={ppe:"f74c101dfd474d06a7b40fed2051df7e-edb10b9a-779e-4b75-b0cc-ee0cee0f831b-7189",prod:"af7114704a204580909f08c904c5ac6f-6f6f4c13-294c-4a00-8e55-71180ed7d627-7044"}}
,function(e,t,n){n.d(t,{a:function(){return _},b:function(){return h}});var a=n(0),i=n(38),r=n(1),o=n(49),s=n(31),c=n(352),d=n(348),l=n(29),u=n(117),f=function(e){function t(t){var n=t.contextProvided,i=(0,a.f)(t,["contextProvided"]),r=new l.a,o=r.osName,s=r.osVersion,c=(0,a.a)({OSName:o,OSVersion:s,UserAgent:navigator.userAgent},n);return e.call(this,(0,a.a)({context:c,logStartEvents:!0},i))||this}return(0,a.d)(t,e),t}(function(e){function t(t){var n=t.context,i=void 0===n?{}:n,r=(0,d.a)();return e.call(this,(0,a.a)((0,a.a)({language:window.navigator.language},t),{context:(0,a.a)((0,a.a)({},r),i)}))||this}return(0,a.d)(t,e),t}(c.a)),p=!r.b.isActivated("F68B6171-BBD4-440F-9527-F56CE8D3EA2C","01/06/2024","collect flight and experiment"),m=!r.b.isActivated("D3B20610-CED8-4AAF-958B-8EC166C0A3D4","02/20/2024","build as experiment context");function _(e,t){var n,c,d,l,f,_=e.CorrelationId,h=e.systemUserKey,b=e.userLoginName,g=e.farmName,v=e.farmLabel,y=e.siteSubscriptionId,S=e.homeTenantId,D=e.aadTenantId,I=e.SideBySideToken;if(r.b.isActivated("0d905643-decb-4b91-8c6d-87348745d166"))n=_;else{var x=new s.a(window.location.href).getQueryParameter("sessionId");n=i.a.isValidGuid(x)?x:_}if(p){var C=function(e){var t=window.ODSP_EXPERIMENTS||{},n=void 0;for(var a in t)if(t.hasOwnProperty(a)){n=n||{};var i=t[a];i&&i._serverTime&&Date.now()-new Date(i._serverTime).getTime()<1296e6&&(n[a]=t[a])}return window.ODSP_EXPERIMENT_TAGS||(0,u.d)(e),{experiments:n,experimentTags:window.ODSP_EXPERIMENT_TAGS}}(e)||{};c=JSON.stringify(C.experiments),d=JSON.stringify(C.experimentTags),l=function(e){var t,n=e.ExpFeatures,a=void 0;if(n){a="";for(var i=0,r=n;i<r.length;i++)a+=(t=(r[i]>>>0).toString(2),"".concat(Array(32-t.length+1).join("0")).concat(t)).split("").reverse().join("")}return a}(e)}return m&&(f="undefined"!=typeof window?window._spModuleLink:void 0),(0,a.a)((0,a.a)((0,a.a)({UserId:h,FarmName:g,FarmLabel:v,AccountType:b?o.a[o.a.Business]:o.a[o.a.BusinessAnonymous],TenantID:y,ServerGU:I,Session:n,SessionId:n,HomeTenantId:S||D,ResourceTenantId:D},p?{Flights:l,Experiments:c,ExperimentTags:d}:{}),m&&f?{isBuildAsExperimentRunning:f.isBuildAsExperimentRunning,buildAsExperimentTargetVersion:f.targetBuildNumber}:{}),t)}function h(e){var t=e.pageContext,n=e.customerContext,i=(0,a.f)(e,["pageContext","customerContext"]),r=_(t,n||{});return new f((0,a.a)({contextProvided:r,disableCookies:t.isAnonymousGuestUser,ariaLogConfiguration:{collectorUrl:t.ariaCollectorUrl}},i))}}
,function(e,t,n){n.d(t,{a:function(){return b}});var a=n(0),i=n(121),r=function(){function e(e){this._scope=new i.a,this._targetMap=new WeakMap,this._disposableMap=new WeakMap}return e.prototype.on=function(e,t,n){var a;if(o(e))a=e;else{var i=this._targetMap.get(e);i?a=i:(a=new EventTarget,this._targetMap.set(e,a))}a.addEventListener(t,n);var r=this._disposableMap.get(e);r||(r=new Map,this._disposableMap.set(e,r));var s=this._scope.attach({dispose:function(){a.removeEventListener(t,n)}});r.set(t,s)},e.prototype.off=function(e,t,n){var a;if(o(e))a=e;else{var i=this._targetMap.get(e);i&&(a=i)}var r=this._disposableMap.get(e);if(r){var s=r.get(t);s&&(s.dispose(),r.delete(t)),0===r.size&&this._disposableMap.delete(e)}a&&a.removeEventListener(t,n)},e.prototype.dispose=function(){this._scope.dispose()},e}();function o(e){return!!e.addEventListener}var s=function(){function e(e){this._scope=new i.a,this._timeoutMap=new Map}return e.prototype.setTimeout=function(e,t){var n=this,a=setTimeout(function(){n._timeoutMap.delete(a),e()},t),i=this._scope.attach({dispose:function(){clearTimeout(a)}});return this._timeoutMap.set(a,i),a},e.prototype.clearTimeout=function(e){var t=this._timeoutMap.get(e);t&&(this._timeoutMap.delete(e),t.dispose())},e.prototype.dispose=function(){this._scope.dispose()},e}(),c="handlerRejection",d="canceled",l=0,u=function(){function e(e,t){void 0===t&&(t={});var n=this,a=new Map,o={onCommand:e.onCommand,onNotification:e.onNotification},l=e.initResources,u=e.initTimeoutMs,f=void 0===u?1e4:u,p=e.ackTimeoutMs,m=void 0===p?1e3:p,_=e.resultTimeoutMs,h=void 0===_?1e4:_,b=t.asyncType,g=void 0===b?s:b,v=t.eventGroupType,y=void 0===v?r:v,S=this._scope=new i.a;S.attach(l);var D,I=this._async=S.attach(new g(this)),x=S.attach(new y(this));this._ackTimeoutMs=m,this._resultTimeoutMs=h,this._invokeCommandHandler=function(e){try{var t=o.onCommand&&o.onCommand(e);return t?Promise.resolve(t).catch(function(e){return{result:"error",error:{code:(e=e||{name:c,isExpected:!1,message:"Unknown error"}).code||e.name||c,message:e.message||"".concat(e)},isExpected:!!e.isExpected}}):Promise.resolve({result:"error",error:{code:"unsupportedCommand",message:e.command},isExpected:!0})}catch(e){return Promise.resolve({result:"error",isExpected:!1,error:{code:"handlerError",message:e&&"Name: ".concat(e.name,"; Message: ").concat(e.message||e)}})}},this._invokeNotificationHandler=function(e){try{o.onNotification&&o.onNotification(e)}catch(e){}};var C=this._port=new Promise(function(t,a){S.attach({dispose:function(){var e=new Error("Initialization canceled.");e.code=d,a(e)}}),D=I.setTimeout(function(){var e=new Error("Initialization timed out after ".concat(f,"ms"));e.code="setupTimeout",a(e)},f),e.init(function(e){I.clearTimeout(D),S.attach({dispose:function(){e.close()}}),x.on(e,"message",function(t){var a=t.data;if(a&&"object"==typeof a)return"acknowledge"===a.type?n._onAcknowledge(a):"command"===a.type?n._onCommand(e,a):"notification"===a.type?n._onNotification(a):"result"===a.type?n._onResult(a):void 0}),e.start(),t(e)},a)});this.ready=C.then(function(){},function(e){return n.dispose(),Promise.reject(e)}),this._signals=a}return e.prototype.dispose=function(){this._scope.dispose(),this._signals.forEach(function(e){e.resolve({result:"error",isExpected:!0,error:{code:d,message:"Messenger disposed"}})}),this._signals.clear()},e.prototype.sendCommand=function(e,t){var n=this;if(void 0===t&&(t={}),this._scope.isDisposed)return Promise.resolve({result:"error",isExpected:!1,error:{code:"disposed",message:"disposed"}});var a=++l,i=t.timeoutDelayMs,r=void 0===i?this._resultTimeoutMs:i,o=t.acknowledgeTimeoutMs,s=void 0===o?this._ackTimeoutMs:o,c=t.transfer;return this._port.then(function(t){var i=n._async,o=new Promise(function(e){n._signals.set(a,{acknowledgeTimeout:i.setTimeout(function(){n._onResult(f(a,"acknowledgeTimeout"))},s),resultTimeout:i.setTimeout(function(){n._onResult(f(a,"resultTimeout"))},r),resolve:e})});return t.postMessage({type:"command",id:a,data:e},c||[]),o})},e.prototype.sendNotification=function(e){this._scope.isDisposed||this._port.then(function(t){t.postMessage({type:"notification",data:e})})},e.prototype._onAcknowledge=function(e){var t=this._signals.get(e.id);t&&this._async.clearTimeout(t.acknowledgeTimeout)},e.prototype._onCommand=function(e,t){var n=t.id;e.postMessage({type:"acknowledge",id:n}),this._invokeCommandHandler(t.data).then(function(t){e.postMessage({type:"result",data:t,id:n})}).catch(function(e){})},e.prototype._onNotification=function(e){this._invokeNotificationHandler(e.data)},e.prototype._onResult=function(e){var t=e.id,n=this._async,a=this._signals,i=a.get(t);i&&(n.clearTimeout(i.acknowledgeTimeout),n.clearTimeout(i.resultTimeout),i.resolve(e.data)),a.delete(t)},e}();function f(e,t){return{id:e,data:{result:"error",error:{code:t,message:"Timed out"},isExpected:!1}}}function p(e){if(e.channelId&&e.origin)return e;var t=window.location.hash;if(!t)return e;for(var n={channelId:"",origin:""},i=0,r=t.slice(1).split("&");i<r.length;i++){var o=r[i].split("=",3),s=o[0],c=o[1];n.hasOwnProperty(s)&&(n[s]=decodeURIComponent(c))}return(0,a.a)((0,a.a)({},n),e)}var m,_=function(){function e(){this._commandHandlers=[],this._notificationHandlers=[]}return Object.defineProperty(e.prototype,"ready",{get:function(){return this._messenger.ready},enumerable:!1,configurable:!0}),e.prototype.sendCommand=function(e,t){return this._messenger.sendCommand(e,t)},e.prototype.sendNotification=function(e){return this._messenger.sendNotification(e)},e.prototype.addCommandHandler=function(e){var t=this;return this._commandHandlers.push(e),{dispose:function(){var n=t._commandHandlers.indexOf(e);n>-1&&t._commandHandlers.splice(n,1)}}},e.prototype.addNotificationHandler=function(e){var t=this;return this._notificationHandlers.push(e),{dispose:function(){var n=t._notificationHandlers.indexOf(e);n>-1&&t._notificationHandlers.splice(n,1)}}},e.prototype.dispose=function(){this._messenger.dispose()},e.prototype._onCommand=function(e){for(var t=0,n=this._commandHandlers;t<n.length;t++){var a=(0,n[t])(e);if(a)return a}},e.prototype._onNotificiation=function(e){for(var t=0,n=this._notificationHandlers;t<n.length;t++)(0,n[t])(e)},e}(),h=n(4);!function(e){e.ScriptLoaded="share_scriptsLoaded",e.CopyLinkClicked="share_copyLinkClicked",e.ShareReady="share_ready",e.ShareDismiss="share_dismiss",e.ShareSendClicked="share_sendClicked",e.ShareManageAccessClicked="share_manageAccessClicked",e.ShareUIReady="share_uiReady",e.SharePageError="share_error",e.ShareCompleted="share_completed",e.ShareOutlookClicked="share_outlookClicked",e.ShareTeamsClickedWithContext="share_teamsClickedWithContext",e.ShareAddPeopleCompleted="share_addPeopleCompleted",e.ShareReadyForRecipients="share_readyForRecipients",e.GrantAccessCompleted="share_grantAccessCompleted",e.PeoplePickerFocused="share_peoplePickerFocused",e.ShareInstantLoad="share_instantLoadReady",e.ShareStarted="share_started",e.ShareLoadResult="share_loadResult"}(m||(m={}));var b=function(e){function t(t){var n=this,o=t.initTimeoutMs,s=void 0===o?4e4:o,c=t.overridePort,d=(0,a.f)(t,["initTimeoutMs","overridePort"]);return(n=e.call(this)||this)._isPageLoaded=!1,n._customerPromiseLogger=d.customerPromiseLogger,n._messenger=function(e,t){if(void 0===t&&(t={}),e.isRestartable)return function(e,t){void 0===t&&(t={});var n=p(e),a=n.channelId,o=n.origin,s=void 0===o?location.origin:o,c=n.host,d=void 0===c?window.parent!==window&&window.parent||window.opener:c,l=n.overridePort,f=n.receiver,m=void 0===f?window:f,_=t.channelType,h=void 0===_?MessageChannel:_,b=t.eventGroupType,g=void 0===b?r:b,v=t.messengerType,y=void 0===v?u:v,S=new i.a,D=S.attach(new g(null));return new y({onCommand:e.onCommand,onNotification:e.onNotification,init:function(e,t){var n=l?{port1:l,port2:void 0}:new h,i=n.port1,r=n.port2,o=!1;S.attach({dispose:function(){i.close()}});var c=!1,u=function(e){var t=e.data;if(c||!t||"object"!=typeof t||"identify-parent"!==t.type||t.channelId!==a);else{D.off(m,"message",u);var n=e.source,i=r;if(!l&&o){var d=new h,p=d.port1;i=d.port2,D.on(p,"message",f.bind(null,p)),p.start()}o=!0;var _={type:"initialize",channelId:a,replyTo:i};n.postMessage(_,s,i?[i]:void 0),c=!0}},f=function(n,a){var i=a.data;i&&"object"==typeof i&&"activate"===i.type?(D.dispose(),e(n)):t(new Error("Unexpected message during messenger initialization")),D.off(m,"message",u)};D.on(i,"message",f.bind(null,i)),i.start();var p={type:"initialize",channelId:a,replyTo:r};l?(o=!0,l.postMessage(p,[r])):d&&(o=!0,d.postMessage(p,s,[r]),D.on(m,"message",u))},initResources:S,initTimeoutMs:e.initTimeoutMs,ackTimeoutMs:e.ackTimeoutMs})}(e,t);var n=p(e),a=n.channelId,o=n.origin,s=void 0===o?location.origin:o,c=n.host,d=void 0===c?window.parent!==window&&window.parent||window.opener:c,l=n.overridePort,f=n.receiver,m=void 0===f?window:f,_=t.channelType,h=void 0===_?MessageChannel:_,b=t.eventGroupType,g=void 0===b?r:b,v=t.messengerType,y=void 0===v?u:v,S=new i.a,D=S.attach(new g(null));return new y({onCommand:e.onCommand,onNotification:e.onNotification,init:function(e,t){var n=l?{port1:l,port2:void 0}:new h,i=n.port1,r=n.port2;S.attach({dispose:function(){i.close()}}),D.on(i,"message",function(n){var a=n.data;a&&"object"==typeof a&&"activate"===a.type?(D.dispose(),e(i)):t(new Error("Unexpected message during messenger initialization"))}),i.start();var o={type:"initialize",channelId:a,replyTo:r};if(l)l.postMessage(o,[r]);else if(d)d.postMessage(o,s,[r]);else{var c=function(e){var t=e.data;t&&"object"==typeof t&&"identify-parent"===t.type&&t.channelId===a&&(D.off(m,"message",c),e.source.postMessage(o,s,[r]))};D.on(m,"message",c)}},initResources:S,initTimeoutMs:e.initTimeoutMs,ackTimeoutMs:e.ackTimeoutMs,resultTimeoutMs:e.resultTimeoutMs})}((0,a.a)((0,a.a)({},d),{initTimeoutMs:s,overridePort:c,onCommand:n._onCommand.bind(n),onNotification:n._onNotificiation.bind(n)})),n}return(0,a.d)(t,e),t.prototype.sendScriptLoaded=function(){return this._send({command:"shareCommand",name:m.ScriptLoaded})},t.prototype.sendCopyLinkShareTargetClicked=function(){return this._send({command:"shareCommand",name:m.CopyLinkClicked})},t.prototype.sendShareReady=function(){return this._isPageLoaded?this._send({command:"shareCommand",name:m.ShareInstantLoad}):(this._isPageLoaded=!0,this._send({command:"shareCommand",name:m.ShareReady}))},t.prototype.sendShareStarted=function(){return this._send({command:"shareCommand",name:m.ShareStarted})},t.prototype.sendDismiss=function(){return this._send({command:"shareCommand",name:m.ShareDismiss})},t.prototype.sendShareSendClicked=function(){return this._send({command:"shareCommand",name:m.ShareSendClicked})},t.prototype.sendShareManageAccessClicked=function(){return this._send({command:"shareCommand",name:m.ShareManageAccessClicked})},t.prototype.sendShareUIReady=function(){return this._send({command:"shareCommand",name:m.ShareUIReady})},t.prototype.sendShareError=function(e){var t,n,a,i,r={command:"shareCommand",name:m.SharePageError,error:(null===(t=e.error)||void 0===t?void 0:t.toString())||"",errorCategory:(null===(n=e.errorCategory)||void 0===n?void 0:n.toString())||"",errorMessage:(null===(a=e.errorMessage)||void 0===a?void 0:a.toString())||"",debugErrorMessage:(null===(i=e.debugErrorMessage)||void 0===i?void 0:i.toString())||""};return this._send(r)},t.prototype.sendShareCompleted=function(){return this._send({command:"shareCommand",name:m.ShareCompleted})},t.prototype.sendOutlookClicked=function(){return this._send({command:"shareCommand",name:m.ShareOutlookClicked})},t.prototype.sendTeamsClicked=function(e,t,n){var a={command:"shareCommand",name:m.ShareTeamsClickedWithContext,sharingLink:e.url,recipients:t,numRecipients:t?t.length:0,body:n};return this._send(a)},t.prototype.sendShareAddPeopleCompleted=function(e,t){void 0===t&&(t="");var n={command:"shareCommand",name:m.ShareAddPeopleCompleted,successful:e,completionMessage:t};return this._send(n)},t.prototype.sendShareReadyForRecipients=function(){return this._send({command:"shareCommand",name:m.ShareReadyForRecipients})},t.prototype.sendGrantAccessCompleted=function(e){var t={command:"shareCommand",name:m.GrantAccessCompleted,successful:e};return this._send(t)},t.prototype.sendPeoplePickerFocused=function(){return this._send({command:"shareCommand",name:m.PeoplePickerFocused})},t.prototype.sendResize=function(e){var t=e;return t.command="shareCommand",this._send(t)},t.prototype.sendShareLoadResult=function(e){var t={command:"shareCommand",name:m.ShareLoadResult,result:e};return this._send(t)},t.prototype._send=function(e){var t=this;return this._messenger.sendCommand(e).then(function(e){return!!e}).catch(function(n){var a;return null===(a=t._customerPromiseLogger)||void 0===a||a.end({resultType:h.b.Failure,errorCode:"SharingClientMessenger - send ".concat(e.name," failed"),extraData:{errorMessage:n.toString()}}),!1})},t}(_)}
,function(e,t,n){var a;n.d(t,{a:function(){return c},b:function(){return d}}),function(e){e[e.default=0]="default",e[e.powerpoint=1]="powerpoint",e[e.stream=2]="stream",e[e.excelRange=3]="excelRange",e[e.excelTable=4]="excelTable",e[e.excelSheet=5]="excelSheet",e[e.excelChart=6]="excelChart",e[e.excelSheetView=7]="excelSheetView",e[e.excelComment=8]="excelComment"}(a||(a={}));var i=n(19),r=n(21),o=n(20),s=n(592);function c(e,t){if(e){var n="";return t&&(0,s.c)(t)&&(n=(0,s.b)(t)),{context:l(e),location:n}}}function d(e){var t=e.sharingStore,n=e.fallback,s=e.copyToClipboardFailed;if(r.A()&&t){var c=t.getContextualSharingInformation(),d=t.getNavId();if(c&&d){var l="".concat(function(e){switch(e){case a.excelRange:return o.qb;case a.excelTable:return o.Xb;case a.excelSheet:return o.Yb;case a.excelChart:return o.Gb;case a.excelSheetView:return o.Qb;case a.excelComment:return o.Kb;case a.powerpoint:return o.Jb;case a.stream:default:return""}}(c.context)).concat(c.location?" "+c.location:""),u=s?o.hf:o.Wb;return i.d(u,l)}}return n}function l(e){switch(e&&(e=e.toString()),e){case"1":return a.powerpoint;case"2":return a.stream;case"3":return a.excelRange;case"4":return a.excelTable;case"5":return a.excelSheet;case"6":return a.excelChart;case"7":return a.excelSheetView;case"8":return a.excelComment;default:return a.default}}}
,function(e,t,n){n.d(t,{a:function(){return m},b:function(){return _}});var a=n(0),i=(n(225),n(226),n(227),n(349)),r=n(350),o=n(351),s=n(38),c=n(49),d=n(151),l=n(36);(0,i.a)();var u,f=void 0;function p(e){var t=window.PageContext,n=t.env||"devbox",a=window.Flight,i=e.oAuthToken&&function(e){if(e){var t=e.split(".");if(3===t.length)try{return JSON.parse(atob(t[1].replace(/-/g,"+").replace(/_/g,"/")))}catch(e){return}}}(e.oAuthToken),r=i&&i.puid||a.session,o=i&&i.puid||t.userName,d=i&&i.tid,l=d||t.siteSubscriptionId,u=d||t.aadTenantId;return{isAuthenticated:!!o,market:t.mkt,session:s.a.generate(),collectorUrl:t.ariaCollectorUrl,oneDsCollectorUrl:t.oneDsCollectorUrl,version:a.version,manifest:a.manifest||a.name,userId:r,accountType:o?c.a.Business:c.a.BusinessAnonymous,siteSubscriptionId:l,farmLabel:t.farmLabel,environment:n,workload:e.workload,disableCookies:!t.userName,context:e.context,cloudType:t.cloudType,homeTenantId:t.homeTenantId||u,resourceTenantId:u}}function m(e,t){void 0===t&&(t={}),function(e){var t="",n=window.PageContext.env||"devbox",a=window.Flight;if(a)if(a.ramps&&!a.Ramps&&(a.Ramps=a.ramps),a.usingRedirectCookie)t=e.tokens.ppe;else switch(n.toLowerCase()){case"edog":case"dogfood":case"prodbubble":t=e.tokens.ppe;break;case"prod":case"dprod":t=e.tokens.prod}else t=e.tokens.prod;u=p(e),t&&(e.initOneDS||(0,o.b)()?(null==f||f.dispose(),(f=new d.a({sourceName:"od-core",tenantToken:t,context:u})).attach(l.a)):(f=void 0,o.a.Init(t,u)))}({oAuthToken:e,workload:"ODB",tokens:{ppe:"f74c101dfd474d06a7b40fed2051df7e-edb10b9a-779e-4b75-b0cc-ee0cee0f831b-7189",prod:"af7114704a204580909f08c904c5ac6f-6f6f4c13-294c-4a00-8e55-71180ed7d627-7044"},context:t.context,initOneDS:t.initOneDS})}function _(e,t){void 0===t&&(t={}),function(e){if(u){var t=p(e),n=(0,a.a)((0,a.a)((0,a.a)({},u),t),{context:(0,a.a)((0,a.a)({},u.context),e.context)});f?f.updateContext(n):o.a.UpdateContext(n)}}({oAuthToken:e,workload:"ODB",tokens:{ppe:"f74c101dfd474d06a7b40fed2051df7e-edb10b9a-779e-4b75-b0cc-ee0cee0f831b-7189",prod:"af7114704a204580909f08c904c5ac6f-6f6f4c13-294c-4a00-8e55-71180ed7d627-7044"},context:t.context})}r.a.init()}
,function(e,t,n){var a=n(99),i=n(38),r="https://outlook.office.com/search",o=function(){function e(e,t){this._dataRequestor=t.dataRequestor,this._substrateToken=e.substrateToken,this._mailbox=e.mailbox,this._graphApiVersion=e.graphApiVersion}return e.prototype.getContacts=function(e){var t="/me/contacts?$select=displayName,emailAddresses&$top=50";return e&&e.length>0&&(t+='&$search="'.concat(a.a.encodeURIComponent(e),'"')),this._dataRequestor.send({path:t,apiName:"GetContacts",requestType:"GET",useAuthorizationHeaders:!0,qosExtraData:{graphApiVersion:this._graphApiVersion}}).then(function(e){return e.value})},e.prototype.getPeople=function(e){var t=this,n="/me/people?$select=displayName,";return n=this._appendEmailAddressSelector(n),n+="&$top=20",e&&e.length>0&&(n+='&$search="'.concat(a.a.encodeURIComponent(e),'"')),this._dataRequestor.send({path:n,apiName:"GetTopCollaborators",requestType:"GET",useAuthorizationHeaders:!0,qosExtraData:{graphApiVersion:this._graphApiVersion}}).then(function(e){var n=e;return"1.0"===t._graphApiVersion&&(n=t._convertPersonEmails(e)),n&&n.value},function(e){})},e.prototype.searchPeople=function(e){var t=this,n="/me/people?$select=displayName,";return n=this._appendEmailAddressSelector(n),n+="&$top=20",e&&e.length>0&&(n+='&$search="'.concat(a.a.encodeURIComponent(e),'"')),this._dataRequestor.send({path:n,apiName:"SearchPeople",requestType:"GET",useAuthorizationHeaders:!0,qosExtraData:{graphApiVersion:this._graphApiVersion}}).then(function(e){var n=e;return"1.0"===t._graphApiVersion&&(n=t._convertPersonEmails(e)),n&&n.value},function(e){})},e.prototype.searchPeople3S=function(e){var t,n={Authorization:"Bearer "+this._substrateToken,"x-anchormailbox":"SMTP:".concat(this._mailbox)};return t=JSON.stringify({EntityRequests:[{EntityType:"People",ProvenanceMergeMode:"Default",Provenances:["Mailbox"],Query:{QueryString:e},From:0,Size:25,Fields:["DisplayName","EmailAddresses","CompanyName","JobTitle","OfficeLocation","Department","UserPrincipalName","PeopleType","PeopleSubtype"]}],TimeZone:"UTC",Cvid:i.a.generate(),Scenario:{Name:"documentshare"}}),this._dataRequestor.send({apiName:"Substrate.PeopleSearch",path:"/api/v1/suggestions",endpoint:r,needsAuthorization:!1,headers:n,requestType:"POST",postData:t}).then(function(e){return e&&e.Groups&&e.Groups.length&&e.Groups[0].Suggestions},function(e){})},e.prototype.isSubstrateTokenAvailabe=function(){return this._substrateToken&&this._substrateToken.length>0},e.prototype.init3S=function(){if(this._substrateToken){var e={Authorization:"Bearer "+this._substrateToken,"x-anchormailbox":"SMTP:".concat(this._mailbox)};this._dataRequestor.send({apiName:"Substrate.PeopleSearchInit",path:"/api/v1/init?scenario=documentshare",endpoint:r,needsAuthorization:!1,headers:e,requestType:"GET"})}},e.prototype._appendEmailAddressSelector=function(e){return"1.0"===this._graphApiVersion?e+="scoredEmailAddresses":e+="emailAddresses",e},e.prototype._convertPersonEmails=function(e){var t=e&&(null==e?void 0:e.value);if(t&&t.length>0){for(var n=0;n<t.length;n++){var a=t[n];if(a.scoredEmailAddresses&&!a.emailAddresses){for(var i=[],r=0;r<a.scoredEmailAddresses.length;r++){var o=a.scoredEmailAddresses[r],s={address:o.address,rank:o.relevanceScore};i.push(s)}a.emailAddresses=i}}return e}},e}();t.a=o}
,function(e,t,n){n.d(t,{a:function(){return d}});var a=n(0),i=n(7),r=n(593),o=n(1),s=n(10),c=o.b.isActivated("7853DF32-37BE-47FC-9ED5-B341B51F0667","07/07/2023","Killswitch for new Share Dialog for COB")||s.a.isFeatureEnabled({ECS:1131341}),d=function(){function e(e,t){this._service=e,this._supportsPeople=t||!1}return e.prototype.getCapabilities=function(){return{supportsMruCaching:!1}},e.prototype.search=function(e,t){var n=this;if(t.useNew3Ssearch&&this._service.isSubstrateTokenAvailabe())try{return this._service.searchPeople3S(e).then(function(i){if(i&&i.length){var o=[],s=r.a.isValidEmailSyntax(e,!1);if(!1!==t.resolveEmailIfNoResults&&0===o.length&&s){var d={Key:e,IsResolved:!1};o.push((0,a.a)({email:e,name:e,userId:e,isResolved:!0},c?{}:{rawData:d,rawPersonData:d}))}for(var l=0,u=i;l<u.length;l++){var f=u[l],p=f.EmailAddresses&&f.EmailAddresses.length?f.EmailAddresses[0]:"",m="";if(p)try{(m=btoa(f.Id)).indexOf(p)>-1&&(m=m.substring(0,m.indexOf(p)))}catch(e){m=""}d={Key:p,IsResolved:!1},o.push((0,a.a)({email:p,name:f.DisplayName,userId:m,isResolved:!0},c?{}:{rawData:d,rawPersonData:d}))}return o}return n._getContact(e,t)})}catch(e){}else if(this._supportsPeople)try{return this._service.searchPeople(e).then(function(n){var i,o,s=[],d=r.a.isValidEmailSyntax(e,!1);if(!1!==t.resolveEmailIfNoResults&&0===s.length&&d){var l={Key:e,IsResolved:!1};s.push((0,a.a)({email:e,name:e,userId:e,isResolved:!0},c?{}:{rawData:l,rawPersonData:l}))}if(n&&n.length>0)for(var u=0,f=n;u<f.length;u++){var p=f[u],m=null===(o=null===(i=null==p?void 0:p.emailAddresses)||void 0===i?void 0:i[0])||void 0===o?void 0:o.address,_="";if(m)try{(_=btoa(p.id)).indexOf(m)>-1&&(_=_.substring(0,_.indexOf(m)))}catch(e){_=""}l={Key:m,IsResolved:!1},s.push((0,a.a)({email:m,name:p.displayName,userId:_,isResolved:!0},c?{}:{rawData:l,rawPersonData:l}))}return s})}catch(e){}return this._getContact(e,t)},e.prototype._getContact=function(e,t){return this._service.getContacts(e).then(function(n){var i=r.a.isValidEmailSyntax(e,!1);if(!1!==t.resolveEmailIfNoResults&&0===n.length&&i){var o={Key:e,IsResolved:!1};return[(0,a.a)({email:e,name:e,userId:e,isResolved:!0},c?{}:{rawData:o,rawPersonData:o})]}var s=e.toLowerCase(),d=n.map(function(e){var t,n="",r="",o=e.emailAddresses;if(o&&o.length>0)for(var d=0,l=o;d<l.length;d++){var u=l[d];if(u&&u.address&&u.address.length>0&&(r||(r=u.address),i&&0===u.address.toLowerCase().indexOf(s))){n=u.address;break}}t=i&&n||e.displayName;var f=i?n:r,p={Key:f,IsResolved:!1};return(0,a.a)({userId:t,name:e.displayName,email:f,isResolved:!0},c?{}:{rawData:p,rawPersonData:p})});return d.filter(function(e){return e.email})})},e.prototype.resolve=function(e,t){var n,a=this,r=function(){n&&(n.cancel(),n=void 0)};return new i.c(function(o,s){var c=function(e){r(),o(e)};n=i.c.timeout(2e3).then(function(){c(a._getPersonFromQuery(e))}),a.search(e,t).then(function(t){0===t.length?c(a._getPersonFromQuery(e)):c(t[0])},function(t){c(a._getPersonFromQuery(e))})},r)},e.prototype.getPersonaDetails=function(e){return null},e.prototype.subscribePresence=function(e,t){return{dispose:function(){}}},e.prototype.getPickerEntityInformation=function(e){return null},e.prototype._getPersonFromQuery=function(e){var t=new r.a(e),n={};return t.getEmail()?(n.name=t.getName()||"",n.image="",n.sharingInfo={type:0},n.isResolved=!0):n.name=n.name||e,n.email=t.getEmail()||e,n},e}()}
,function(e,t,n){n.d(t,{a:function(){return M}});var a=n(0),i=n(96),r=n(533),o=n(8),s=n(99),c=n(10),d=n(128),l=n(1),u=n(31),f=n(126),p=!l.a.isActivated("E4A35A7B-6CF9-482A-B4B8-C63B7CC489F6"),m=p?"https://res-1.cdn.office.net":"https://shellprod.msocdn.com",_=p?"https://res-1-sdf.cdn.office.net":"https://shellppe.msocdn.com",h="/api/shellbootstrapper/business/oneshell",b=function(){function e(e,t){this._pageContext=t.pageContext,this._usePPEHost="true"===this._getUrlQueryParam("usePPE"),this._suiteNavContext=e.suiteNavContext,this._capabilities=e.suiteNavCapabilities?e.suiteNavCapabilities:{supportsCaching:!0,supportsRealSuiteNav:!0,showO365Text:!0,disableSecondaryUserPhotoProvider:!1,collapseO365Settings:!1,enableDelayLoading:!1}}return e.prototype.getCapabilities=function(){return this._capabilities},e.prototype.getReactShellBootstrapperUrl=function(){return this._usePPEHost?_+h:m+h},e.prototype.getInitialRenderNavBarData=function(){return{WorkloadId:this._suiteNavContext.workloadId,CurrentMainLinkElementID:this._suiteNavContext.currentMainLinkElementID,UserID:this._parseUserID(this._pageContext.systemUserKey),UserDisplayName:this._pageContext.isSPO&&this._pageContext.isAnonymousGuestUser?void 0:this._pageContext.userDisplayName,ShellBootHost:this._usePPEHost?_:m,IsConsumer:!!this._suiteNavContext.isConsumer,Culture:s.a.escapeUrlForCallback(this._pageContext.currentUICultureName),IsRtl:f.a.isRightToLeft,AppBrandTheme:g(this._suiteNavContext),Language:this._pageContext.currentLanguage.toString()}},e.prototype.getCacheToken=function(){var e=this._pageContext.siteClientTag;return"string"==typeof e?e.substring(0,e.indexOf("$$")):""},e.prototype.getUserIdentifier=function(){return this._pageContext.systemUserKey},e.prototype._getUrlQueryParam=function(e){try{return new u.a(window.location.href).getQueryParameter(e)}catch(e){}},e.prototype._parseUserID=function(e){if(e){var t=e.lastIndexOf("|");return e.substring(t+1,e.indexOf("@",t))}return""},e}();function g(e){var t={Primary:d.c?"#0078D4":"#03787c"};return e.appBrandTheme?e.appBrandTheme:t}var v=n(168),y=n(594),S=n(53),D=n(595),I=n(4),x=["teams","sites","personal"],C="<scrubbed>",O="unknown";function w(e){if("/"===e.charAt(0)){for(var t="",n=e.split("/"),a=1;a<n.length;a++)1===a&&x.includes(n[1].toLowerCase())?t+="/"+n[1]:t+="/<scrubbed>";return t}return C}var E={ODB:60222,ODC:!1,Fallback:!1},A="88d7a955-6ccc-4b35-b8ff-342a6bb08f3b",L=l.b.isActivated("6ce35856-96fa-409e-9292-912de2e7e615"),k=l.b.isActivated("54d52105-eb9a-472b-98c2-17bc1192a994"),M=function(e){function t(n,a){var i=e.call(this,{dataSourceName:"SuiteNavDataSource"},a)||this;return i._suiteNavContext=n.suiteNavContext,i._suiteNavDataUpdater=n.suiteNavDataUpdater,i._suiteNavDataSourceBasic=n.suiteNavDataSourceBasic?n.suiteNavDataSourceBasic:new b(n,a),i._prefetchCache=a.prefetchCache,i.isAdditionalFeedbackKsActivated=l.b.isActivated("45e4c761-cac2-442c-b789-ed37039a99bd","06/27/2023","Additional feedback metadata"),i._useDeadTabDetection()&&(i._signInTimeAtPageLoad=t._getSignInTime(),window.addEventListener("focus",function(){if("undefined"!=typeof MastInteraction&&MastInteraction.ShowPrompt){var e=t._getSignInTime();e&&e>i._signInTimeAtPageLoad&&(MastInteraction.SignOutPage(),MastInteraction.ShowPrompt("SwitchAccount"))}})),i}return(0,a.d)(t,e),t.prototype.getCapabilities=function(){return this._suiteNavDataSourceBasic.getCapabilities()},t.prototype.getReactShellBootstrapperUrl=function(){return this._suiteNavDataSourceBasic.getReactShellBootstrapperUrl()},t.prototype.getInitialRenderNavBarData=function(){return this._suiteNavDataSourceBasic.getInitialRenderNavBarData()},t.prototype.getCacheToken=function(){return this._suiteNavDataSourceBasic.getCacheToken()},t.prototype.getUserIdentifier=function(){return this._suiteNavDataSourceBasic.getUserIdentifier()},t.prototype.getWebTemplateType=function(){var e;return Number((null===(e=this._pageContext)||void 0===e?void 0:e.webTemplate)||S.b.invalid)},t.prototype.setFeedbackMetadata=function(e,t,i){var r,o,s,u,f,p,m,_,h,b,g,v,y=this,S=this._suiteNavContext.feedbackOptions;if((d.a||d.d)&&(e.options=(0,a.a)((0,a.a)({},e.options),S),e.baseThemebyWorkload={baseThemeDark:"M365Dark",baseThemeLight:"M365Light"},e.colorSchemebyWorkload={colorSchemeDark:"M365Dark",colorSchemeLight:"M365Light"}),d.d&&(this.isAdditionalFeedbackKsActivated||(e.options.isFeedbackForumEnabled=!0,e.options.isScreenRecordingEnabled=!0,e.options.isEmailCollectionEnabled=!0,this._isMsit()&&(e.options.msInternalTitleTarget="SharePoint Engineering"),i&&(e.options.diagnosticsConfig={isShareContextDataEnabled:!0,getContextData:i}))),S&&S.appId){e=e||{contentLanguage:void 0,source:"OneShell",options:{telemetryGroup:{}}};var D=c.a.isFeatureEnabled({ODB:d.c?60887:1246,ODC:!1,Fallback:!1});if(!l.b.isActivated(A,"9/27/2021","Add Lists Freemium feature area")&&this._pageContext.isSiteListsHost&&(D=!0),l.b.isActivated("1da070f4-d176-43bf-a6db-6b00339b819b","02/07/2024","Check stream path from serverRequestPath")?/\/_layouts\/15\/stream.aspx$/i.test(window.location.pathname):/\/stream\.aspx/i.test(null!==(o=null===(r=this._pageContext)||void 0===r?void 0:r.serverRequestPath)&&void 0!==o?o:"")){D=!0;var x=null===(s=null==e?void 0:e.options)||void 0===s?void 0:s.webGroup,E=new URLSearchParams(document.location.search).get("action");e.options=(0,a.a)((0,a.a)((0,a.a)({},e.options),S),{isEmailCollectionEnabled:!0,isFeedbackForumEnabled:!0,isScreenRecordingEnabled:!0,webGroup:{browser:null==x?void 0:x.browser,browserVersion:null==x?void 0:x.browserVersion,sourcePageName:"action=".concat(E),sourcePageURI:null==x?void 0:x.sourcePageURI}})}if(!l.b.isActivated("8170d83a-2aba-4307-99cc-c500e080de87")&&e.options)x=e.options.webGroup,(k=(0,a.a)({},x)).sourcePageURI=function(){var e=new I.a({name:"FeedbackHelperFunctions.getScrubbedSourcePageUri"});try{var t=new URL(window.location.href),n=t.pathname,a=!1,i=!1,r=[/^\/_layouts\/15\/(sharepoint|begin)\.aspx$/i,/^\/_layouts\/15\/(viva-amplify)\.aspx$/i,/^\/(my|shared|favorites|people|meetings|media|query)$/i,/^\/$/i];if(l.b.isActivated("86692ccd-74f8-425e-b099-53bbb5620c88")){for(var o=0,s=r;o<s.length;o++)if(u=s[o],h=n.match(u)){a=!0,i=!1;break}}else{for(var c=0,d=[/^microsoft.sharepoint.com$/i,/^microsoft.sharepoint-df.com$/i];c<d.length;c++){var u=d[c];if(t.hostname.match(u)){a=!0,i=!1;break}}if(!a)for(var f=0,p=r;f<p.length;f++)if(u=p[f],h=n.match(u)){a=!0,i=!1;break}}if(!a)for(var m=0,_=[/^(\/.+)+\/_layouts\/15\/onedrive\.aspx$/i,/^(\/.+)+\/Forms\/([^\/]*)$/i,/^(\/.+)+\/SitePages\/([^\/]*)$/i,/^(\/.+)+\/_layouts\/15\//i,/^(\/.+)+\/Lists\/([^\/]*)\/([^\/]*)/i,/^(\/.+)+$/i];m<_.length;m++){var h;if(u=_[m],(h=n.match(u))&&h.length>=2){a=!0,h[1]&&h[1].length>0&&(n=n.replace(h[1],w(h[1])),i=!0);for(var b=2;b<h.length;b++)h[b].length>0&&(n=n.replace(h[b],C),i=!0);break}}var g=void 0;return a?(g=t.origin+n,e.end({resultType:I.b.Success,extraData:{sourcePageURI:g,didUrlPathScrubbing:i}})):(g=O,e.end({resultType:I.b.Failure,error:"Unrecognized sourcePageURI.",extraData:{rawUrl:t}})),g}catch(t){return e.end({resultType:I.b.Failure,error:t}),O}}(),e.options.webGroup=k;else if(!l.b.isActivated("F119E415-6D2A-442B-AEAE-398DF04F2E1D")&&e.options&&(x=e.options.webGroup)){var L=x.sourcePageURI;if(L){var k,M=L.match(/\/personal\/(.*)\/_layouts\/15\//);M&&M[1]&&((k=(0,a.a)({},x)).sourcePageURI=L.replace(M[1],"{ALPHANUMERICPII}"),e.options.webGroup=k)}}/\/_layouts\/15\/videoeditor.aspx$/i.test(window.location.pathname)&&(S.screenshotPolicyValue&&(D=1===S.screenshotPolicyValue),l.b.isActivated("665b2b9f-a110-4b48-8a93-9b9d6602c44b","6/27/2023","Adding additional configs for clipchamp OCV")||(e.options=(0,a.a)((0,a.a)({},e.options),S)));var P=e.options;if(P.appId=S.appId,P.disableIncludeScreenshot=!D,P.userVoiceEnabled=S.userVoiceEnabled,P.userVoiceLink=S.userVoiceLink,P.applicationGroup||(P.applicationGroup={}),l.b.isActivated("879be614-f8ba-435e-91d0-8da728ef4fd7")){P.applicationGroup.appData||(T={isListDataSyncEnabled:!!window.__isListDataSyncEnabled},P.applicationGroup.appData=JSON.stringify(T));try{(T=JSON.parse(P.applicationGroup.appData)).isListDataSyncEnabled=!!window.__isListDataSyncEnabled,P.applicationGroup.appData=JSON.stringify(T)}catch(e){}}else try{var T=void 0;T=l.b.isActivated("affcc3e2-051d-4395-ada6-ac745339def7")?{isListDataSyncEnabled:!!window.__isListDataSyncEnabled,entryPoint:"SuiteNav",build:window._spModuleLink.buildNumber}:{isListDataSyncEnabled:!!window.__isListDataSyncEnabled,entryPoint:"SuiteNav",build:window._spModuleLink.buildNumber,groupId:null===(u=this._pageContext)||void 0===u?void 0:u.groupId,groupType:null===(f=this._pageContext)||void 0===f?void 0:f.groupType,listId:null===(p=this._pageContext)||void 0===p?void 0:p.listId,listBaseTemplate:null===(m=this._pageContext)||void 0===m?void 0:m.listBaseTemplate,pageItemId:null===(_=this._pageContext)||void 0===_?void 0:_.pageItemId,siteId:null===(h=this._pageContext)||void 0===h?void 0:h.siteId,webId:null===(b=this._pageContext)||void 0===b?void 0:b.webId,viewId:null===(g=this._pageContext)||void 0===g?void 0:g.viewId},P.applicationGroup.appData?P.applicationGroup.appData=JSON.stringify((0,a.a)((0,a.a)({},JSON.parse(P.applicationGroup.appData)),T)):P.applicationGroup.appData=JSON.stringify(T)}catch(e){}var U=P.telemetryGroup;U.audienceGroup=this._getAudienceGroup(),U.featureArea=this._getFeatureArea(null===(v=S.telemetryGroup)||void 0===v?void 0:v.featureArea),U.processSessionId=this._pageContext.CorrelationId,D&&t&&n.e(38).then(n.t.bind(n,552,23)).then(function(e){var n=e.default||e;if(!l.b.isActivated(A,"9/27/2021","Add Lists Freemium feature area")&&y._pageContext.isSiteListsHost){var a=document.body;try{window.frames.length>0&&(a=window.frames[0].document.body)}catch(e){}n(a).then(function(e){t(e.toDataURL("image/jpeg"))})}else n(document.body).then(function(e){t(e.toDataURL("image/jpeg"))})})}return e},t.prototype.loadData=function(e){var t=this;if(!e&&this._dataPromise)return this._dataPromise;var n,a=s.a.escapeUrlForCallback(this._pageContext.currentUICultureName),r=(0,i.a)(this._pageContext),o=(0,i.b)(this._pageContext),c=!L&&o&&r?u.a.concatenate(s.a.escapeUrlForCallback(o),s.a.escapeUrlForCallback(r)):r?s.a.escapeUrlForCallback(r):"",d=(0,D.a)({baseUrl:c,cultureName:a}),l="".concat(c,"/_api/Microsoft.SharePoint.Portal.SuiteNavData.GetSuiteNavData?v=2&Locale=").concat(a),f=function(e){var n=new I.a({name:"SuiteNavProvider.ServerAPIData"}),a={suiteNavData:e.NavBarData,suiteNavContext:t._suiteNavContext,pageContext:t._pageContext},i=t._suiteNavDataUpdater?t._suiteNavDataUpdater.updateSuiteNavData(a):e.NavBarData,r=!(!i.HasTenantBranding||!e.TenantPrimaryColorShades&&!i.TenantLogoUrl);i.AppBrandTheme=g(t._suiteNavContext);var o={data:i,jsUrl:e.JsUrl,cssUrl:e.CssUrl,hasCobranding:r,userIdentifier:t.getUserIdentifier(),cacheToken:t.getCacheToken()};return k||(0,D.b)(i,n,t._pageContext),o},p=function(e){return t.getData(function(){return e},function(e){return JSON.parse(e)},"LoadData",null,"POST",null,null,1).then(function(t){var n=e===d?t:JSON.parse(t.d.GetSuiteNavData);return f(n)})},m=function(){return p(d).catch(function(){return p(l)})};if(this._pageContext.isSPO){var _=!1;if(this._prefetchCache){var h=this._prefetchCache.getData({url:d,body:"",qosName:"SpoSuiteLinks"});h&&(n=h.then(f,m),_=!0)}_||(n=m())}else n=p(l);return this._dataPromise=n,n.catch(function(){t._dataPromise=null}),n},t.prototype.getSuiteNavContext=function(){return this._suiteNavContext},t.prototype.onCssLoad=function(e){if(e.data&&e.data.ClientData)try{var t=JSON.parse(e.data.ClientData);t&&t.IsFallbackShell&&(0,o.b)(".o365cs-base .o365cs-nav-contextMenu {    background-color: '[theme:white, default:#ffffff]';}\n.o365cs-base-visibility{  visibility: visible;}\n.o365cs-base .ms-fcl-tdr,.o365cs-base .ms-fcl-tdr-h:hover,.o365cs-base .ms-fcl-tdr-f:focus{    color: '[theme:themeDarker, default:#104a7d]';}\n.o365cs-base .ms-bgc-tdr,.o365cs-base .ms-bgc-tdr-h:hover,.o365cs-base .ms-bgc-tdr-f:focus{    background-color: '[theme:themeDarker, default:#104a7d]';}\n.o365cs-base .ms-bcl-tdr,.o365cs-base .ms-bcl-tdr-h:hover,.o365cs-base .ms-bcl-tdr-f:focus{    border-color: '[theme:themeDarker, default:#104a7d]';}\n.o365cs-base .ms-fcl-td,.o365cs-base .ms-fcl-td-h:hover,.o365cs-base .ms-fcl-td-f:focus{    color: '[theme:themeDark, default:#0d62aa]';}\n.o365cs-base .ms-bgc-td,.o365cs-base .ms-bgc-td-h:hover,.o365cs-base .ms-bgc-td-f:focus{    background-color: '[theme:themeDark, default:#0d62aa]';}\n.o365cs-base .ms-bcl-td,.o365cs-base .ms-bcl-td-h:hover,.o365cs-base .ms-bcl-td-f:focus{    border-color: '[theme:themeDark, default:#0d62aa]';}\n.o365cs-base .ms-fcl-tda,.o365cs-base .ms-fcl-tda-h:hover,.o365cs-base .ms-fcl-tda-f:focus{    color: '[theme:themeDarkAlt, default:#106ebe]';}\n.o365cs-base .ms-bgc-tda,.o365cs-base .ms-bgc-tda-h:hover,.o365cs-base .ms-bgc-tda-f:focus{    background-color: '[theme:themeDarkAlt, default:#106ebe]';}\n.o365cs-base .ms-bcl-tda,.o365cs-base .ms-bcl-tda-h:hover,.o365cs-base .ms-bcl-tda-f:focus{    border-color: '[theme:themeDarkAlt, default:#106ebe]';}\n.o365cs-base .ms-fcl-tp,.o365cs-base .ms-fcl-tp-h:hover,.o365cs-base .ms-fcl-tp-f:focus{    color: '[theme:themePrimary, default:#0078d7]';}\n.o365cs-base .ms-bgc-tp,.o365cs-base .ms-bgc-tp-h:hover,.o365cs-base .ms-bgc-tp-f:focus,.o365cs-base.ms-bgc-tp{    background-color: '[theme:themePrimary, default:#0078d7]';}\n.o365cs-base .ms-bcl-tp,.o365cs-base .ms-bcl-tp-h:hover,.o365cs-base .ms-bcl-tp-f:focus{    border-color: '[theme:themePrimary, default:#0078d7]';}\n.o365cs-base .ms-fcl-ts,.o365cs-base .ms-fcl-ts-h:hover,.o365cs-base .ms-fcl-ts-f:focus{    color: '[theme:themeSecondary, default:#2b88d8]';}\n.o365cs-base .ms-bgc-ts,.o365cs-base .ms-bgc-ts-h:hover,.o365cs-base .ms-bgc-ts-f:focus{    background-color: '[theme:themeSecondary, default:#2b88d8]';}\n.o365cs-base .ms-bcl-ts,.o365cs-base .ms-bcl-ts-h:hover,.o365cs-base .ms-bcl-ts-f:focus{    border-color: '[theme:themeSecondary, default:#2b88d8]';}\n.o365cs-base .ms-fcl-tt,.o365cs-base .ms-fcl-tt-h:hover,.o365cs-base .ms-fcl-tt-f:focus{    color: '[theme:themeTertiary, default:#71afe5]';}\n.o365cs-base .ms-bgc-tt,.o365cs-base .ms-bgc-tt-h:hover,.o365cs-base .ms-bgc-tt-f:focus{    background-color: '[theme:themeTertiary, default:#71afe5]';}\n.o365cs-base .ms-bcl-tt,.o365cs-base .ms-bcl-tt-h:hover,.o365cs-base .ms-bcl-tt-f:focus{    border-color: '[theme:themeTertiary, default:#71afe5]';}\n.o365cs-base .ms-fcl-tl,.o365cs-base .ms-fcl-tl-h:hover,.o365cs-base .ms-fcl-tl-f:focus{    color: '[theme:themeLight, default:#c7e0f4]';}\n.o365cs-base .ms-bgc-tl,.o365cs-base .ms-bgc-tl-h:hover,.o365cs-base .ms-bgc-tl-f:focus{    background-color: '[theme:themeLight, default:#c7e0f4]';}\n.o365cs-base .ms-bcl-tl,.o365cs-base .ms-bcl-tl-h:hover,.o365cs-base .ms-bcl-tl-f:focus{    border-color: '[theme:themeLight, default:#c7e0f4]';}\n.o365cs-base .ms-fcl-tlr,.o365cs-base .ms-fcl-tlr-h:hover,.o365cs-base .ms-fcl-tlr-f:focus{    color: '[theme:themeLighter, default:#deecf9]';}\n.o365cs-base .ms-bgc-tlr,.o365cs-base .ms-bgc-tlr-h:hover,.o365cs-base .ms-bgc-tlr-f:focus{    background-color: '[theme:themeLighter, default:#deecf9]';}\n.o365cs-base .ms-bcl-tlr,.o365cs-base .ms-bcl-tlr-h:hover,.o365cs-base .ms-bcl-tlr-f:focus{    border-color: '[theme:themeLighter, default:#deecf9]';}\n.o365cs-base .ms-fcl-tlra,.o365cs-base .ms-fcl-tlra-h:hover,.o365cs-base .ms-fcl-tlra-f:focus{    color: '[theme:themeLighterAlt, default:#eff6fc]';}\n.o365cs-base .ms-bgc-tlra,.o365cs-base .ms-bgc-tlra-h:hover,.o365cs-base .ms-bgc-tlra-f:focus{    background-color: '[theme:themeLighterAlt, default:#eff6fc]';}\n.o365cs-base .ms-bcl-tlra,.o365cs-base .ms-bcl-tlra-h:hover,.o365cs-base .ms-bcl-tlra-f:focus{    border-color: '[theme:themeLighterAlt, default:#eff6fc]';}\n.o365cs-base .ms-fcl-w,.o365cs-base .ms-fcl-w-h:hover,.o365cs-base .ms-fcl-w-f:focus{    color: '[theme:white, default:#ffffff]';}\n.o365cs-base .ms-bgc-w,.o365cs-base .ms-bgc-w-h:hover,.o365cs-base .ms-bgc-w-f:focus,.o365cs-base.ms-bgc-w{    background-color: '[theme:white, default:#ffffff]';}\n.o365cs-base .ms-bcl-w,.o365cs-base .ms-bcl-w-h:hover,.o365cs-base .ms-bcl-w-f:focus{    border-color: '[theme:white, default:#ffffff]';}\n.o365cs-base .ms-fcl-b,.o365cs-base .ms-fcl-b-h:hover,.o365cs-base .ms-fcl-b-f:focus{    color: '[theme:black, default:#000000]';}\n.o365cs-base .ms-fcl-b.o365cs-nav-closeButton{    color: #000000;}\n.o365cs-base .ms-bgc-b,.o365cs-base .ms-bgc-b-h:hover,.o365cs-base .ms-bgc-b-f:focus,.o365cs-base.ms-bgc-b{    background-color: '[theme:black, default:#000000]';}\n.o365cs-base .ms-bcl-b,.o365cs-base .ms-bcl-b-h:hover,.o365cs-base .ms-bcl-b-f:focus{    border-color: '[theme:black, default:#000000]';}\n.o365cs-base .ms-fcl-nd,.o365cs-base .ms-fcl-nd-h:hover,.o365cs-base .ms-fcl-nd-f:focus{    color: '[theme:neutralDark, default:#212121]';}\n.o365cs-base .ms-bgc-nd,.o365cs-base .ms-bgc-nd-h:hover,.o365cs-base .ms-bgc-nd-f:focus{    background-color: '[theme:neutralDark, default:#212121]';}\n.o365cs-base .ms-bcl-nd,.o365cs-base .ms-bcl-nd-h:hover,.o365cs-base .ms-bcl-nd-f:focus{    border-color: '[theme:neutralDark, default:#212121]';}\n.o365cs-base .ms-fcl-np,.o365cs-base .ms-fcl-np-h:hover,.o365cs-base .ms-fcl-np-f:focus{    color: '[theme:neutralPrimary, default:#333333]';}\n.o365cs-base .ms-bgc-np,.o365cs-base .ms-bgc-np-h:hover,.o365cs-base .ms-bgc-np-f:focus{    background-color: '[theme:neutralPrimary, default:#333333]';}\n.o365cs-base .ms-bcl-np,.o365cs-base .ms-bcl-np-h:hover,.o365cs-base .ms-bcl-np-f:focus{    border-color: '[theme:neutralPrimary, default:#333333]';}\n.o365cs-base .ms-fcl-ns,.o365cs-base .ms-fcl-ns-h:hover,.o365cs-base .ms-fcl-ns-f:focus{    color: '[theme:neutralSecondary, default:#666666]';}\n.o365cs-base .ms-fcl-ns.o365cs-nav-moduleLabel{    color: #666666;}\n.o365cs-base .ms-bgc-ns,.o365cs-base .ms-bgc-ns-h:hover,.o365cs-base .ms-bgc-ns-f:focus{    background-color: '[theme:neutralSecondary, default:#666666]';}\n.o365cs-base .ms-bcl-ns,.o365cs-base .ms-bcl-ns-h:hover,.o365cs-base .ms-bcl-ns-f:focus{    border-color: '[theme:neutralSecondary, default:#666666]';}\n.o365cs-base .ms-fcl-nsa,.o365cs-base .ms-fcl-nsa-h:hover,.o365cs-base .ms-fcl-nsa-f:focus{    color: '[theme:neutralSecondaryAlt, default:#767676]';}\n.o365cs-base .ms-bgc-nsa,.o365cs-base .ms-bgc-nsa-h:hover,.o365cs-base .ms-bgc-nsa-f:focus{    background-color: '[theme:neutralSecondaryAlt, default:#767676]';}\n.o365cs-base .ms-bcl-nsa,.o365cs-base .ms-bcl-nsa-h:hover,.o365cs-base .ms-bcl-nsa-f:focus{    border-color: '[theme:neutralSecondaryAlt, default:#767676]';}\n.o365cs-base .ms-fcl-nt,.o365cs-base .ms-fcl-nt-h:hover,.o365cs-base .ms-fcl-nt-f:focus{    color: '[theme:neutralTertiary, default:#a6a6a6]';}\n.o365cs-base .ms-bgc-nt,.o365cs-base .ms-bgc-nt-h:hover,.o365cs-base .ms-bgc-nt-f:focus{    background-color: '[theme:neutralTertiary, default:#a6a6a6]';}\n.o365cs-base .ms-bcl-nt,.o365cs-base .ms-bcl-nt-h:hover,.o365cs-base .ms-bcl-nt-f:focus{    border-color: '[theme:neutralTertiary, default:#a6a6a6]';}\n.o365cs-base .ms-fcl-nta,.o365cs-base .ms-fcl-nta-h:hover,.o365cs-base .ms-fcl-nta-f:focus{    color: '[theme:neutralTertiaryAlt, default:#c8c8c8]';}\n.o365cs-base .ms-bgc-nta,.o365cs-base .ms-bgc-nta-h:hover,.o365cs-base .ms-bgc-nta-f:focus{    background-color: '[theme:neutralTertiaryAlt, default:#c8c8c8]';}\n.o365cs-base .ms-bcl-nta,.o365cs-base .ms-bcl-nta-h:hover,.o365cs-base .ms-bcl-nta-f:focus{    border-color: '[theme:neutralTertiaryAlt, default:#c8c8c8]';}\n.o365cs-base .ms-fcl-nl,.o365cs-base .ms-fcl-nl-h:hover,.o365cs-base .ms-fcl-nl-f:focus{    color: '[theme:neutralLight, default:#eaeaea]';}\n.o365cs-base .ms-bgc-nl,.o365cs-base .ms-bgc-nl-h:hover,.o365cs-base .ms-bgc-nl-f:focus{    background-color: '[theme:neutralLight, default:#eaeaea]';}\n.o365cs-base .ms-bcl-nl,.o365cs-base .ms-bcl-nl-h:hover,.o365cs-base .ms-bcl-nl-f:focus{    border-color: '[theme:neutralLight, default:#eaeaea]';}\n.o365cs-base .ms-fcl-nlr,.o365cs-base .ms-fcl-nlr-h:hover,.o365cs-base .ms-fcl-nlr-f:focus{    color: '[theme:neutralLighter, default:#f4f4f4]';}\n.o365cs-base .ms-bgc-nlr,.o365cs-base .ms-bgc-nlr-h:hover,.o365cs-base .ms-bgc-nlr-f:focus,.o365cs-base.ms-bgc-nlr{    background-color: '[theme:neutralLighter, default:#f4f4f4]';}\n.o365cs-base .ms-bcl-nlr,.o365cs-base .ms-bcl-nlr-h:hover,.o365cs-base .ms-bcl-nlr-f:focus{    border-color: '[theme:neutralLighter, default:#f4f4f4]';}\n.o365cs-base .ms-fcl-nlra,.o365cs-base .ms-fcl-nlra-h:hover,.o365cs-base .ms-fcl-nlra-f:focus{    color: '[theme:neutralLighterAlt, default:#f8f8f8]';}\n.o365cs-base .ms-bgc-nlra,.o365cs-base .ms-bgc-nlra-h:hover,.o365cs-base .ms-bgc-nlra-f:focus,.o365cs-base.ms-bgc-nlra{    background-color: '[theme:neutralLighterAlt, default:#f8f8f8]';}\n.o365cs-base .ms-bcl-nlra,.o365cs-base .ms-bcl-nlra-h:hover,.o365cs-base .ms-bcl-nlra-f:focus{    border-color: '[theme:neutralLighterAlt, default:#f8f8f8]';}\n.o365cs-base .o365cs-topnavLinkBackground-2{    background-color: transparent;}\n.o365cs-base .o365cs-topnavText,.o365cs-base .o365cs-topnavText:hover{    color: '[theme:suiteBarText, default:#ffffff]';}\n.o365cs-base .o365cs-appLauncherBackground{    background-color: '[theme:themeDarker, default:#104a7d]';}\n.o365cs-nav-header16 .o365cs-navMenuButton{    color: '[theme:white, default:#ffffff]';}\n.o365cs-base .o365cs-navMenuButton{    color: '[theme:suiteBarText, default:#ffffff]';}\n.o365cs-base.o365cs-topnavBGImage{    background-position: center top;    background-repeat: repeat-x;    background-image: none;}\n.o365cs-base.o365cs-topnavBGColor-2{    background-color: '[theme:suiteBarBackground, default:#000000]';}\n")}catch(e){}},t.prototype.updateDataForCurrentPage=function(e){if(!this._suiteNavDataUpdater)return e;var t={suiteNavData:e,suiteNavContext:this._suiteNavContext,pageContext:this._pageContext};return this._suiteNavDataUpdater.updateSuiteNavData(t)},t.prototype._isDogfood=function(){var e=this._pageContext;return l.b.isActivated("5a7b54f2-bebb-4997-93a5-bb8a00ecbf56")?"prodbubble"===e.env&&"MSIT_SPDF_1_Content"===e.farmLabel:"spdf"===e.cloudType},t.prototype._isMsit=function(){var e;return"ec63b09b-9748-47ba-9018-beeadd405204"===(null===(e=this._pageContext)||void 0===e?void 0:e.siteSubscriptionId)},t.prototype._getAudienceGroup=function(){var e,t=this._pageContext;return this._isDogfood()?e="Dogfood":"prodbubble"===t.env?e="Microsoft":("prod"===t.env||"dprod"===t.env||!l.b.isActivated(A,"9/27/2021","Add Lists Freemium feature area")&&t.isSiteListsHost)&&(e="Production"),e},t.prototype._getFeatureArea=function(e){if(!l.b.isActivated("a00248de-2fc2-41a8-8671-f8fec416a811","10/22/2021","Allow apps to provide own feature area")&&e)return e;if(!l.b.isActivated("c41ebe97-8fa6-4fdc-8911-15ba2d8b163e","05/16/2023","Get feature area callback")&&this._suiteNavContext.getFeatureArea)return this._suiteNavContext.getFeatureArea();var t=this._pageContext;return!l.b.isActivated(A,"9/27/2021","Add Lists Freemium feature area")&&t.isSiteListsHost?"Lists Freemium":t.listBaseTemplate===y.a.genericList?"List":t.listBaseTemplate===y.a.documentLibrary?"Libraries":t.listBaseTemplate===y.a.webPageLibrary?"Modern Pages and News Authoring":this.getWebTemplateType()===S.b.contentCenter?"Syntex In-product Feedback":"Site"},t.prototype._useDeadTabDetection=function(){return!l.b.isActivated("8FE233B6-3394-4918-A449-B5808E8B40BD","9/8/21","Dead tab detection")&&c.a.isFeatureEnabled(E)},t._getCookieValue=function(e){var t=document.cookie.match("(^|;)\\s*"+e+"\\s*=\\s*([^;]+)");return(null==t?void 0:t.pop())||""},t._getSignInTime=function(){var e=t._getCookieValue("SIMI");return e?Number(JSON.parse(atob(e)).st):0},t.siteSettingsPermissions=[r.a.enumeratePermissions,r.a.manageWeb,r.a.manageSubwebs,r.a.addAndCustomizePages,r.a.applyThemeAndBorder,r.a.manageAlerts,r.a.manageLists,r.a.viewUsageData],t}(v.a)}
,function(e,t,n){n.d(t,{a:function(){return a}});var a=function(){function e(){}return e.hasItemPermission=function(t,n){return t&&t.permissions&&e.hasPermission(t.permissions,n)},e.hasPermission=function(e,t){return!!t&&!!e&&(t.Low&e.Low)>>>0===t.Low&&(t.High&e.High)>>>0===t.High},e.hasAny=function(t,n){return(n||[]).some(function(n){return e.hasPermission(t,n)})},e.hasIdentityPermission=function(t,n){return n&&t.webPermMasks&&e.hasPermission(t.webPermMasks,n)},e.viewListItems={High:0,Low:1},e.insertListItems={High:0,Low:2},e.editListItems={High:0,Low:4},e.deleteListItems={High:0,Low:8},e.approveItems={High:0,Low:16},e.openItems={High:0,Low:32},e.viewVersions={High:0,Low:64},e.deleteVersions={High:0,Low:128},e.cancelCheckout={High:0,Low:256},e.managePersonalViews={High:0,Low:512},e.manageLists={High:0,Low:2048},e.viewFormPages={High:0,Low:4096},e.reviewListItems={High:0,Low:16384},e.open={High:0,Low:65536},e.viewPages={High:0,Low:131072},e.layoutsPage={High:0,Low:135168},e.addAndCustomizePages={High:0,Low:262144},e.applyThemeAndBorder={High:0,Low:524288},e.viewUsageData={High:0,Low:2097152},e.createSSCSite={High:0,Low:4194304},e.manageSubwebs={High:0,Low:8388608},e.managePermissions={High:0,Low:33554432},e.browseDirectories={High:0,Low:67108864},e.browseUserInfo={High:0,Low:134217728},e.addDelPrivateWebParts={High:0,Low:268435456},e.updatePersonalWebParts={High:0,Low:536870912},e.manageWeb={High:0,Low:1073741824},e.useClientIntegration={High:16,Low:0},e.manageAlerts={High:64,Low:0},e.createAlerts={High:128,Low:0},e.editMyUserInfo={High:256,Low:0},e.viewItemsRequiresOpen={High:65536,Low:0},e.enumeratePermissions={High:1073741824,Low:0},e.useRemoteAPIs={High:32,Low:0},e.fullMaskWithoutACP={High:2147483647,Low:4294705151},e.fullMask={High:2147483647,Low:4294967295},e}();t.b=a}
,function(e,t,n){n.d(t,{a:function(){return r}});var a=n(7),i=function(){return null},r=function(){function e(e){this.getPersonaDetails=i,this.subscribePresence=i,this.getPickerEntityInformation=i,this.addToMruCache=i,this._dataSource=e,this.MaxCacheSuggestions=0}return e.prototype.search=function(e,t){var n,i=this,r={cached:null,promise:null};return r.promise=new a.c(function(a,r){n=i._dataSource.search(e,t).then(function(e){e&&a(e)},function(e){r(e)})},function(){n&&n.cancel()}),r},e.prototype.resolve=function(e,t){return this._dataSource.resolve(e,t).then(function(e){return e})},e}()}
,function(e,t,n){var a=n(0),i=n(7),r=n(404),o=n(30),s={ownerCannotShareWithSelf:!0,maximumRecipientsExceeded:!0,invalidAclEmailSpecified:!0,duplicateMembersInRequest:!0,secureSharingInvalidRequest:!0},c=function(){function e(e,t){this._dataRequestor=t.dataRequestor,this._betaDataRequestor=t.betaDataRequestor,this._graphApiVersion=e.graphApiVersion||""}return e.getSharesPathFromItemUrl=function(e){var t=btoa(unescape(encodeURIComponent(e)));return"/shares/u!".concat(t.replace(/=/g,"").replace(/\//g,"_").replace(/\+/g,"-"),"/driveItem")},e.prototype.createBundle=function(e,t){var n=JSON.stringify({children:e.map(function(e){return{id:e}}),bundle:{},name:t});return n=n.slice(0,-1)+',"@microsoft.graph.conflictBehavior": "rename"}',this._dataRequestor.send({path:"/drive/bundles",apiName:"bundles",requestType:"POST",useAuthorizationHeaders:!0,postData:n,getErrorAsMessage:!0,expectedErrorCodes:s,qosExtraData:{graphApiVersion:this._graphApiVersion}}).then(function(e){return e})},e.prototype.getFamily=function(){var e={};return o.a.isFeatureEnabled({ODC:"FamilySharingPreferKillswitch"})||(e.prefer="family.group-enabled-only"),("1.0"===this._graphApiVersion&&this._betaDataRequestor?this._betaDataRequestor:this._dataRequestor).send({path:"/household/me/family",apiName:"family",requestType:"GET",useAuthorizationHeaders:!0,getErrorAsMessage:!0,headers:e,expectedErrorCodes:(0,a.a)((0,a.a)({},s),{404:!0}),qosExtraData:{graphApiVersion:"beta"}}).then(function(e){return e}).catch(function(e){})},e.prototype.getFamilyMembers=function(){var e={};return o.a.isFeatureEnabled({ODC:"FamilySharingPreferKillswitch"})||(e.prefer="family.group-enabled-only"),("1.0"===this._graphApiVersion&&this._betaDataRequestor?this._betaDataRequestor:this._dataRequestor).send({path:"/household/me/family/members",apiName:"familyMembers",requestType:"GET",useAuthorizationHeaders:!0,getErrorAsMessage:!0,headers:e,expectedErrorCodes:(0,a.a)((0,a.a)({},s),{404:!0}),qosExtraData:{graphApiVersion:"beta"}}).then(function(e){return e}).catch(function(e){})},e.prototype.isUserPremium=function(){return this._dataRequestor.send({path:"/me/drive",apiName:"drive",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:s,qosExtraData:{graphApiVersion:this._graphApiVersion}}).then(function(e){return!!e.quota.storagePlanInformation&&!e.quota.storagePlanInformation.upgradeAvailable})},e.prototype.getDriveInfo=function(){return this._dataRequestor.send({path:"/me/drive",apiName:"drive",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:s,qosExtraData:{graphApiVersion:this._graphApiVersion}}).then(function(e){return e})},e.prototype.createLink=function(e){var t=this,n=e.itemIds,a=e.type,i=e.scope,r=e.preventDownload,o=e.password,s=e.expiration,c=e.bundleName;return 1===n.length?this.createLinkSingleItem({itemUrl:this.getDrivesPathFromItemId(n[0]),type:a,scope:i,preventDownload:r,password:o,expiration:s}):this.createBundle(n,c||"").then(function(e){return t.createLinkSingleItem({itemUrl:t.getDrivesPathFromItemId(e.id),type:a,scope:i,preventDownload:r,password:o,expiration:s})})},e.prototype.createLinkFromItemUrl=function(t){var n=t.itemUrl,a=t.type,i=t.scope,r=t.preventDownload,o=t.password,s=t.expiration;return this.createLinkSingleItem({itemUrl:e.getSharesPathFromItemUrl(n),type:a,scope:i,preventDownload:r,password:o,expiration:s})},e.prototype.getCurrentUserId=function(){return this._dataRequestor.send({path:"/me",apiName:"me",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:s,qosExtraData:{graphApiVersion:this._graphApiVersion}}).then(function(e){return e.id})},e.prototype.getDriveOwner=function(e){var t="/drives/"+e;return this._dataRequestor.send({path:t,apiName:"/drives/",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:s,qosExtraData:{graphApiVersion:this._graphApiVersion}}).then(function(e){return e})},e.prototype.getCurrentUser=function(){return this._dataRequestor.send({path:"/me",apiName:"me",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:s,qosExtraData:{graphApiVersion:this._graphApiVersion}})},e.prototype.getItemInfo=function(e){var t="".concat(this.getDrivesPathFromItemId(e));return this._dataRequestor.send({path:t,apiName:"item",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:s,qosExtraData:{graphApiVersion:this._graphApiVersion}}).then(function(e){return e})},e.prototype.getItemInfoFromItemUrl=function(t){var n="".concat(e.getSharesPathFromItemUrl(t));return this._dataRequestor.send({path:n,apiName:"item",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:s,qosExtraData:{graphApiVersion:this._graphApiVersion}}).then(function(e){return e})},e.prototype.getPermissions=function(e){var t="".concat(this.getDrivesPathFromItemId(e),"/permissions");return("1.0"===this._graphApiVersion&&this._betaDataRequestor?this._betaDataRequestor:this._dataRequestor).send({path:t,apiName:"permissions",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:s,qosExtraData:{graphApiVersion:"beta"}}).then(function(e){return e.value})},e.prototype.getPermissionsFromItemUrl=function(t){var n;n="1.0"===this._graphApiVersion&&this._betaDataRequestor?this._betaDataRequestor:this._dataRequestor;var a="".concat(e.getSharesPathFromItemUrl(t),"/permissions");return n.send({path:a,apiName:"permissions",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:s,qosExtraData:{graphApiVersion:"beta"}}).then(function(e){return e.value})},e.prototype.invite=function(e){var t=this,n=e.itemIds,a=e.recipients,i=e.message,r=e.requireSignIn,o=e.sendInvitation,s=e.roles,c=e.password,d=e.expiration,l=e.bundleName;return 1===n.length?this.inviteSingleItem(this.getDrivesPathFromItemId(n[0]),a,i,r,o,s,c,d):this.createBundle(n,l||"").then(function(e){return t.inviteSingleItem(t.getDrivesPathFromItemId(e.id),a,i,r,o,s,c,d)})},e.prototype.inviteFromItemUrl=function(t){var n=t.itemUrl,a=t.recipients,i=t.message,r=t.requireSignIn,o=t.sendInvitation,s=t.roles,c=t.password,d=t.expiration;return this.inviteSingleItem(e.getSharesPathFromItemUrl(n),a,i,r,o,s,c,d)},e.prototype.getDefaultLink=function(t,n,a){return n.length>0?this.inviteSingleItem(e.getSharesPathFromItemUrl(t),n,"",!0,!1,[],"",void 0,{prefer:"getDefaultLink,ReturnSpecificErrorCode"},a):this.createLinkSingleItem({itemUrl:e.getSharesPathFromItemUrl(t),useMultiPart:a}).then(function(e){return i.c.wrap([e])})},e.prototype.getDefaultLinkByUniqueId=function(e,t,n){return t.length>0?this.inviteSingleItem(this.getPathFromUniqueId(e),t,"",!0,!1,[],"",void 0,{prefer:"getDefaultLink,ReturnSpecificErrorCode"},n):this.createLinkSingleItem({itemUrl:this.getPathFromUniqueId(e),useMultiPart:n}).then(function(e){return i.c.wrap([e])})},e.prototype.updatePermissions=function(e,t,n){var a="".concat(this.getDrivesPathFromItemId(e),"/permissions/").concat(t),o={roles:[n]};return this._dataRequestor.send({path:a,apiName:"updatePermission",requestType:"PATCH",useAuthorizationHeaders:!0,postData:JSON.stringify(o),getErrorAsMessage:!0,expectedErrorCodes:s,qosExtraData:{graphApiVersion:this._graphApiVersion}}).then(function(e){return e.value}).catch(function(e){var t=e.message||"Error updating permission",n=e.code||(0,r.d)(e)||"genericPermissionUpdateFailure",a={error:e.error,name:e.name,errorCode:n,debugErrorMessage:JSON.stringify(e),errorMessage:t,rawError:JSON.stringify(e)};return i.c.reject(a)})},e.prototype.updatePermissionsFromItemUrl=function(t,n,a){var i="".concat(e.getSharesPathFromItemUrl(t),"/permissions/").concat(n),r={roles:[a]};return this._dataRequestor.send({path:i,apiName:"updatePermission",requestType:"PATCH",useAuthorizationHeaders:!0,postData:JSON.stringify(r),getErrorAsMessage:!0,expectedErrorCodes:s,qosExtraData:{graphApiVersion:this._graphApiVersion}}).then(function(e){return e.value})},e.prototype.unshareLink=function(e,t){var n="".concat(this.getDrivesPathFromItemId(e),"/permissions/").concat(t);return this._dataRequestor.send({path:n,apiName:"removePermission",requestType:"DELETE",useAuthorizationHeaders:!0,getErrorAsMessage:!0,expectedErrorCodes:s,qosExtraData:{graphApiVersion:this._graphApiVersion}}).then(function(){return!0})},e.prototype.unshareLinkFromItemUrl=function(t,n){var a="".concat(e.getSharesPathFromItemUrl(t),"/permissions/").concat(n);return this._dataRequestor.send({path:a,apiName:"removePermission",requestType:"DELETE",useAuthorizationHeaders:!0,getErrorAsMessage:!0,expectedErrorCodes:s,qosExtraData:{graphApiVersion:this._graphApiVersion}}).then(function(){return!0})},e.prototype.createLinkSingleItem=function(e){var t=e.type,n=e.itemUrl,a=e.scope,i=e.preventDownload,r=e.password,o=e.useMultiPart,c=e.expiration,d="".concat(n,"/createLink"),l=t&&a?{type:t,scope:a,preventDownload:i}:{};return(r||""===r)&&(l.password=r),c&&(l.expirationDateTime=c),this._dataRequestor.send({path:d,apiName:"createLink",requestType:"POST",useMultiPart:o,useAuthorizationHeaders:!0,postData:JSON.stringify(l||{}),getErrorAsMessage:!0,expectedErrorCodes:s,qosExtraData:{graphApiVersion:this._graphApiVersion}}).then(function(e){return e})},e.prototype.getPathFromUniqueId=function(e){return"/sites/root/items/".concat(e,"/driveItem")},e.prototype.getDrivesPathFromItemId=function(e){var t=e.split("!");return t.length>1?"/drives/".concat(t[0],"/items/").concat(e):"/drive/items/".concat(e)},e.prototype.inviteSingleItem=function(e,t,n,a,i,r,o,c,d,l){var u="".concat(e,"/invite"),f={recipients:t,message:n,requireSignIn:a,sendInvitation:i,roles:r};return o&&(f.password=o),c&&(f.expirationDateTime=c),this._dataRequestor.send({path:u,apiName:"invite",requestType:"POST",useAuthorizationHeaders:!0,postData:JSON.stringify(f),useMultiPart:l,headers:d,getErrorAsMessage:!0,expectedErrorCodes:s,qosExtraData:{graphApiVersion:this._graphApiVersion}}).then(function(e){return e.value})},e}();t.a=c}
,function(e,t,n){n.d(t,{a:function(){return a}});var a=function(){function e(e){this._isCopilotEnabled=e}return e.prototype.getIsCopilotEnabled=function(){return this._isCopilotEnabled},e.prototype.getAppData=function(){return this._appData},e.prototype.getContextData=function(){return this._contextData},e.prototype.getCopilotFeedbackProps=function(){return this._copilotFeedbackProps},e.prototype.getCopilotSummaryDisabledReasonsMask=function(){return this._copilotSummaryDisabledReasonsMask},e.prototype.setAppData=function(e){this._appData=e},e.prototype.setContextData=function(e){this._contextData=e},e.prototype.setCopilotFeedbackProps=function(e){this._copilotFeedbackProps=e},e.prototype.setCopilotSummaryDisabledReasonsMask=function(e){this._copilotSummaryDisabledReasonsMask=e},e}()}
,function(e,t,n){n.d(t,{a:function(){return I}});var a=n("react-dom-lib"),i=n(0),r=n("react-lib"),o=n(2),s=n(1),c=n(104),d=n(43),l=n(3),u=n(541),f=n(542),p=(0,d.a)({lineHeightRemove:{lineHeight:""},backgroundRemove:{backgroundColor:""},compatStyles:{display:"contents",color:"inherit",backgroundColor:"inherit",textAlign:"inherit",fontFamily:"inherit",fontSize:"inherit",fontWeight:"inherit",lineHeight:"inherit"}}),m=r.forwardRef(function(e,t){var n,a=p(),o=e.className,s=e.configOverride,c=e.children,d=e.applyStylesToPortals,m=(0,i.f)(e,["className","configOverride","children","applyStylesToPortals"]);return!0===(null==s?void 0:s.compat)&&(d=null!=d&&d),n=r.useMemo(function(){return l.a.apply(void 0,(0,i.g)([o],function(e){var t=[];return"remove"===(null==e?void 0:e.lineHeight)&&t.push(a.lineHeightRemove),"remove"===(null==e?void 0:e.background)&&t.push(a.backgroundRemove),!0===(null==e?void 0:e.compat)&&t.push(a.compatStyles),t}(s),!1))},[s,o]),r.createElement(u.a,(0,i.a)({},m,{className:n,applyStylesToPortals:d,ref:t},!0===(null==s?void 0:s.compat)?{"data-is-visible":!0}:{}),r.createElement(f.a,null,c))});m.displayName="FluentProviderWithOverrides";var _,h=n(539),b=n(353);!function(e){e.Body="body",e.Label="label",e.Heading="heading",e.Title="title"}(_||(_={}));var g=function(e){var t=Number(e.fontWeight);return(0,i.a)({fontFamily:e.fontFamily},t&&{fontWeight:t})},v=n(106),y=function(e){var t=function(e){var t,n,a=e.fontSlots&&(t=e.fontSlots,n={100:{fontFamily:""},200:{fontFamily:""},300:{fontFamily:""},400:{fontFamily:""},500:{fontFamily:""},600:{fontFamily:""},700:{fontFamily:""},800:{fontFamily:""},900:{fontFamily:""},1e3:{fontFamily:""},1100:{fontFamily:""},1200:{fontFamily:""},1300:{fontFamily:""},1400:{fontFamily:""},1500:{fontFamily:""},1600:{fontFamily:""},1700:{fontFamily:""}},Object.keys(t).forEach(function(e){var a=t[e];switch(e){case _.Body:n[100]=g(a),n[200]=g(a),n[300]=g(a),n[700]=g(a),n[800]=g(a),n[900]=g(a);break;case _.Label:n[400]=g(a),n[500]=g(a),n[600]=g(a);break;case _.Heading:n[1e3]=g(a),n[1100]=g(a),n[1200]=g(a),n[1300]=g(a),n[1400]=g(a);break;case _.Title:n[1500]=g(a),n[1600]=g(a),n[1700]=g(a);break;default:console.log("createV9MigrationTheme: ".concat(e," is not a supported font slot."))}}),n),i=(0,b.a)(void 0,a);return(0,h.a)(e,i)}(e);return(0,i.a)((0,i.a)({},t),{vivaConnectionsSoftBackground:e.isInverted?e.palette.themeLight:e.palette.themeLighterAlt,semanticPrimaryButtonText:e.semanticColors.primaryButtonText,semanticPrimaryButtonTextHovered:e.semanticColors.primaryButtonTextHovered,semanticPrimaryButtonBackgroundHovered:e.semanticColors.primaryButtonBackgroundHovered,semanticButtonBackgroundDisabled:e.semanticColors.buttonBackgroundDisabled,semanticPrimaryButtonBackgroundDisabled:e.semanticColors.primaryButtonBackgroundDisabled,semanticButtonTextDisabled:e.semanticColors.buttonTextDisabled,semanticDisabledBackground:e.semanticColors.disabledBackground,semanticButtonTextHovered:e.semanticColors.buttonTextHovered,semanticButtonBackgroundHovered:e.semanticColors.buttonBackgroundHovered,semanticPrimaryButtonBackgroundPressed:e.semanticColors.primaryButtonBackgroundPressed,semanticPrimaryButtonTextPressed:e.semanticColors.primaryButtonTextPressed,semanticDisabledText:e.semanticColors.disabledText,semanticActionLink:e.semanticColors.actionLink,semanticBodyText:e.semanticColors.bodyText,semanticDisabledBodyText:e.semanticColors.disabledBodyText,semanticDisabledBodySubtext:e.semanticColors.disabledBodySubtext,semanticInputBackground:e.semanticColors.inputBackground,semanticInputText:e.semanticColors.inputText,semanticPrimaryButtonTextDisabled:e.semanticColors.primaryButtonTextDisabled,semanticPrimaryButtonBackground:e.semanticColors.primaryButtonBackground,semanticButtonBackground:e.semanticColors.buttonBackground,semanticButtonBorder:e.semanticColors.buttonBorder,semanticButtonBackgroundPressed:e.semanticColors.buttonBackgroundPressed,colorNeutralForeground4:(0,v.c)()?t.colorNeutralForeground4:e.semanticColors.inputPlaceholderText,semanticErrorBackground:e.semanticColors.errorBackground,semanticWarningBackground:e.semanticColors.warningBackground,semanticSuccessBackground:e.semanticColors.successBackground,semanticSevereWarningBackground:e.semanticColors.severeWarningBackground,semanticInfoBackground:e.semanticColors.infoBackground,semanticErrorIcon:e.semanticColors.errorIcon,semanticWarningIcon:e.semanticColors.warningIcon,semanticSuccessIcon:e.semanticColors.successIcon,semanticSevereWarningIcon:e.semanticColors.severeWarningIcon,semanticInfoIcon:e.semanticColors.infoIcon})},S=n(245),D=r.forwardRef(function(e,t){var n,a=e.dir,s=e.theme,d=a||("rtl"===(null===(n=null===document||void 0===document?void 0:document.documentElement)||void 0===n?void 0:n.dir)?"rtl":"ltr"),l=r.useMemo(function(){return y(s)},[s]),u=r.useRef(l),f=r.useRef(s),p=r.useReducer(function(e){return e+1},0)[1],_=u.current,h=function(e){e&&(0,S.a)(e,f.current)||(f.current=e,u.current=y(e),p())};return r.useMemo(function(){(0,o.M)(h)},[]),r.useEffect(function(){return function(){(0,o.N)(h)}},[]),r.createElement(c.a,{dir:d},r.createElement(m,(0,i.a)({},e,{theme:_,dir:d,ref:t}),e.children))});D.displayName="FluentMigrationThemeWrapper";var I,x=function(e,t){var n,a,i,r=null==t?void 0:t.children[0];if(!r||!r.classList.contains("fui-FluentProvider"))return null;var o=Object.keys(r).find(function(e){return e.startsWith("__reactFiber$")});if(!o)return null;var s=null===(i=null===(a=null===(n=r[o])||void 0===n?void 0:n.child)||void 0===a?void 0:a.child)||void 0===i?void 0:i.child;return!s||s.type!==e.type||s.stateNode instanceof Node?null:s.stateNode},C={lineHeight:"remove",background:"remove"},O={compat:!0},w=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e[0],c=e[1],d=e.slice(2),l=r.isValidElement(n)&&n||void 0;a.render.apply(a,(0,i.g)([r.createElement(D,{theme:(0,o.D)(),configOverride:s.b.isActivated("6cda8c08-94f5-469f-8312-b4c4442d386a")?C:O},n),c],d,!1));try{if(l)return x(l,c)}catch(e){}return null},E=n(269),A=n(538),L=function(e){var t=e.children,n=r.useMemo(A.a,[]);return r.createElement(E.a.Provider,{value:n},t)};I=s.a.isActivated("26DDB843-862A-4916-A636-1BCE47633238")?a.render:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e[0],a=e.slice(1);return w.apply(void 0,(0,i.g)([r.createElement(L,null,n)],a,!1))}}
,,,,,,function(e,t,n){var a;n.d(t,{a:function(){return a}}),function(e){e.ScriptLoaded="share_scriptsLoaded",e.UIReady="share_uiReady",e.Ready="share_ready",e.Error="share_error",e.Resize="share_resize",e.GrantAccessCompleted="share_grantAccessCompleted",e.Dismiss="share_dismiss",e.ReadyForRecipients="share_readyForRecipients",e.OutlookClicked="share_outlookClicked",e.SendRecipients="atMention_defaultRecipients",e.ManageAccessClicked="share_manageAccessClicked",e.ShareCompleted="share_completed",e.MakeVisible="share_makeVisible",e.Destruct="share_destruct",e.ResetMakeVisible="share_resetMakeVisible",e.InstantLoadReady="share_instantLoadReady",e.ShareContextInformation="share_postContextInformation",e.Started="share_started",e.LinkSettingCompleted="share_linkSettingsCompleted",e.GetToken="share_getToken",e.DocumentInformation="share_documentInformation",e.SharingInfoBarInformation="share_sharingInfoBarInformation",e.SharingStoreReady="share_sharingStoreReady",e.ShareLoadResult="share_loadResult"}(a||(a={}))}
,function(e,t,n){n.d(t,{a:function(){return i}});var a=n(40);function i(e){switch(e){case a.a.odb:case a.a.wac:case a.a.odc:case a.a.odcWac:return"Files";case a.a.sharePoint:return"SPO DocLib";case a.a.sharePointPages:return"SPO Sites";case a.a.ngsc:return"Sync";case a.a.listPart:case a.a.listsHome:case a.a.listsIos:return"Lists";case a.a.npe:return"Photos"}return"None"}}
,,,,,,,,,function(e,t,n){n.d(t,{a:function(){return i}});var a=n(50);function i(e){try{if(!e)return;if("string"==typeof e)return(0,a.e)(e,!1);if((0,a.c)(e))return e;if(e.message)return e.loggableMessage?e.loggableMessage:(0,a.e)(e.message,!1);if(e.name)return(0,a.e)(e.name,!0)}catch(e){}}}
,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){var a;n.d(t,{a:function(){return a}}),function(e){e[e.Single=0]="Single",e[e.Start=1]="Start",e[e.End=2]="End"}(a||(a={}))}
,function(e,t,n){n.d(t,{a:function(){return i}});var a=n(0),i=function(){function e(e){if(e<=0)throw new Error("Size must be positive");this._size=e,this._buffer=new Array(e),this._length=0,this._head=-1}return e.prototype.push=function(e){this._length<this._size&&this._length++,this._head++,this._head===this._size&&(this._head=0),this._buffer[this._head]=e},e.prototype.popOldest=function(){if(0===this._length)return null;var e=(this._head-this._length+1+this._size)%this._size;return this._length--,this._buffer[e]},Object.defineProperty(e.prototype,"isFull",{get:function(){return this._length>=this._size},enumerable:!1,configurable:!0}),e.prototype.getAll=function(){var e=this._head+1;return this._length<this._size?this._buffer.slice(0,e):(0,a.g)((0,a.g)([],this._buffer.slice(e),!0),this._buffer.slice(0,e),!0)},e}()}
,function(e,t){var n;!function(e){e[e.none=0]="none",e[e.viewChange=1]="viewChange",e[e.inPageNavigation=2]="inPageNavigation",e[e.pageToPageNavigation=3]="pageToPageNavigation",e[e.fullPageLoad=4]="fullPageLoad",e[e.onePageAppNavigation=5]="onePageAppNavigation"}(n||(n={})),t.a=n}
,function(e,t,n){function a(e){return decodeURIComponent(escape(atob(e)))}function i(e){try{return!!btoa(atob(e)).match(/^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)?$/)}catch(e){return!1}}function r(e){try{var t=(e=e.replace(/-/g,"+").replace(/_/g,"/")).length%4;if(t){if(1===t)return"";e+=new Array(5-t).join("=")}return e}catch(e){return""}}function o(e){var t=r(e);return!(e.length>0&&""===t)&&i(t)}function s(e){var t=r(e);return i(t)?a(t):""}n.d(t,{a:function(){return a},b:function(){return s},c:function(){return o}})}
,function(e,t){var n=function(){function e(t){var n;if(this._raw=t,t){t=(t=t.replace(/\u200e|\u200f/g,"")).trim();for(var a,i,r=new RegExp(e.EmailRegexPattern,"gi"),o=e.EmailMatchTypes.None,s=e.EmailMatchTypes.None;null!==(i=r.exec(t));){var c=i[0],d=c.charAt(0),l=c.charAt(c.length-1);if((s="<"===d&&">"===l?e.EmailMatchTypes.Bracketed:'"'===d&&'"'===l?e.EmailMatchTypes.Quoted:e.EmailMatchTypes.Bare)>o&&(a=i,o=s,s===e.EmailMatchTypes.Bracketed))break}var u=t;if(a){n=a[0];var f=a.index,p=f+n.length,m=f>0?t.substr(0,f).trim():"",_=p<t.length?t.substr(p):"";"'"===(n=e.StripBracketsAndQuotesRegex.exec(n)[1]).charAt(0)&&_&&"'"===_.charAt(0)&&(n=n.slice(1),_=_.slice(1).trim()),u=""===m?_:m,this._email=n.trim()}(u=u.replace(/^\s*"\s*/,"").trim()).length>1&&"/"!==u.charAt(u.length-2)&&(u=u.replace(/\s*"$/,"")),""!==(u=u.replace(/\//g,""))&&u!==n&&(this._name=u)}}return e.isValidEmailSyntax=function(t,n){return!!t&&!!(n?e.ValidEmailRegex:e.EmailRegex).exec(t.trim())},e.parse=function(t){if(!t)return[];for(var n=e._splitAddresses(t),a=[],i=0,r=n.length;i<r;i++)a.push(new e(n[i]));return a},e.endsWithDelimiter=function(t){if(t){var n=t.split(e.DelimiterRegex);return!n[n.length-1].trim()}return!1},e._splitAddresses=function(t){for(var n=t.split(e.DelimiterRegex),a=n.length-1;a>=0;a--)n[a]=n[a].trim(),0===n[a].length&&n.splice(a,1);return n},e.prototype.getEmail=function(){return this._email},e.prototype.getName=function(){return this._name},e.prototype.getRaw=function(){return this._raw},e.EmailRegexPattern="(?:[<\"]\\s*)?[a-z0-9\\u0080-\\uFFFF!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9\\u0080-\\uFFFF!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9\\u0080-\\uFFFF](?:[a-z0-9\\u0080-\\uFFFF-]*[a-z0-9\\u0080-\\uFFFF])?\\.)+[a-z0-9\\u0080-\\uFFFF](?:[a-z0-9\\u0080-\\uFFFF-]*[a-z0-9\\u0080-\\uFFFF])?(?:\\s*[>\"])?",e.EmailRegex=new RegExp(e.EmailRegexPattern,"i"),e.ValidEmailRegexPattern="[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@((?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?)",e.ValidEmailRegex=new RegExp(e.ValidEmailRegexPattern,"i"),e.StripBracketsAndQuotesRegex=/^[<"]?([^<>"]*)[>"]?$/,e.DelimiterRegex=/[,;](?=(?:[^"]*"[^"]*")*(?![^"]*"))/,e.EmailMatchTypes={None:0,Quoted:1,Bare:2,Bracketed:3},e}();t.a=n}
,function(e,t,n){var a;n.d(t,{a:function(){return a}}),function(e){e[e.invalidType=-1]="invalidType",e[e.noListTemplate=0]="noListTemplate",e[e.genericList=100]="genericList",e[e.documentLibrary=101]="documentLibrary",e[e.survey=102]="survey",e[e.links=103]="links",e[e.announcements=104]="announcements",e[e.contacts=105]="contacts",e[e.events=106]="events",e[e.tasks=107]="tasks",e[e.pictureLibrary=109]="pictureLibrary",e[e.webTemplateCatalog=111]="webTemplateCatalog",e[e.webPartCatalog=113]="webPartCatalog",e[e.listTemplateCatalog=114]="listTemplateCatalog",e[e.xmlFormLibrary=115]="xmlFormLibrary",e[e.masterPageCatalog=116]="masterPageCatalog",e[e.webPageLibrary=119]="webPageLibrary",e[e.customGrid=120]="customGrid",e[e.solutionCatalog=121]="solutionCatalog",e[e.themeCatalog=123]="themeCatalog",e[e.designCatalog=124]="designCatalog",e[e.appDataCatalog=125]="appDataCatalog",e[e.ganttTasks=150]="ganttTasks",e[e.promotedLinks=170]="promotedLinks",e[e.tasksWithTimelineAndHierarchy=171]="tasksWithTimelineAndHierarchy",e[e.meetings=200]="meetings",e[e.externalList=600]="externalList",e[e.mySiteDocumentLibrary=700]="mySiteDocumentLibrary",e[e.publishingPageLibrary=850]="publishingPageLibrary",e[e.publishingAsset=851]="publishingAsset",e[e.issueTracking=1100]="issueTracking",e[e.contentCenterModelLibrary=1328]="contentCenterModelLibrary",e[e.contentCenterPrimeLibrary=1329]="contentCenterPrimeLibrary",e[e.contentCenterSampleLibrary=1330]="contentCenterSampleLibrary",e[e.contentCenterModelUsageList=1331]="contentCenterModelUsageList",e[e.contentCenterExplanationList=1332]="contentCenterExplanationList",e[e.corporateCatalog=330]="corporateCatalog",e[e.siteCollectionCorporateCatalog=336]="siteCollectionCorporateCatalog",e[e.SyntexModernTemplateLibrary=4e3]="SyntexModernTemplateLibrary",e[e.SyntexSnippetLibrary=4200]="SyntexSnippetLibrary",e[e.SyntexFieldsLibrary=4201]="SyntexFieldsLibrary"}(a||(a={}))}
,function(e,t,n){n.d(t,{a:function(){return r},b:function(){return i}});var a=n(4);function i(e,t,n){if(e&&e.ClientData)try{var i=JSON.parse(e.ClientData),r={isGuestMode:i.IsGuestMode,isDarkMode:i.IsDarkMode,puid:i.PUID,systemUserKey:null==n?void 0:n.systemUserKey};t.end({resultType:a.b.Success,extraData:r})}catch(e){t.end({resultType:a.b.Failure,error:e,extraData:{systemUserKey:null==n?void 0:n.systemUserKey}})}else t.end({resultType:a.b.ExpectedFailure,error:"NoNavBarData or NoClientData",extraData:n?{systemUserKey:null==n?void 0:n.systemUserKey}:{}})}function r(e){var t=e.baseUrl,n=e.cultureName;return"".concat(t,"/_layouts/15/online/handlers/SpoSuiteLinks.ashx?Locale=").concat(n,"&v=2&msajax=1&cv=2")}}
,function(e,t,n){var a;n.d(t,{a:function(){return a}}),function(e){e[e.Family=0]="Family",e[e.FamilyMember=1]="FamilyMember"}(a||(a={}))}
,,function(e,t,n){var a;n.d(t,{a:function(){return a}}),function(e){e[e.None=0]="None",e[e.WaitingForSharingInfoBarInformation=1]="WaitingForSharingInfoBarInformation",e[e.Visible=2]="Visible",e[e.Dismissed=3]="Dismissed"}(a||(a={}))}
,function(e,t,n){n.d(t,{a:function(){return a}});var a=!n(1).b.isActivated("6d2a844a-9c33-46b3-80c2-9e47560a97b7","4/26/2022")}
]]),define("plt.odsp-common",[],{});